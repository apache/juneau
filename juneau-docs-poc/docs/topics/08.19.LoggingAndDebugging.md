---
title: "Logging / Debugging"
---

The REST APIs provides supports enabling logging of HTTP requests and responses through
the following annotations:
- [Rest](../apidocs/org/apache/juneau/rest/annotation/Rest.html)
- [debug](../apidocs/org/apache/juneau/rest/annotation/Rest.html#debug())
- [debugOn](../apidocs/org/apache/juneau/rest/annotation/Rest.html#debugOn())
- [RestOp](../apidocs/org/apache/juneau/rest/annotation/RestOp.html)
- [debug](../apidocs/org/apache/juneau/rest/annotation/RestOp.html#debug())

Debug mode enables the following:
-
HTTP request/response bodies are cached in memory for logging purposes.
-
HTTP requests/responses are logged to the registered [CallLogger](../apidocs/org/apache/juneau/rest/logger/CallLogger.html).
The possible annotation values are:
"true" - Debug is enabled for all requests.
"false" - Debug is disabled for all requests.
"conditional" - Debug is enabled only for requests that have a Debug: true header.
### Example


```java
// Enable debugging on all op calls on this resource
@Rest(debug="true")
public class MyResource {...}
```


These annotations support SVL variables, so it's possible to define them as a system property for example.

```java
// Enable via system property 'MyResource.debug'
@Rest(debug="$S{MyResource.debug}")
public class MyResource {...}
```


The [@Rest(debugOn)](../apidocs/org/apache/juneau/rest/annotation/Rest.html#debugOn()) annotation can also be used
to enable debugging.  It takes a comma-delimited list of key-value pairs, the keys
being class or method names, and the values being one of `true|false|conditional`.

```java
// Turn on debug per-request on the class and always on the doX() method
@Rest(debugOn="MyResource=conditional,MyResource.doX=true")
public class MyResource {...}
```


The primary advantage of [@Rest(debugOn)](../apidocs/org/apache/juneau/rest/annotation/Rest.html#debugOn()) is that
you can control debugging externally such as through a system property or environment variable:

```java
// Turn on debug per-request on the class and always on the doX() method
@Rest(debugOn="$E{DEBUG}")
public class MyResource {...}
```


Debugging can also be enabled programmatically with the use of the following APIs:
- [DebugEnablement](../apidocs/org/apache/juneau/rest/debug/DebugEnablement.html)
- [BasicDebugEnablement](../apidocs/org/apache/juneau/rest/debug/BasicDebugEnablement.html)
- [Builder](../apidocs/org/apache/juneau/rest/RestContext/Builder.html)
- [debugEnablement()](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#debugEnablement())
- [debugEnablement(Class)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#debugEnablement(Class))
- [debugEnablement(DebugEnablement)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#debugEnablement(DebugEnablement))

HTTP calls can be logged with the following levels of granularity:
- [CallLoggingDetail](../apidocs/org/apache/juneau/rest/logger/CallLoggingDetail.html)
- [STATUS_LINE](../apidocs/org/apache/juneau/rest/logger/CallLoggingDetail.html#STATUS_LINE)
- [HEADER](../apidocs/org/apache/juneau/rest/logger/CallLoggingDetail.html#HEADER)
- [ENTITY](../apidocs/org/apache/juneau/rest/logger/CallLoggingDetail.html#ENTITY)

The following examples show the output format for each detail type:
### STATUS_LINE


```text
WARNING: [500] HTTP POST /foo?foo=bar
```


### HEADER


```text
WARNING:
=== HTTP Call (incoming) ===================================================
[500] HTTP POST /foo?foo=bar
    Request length: 3 bytes
    Response code: 500
    Response length: 3 bytes
    Exec time: 20ms
---Request Headers---
    Foo: bar
---Response Headers---
    Foo: bar
    Content-Type: text/plain
=== END ===================================================================
```


### ENTITY


```text
WARNING:
=== HTTP Call (incoming) ===================================================
[500] HTTP POST /foo?foo=bar
    Request length: 3 bytes
    Response code: 500
    Response length: 3 bytes
    Exec time: 20ms
---Request Headers---
    Foo: bar
---Response Headers---
    Foo: bar
    Content-Type: text/plain
---Request Content UTF-8---
Foo
---Request Content Hex---
46 6F 6F
---Response Content UTF-8---
Foo
---Response Content Hex---
46 6F 6F
=== END ===================================================================
```


The interface responsible for generating the log entries is [CallLogger](../apidocs/org/apache/juneau/rest/logger/CallLogger.html)
and the default is [BasicCallLogger](../apidocs/org/apache/juneau/rest/logger/BasicCallLogger.html) which produces the output above.  It
can be changed through any of the following:
- [Rest](../apidocs/org/apache/juneau/rest/annotation/Rest.html)
- [callLogger()](../apidocs/org/apache/juneau/rest/annotation/Rest.html#callLogger())
- [Builder](../apidocs/org/apache/juneau/rest/RestContext/Builder.html)
- [callLogger()](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#callLogger())
- [callLogger(Class)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#callLogger(Class))
- [callLogger(CallLogger)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#callLogger(CallLogger))

The call logger uses logging rules to map requests to logging detail levels.
By default, these are the logging rules:

```java
RestLogger
    .create()
    .beanStore(beanStore)  // Allow injected beans in constructor
    .normalRules(  // Rules when debugging is not enabled
        RestLoggerRule.create()  // Log 500+ errors with status-line and header information
            .statusFilter(x -> x >= 500)
            .level(SEVERE)
            .requestDetail(HEADER)
            .responseDetail(HEADER)
            .build(),
        RestLoggerRule.create()  // Log 400-500 errors with just status-line information
            .statusFilter(x -> x >= 400)
            .level(WARNING)
            .requestDetail(STATUS_LINE)
            .responseDetail(STATUS_LINE)
            .build()
    )
    .debugRules(  // Rules when debugging is enabled
        RestLoggerRule.create()  // Log everything with full details
            .level(SEVERE)
            .requestDetail(ENTITY)
            .responseDetail(ENTITY)
            .build()
    );
```


Thrown exceptions get logged with a stack trace hash and a counter like below:

```text
WARNING: [500,9b85cc96.13] HTTP POST /foo?foo=bar
```


Stack trace hashes are controlled by the [ThrownStore](../apidocs/org/apache/juneau/rest/stats/ThrownStore.html) bean which is configured
via the following:
- [Builder](../apidocs/org/apache/juneau/rest/RestContext/Builder.html)
- [thrownStore()](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#thrownStore())
- [thrownStore(Class)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#thrownStore(Class))
- [thrownStore(ThrownStore)](../apidocs/org/apache/juneau/rest/RestContext/Builder.html#thrownStore(ThrownStore))


:::note
The [BasicTestCallLogger](../apidocs/org/apache/juneau/rest/logger/BasicTestCallLogger.html) class is useful for testing and
allows you to suppress logging when testing error conditions by passing in a `noTrace=true` query parameter
or `No-Trace: true` header on requests.
- [DebugEnablement](../apidocs/org/apache/juneau/rest/debug/DebugEnablement.html), [CallLogger](../apidocs/org/apache/juneau/rest/logger/CallLogger.html), and

[ThrownStore](../apidocs/org/apache/juneau/rest/stats/ThrownStore.html) can all be defined globally as Spring beans in a Spring Boot environment.
:::
