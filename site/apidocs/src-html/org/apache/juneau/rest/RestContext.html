<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: org.apache.juneau.rest, class: RestContext">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../javadoc.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">// ***************************************************************************************************************************</span>
<span class="source-line-no">002</span><span id="line-2">// * Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements.  See the NOTICE file *</span>
<span class="source-line-no">003</span><span id="line-3">// * distributed with this work for additional information regarding copyright ownership.  The ASF licenses this file        *</span>
<span class="source-line-no">004</span><span id="line-4">// * to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance            *</span>
<span class="source-line-no">005</span><span id="line-5">// * with the License.  You may obtain a copy of the License at                                                              *</span>
<span class="source-line-no">006</span><span id="line-6">// *                                                                                                                         *</span>
<span class="source-line-no">007</span><span id="line-7">// *  http://www.apache.org/licenses/LICENSE-2.0                                                                             *</span>
<span class="source-line-no">008</span><span id="line-8">// *                                                                                                                         *</span>
<span class="source-line-no">009</span><span id="line-9">// * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an  *</span>
<span class="source-line-no">010</span><span id="line-10">// * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the License for the        *</span>
<span class="source-line-no">011</span><span id="line-11">// * specific language governing permissions and limitations under the License.                                              *</span>
<span class="source-line-no">012</span><span id="line-12">// ***************************************************************************************************************************</span>
<span class="source-line-no">013</span><span id="line-13">package org.apache.juneau.rest;</span>
<span class="source-line-no">014</span><span id="line-14"></span>
<span class="source-line-no">015</span><span id="line-15">import static jakarta.servlet.http.HttpServletResponse.*;</span>
<span class="source-line-no">016</span><span id="line-16">import static org.apache.juneau.collections.JsonMap.*;</span>
<span class="source-line-no">017</span><span id="line-17">import static org.apache.juneau.common.internal.IOUtils.*;</span>
<span class="source-line-no">018</span><span id="line-18">import static org.apache.juneau.common.internal.StringUtils.*;</span>
<span class="source-line-no">019</span><span id="line-19">import static org.apache.juneau.common.internal.Utils.*;</span>
<span class="source-line-no">020</span><span id="line-20">import static org.apache.juneau.http.HttpHeaders.*;</span>
<span class="source-line-no">021</span><span id="line-21">import static org.apache.juneau.internal.ClassUtils.*;</span>
<span class="source-line-no">022</span><span id="line-22">import static org.apache.juneau.internal.CollectionUtils.*;</span>
<span class="source-line-no">023</span><span id="line-23">import static org.apache.juneau.rest.processor.ResponseProcessor.*;</span>
<span class="source-line-no">024</span><span id="line-24">import static java.util.Collections.*;</span>
<span class="source-line-no">025</span><span id="line-25">import static java.util.Optional.*;</span>
<span class="source-line-no">026</span><span id="line-26">import static org.apache.juneau.rest.annotation.RestOpAnnotation.*;</span>
<span class="source-line-no">027</span><span id="line-27"></span>
<span class="source-line-no">028</span><span id="line-28">import java.io.*;</span>
<span class="source-line-no">029</span><span id="line-29">import java.lang.annotation.*;</span>
<span class="source-line-no">030</span><span id="line-30">import java.lang.reflect.*;</span>
<span class="source-line-no">031</span><span id="line-31">import java.lang.reflect.Method;</span>
<span class="source-line-no">032</span><span id="line-32">import java.nio.charset.*;</span>
<span class="source-line-no">033</span><span id="line-33">import java.time.*;</span>
<span class="source-line-no">034</span><span id="line-34">import java.util.*;</span>
<span class="source-line-no">035</span><span id="line-35">import java.util.concurrent.*;</span>
<span class="source-line-no">036</span><span id="line-36">import java.util.concurrent.atomic.*;</span>
<span class="source-line-no">037</span><span id="line-37">import java.util.function.*;</span>
<span class="source-line-no">038</span><span id="line-38">import java.util.logging.*;</span>
<span class="source-line-no">039</span><span id="line-39"></span>
<span class="source-line-no">040</span><span id="line-40">import jakarta.servlet.*;</span>
<span class="source-line-no">041</span><span id="line-41">import jakarta.servlet.http.*;</span>
<span class="source-line-no">042</span><span id="line-42"></span>
<span class="source-line-no">043</span><span id="line-43">import org.apache.http.Header;</span>
<span class="source-line-no">044</span><span id="line-44">import org.apache.juneau.*;</span>
<span class="source-line-no">045</span><span id="line-45">import org.apache.juneau.collections.*;</span>
<span class="source-line-no">046</span><span id="line-46">import org.apache.juneau.common.internal.*;</span>
<span class="source-line-no">047</span><span id="line-47">import org.apache.juneau.config.*;</span>
<span class="source-line-no">048</span><span id="line-48">import org.apache.juneau.config.vars.*;</span>
<span class="source-line-no">049</span><span id="line-49">import org.apache.juneau.cp.*;</span>
<span class="source-line-no">050</span><span id="line-50">import org.apache.juneau.bean.swagger.Swagger;</span>
<span class="source-line-no">051</span><span id="line-51">import org.apache.juneau.encoders.*;</span>
<span class="source-line-no">052</span><span id="line-52">import org.apache.juneau.html.*;</span>
<span class="source-line-no">053</span><span id="line-53">import org.apache.juneau.html.annotation.*;</span>
<span class="source-line-no">054</span><span id="line-54">import org.apache.juneau.httppart.*;</span>
<span class="source-line-no">055</span><span id="line-55">import org.apache.juneau.httppart.HttpPartSerializer.Creator;</span>
<span class="source-line-no">056</span><span id="line-56">import org.apache.juneau.internal.*;</span>
<span class="source-line-no">057</span><span id="line-57">import org.apache.juneau.jsonschema.*;</span>
<span class="source-line-no">058</span><span id="line-58">import org.apache.juneau.oapi.*;</span>
<span class="source-line-no">059</span><span id="line-59">import org.apache.juneau.parser.*;</span>
<span class="source-line-no">060</span><span id="line-60">import org.apache.juneau.parser.ParseException;</span>
<span class="source-line-no">061</span><span id="line-61">import org.apache.juneau.reflect.*;</span>
<span class="source-line-no">062</span><span id="line-62">import org.apache.juneau.rest.annotation.*;</span>
<span class="source-line-no">063</span><span id="line-63">import org.apache.juneau.rest.arg.*;</span>
<span class="source-line-no">064</span><span id="line-64">import org.apache.juneau.rest.debug.*;</span>
<span class="source-line-no">065</span><span id="line-65">import org.apache.juneau.rest.httppart.*;</span>
<span class="source-line-no">066</span><span id="line-66">import org.apache.juneau.rest.logger.*;</span>
<span class="source-line-no">067</span><span id="line-67">import org.apache.juneau.rest.processor.*;</span>
<span class="source-line-no">068</span><span id="line-68">import org.apache.juneau.rest.rrpc.*;</span>
<span class="source-line-no">069</span><span id="line-69">import org.apache.juneau.rest.servlet.*;</span>
<span class="source-line-no">070</span><span id="line-70">import org.apache.juneau.rest.staticfile.*;</span>
<span class="source-line-no">071</span><span id="line-71">import org.apache.juneau.rest.stats.*;</span>
<span class="source-line-no">072</span><span id="line-72">import org.apache.juneau.rest.swagger.*;</span>
<span class="source-line-no">073</span><span id="line-73">import org.apache.juneau.http.annotation.*;</span>
<span class="source-line-no">074</span><span id="line-74">import org.apache.juneau.http.header.*;</span>
<span class="source-line-no">075</span><span id="line-75">import org.apache.juneau.http.response.*;</span>
<span class="source-line-no">076</span><span id="line-76">import org.apache.juneau.rest.util.*;</span>
<span class="source-line-no">077</span><span id="line-77">import org.apache.juneau.rest.vars.*;</span>
<span class="source-line-no">078</span><span id="line-78">import org.apache.juneau.serializer.*;</span>
<span class="source-line-no">079</span><span id="line-79">import org.apache.juneau.svl.*;</span>
<span class="source-line-no">080</span><span id="line-80">import org.apache.juneau.svl.vars.*;</span>
<span class="source-line-no">081</span><span id="line-81">import org.apache.juneau.utils.*;</span>
<span class="source-line-no">082</span><span id="line-82"></span>
<span class="source-line-no">083</span><span id="line-83">/**</span>
<span class="source-line-no">084</span><span id="line-84"> * Defines the initial configuration of a &lt;c&gt;RestServlet&lt;/c&gt; or &lt;c&gt;@Rest&lt;/c&gt; annotated object.</span>
<span class="source-line-no">085</span><span id="line-85"> *</span>
<span class="source-line-no">086</span><span id="line-86"> * &lt;p&gt;</span>
<span class="source-line-no">087</span><span id="line-87"> * An extension of the {@link ServletConfig} object used during servlet initialization.</span>
<span class="source-line-no">088</span><span id="line-88"> *</span>
<span class="source-line-no">089</span><span id="line-89"> * &lt;p&gt;</span>
<span class="source-line-no">090</span><span id="line-90"> * Methods are provided for overriding or augmenting the information provided by the &lt;ja&gt;@Rest&lt;/ja&gt; annotation.</span>
<span class="source-line-no">091</span><span id="line-91"> * In general, most information provided in the &lt;ja&gt;@Rest&lt;/ja&gt; annotation can be specified programmatically</span>
<span class="source-line-no">092</span><span id="line-92"> * through calls on this object.</span>
<span class="source-line-no">093</span><span id="line-93"> *</span>
<span class="source-line-no">094</span><span id="line-94"> * &lt;p&gt;</span>
<span class="source-line-no">095</span><span id="line-95"> * To interact with this object, simply pass it in as a constructor argument or in an INIT hook.</span>
<span class="source-line-no">096</span><span id="line-96"> * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">097</span><span id="line-97"> *    &lt;jc&gt;// Option #1 - Pass in through constructor.&lt;/jc&gt;</span>
<span class="source-line-no">098</span><span id="line-98"> *    &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) {</span>
<span class="source-line-no">099</span><span id="line-99"> *          &lt;jv&gt;builder&lt;/jv&gt;</span>
<span class="source-line-no">100</span><span id="line-100"> *             .swaps(TemporalCalendarSwap.IsoLocalDateTime.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">101</span><span id="line-101"> *    }</span>
<span class="source-line-no">102</span><span id="line-102"> *</span>
<span class="source-line-no">103</span><span id="line-103"> *    &lt;jc&gt;// Option #2 - Use an init hook.&lt;/jc&gt;</span>
<span class="source-line-no">104</span><span id="line-104"> *    &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">105</span><span id="line-105"> *    &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">106</span><span id="line-106"> *          &lt;jv&gt;builder&lt;/jv&gt;</span>
<span class="source-line-no">107</span><span id="line-107"> *             .swaps(TemporalCalendarSwap.IsoLocalDateTime.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">108</span><span id="line-108"> *    }</span>
<span class="source-line-no">109</span><span id="line-109"> * &lt;/p&gt;</span>
<span class="source-line-no">110</span><span id="line-110"> *</span>
<span class="source-line-no">111</span><span id="line-111"> * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">112</span><span id="line-112"> *    &lt;li class='note'&gt;This class is thread safe and reusable.</span>
<span class="source-line-no">113</span><span id="line-113"> * &lt;/ul&gt;</span>
<span class="source-line-no">114</span><span id="line-114"> *</span>
<span class="source-line-no">115</span><span id="line-115"> * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">116</span><span id="line-116"> *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestContext"&gt;RestContext&lt;/a&gt;</span>
<span class="source-line-no">117</span><span id="line-117"></span>
<span class="source-line-no">118</span><span id="line-118"> * &lt;/ul&gt;</span>
<span class="source-line-no">119</span><span id="line-119"> */</span>
<span class="source-line-no">120</span><span id="line-120">public class RestContext extends Context {</span>
<span class="source-line-no">121</span><span id="line-121"></span>
<span class="source-line-no">122</span><span id="line-122">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">123</span><span id="line-123">   // Static</span>
<span class="source-line-no">124</span><span id="line-124">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">125</span><span id="line-125"></span>
<span class="source-line-no">126</span><span id="line-126">   private static final Map&lt;Class&lt;?&gt;, RestContext&gt; REGISTRY = new ConcurrentHashMap&lt;&gt;();</span>
<span class="source-line-no">127</span><span id="line-127"></span>
<span class="source-line-no">128</span><span id="line-128">   /**</span>
<span class="source-line-no">129</span><span id="line-129">    * Returns a registry of all created {@link RestContext} objects.</span>
<span class="source-line-no">130</span><span id="line-130">    *</span>
<span class="source-line-no">131</span><span id="line-131">    * @return An unmodifiable map of resource classes to {@link RestContext} objects.</span>
<span class="source-line-no">132</span><span id="line-132">    */</span>
<span class="source-line-no">133</span><span id="line-133">   public static final Map&lt;Class&lt;?&gt;, RestContext&gt; getGlobalRegistry() {</span>
<span class="source-line-no">134</span><span id="line-134">      return u(REGISTRY);</span>
<span class="source-line-no">135</span><span id="line-135">   }</span>
<span class="source-line-no">136</span><span id="line-136"></span>
<span class="source-line-no">137</span><span id="line-137">   /**</span>
<span class="source-line-no">138</span><span id="line-138">    * Creates a new builder for this object.</span>
<span class="source-line-no">139</span><span id="line-139">    *</span>
<span class="source-line-no">140</span><span id="line-140">    * @param resourceClass</span>
<span class="source-line-no">141</span><span id="line-141">    *    The class annotated with &lt;ja&gt;@Rest&lt;/ja&gt;.</span>
<span class="source-line-no">142</span><span id="line-142">    *    &lt;br&gt;Must not be &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">143</span><span id="line-143">    * @param parentContext</span>
<span class="source-line-no">144</span><span id="line-144">    *    The parent context if the REST bean was registered via {@link Rest#children()}.</span>
<span class="source-line-no">145</span><span id="line-145">    *    &lt;br&gt;Can be &lt;jk&gt;null&lt;/jk&gt; if the bean is a top-level resource.</span>
<span class="source-line-no">146</span><span id="line-146">    * @param servletConfig</span>
<span class="source-line-no">147</span><span id="line-147">    *    The servlet config passed into the servlet by the servlet container.</span>
<span class="source-line-no">148</span><span id="line-148">    *    &lt;br&gt;Can be &lt;jk&gt;null&lt;/jk&gt; if not available.</span>
<span class="source-line-no">149</span><span id="line-149">    *    &lt;br&gt;If &lt;jk&gt;null&lt;/jk&gt;, then some features (such as access to servlet init params) will not be available.</span>
<span class="source-line-no">150</span><span id="line-150">    *</span>
<span class="source-line-no">151</span><span id="line-151">    * @return A new builder object.</span>
<span class="source-line-no">152</span><span id="line-152">    * @throws ServletException Something bad happened.</span>
<span class="source-line-no">153</span><span id="line-153">    */</span>
<span class="source-line-no">154</span><span id="line-154">   public static Builder create(Class&lt;?&gt; resourceClass, RestContext parentContext, ServletConfig servletConfig) throws ServletException {</span>
<span class="source-line-no">155</span><span id="line-155">      return new Builder(resourceClass, parentContext, servletConfig);</span>
<span class="source-line-no">156</span><span id="line-156">   }</span>
<span class="source-line-no">157</span><span id="line-157"></span>
<span class="source-line-no">158</span><span id="line-158">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">159</span><span id="line-159">   // Builder</span>
<span class="source-line-no">160</span><span id="line-160">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">161</span><span id="line-161"></span>
<span class="source-line-no">162</span><span id="line-162">   /**</span>
<span class="source-line-no">163</span><span id="line-163">    * Builder class.</span>
<span class="source-line-no">164</span><span id="line-164">    */</span>
<span class="source-line-no">165</span><span id="line-165">   @FluentSetters(ignore={"set"})</span>
<span class="source-line-no">166</span><span id="line-166">   public static class Builder extends Context.Builder implements ServletConfig {</span>
<span class="source-line-no">167</span><span id="line-167"></span>
<span class="source-line-no">168</span><span id="line-168">      private static final Set&lt;Class&lt;?&gt;&gt; DELAYED_INJECTION = Utils.set(</span>
<span class="source-line-no">169</span><span id="line-169">         BeanContext.Builder.class,</span>
<span class="source-line-no">170</span><span id="line-170">         BeanStore.Builder.class,</span>
<span class="source-line-no">171</span><span id="line-171">         BeanStore.class,</span>
<span class="source-line-no">172</span><span id="line-172">         CallLogger.Builder.class,</span>
<span class="source-line-no">173</span><span id="line-173">         CallLogger.class,</span>
<span class="source-line-no">174</span><span id="line-174">         Config.class,</span>
<span class="source-line-no">175</span><span id="line-175">         DebugEnablement.Builder.class,</span>
<span class="source-line-no">176</span><span id="line-176">         DebugEnablement.class,</span>
<span class="source-line-no">177</span><span id="line-177">         EncoderSet.Builder.class,</span>
<span class="source-line-no">178</span><span id="line-178">         EncoderSet.class,</span>
<span class="source-line-no">179</span><span id="line-179">         FileFinder.Builder.class,</span>
<span class="source-line-no">180</span><span id="line-180">         FileFinder.class,</span>
<span class="source-line-no">181</span><span id="line-181">         HttpPartParser.class,</span>
<span class="source-line-no">182</span><span id="line-182">         HttpPartParser.Creator.class,</span>
<span class="source-line-no">183</span><span id="line-183">         HttpPartSerializer.class,</span>
<span class="source-line-no">184</span><span id="line-184">         HttpPartSerializer.Creator.class,</span>
<span class="source-line-no">185</span><span id="line-185">         JsonSchemaGenerator.Builder.class,</span>
<span class="source-line-no">186</span><span id="line-186">         JsonSchemaGenerator.class,</span>
<span class="source-line-no">187</span><span id="line-187">         Logger.class,</span>
<span class="source-line-no">188</span><span id="line-188">         Messages.Builder.class,</span>
<span class="source-line-no">189</span><span id="line-189">         Messages.class,</span>
<span class="source-line-no">190</span><span id="line-190">         MethodExecStore.Builder.class,</span>
<span class="source-line-no">191</span><span id="line-191">         MethodExecStore.class,</span>
<span class="source-line-no">192</span><span id="line-192">         ParserSet.Builder.class,</span>
<span class="source-line-no">193</span><span id="line-193">         ParserSet.class,</span>
<span class="source-line-no">194</span><span id="line-194">         ResponseProcessorList.Builder.class,</span>
<span class="source-line-no">195</span><span id="line-195">         ResponseProcessorList.class,</span>
<span class="source-line-no">196</span><span id="line-196">         RestChildren.Builder.class,</span>
<span class="source-line-no">197</span><span id="line-197">         RestChildren.class,</span>
<span class="source-line-no">198</span><span id="line-198">         RestOpArgList.Builder.class,</span>
<span class="source-line-no">199</span><span id="line-199">         RestOpArgList.class,</span>
<span class="source-line-no">200</span><span id="line-200">         RestOperations.Builder.class,</span>
<span class="source-line-no">201</span><span id="line-201">         RestOperations.class,</span>
<span class="source-line-no">202</span><span id="line-202">         SerializerSet.Builder.class,</span>
<span class="source-line-no">203</span><span id="line-203">         SerializerSet.class,</span>
<span class="source-line-no">204</span><span id="line-204">         StaticFiles.Builder.class,</span>
<span class="source-line-no">205</span><span id="line-205">         StaticFiles.class,</span>
<span class="source-line-no">206</span><span id="line-206">         SwaggerProvider.Builder.class,</span>
<span class="source-line-no">207</span><span id="line-207">         SwaggerProvider.class,</span>
<span class="source-line-no">208</span><span id="line-208">         ThrownStore.Builder.class,</span>
<span class="source-line-no">209</span><span id="line-209">         ThrownStore.class,</span>
<span class="source-line-no">210</span><span id="line-210">         VarList.class,</span>
<span class="source-line-no">211</span><span id="line-211">         VarResolver.Builder.class,</span>
<span class="source-line-no">212</span><span id="line-212">         VarResolver.class</span>
<span class="source-line-no">213</span><span id="line-213">      );</span>
<span class="source-line-no">214</span><span id="line-214"></span>
<span class="source-line-no">215</span><span id="line-215">      private static final Set&lt;String&gt; DELAYED_INJECTION_NAMES = Utils.set(</span>
<span class="source-line-no">216</span><span id="line-216">         "defaultRequestAttributes",</span>
<span class="source-line-no">217</span><span id="line-217">         "defaultRequestHeaders",</span>
<span class="source-line-no">218</span><span id="line-218">         "defaultResponseHeaders",</span>
<span class="source-line-no">219</span><span id="line-219">         "destroyMethods",</span>
<span class="source-line-no">220</span><span id="line-220">         "endCallMethods",</span>
<span class="source-line-no">221</span><span id="line-221">         "postCallMethods",</span>
<span class="source-line-no">222</span><span id="line-222">         "postInitChildFirstMethods",</span>
<span class="source-line-no">223</span><span id="line-223">         "postInitMethods",</span>
<span class="source-line-no">224</span><span id="line-224">         "preCallMethods",</span>
<span class="source-line-no">225</span><span id="line-225">         "startCallMethods"</span>
<span class="source-line-no">226</span><span id="line-226">      );</span>
<span class="source-line-no">227</span><span id="line-227"></span>
<span class="source-line-no">228</span><span id="line-228">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">229</span><span id="line-229">      // The following fields are meant to be modifiable.</span>
<span class="source-line-no">230</span><span id="line-230">      // They should not be declared final.</span>
<span class="source-line-no">231</span><span id="line-231">      // Read-only snapshots of these will be made in RestServletContext.</span>
<span class="source-line-no">232</span><span id="line-232">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">233</span><span id="line-233"></span>
<span class="source-line-no">234</span><span id="line-234">      private boolean initialized;</span>
<span class="source-line-no">235</span><span id="line-235"></span>
<span class="source-line-no">236</span><span id="line-236">      ResourceSupplier resource;</span>
<span class="source-line-no">237</span><span id="line-237">      ServletContext servletContext;</span>
<span class="source-line-no">238</span><span id="line-238"></span>
<span class="source-line-no">239</span><span id="line-239">      final ServletConfig inner;</span>
<span class="source-line-no">240</span><span id="line-240">      final Class&lt;?&gt; resourceClass;</span>
<span class="source-line-no">241</span><span id="line-241">      final RestContext parentContext;</span>
<span class="source-line-no">242</span><span id="line-242"></span>
<span class="source-line-no">243</span><span id="line-243">      private DefaultClassList defaultClasses;</span>
<span class="source-line-no">244</span><span id="line-244">      private DefaultSettingsMap defaultSettings;</span>
<span class="source-line-no">245</span><span id="line-245"></span>
<span class="source-line-no">246</span><span id="line-246">      private BeanStore rootBeanStore, beanStore;</span>
<span class="source-line-no">247</span><span id="line-247">      private Config config;</span>
<span class="source-line-no">248</span><span id="line-248">      private VarResolver.Builder varResolver;</span>
<span class="source-line-no">249</span><span id="line-249">      private Logger logger;</span>
<span class="source-line-no">250</span><span id="line-250">      private ThrownStore.Builder thrownStore;</span>
<span class="source-line-no">251</span><span id="line-251">      private MethodExecStore.Builder methodExecStore;</span>
<span class="source-line-no">252</span><span id="line-252">      private Messages.Builder messages;</span>
<span class="source-line-no">253</span><span id="line-253">      private ResponseProcessorList.Builder responseProcessors;</span>
<span class="source-line-no">254</span><span id="line-254">      private BeanCreator&lt;CallLogger&gt; callLogger;</span>
<span class="source-line-no">255</span><span id="line-255">      private HttpPartSerializer.Creator partSerializer;</span>
<span class="source-line-no">256</span><span id="line-256">      private HttpPartParser.Creator partParser;</span>
<span class="source-line-no">257</span><span id="line-257">      private JsonSchemaGenerator.Builder jsonSchemaGenerator;</span>
<span class="source-line-no">258</span><span id="line-258">      private BeanCreator&lt;StaticFiles&gt; staticFiles;</span>
<span class="source-line-no">259</span><span id="line-259">      private HeaderList defaultRequestHeaders, defaultResponseHeaders;</span>
<span class="source-line-no">260</span><span id="line-260">      private NamedAttributeMap defaultRequestAttributes;</span>
<span class="source-line-no">261</span><span id="line-261">      private RestOpArgList.Builder restOpArgs;</span>
<span class="source-line-no">262</span><span id="line-262">      private BeanCreator&lt;DebugEnablement&gt; debugEnablement;</span>
<span class="source-line-no">263</span><span id="line-263">      private MethodList startCallMethods, endCallMethods, postInitMethods, postInitChildFirstMethods, destroyMethods, preCallMethods, postCallMethods;</span>
<span class="source-line-no">264</span><span id="line-264">      private RestOperations.Builder restOperations;</span>
<span class="source-line-no">265</span><span id="line-265">      private RestChildren.Builder restChildren;</span>
<span class="source-line-no">266</span><span id="line-266">      private BeanCreator&lt;SwaggerProvider&gt; swaggerProvider;</span>
<span class="source-line-no">267</span><span id="line-267">      private BeanContext.Builder beanContext;</span>
<span class="source-line-no">268</span><span id="line-268">      private EncoderSet.Builder encoders;</span>
<span class="source-line-no">269</span><span id="line-269">      private SerializerSet.Builder serializers;</span>
<span class="source-line-no">270</span><span id="line-270">      private ParserSet.Builder parsers;</span>
<span class="source-line-no">271</span><span id="line-271"></span>
<span class="source-line-no">272</span><span id="line-272">      String</span>
<span class="source-line-no">273</span><span id="line-273">         allowedHeaderParams = env("RestContext.allowedHeaderParams", "Accept,Content-Type"),</span>
<span class="source-line-no">274</span><span id="line-274">         allowedMethodHeaders = env("RestContext.allowedMethodHeaders", ""),</span>
<span class="source-line-no">275</span><span id="line-275">         allowedMethodParams = env("RestContext.allowedMethodParams", "HEAD,OPTIONS"),</span>
<span class="source-line-no">276</span><span id="line-276">         clientVersionHeader = env("RestContext.clientVersionHeader", "Client-Version"),</span>
<span class="source-line-no">277</span><span id="line-277">         debugOn = env("RestContext.debugOn", null),</span>
<span class="source-line-no">278</span><span id="line-278">         path = null,</span>
<span class="source-line-no">279</span><span id="line-279">         uriAuthority = env("RestContext.uriAuthority", (String)null),</span>
<span class="source-line-no">280</span><span id="line-280">         uriContext = env("RestContext.uriContext", (String)null);</span>
<span class="source-line-no">281</span><span id="line-281">      UriRelativity uriRelativity = env("RestContext.uriRelativity", UriRelativity.RESOURCE);</span>
<span class="source-line-no">282</span><span id="line-282">      UriResolution uriResolution = env("RestContext.uriResolution", UriResolution.ROOT_RELATIVE);</span>
<span class="source-line-no">283</span><span id="line-283">      Charset defaultCharset = env("RestContext.defaultCharset", IOUtils.UTF8);</span>
<span class="source-line-no">284</span><span id="line-284">      long maxInput = parseLongWithSuffix(env("RestContext.maxInput", "100M"));</span>
<span class="source-line-no">285</span><span id="line-285">      List&lt;MediaType&gt; consumes, produces;</span>
<span class="source-line-no">286</span><span id="line-286">      boolean disableContentParam = env("RestContext.disableContentParam", false);</span>
<span class="source-line-no">287</span><span id="line-287">      boolean renderResponseStackTraces = env("RestContext.renderResponseStackTraces", false);</span>
<span class="source-line-no">288</span><span id="line-288"></span>
<span class="source-line-no">289</span><span id="line-289">      Class&lt;? extends RestChildren&gt; childrenClass = RestChildren.class;</span>
<span class="source-line-no">290</span><span id="line-290">      Class&lt;? extends RestOpContext&gt; opContextClass = RestOpContext.class;</span>
<span class="source-line-no">291</span><span id="line-291">      Class&lt;? extends RestOperations&gt; operationsClass = RestOperations.class;</span>
<span class="source-line-no">292</span><span id="line-292"></span>
<span class="source-line-no">293</span><span id="line-293">      List&lt;Object&gt; children = Utils.list();</span>
<span class="source-line-no">294</span><span id="line-294"></span>
<span class="source-line-no">295</span><span id="line-295">      /**</span>
<span class="source-line-no">296</span><span id="line-296">       * Constructor.</span>
<span class="source-line-no">297</span><span id="line-297">       *</span>
<span class="source-line-no">298</span><span id="line-298">       * @param resourceClass</span>
<span class="source-line-no">299</span><span id="line-299">       *    The REST servlet/bean type that this context is defined against.</span>
<span class="source-line-no">300</span><span id="line-300">       * @param parentContext The parent context if this is a child of another resource.</span>
<span class="source-line-no">301</span><span id="line-301">       * @param servletConfig The servlet config if available.</span>
<span class="source-line-no">302</span><span id="line-302">       */</span>
<span class="source-line-no">303</span><span id="line-303">      protected Builder(Class&lt;?&gt; resourceClass, RestContext parentContext, ServletConfig servletConfig) {</span>
<span class="source-line-no">304</span><span id="line-304"></span>
<span class="source-line-no">305</span><span id="line-305">         this.resourceClass = resourceClass;</span>
<span class="source-line-no">306</span><span id="line-306">         this.inner = servletConfig;</span>
<span class="source-line-no">307</span><span id="line-307">         this.parentContext = parentContext;</span>
<span class="source-line-no">308</span><span id="line-308"></span>
<span class="source-line-no">309</span><span id="line-309">         // Pass-through default values.</span>
<span class="source-line-no">310</span><span id="line-310">         if (parentContext != null) {</span>
<span class="source-line-no">311</span><span id="line-311">            defaultClasses = parentContext.defaultClasses.copy();</span>
<span class="source-line-no">312</span><span id="line-312">            defaultSettings = parentContext.defaultSettings.copy();</span>
<span class="source-line-no">313</span><span id="line-313">            rootBeanStore = parentContext.rootBeanStore;</span>
<span class="source-line-no">314</span><span id="line-314">         } else {</span>
<span class="source-line-no">315</span><span id="line-315">            defaultClasses = DefaultClassList.create();</span>
<span class="source-line-no">316</span><span id="line-316">            defaultSettings = DefaultSettingsMap.create();</span>
<span class="source-line-no">317</span><span id="line-317">         }</span>
<span class="source-line-no">318</span><span id="line-318">      }</span>
<span class="source-line-no">319</span><span id="line-319"></span>
<span class="source-line-no">320</span><span id="line-320">      @Override /* Context.Builder */</span>
<span class="source-line-no">321</span><span id="line-321">      public Builder copy() {</span>
<span class="source-line-no">322</span><span id="line-322">         throw new NoSuchMethodError("Not implemented.");</span>
<span class="source-line-no">323</span><span id="line-323">      }</span>
<span class="source-line-no">324</span><span id="line-324"></span>
<span class="source-line-no">325</span><span id="line-325">      @Override /* BeanContext.Builder */</span>
<span class="source-line-no">326</span><span id="line-326">      public RestContext build() {</span>
<span class="source-line-no">327</span><span id="line-327">         try {</span>
<span class="source-line-no">328</span><span id="line-328">            return beanStore().createBean(RestContext.class).type(getType().orElse(RestContext.class)).builder(RestContext.Builder.class, this).run();</span>
<span class="source-line-no">329</span><span id="line-329">         } catch (Exception e) {</span>
<span class="source-line-no">330</span><span id="line-330">            throw new InternalServerError(e, "Could not instantiate RestContext.");</span>
<span class="source-line-no">331</span><span id="line-331">         }</span>
<span class="source-line-no">332</span><span id="line-332">      }</span>
<span class="source-line-no">333</span><span id="line-333"></span>
<span class="source-line-no">334</span><span id="line-334">      /**</span>
<span class="source-line-no">335</span><span id="line-335">       * Performs initialization on this builder against the specified REST servlet/bean instance.</span>
<span class="source-line-no">336</span><span id="line-336">       *</span>
<span class="source-line-no">337</span><span id="line-337">       * @param resource</span>
<span class="source-line-no">338</span><span id="line-338">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">339</span><span id="line-339">       * @return This object.</span>
<span class="source-line-no">340</span><span id="line-340">       * @throws ServletException If hook method calls failed.</span>
<span class="source-line-no">341</span><span id="line-341">       */</span>
<span class="source-line-no">342</span><span id="line-342">      public Builder init(Supplier&lt;?&gt; resource) throws ServletException {</span>
<span class="source-line-no">343</span><span id="line-343"></span>
<span class="source-line-no">344</span><span id="line-344">         if (initialized)</span>
<span class="source-line-no">345</span><span id="line-345">            return this;</span>
<span class="source-line-no">346</span><span id="line-346">         initialized = true;</span>
<span class="source-line-no">347</span><span id="line-347"></span>
<span class="source-line-no">348</span><span id="line-348">         this.resource = new ResourceSupplier(resourceClass, resource);</span>
<span class="source-line-no">349</span><span id="line-349">         Supplier&lt;?&gt; r = this.resource;</span>
<span class="source-line-no">350</span><span id="line-350">         Class&lt;?&gt; rc = resourceClass;</span>
<span class="source-line-no">351</span><span id="line-351"></span>
<span class="source-line-no">352</span><span id="line-352">         beanStore = createBeanStore(resource)</span>
<span class="source-line-no">353</span><span id="line-353">            .build()</span>
<span class="source-line-no">354</span><span id="line-354">            .addBean(Builder.class, this)</span>
<span class="source-line-no">355</span><span id="line-355">            .addBean(ResourceSupplier.class, this.resource)</span>
<span class="source-line-no">356</span><span id="line-356">            .addBean(ServletConfig.class, inner != null ? inner : this)</span>
<span class="source-line-no">357</span><span id="line-357">            .addBean(ServletContext.class, (inner != null ? inner : this).getServletContext());</span>
<span class="source-line-no">358</span><span id="line-358"></span>
<span class="source-line-no">359</span><span id="line-359">         if (rootBeanStore == null) {</span>
<span class="source-line-no">360</span><span id="line-360">            rootBeanStore = beanStore;</span>
<span class="source-line-no">361</span><span id="line-361">            beanStore = BeanStore.of(rootBeanStore, r.get());</span>
<span class="source-line-no">362</span><span id="line-362">         }</span>
<span class="source-line-no">363</span><span id="line-363">         BeanStore bs = beanStore;</span>
<span class="source-line-no">364</span><span id="line-364"></span>
<span class="source-line-no">365</span><span id="line-365">         beanStore.add(BeanStore.class, bs);</span>
<span class="source-line-no">366</span><span id="line-366">         varResolver = createVarResolver(bs, r, rc);</span>
<span class="source-line-no">367</span><span id="line-367">         beanStore.add(VarResolver.class, varResolver.build());</span>
<span class="source-line-no">368</span><span id="line-368">         config = beanStore.add(Config.class, createConfig(bs, r, rc));</span>
<span class="source-line-no">369</span><span id="line-369">         beanStore.add(VarResolver.class, varResolver.bean(Config.class, config).build());</span>
<span class="source-line-no">370</span><span id="line-370"></span>
<span class="source-line-no">371</span><span id="line-371">         ClassInfo rci = ClassInfo.of(resourceClass);</span>
<span class="source-line-no">372</span><span id="line-372"></span>
<span class="source-line-no">373</span><span id="line-373">         // Get @RestInject fields initialized with values.</span>
<span class="source-line-no">374</span><span id="line-374">         rci.forEachAllField(</span>
<span class="source-line-no">375</span><span id="line-375">            x -&gt; x.hasAnnotation(RestInject.class),</span>
<span class="source-line-no">376</span><span id="line-376">            x -&gt; x.getOptional(resource.get()).ifPresent(</span>
<span class="source-line-no">377</span><span id="line-377">               y -&gt; beanStore.add(</span>
<span class="source-line-no">378</span><span id="line-378">                  x.getType().inner(),</span>
<span class="source-line-no">379</span><span id="line-379">                  y,</span>
<span class="source-line-no">380</span><span id="line-380">                  RestInjectAnnotation.name(x.getAnnotation(RestInject.class))</span>
<span class="source-line-no">381</span><span id="line-381">               )</span>
<span class="source-line-no">382</span><span id="line-382">            )</span>
<span class="source-line-no">383</span><span id="line-383">         );</span>
<span class="source-line-no">384</span><span id="line-384"></span>
<span class="source-line-no">385</span><span id="line-385">         rci.forEachMethod(x -&gt; x.hasAnnotation(RestInject.class), x -&gt; {</span>
<span class="source-line-no">386</span><span id="line-386">            Class&lt;Object&gt; rt = x.getReturnType().inner();</span>
<span class="source-line-no">387</span><span id="line-387">            String name = RestInjectAnnotation.name(x.getAnnotation(RestInject.class));</span>
<span class="source-line-no">388</span><span id="line-388">            if (! (DELAYED_INJECTION.contains(rt) || DELAYED_INJECTION_NAMES.contains(name))) {</span>
<span class="source-line-no">389</span><span id="line-389">               beanStore</span>
<span class="source-line-no">390</span><span id="line-390">                  .createMethodFinder(rt)</span>
<span class="source-line-no">391</span><span id="line-391">                  .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">392</span><span id="line-392">                  .run(y -&gt; beanStore.add(rt, y, name));</span>
<span class="source-line-no">393</span><span id="line-393">            }</span>
<span class="source-line-no">394</span><span id="line-394">         });</span>
<span class="source-line-no">395</span><span id="line-395"></span>
<span class="source-line-no">396</span><span id="line-396">         VarResolverSession vrs = varResolver().build().createSession();</span>
<span class="source-line-no">397</span><span id="line-397">         AnnotationWorkList work = AnnotationWorkList.of(vrs, rci.getAnnotationList(CONTEXT_APPLY_FILTER));</span>
<span class="source-line-no">398</span><span id="line-398"></span>
<span class="source-line-no">399</span><span id="line-399">         apply(work);</span>
<span class="source-line-no">400</span><span id="line-400">         beanContext().apply(work);</span>
<span class="source-line-no">401</span><span id="line-401">         partSerializer().apply(work);</span>
<span class="source-line-no">402</span><span id="line-402">         partParser().apply(work);</span>
<span class="source-line-no">403</span><span id="line-403">         jsonSchemaGenerator().apply(work);</span>
<span class="source-line-no">404</span><span id="line-404"></span>
<span class="source-line-no">405</span><span id="line-405">         runInitHooks(bs, resource());</span>
<span class="source-line-no">406</span><span id="line-406"></span>
<span class="source-line-no">407</span><span id="line-407">         // Set @RestInject fields not initialized with values.</span>
<span class="source-line-no">408</span><span id="line-408">         rci.forEachAllField(</span>
<span class="source-line-no">409</span><span id="line-409">            x -&gt; x.hasAnnotation(RestInject.class),</span>
<span class="source-line-no">410</span><span id="line-410">            x -&gt; x.setIfNull(</span>
<span class="source-line-no">411</span><span id="line-411">               resource.get(),</span>
<span class="source-line-no">412</span><span id="line-412">               beanStore.getBean(</span>
<span class="source-line-no">413</span><span id="line-413">                  x.getType().inner(),</span>
<span class="source-line-no">414</span><span id="line-414">                  RestInjectAnnotation.name(x.getAnnotation(RestInject.class))</span>
<span class="source-line-no">415</span><span id="line-415">               ).orElse(null)</span>
<span class="source-line-no">416</span><span id="line-416">            )</span>
<span class="source-line-no">417</span><span id="line-417">         );</span>
<span class="source-line-no">418</span><span id="line-418"></span>
<span class="source-line-no">419</span><span id="line-419">         return this;</span>
<span class="source-line-no">420</span><span id="line-420">      }</span>
<span class="source-line-no">421</span><span id="line-421"></span>
<span class="source-line-no">422</span><span id="line-422">      private void runInitHooks(BeanStore beanStore, Supplier&lt;?&gt; resource) throws ServletException {</span>
<span class="source-line-no">423</span><span id="line-423"></span>
<span class="source-line-no">424</span><span id="line-424">         Object r = resource.get();</span>
<span class="source-line-no">425</span><span id="line-425"></span>
<span class="source-line-no">426</span><span id="line-426">         Map&lt;String,MethodInfo&gt; map = map();</span>
<span class="source-line-no">427</span><span id="line-427">         ClassInfo.ofProxy(r).forEachAllMethodParentFirst(</span>
<span class="source-line-no">428</span><span id="line-428">            y -&gt; y.hasAnnotation(RestInit.class) &amp;&amp; ! y.hasArg(RestOpContext.Builder.class),</span>
<span class="source-line-no">429</span><span id="line-429">            y -&gt; {</span>
<span class="source-line-no">430</span><span id="line-430">               String sig = y.getSignature();</span>
<span class="source-line-no">431</span><span id="line-431">               if (! map.containsKey(sig))</span>
<span class="source-line-no">432</span><span id="line-432">                  map.put(sig, y.accessible());</span>
<span class="source-line-no">433</span><span id="line-433">            }</span>
<span class="source-line-no">434</span><span id="line-434">         );</span>
<span class="source-line-no">435</span><span id="line-435"></span>
<span class="source-line-no">436</span><span id="line-436">         for (MethodInfo m : map.values()) {</span>
<span class="source-line-no">437</span><span id="line-437">            if (! beanStore.hasAllParams(m))</span>
<span class="source-line-no">438</span><span id="line-438">               throw servletException("Could not call @RestInit method {0}.{1}.  Could not find prerequisites: {2}.", m.getDeclaringClass().getSimpleName(), m.getSignature(), beanStore.getMissingParams(m));</span>
<span class="source-line-no">439</span><span id="line-439">            try {</span>
<span class="source-line-no">440</span><span id="line-440">               m.invoke(r, beanStore.getParams(m));</span>
<span class="source-line-no">441</span><span id="line-441">            } catch (Exception e) {</span>
<span class="source-line-no">442</span><span id="line-442">               throw servletException(e, "Exception thrown from @RestInit method {0}.{1}.", m.getDeclaringClass().getSimpleName(), m.getSignature());</span>
<span class="source-line-no">443</span><span id="line-443">            }</span>
<span class="source-line-no">444</span><span id="line-444">         }</span>
<span class="source-line-no">445</span><span id="line-445">      }</span>
<span class="source-line-no">446</span><span id="line-446"></span>
<span class="source-line-no">447</span><span id="line-447">      /**</span>
<span class="source-line-no">448</span><span id="line-448">       * Returns the REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">449</span><span id="line-449">       *</span>
<span class="source-line-no">450</span><span id="line-450">       * @return The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">451</span><span id="line-451">       */</span>
<span class="source-line-no">452</span><span id="line-452">      public Supplier&lt;?&gt; resource() {</span>
<span class="source-line-no">453</span><span id="line-453">         return Objects.requireNonNull(resource, "Resource not available. init(Object) has not been called.");</span>
<span class="source-line-no">454</span><span id="line-454">      }</span>
<span class="source-line-no">455</span><span id="line-455"></span>
<span class="source-line-no">456</span><span id="line-456">      /**</span>
<span class="source-line-no">457</span><span id="line-457">       * Returns the REST servlet/bean instance that this context is defined against if it's the specified type.</span>
<span class="source-line-no">458</span><span id="line-458">       *</span>
<span class="source-line-no">459</span><span id="line-459">       * @param &lt;T&gt; The expected type of the resource bean.</span>
<span class="source-line-no">460</span><span id="line-460">       * @param type The expected type of the resource bean.</span>
<span class="source-line-no">461</span><span id="line-461">       * @return The bean cast to that instance, or {@link Optional#empty()} if it's not the specified type.</span>
<span class="source-line-no">462</span><span id="line-462">       */</span>
<span class="source-line-no">463</span><span id="line-463">      public &lt;T&gt; Optional&lt;T&gt; resourceAs(Class&lt;T&gt; type) {</span>
<span class="source-line-no">464</span><span id="line-464">         Object r = resource().get();</span>
<span class="source-line-no">465</span><span id="line-465">         return Utils.opt(type.isInstance(r) ? type.cast(r) : null);</span>
<span class="source-line-no">466</span><span id="line-466">      }</span>
<span class="source-line-no">467</span><span id="line-467"></span>
<span class="source-line-no">468</span><span id="line-468">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">469</span><span id="line-469">      // defaultClasses</span>
<span class="source-line-no">470</span><span id="line-470">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">471</span><span id="line-471"></span>
<span class="source-line-no">472</span><span id="line-472">      /**</span>
<span class="source-line-no">473</span><span id="line-473">       * Returns the default implementation class list.</span>
<span class="source-line-no">474</span><span id="line-474">       *</span>
<span class="source-line-no">475</span><span id="line-475">       * &lt;p&gt;</span>
<span class="source-line-no">476</span><span id="line-476">       * This defines the implementation classes for a variety of bean types.</span>
<span class="source-line-no">477</span><span id="line-477">       *</span>
<span class="source-line-no">478</span><span id="line-478">       * &lt;p&gt;</span>
<span class="source-line-no">479</span><span id="line-479">       * Default classes are inherited from the parent REST object.</span>
<span class="source-line-no">480</span><span id="line-480">       * Typically used on the top-level {@link RestContext.Builder} to affect class types for that REST object and all children.</span>
<span class="source-line-no">481</span><span id="line-481">       *</span>
<span class="source-line-no">482</span><span id="line-482">       * &lt;p&gt;</span>
<span class="source-line-no">483</span><span id="line-483">       * Modifying the default class list on this builder does not affect the default class list on the parent builder, but changes made</span>
<span class="source-line-no">484</span><span id="line-484">       * here are inherited by child builders.</span>
<span class="source-line-no">485</span><span id="line-485">       *</span>
<span class="source-line-no">486</span><span id="line-486">       * @return The default implementation class list.</span>
<span class="source-line-no">487</span><span id="line-487">       */</span>
<span class="source-line-no">488</span><span id="line-488">      public DefaultClassList defaultClasses() {</span>
<span class="source-line-no">489</span><span id="line-489">         return defaultClasses;</span>
<span class="source-line-no">490</span><span id="line-490">      }</span>
<span class="source-line-no">491</span><span id="line-491"></span>
<span class="source-line-no">492</span><span id="line-492">      /**</span>
<span class="source-line-no">493</span><span id="line-493">       * Adds to the default implementation class list.</span>
<span class="source-line-no">494</span><span id="line-494">       *</span>
<span class="source-line-no">495</span><span id="line-495">       * &lt;p&gt;</span>
<span class="source-line-no">496</span><span id="line-496">       * A shortcut for the following code:</span>
<span class="source-line-no">497</span><span id="line-497">       *</span>
<span class="source-line-no">498</span><span id="line-498">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">499</span><span id="line-499">       *    &lt;jv&gt;builder&lt;/jv&gt;.defaultClasses().add(&lt;jv&gt;values&lt;/jv&gt;);</span>
<span class="source-line-no">500</span><span id="line-500">       * &lt;/p&gt;</span>
<span class="source-line-no">501</span><span id="line-501">       *</span>
<span class="source-line-no">502</span><span id="line-502">       * @param values The values to add to the list of default classes.</span>
<span class="source-line-no">503</span><span id="line-503">       * @return This object.</span>
<span class="source-line-no">504</span><span id="line-504">       * @see #defaultClasses()</span>
<span class="source-line-no">505</span><span id="line-505">       */</span>
<span class="source-line-no">506</span><span id="line-506">      public Builder defaultClasses(Class&lt;?&gt;...values) {</span>
<span class="source-line-no">507</span><span id="line-507">         defaultClasses().add(values);</span>
<span class="source-line-no">508</span><span id="line-508">         return this;</span>
<span class="source-line-no">509</span><span id="line-509">      }</span>
<span class="source-line-no">510</span><span id="line-510"></span>
<span class="source-line-no">511</span><span id="line-511">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">512</span><span id="line-512">      // defaultSettings</span>
<span class="source-line-no">513</span><span id="line-513">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">514</span><span id="line-514"></span>
<span class="source-line-no">515</span><span id="line-515">      /**</span>
<span class="source-line-no">516</span><span id="line-516">       * Returns the default settings map.</span>
<span class="source-line-no">517</span><span id="line-517">       *</span>
<span class="source-line-no">518</span><span id="line-518">       * &lt;p&gt;</span>
<span class="source-line-no">519</span><span id="line-519">       * Default settings are inherited from the parent REST object.</span>
<span class="source-line-no">520</span><span id="line-520">       * Typically used on the top-level {@link RestContext.Builder} to affect settings for that REST object and all children.</span>
<span class="source-line-no">521</span><span id="line-521">       *</span>
<span class="source-line-no">522</span><span id="line-522">       * &lt;p&gt;</span>
<span class="source-line-no">523</span><span id="line-523">       * Modifying the default settings map on this builder does not affect the default settings on the parent builder, but changes made</span>
<span class="source-line-no">524</span><span id="line-524">       * here are inherited by child builders.</span>
<span class="source-line-no">525</span><span id="line-525">       *</span>
<span class="source-line-no">526</span><span id="line-526">       * @return The default settings map.</span>
<span class="source-line-no">527</span><span id="line-527">       */</span>
<span class="source-line-no">528</span><span id="line-528">      public DefaultSettingsMap defaultSettings() {</span>
<span class="source-line-no">529</span><span id="line-529">         return defaultSettings;</span>
<span class="source-line-no">530</span><span id="line-530">      }</span>
<span class="source-line-no">531</span><span id="line-531"></span>
<span class="source-line-no">532</span><span id="line-532">      /**</span>
<span class="source-line-no">533</span><span id="line-533">       * Sets a value in the default settings map.</span>
<span class="source-line-no">534</span><span id="line-534">       *</span>
<span class="source-line-no">535</span><span id="line-535">       * &lt;p&gt;</span>
<span class="source-line-no">536</span><span id="line-536">       * A shortcut for the following code:</span>
<span class="source-line-no">537</span><span id="line-537">       *</span>
<span class="source-line-no">538</span><span id="line-538">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">539</span><span id="line-539">       *    &lt;jv&gt;builder&lt;/jv&gt;.defaultSettings().add(&lt;jv&gt;key&lt;/jv&gt;, &lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">540</span><span id="line-540">       *</span>
<span class="source-line-no">541</span><span id="line-541">       * &lt;/p&gt;</span>
<span class="source-line-no">542</span><span id="line-542">       * @param key The setting key.</span>
<span class="source-line-no">543</span><span id="line-543">       * @param value The setting value.</span>
<span class="source-line-no">544</span><span id="line-544">       * @return This object.</span>
<span class="source-line-no">545</span><span id="line-545">       * @see #defaultSettings()</span>
<span class="source-line-no">546</span><span id="line-546">       */</span>
<span class="source-line-no">547</span><span id="line-547">      public Builder defaultSetting(String key, Object value) {</span>
<span class="source-line-no">548</span><span id="line-548">         defaultSettings().set(key, value);</span>
<span class="source-line-no">549</span><span id="line-549">         return this;</span>
<span class="source-line-no">550</span><span id="line-550">      }</span>
<span class="source-line-no">551</span><span id="line-551"></span>
<span class="source-line-no">552</span><span id="line-552">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">553</span><span id="line-553">      // beanStore</span>
<span class="source-line-no">554</span><span id="line-554">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">555</span><span id="line-555"></span>
<span class="source-line-no">556</span><span id="line-556">      /**</span>
<span class="source-line-no">557</span><span id="line-557">       * Returns the bean store in this builder.</span>
<span class="source-line-no">558</span><span id="line-558">       *</span>
<span class="source-line-no">559</span><span id="line-559">       * &lt;p&gt;</span>
<span class="source-line-no">560</span><span id="line-560">       * The bean store is a simple storage database for beans keyed by type and name.</span>
<span class="source-line-no">561</span><span id="line-561">       *</span>
<span class="source-line-no">562</span><span id="line-562">       * &lt;p&gt;</span>
<span class="source-line-no">563</span><span id="line-563">       * The bean store is created with the parent root bean store as the parent, allowing any beans in the root bean store to be available</span>
<span class="source-line-no">564</span><span id="line-564">       * in this builder.  The root bean store typically pulls from an injection framework such as Spring to allow injected beans to be used.</span>
<span class="source-line-no">565</span><span id="line-565">       *</span>
<span class="source-line-no">566</span><span id="line-566">       * &lt;p&gt;</span>
<span class="source-line-no">567</span><span id="line-567">       * The default bean store can be overridden via any of the following:</span>
<span class="source-line-no">568</span><span id="line-568">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">569</span><span id="line-569">       *    &lt;li&gt;Class annotation:  {@link Rest#beanStore() @Rest(beanStore)}</span>
<span class="source-line-no">570</span><span id="line-570">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated methods:</span>
<span class="source-line-no">571</span><span id="line-571">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">572</span><span id="line-572">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] BeanStore myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">573</span><span id="line-573">       *       &lt;/p&gt;</span>
<span class="source-line-no">574</span><span id="line-574">       *       Args can be any injected bean including {@link org.apache.juneau.cp.BeanStore.Builder}, the default builder.</span>
<span class="source-line-no">575</span><span id="line-575">       * &lt;/ul&gt;</span>
<span class="source-line-no">576</span><span id="line-576">       *</span>
<span class="source-line-no">577</span><span id="line-577">       * @return The bean store in this builder.</span>
<span class="source-line-no">578</span><span id="line-578">       */</span>
<span class="source-line-no">579</span><span id="line-579">      public BeanStore beanStore() {</span>
<span class="source-line-no">580</span><span id="line-580">         return beanStore;</span>
<span class="source-line-no">581</span><span id="line-581">      }</span>
<span class="source-line-no">582</span><span id="line-582"></span>
<span class="source-line-no">583</span><span id="line-583">      /**</span>
<span class="source-line-no">584</span><span id="line-584">       * Adds a bean to the bean store of this class.</span>
<span class="source-line-no">585</span><span id="line-585">       *</span>
<span class="source-line-no">586</span><span id="line-586">       * &lt;p&gt;</span>
<span class="source-line-no">587</span><span id="line-587">       * Equivalent to calling:</span>
<span class="source-line-no">588</span><span id="line-588">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">589</span><span id="line-589">       *    &lt;jv&gt;builder&lt;/jv&gt;.beanStore().add(&lt;jv&gt;beanType&lt;/jv&gt;, &lt;jv&gt;bean&lt;/jv&gt;);</span>
<span class="source-line-no">590</span><span id="line-590">       * &lt;/p&gt;</span>
<span class="source-line-no">591</span><span id="line-591">       *</span>
<span class="source-line-no">592</span><span id="line-592">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">593</span><span id="line-593">       *    &lt;li class='jm'&gt;{@link #beanStore()}</span>
<span class="source-line-no">594</span><span id="line-594">       * &lt;/ul&gt;</span>
<span class="source-line-no">595</span><span id="line-595">       *</span>
<span class="source-line-no">596</span><span id="line-596">       * @param &lt;T&gt; The class to associate this bean with.</span>
<span class="source-line-no">597</span><span id="line-597">       * @param beanType The class to associate this bean with.</span>
<span class="source-line-no">598</span><span id="line-598">       * @param bean The bean.  Can be &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">599</span><span id="line-599">       * @return This object.</span>
<span class="source-line-no">600</span><span id="line-600">       */</span>
<span class="source-line-no">601</span><span id="line-601">      public &lt;T&gt; Builder beanStore(Class&lt;T&gt; beanType, T bean) {</span>
<span class="source-line-no">602</span><span id="line-602">         beanStore().addBean(beanType, bean);</span>
<span class="source-line-no">603</span><span id="line-603">         return this;</span>
<span class="source-line-no">604</span><span id="line-604">      }</span>
<span class="source-line-no">605</span><span id="line-605"></span>
<span class="source-line-no">606</span><span id="line-606">      /**</span>
<span class="source-line-no">607</span><span id="line-607">       * Adds a bean to the bean store of this class.</span>
<span class="source-line-no">608</span><span id="line-608">       *</span>
<span class="source-line-no">609</span><span id="line-609">       * &lt;p&gt;</span>
<span class="source-line-no">610</span><span id="line-610">       * Equivalent to calling:</span>
<span class="source-line-no">611</span><span id="line-611">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">612</span><span id="line-612">       *    &lt;jv&gt;builder&lt;/jv&gt;.beanStore().add(&lt;jv&gt;beanType&lt;/jv&gt;, &lt;jv&gt;bean&lt;/jv&gt;, &lt;jv&gt;name&lt;/jv&gt;);</span>
<span class="source-line-no">613</span><span id="line-613">       * &lt;/p&gt;</span>
<span class="source-line-no">614</span><span id="line-614">       *</span>
<span class="source-line-no">615</span><span id="line-615">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">616</span><span id="line-616">       *    &lt;li class='jm'&gt;{@link #beanStore()}</span>
<span class="source-line-no">617</span><span id="line-617">       * &lt;/ul&gt;</span>
<span class="source-line-no">618</span><span id="line-618">       *</span>
<span class="source-line-no">619</span><span id="line-619">       * @param &lt;T&gt; The class to associate this bean with.</span>
<span class="source-line-no">620</span><span id="line-620">       * @param beanType The class to associate this bean with.</span>
<span class="source-line-no">621</span><span id="line-621">       * @param bean The bean.  Can be &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">622</span><span id="line-622">       * @param name The bean name if this is a named bean.  Can be &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">623</span><span id="line-623">       * @return This object.</span>
<span class="source-line-no">624</span><span id="line-624">       */</span>
<span class="source-line-no">625</span><span id="line-625">      public &lt;T&gt; Builder beanStore(Class&lt;T&gt; beanType, T bean, String name) {</span>
<span class="source-line-no">626</span><span id="line-626">         beanStore().addBean(beanType, bean, name);</span>
<span class="source-line-no">627</span><span id="line-627">         return this;</span>
<span class="source-line-no">628</span><span id="line-628">      }</span>
<span class="source-line-no">629</span><span id="line-629"></span>
<span class="source-line-no">630</span><span id="line-630">      /**</span>
<span class="source-line-no">631</span><span id="line-631">       * Returns the root bean store.</span>
<span class="source-line-no">632</span><span id="line-632">       *</span>
<span class="source-line-no">633</span><span id="line-633">       * &lt;p&gt;</span>
<span class="source-line-no">634</span><span id="line-634">       * This is the bean store inherited from the parent resource and does not include</span>
<span class="source-line-no">635</span><span id="line-635">       * any beans added by this class.</span>
<span class="source-line-no">636</span><span id="line-636">       *</span>
<span class="source-line-no">637</span><span id="line-637">       * @return The root bean store.</span>
<span class="source-line-no">638</span><span id="line-638">       */</span>
<span class="source-line-no">639</span><span id="line-639">      public BeanStore rootBeanStore() {</span>
<span class="source-line-no">640</span><span id="line-640">         return rootBeanStore;</span>
<span class="source-line-no">641</span><span id="line-641">      }</span>
<span class="source-line-no">642</span><span id="line-642"></span>
<span class="source-line-no">643</span><span id="line-643">      /**</span>
<span class="source-line-no">644</span><span id="line-644">       * Creates the bean store in this builder.</span>
<span class="source-line-no">645</span><span id="line-645">       *</span>
<span class="source-line-no">646</span><span id="line-646">       * @param resource</span>
<span class="source-line-no">647</span><span id="line-647">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">648</span><span id="line-648">       * @return A new bean store builder.</span>
<span class="source-line-no">649</span><span id="line-649">       */</span>
<span class="source-line-no">650</span><span id="line-650">      protected BeanStore.Builder createBeanStore(Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">651</span><span id="line-651"></span>
<span class="source-line-no">652</span><span id="line-652">         // Default value.</span>
<span class="source-line-no">653</span><span id="line-653">         Value&lt;BeanStore.Builder&gt; v = Value.of(</span>
<span class="source-line-no">654</span><span id="line-654">            BeanStore</span>
<span class="source-line-no">655</span><span id="line-655">               .create()</span>
<span class="source-line-no">656</span><span id="line-656">               .parent(rootBeanStore())</span>
<span class="source-line-no">657</span><span id="line-657">               .outer(resource.get())</span>
<span class="source-line-no">658</span><span id="line-658">         );</span>
<span class="source-line-no">659</span><span id="line-659"></span>
<span class="source-line-no">660</span><span id="line-660">         // Apply @Rest(beanStore).</span>
<span class="source-line-no">661</span><span id="line-661">         ClassInfo.of(resourceClass).forEachAnnotation(Rest.class, x -&gt; isNotVoid(x.beanStore()), x -&gt; v.get().type(x.beanStore()));</span>
<span class="source-line-no">662</span><span id="line-662"></span>
<span class="source-line-no">663</span><span id="line-663">         // Replace with bean from:  @RestInject public [static] BeanStore xxx(&lt;args&gt;)</span>
<span class="source-line-no">664</span><span id="line-664">         v.get().build()</span>
<span class="source-line-no">665</span><span id="line-665">            .createMethodFinder(BeanStore.class)</span>
<span class="source-line-no">666</span><span id="line-666">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">667</span><span id="line-667">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">668</span><span id="line-668"></span>
<span class="source-line-no">669</span><span id="line-669">         return v.get();</span>
<span class="source-line-no">670</span><span id="line-670">      }</span>
<span class="source-line-no">671</span><span id="line-671"></span>
<span class="source-line-no">672</span><span id="line-672">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">673</span><span id="line-673">      // varResolver</span>
<span class="source-line-no">674</span><span id="line-674">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">675</span><span id="line-675"></span>
<span class="source-line-no">676</span><span id="line-676">      /**</span>
<span class="source-line-no">677</span><span id="line-677">       * Returns the variable resolver sub-builder.</span>
<span class="source-line-no">678</span><span id="line-678">       *</span>
<span class="source-line-no">679</span><span id="line-679">       * &lt;p&gt;</span>
<span class="source-line-no">680</span><span id="line-680">       *    The variable resolver is used to resolve string variables of the form &lt;js&gt;"$X{...}"&lt;/js&gt; in various places such as annotations on the REST class and methods.</span>
<span class="source-line-no">681</span><span id="line-681">       *</span>
<span class="source-line-no">682</span><span id="line-682">       * &lt;p&gt;</span>
<span class="source-line-no">683</span><span id="line-683">       *    Can be used to add more variables or context objects to the variable resolver.</span>
<span class="source-line-no">684</span><span id="line-684">       *    These variables affect the variable resolver returned by {@link RestRequest#getVarResolverSession()}.</span>
<span class="source-line-no">685</span><span id="line-685">       *</span>
<span class="source-line-no">686</span><span id="line-686">       * &lt;p&gt;</span>
<span class="source-line-no">687</span><span id="line-687">       * The var resolver is created by the constructor using the {@link #createVarResolver(BeanStore,Supplier,Class)} method and is initialized with the following variables:</span>
<span class="source-line-no">688</span><span id="line-688">       * &lt;ul class='javatreec'&gt;</span>
<span class="source-line-no">689</span><span id="line-689">       *    &lt;li class='jc'&gt;{@link ArgsVar}</span>
<span class="source-line-no">690</span><span id="line-690">       *    &lt;li class='jc'&gt;{@link CoalesceVar}</span>
<span class="source-line-no">691</span><span id="line-691">       *    &lt;li class='jc'&gt;{@link ConfigVar}</span>
<span class="source-line-no">692</span><span id="line-692">       *    &lt;li class='jc'&gt;{@link EnvVariablesVar}</span>
<span class="source-line-no">693</span><span id="line-693">       *    &lt;li class='jc'&gt;{@link FileVar}</span>
<span class="source-line-no">694</span><span id="line-694">       *    &lt;li class='jc'&gt;{@link HtmlWidgetVar}</span>
<span class="source-line-no">695</span><span id="line-695">       *    &lt;li class='jc'&gt;{@link IfVar}</span>
<span class="source-line-no">696</span><span id="line-696">       *    &lt;li class='jc'&gt;{@link LenVar}</span>
<span class="source-line-no">697</span><span id="line-697">       *    &lt;li class='jc'&gt;{@link LocalizationVar}</span>
<span class="source-line-no">698</span><span id="line-698">       *    &lt;li class='jc'&gt;{@link LowerCaseVar}</span>
<span class="source-line-no">699</span><span id="line-699">       *    &lt;li class='jc'&gt;{@link ManifestFileVar}</span>
<span class="source-line-no">700</span><span id="line-700">       *    &lt;li class='jc'&gt;{@link NotEmptyVar}</span>
<span class="source-line-no">701</span><span id="line-701">       *    &lt;li class='jc'&gt;{@link PatternExtractVar}</span>
<span class="source-line-no">702</span><span id="line-702">       *    &lt;li class='jc'&gt;{@link PatternMatchVar}</span>
<span class="source-line-no">703</span><span id="line-703">       *    &lt;li class='jc'&gt;{@link PatternReplaceVar}</span>
<span class="source-line-no">704</span><span id="line-704">       *    &lt;li class='jc'&gt;{@link RequestAttributeVar}</span>
<span class="source-line-no">705</span><span id="line-705">       *    &lt;li class='jc'&gt;{@link RequestFormDataVar}</span>
<span class="source-line-no">706</span><span id="line-706">       *    &lt;li class='jc'&gt;{@link RequestHeaderVar}</span>
<span class="source-line-no">707</span><span id="line-707">       *    &lt;li class='jc'&gt;{@link RequestPathVar}</span>
<span class="source-line-no">708</span><span id="line-708">       *    &lt;li class='jc'&gt;{@link RequestQueryVar}</span>
<span class="source-line-no">709</span><span id="line-709">       *    &lt;li class='jc'&gt;{@link RequestSwaggerVar}</span>
<span class="source-line-no">710</span><span id="line-710">       *    &lt;li class='jc'&gt;{@link RequestVar}</span>
<span class="source-line-no">711</span><span id="line-711">       *    &lt;li class='jc'&gt;{@link SerializedRequestAttrVar}</span>
<span class="source-line-no">712</span><span id="line-712">       *    &lt;li class='jc'&gt;{@link ServletInitParamVar}</span>
<span class="source-line-no">713</span><span id="line-713">       *    &lt;li class='jc'&gt;{@link SubstringVar}</span>
<span class="source-line-no">714</span><span id="line-714">       *    &lt;li class='jc'&gt;{@link SwaggerVar}</span>
<span class="source-line-no">715</span><span id="line-715">       *    &lt;li class='jc'&gt;{@link SwitchVar}</span>
<span class="source-line-no">716</span><span id="line-716">       *    &lt;li class='jc'&gt;{@link SystemPropertiesVar}</span>
<span class="source-line-no">717</span><span id="line-717">       *    &lt;li class='jc'&gt;{@link UpperCaseVar}</span>
<span class="source-line-no">718</span><span id="line-718">       *    &lt;li class='jc'&gt;{@link UrlEncodeVar}</span>
<span class="source-line-no">719</span><span id="line-719">       *    &lt;li class='jc'&gt;{@link UrlVar}</span>
<span class="source-line-no">720</span><span id="line-720">       * &lt;/ul&gt;</span>
<span class="source-line-no">721</span><span id="line-721">       *</span>
<span class="source-line-no">722</span><span id="line-722">       * &lt;p&gt;</span>
<span class="source-line-no">723</span><span id="line-723">       * The default var resolver can be overridden via any of the following:</span>
<span class="source-line-no">724</span><span id="line-724">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">725</span><span id="line-725">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">726</span><span id="line-726">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated methods:</span>
<span class="source-line-no">727</span><span id="line-727">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">728</span><span id="line-728">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] VarResolver myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">729</span><span id="line-729">       *       &lt;/p&gt;</span>
<span class="source-line-no">730</span><span id="line-730">       *       Args can be any injected bean including {@link org.apache.juneau.svl.VarResolver.Builder}, the default builder.</span>
<span class="source-line-no">731</span><span id="line-731">       * &lt;/ul&gt;</span>
<span class="source-line-no">732</span><span id="line-732">       *</span>
<span class="source-line-no">733</span><span id="line-733">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">734</span><span id="line-734">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerSvlVariables"&gt;SVL Variables&lt;/a&gt;</span>
<span class="source-line-no">735</span><span id="line-735">       * &lt;/ul&gt;</span>
<span class="source-line-no">736</span><span id="line-736">       *</span>
<span class="source-line-no">737</span><span id="line-737">       * @return The variable resolver sub-builder.</span>
<span class="source-line-no">738</span><span id="line-738">       */</span>
<span class="source-line-no">739</span><span id="line-739">      public VarResolver.Builder varResolver() {</span>
<span class="source-line-no">740</span><span id="line-740">         return varResolver;</span>
<span class="source-line-no">741</span><span id="line-741">      }</span>
<span class="source-line-no">742</span><span id="line-742"></span>
<span class="source-line-no">743</span><span id="line-743">      /**</span>
<span class="source-line-no">744</span><span id="line-744">       * Adds one or more variables to the var resolver of this class.</span>
<span class="source-line-no">745</span><span id="line-745">       *</span>
<span class="source-line-no">746</span><span id="line-746">       * &lt;p&gt;</span>
<span class="source-line-no">747</span><span id="line-747">       * Equivalent to calling:</span>
<span class="source-line-no">748</span><span id="line-748">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">749</span><span id="line-749">       *    &lt;jv&gt;builder&lt;/jv&gt;.vars().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">750</span><span id="line-750">       * &lt;/p&gt;</span>
<span class="source-line-no">751</span><span id="line-751">       *</span>
<span class="source-line-no">752</span><span id="line-752">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">753</span><span id="line-753">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerSvlVariables"&gt;SVL Variables&lt;/a&gt;</span>
<span class="source-line-no">754</span><span id="line-754">       *    &lt;li class='jm'&gt;{@link #varResolver()}</span>
<span class="source-line-no">755</span><span id="line-755">       * &lt;/ul&gt;</span>
<span class="source-line-no">756</span><span id="line-756">       *</span>
<span class="source-line-no">757</span><span id="line-757">       * @param value The values to add.</span>
<span class="source-line-no">758</span><span id="line-758">       * @return This object.</span>
<span class="source-line-no">759</span><span id="line-759">       */</span>
<span class="source-line-no">760</span><span id="line-760">      @SafeVarargs</span>
<span class="source-line-no">761</span><span id="line-761">      public final Builder vars(Class&lt;? extends Var&gt;...value) {</span>
<span class="source-line-no">762</span><span id="line-762">         varResolver.vars(value);</span>
<span class="source-line-no">763</span><span id="line-763">         return this;</span>
<span class="source-line-no">764</span><span id="line-764">      }</span>
<span class="source-line-no">765</span><span id="line-765"></span>
<span class="source-line-no">766</span><span id="line-766">      /**</span>
<span class="source-line-no">767</span><span id="line-767">       * Adds one or more variables to the var resolver of this class.</span>
<span class="source-line-no">768</span><span id="line-768">       *</span>
<span class="source-line-no">769</span><span id="line-769">       * &lt;p&gt;</span>
<span class="source-line-no">770</span><span id="line-770">       * Equivalent to calling:</span>
<span class="source-line-no">771</span><span id="line-771">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">772</span><span id="line-772">       *    &lt;jv&gt;builder&lt;/jv&gt;.vars().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">773</span><span id="line-773">       * &lt;/p&gt;</span>
<span class="source-line-no">774</span><span id="line-774">       *</span>
<span class="source-line-no">775</span><span id="line-775">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">776</span><span id="line-776">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerSvlVariables"&gt;SVL Variables&lt;/a&gt;</span>
<span class="source-line-no">777</span><span id="line-777">       *    &lt;li class='jm'&gt;{@link #varResolver()}</span>
<span class="source-line-no">778</span><span id="line-778">       * &lt;/ul&gt;</span>
<span class="source-line-no">779</span><span id="line-779">       *</span>
<span class="source-line-no">780</span><span id="line-780">       * @param value The values to add.</span>
<span class="source-line-no">781</span><span id="line-781">       * @return This object.</span>
<span class="source-line-no">782</span><span id="line-782">       */</span>
<span class="source-line-no">783</span><span id="line-783">      public Builder vars(Var...value) {</span>
<span class="source-line-no">784</span><span id="line-784">         varResolver.vars(value);</span>
<span class="source-line-no">785</span><span id="line-785">         return this;</span>
<span class="source-line-no">786</span><span id="line-786">      }</span>
<span class="source-line-no">787</span><span id="line-787"></span>
<span class="source-line-no">788</span><span id="line-788">      /**</span>
<span class="source-line-no">789</span><span id="line-789">       * Creates the variable resolver sub-builder.</span>
<span class="source-line-no">790</span><span id="line-790">       *</span>
<span class="source-line-no">791</span><span id="line-791">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">792</span><span id="line-792">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerSvlVariables"&gt;SVL Variables&lt;/a&gt;</span>
<span class="source-line-no">793</span><span id="line-793">       * &lt;/ul&gt;</span>
<span class="source-line-no">794</span><span id="line-794">       *</span>
<span class="source-line-no">795</span><span id="line-795">       * @param beanStore</span>
<span class="source-line-no">796</span><span id="line-796">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">797</span><span id="line-797">       * @param resource</span>
<span class="source-line-no">798</span><span id="line-798">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">799</span><span id="line-799">       * @param resourceClass</span>
<span class="source-line-no">800</span><span id="line-800">       *    The REST servlet/bean type that this context is defined against.</span>
<span class="source-line-no">801</span><span id="line-801">       * @return A new variable resolver sub-builder.</span>
<span class="source-line-no">802</span><span id="line-802">       */</span>
<span class="source-line-no">803</span><span id="line-803">      protected VarResolver.Builder createVarResolver(BeanStore beanStore, Supplier&lt;?&gt; resource, Class&lt;?&gt; resourceClass) {</span>
<span class="source-line-no">804</span><span id="line-804"></span>
<span class="source-line-no">805</span><span id="line-805">         // Default value.</span>
<span class="source-line-no">806</span><span id="line-806">         Value&lt;VarResolver.Builder&gt; v = Value.of(</span>
<span class="source-line-no">807</span><span id="line-807">            VarResolver</span>
<span class="source-line-no">808</span><span id="line-808">               .create()</span>
<span class="source-line-no">809</span><span id="line-809">               .defaultVars()</span>
<span class="source-line-no">810</span><span id="line-810">               .vars(</span>
<span class="source-line-no">811</span><span id="line-811">                  VarList.of(</span>
<span class="source-line-no">812</span><span id="line-812">                     ConfigVar.class,</span>
<span class="source-line-no">813</span><span id="line-813">                     FileVar.class,</span>
<span class="source-line-no">814</span><span id="line-814">                     LocalizationVar.class,</span>
<span class="source-line-no">815</span><span id="line-815">                     RequestAttributeVar.class,</span>
<span class="source-line-no">816</span><span id="line-816">                     RequestFormDataVar.class,</span>
<span class="source-line-no">817</span><span id="line-817">                     RequestHeaderVar.class,</span>
<span class="source-line-no">818</span><span id="line-818">                     RequestPathVar.class,</span>
<span class="source-line-no">819</span><span id="line-819">                     RequestQueryVar.class,</span>
<span class="source-line-no">820</span><span id="line-820">                     RequestVar.class,</span>
<span class="source-line-no">821</span><span id="line-821">                     RequestSwaggerVar.class,</span>
<span class="source-line-no">822</span><span id="line-822">                     SerializedRequestAttrVar.class,</span>
<span class="source-line-no">823</span><span id="line-823">                     ServletInitParamVar.class,</span>
<span class="source-line-no">824</span><span id="line-824">                     SwaggerVar.class,</span>
<span class="source-line-no">825</span><span id="line-825">                     UrlVar.class,</span>
<span class="source-line-no">826</span><span id="line-826">                     UrlEncodeVar.class,</span>
<span class="source-line-no">827</span><span id="line-827">                     HtmlWidgetVar.class</span>
<span class="source-line-no">828</span><span id="line-828">                  )</span>
<span class="source-line-no">829</span><span id="line-829">                  .addDefault()</span>
<span class="source-line-no">830</span><span id="line-830">               )</span>
<span class="source-line-no">831</span><span id="line-831">               .bean(FileFinder.class, FileFinder.create(beanStore).cp(resourceClass,null,true).build())</span>
<span class="source-line-no">832</span><span id="line-832">         );</span>
<span class="source-line-no">833</span><span id="line-833"></span>
<span class="source-line-no">834</span><span id="line-834">         // Replace with bean from bean store.</span>
<span class="source-line-no">835</span><span id="line-835">         beanStore</span>
<span class="source-line-no">836</span><span id="line-836">            .getBean(VarResolver.class)</span>
<span class="source-line-no">837</span><span id="line-837">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">838</span><span id="line-838"></span>
<span class="source-line-no">839</span><span id="line-839">         // Replace with bean from:  @RestInject public [static] VarResolver xxx(&lt;args&gt;)</span>
<span class="source-line-no">840</span><span id="line-840">         beanStore</span>
<span class="source-line-no">841</span><span id="line-841">            .createMethodFinder(VarResolver.class)</span>
<span class="source-line-no">842</span><span id="line-842">            .addBean(VarResolver.Builder.class, v.get())</span>
<span class="source-line-no">843</span><span id="line-843">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">844</span><span id="line-844">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">845</span><span id="line-845"></span>
<span class="source-line-no">846</span><span id="line-846">         return v.get();</span>
<span class="source-line-no">847</span><span id="line-847">      }</span>
<span class="source-line-no">848</span><span id="line-848"></span>
<span class="source-line-no">849</span><span id="line-849">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">850</span><span id="line-850">      // config</span>
<span class="source-line-no">851</span><span id="line-851">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">852</span><span id="line-852"></span>
<span class="source-line-no">853</span><span id="line-853">      /**</span>
<span class="source-line-no">854</span><span id="line-854">       * Returns the external configuration file for this resource.</span>
<span class="source-line-no">855</span><span id="line-855">       *</span>
<span class="source-line-no">856</span><span id="line-856">       * &lt;p&gt;</span>
<span class="source-line-no">857</span><span id="line-857">       * The config file contains arbitrary configuration information that can be accessed by this class, usually</span>
<span class="source-line-no">858</span><span id="line-858">       * via &lt;c&gt;$C&lt;/c&gt; variables.</span>
<span class="source-line-no">859</span><span id="line-859">       *</span>
<span class="source-line-no">860</span><span id="line-860">       * &lt;p&gt;</span>
<span class="source-line-no">861</span><span id="line-861">       * The default config can be overridden via any of the following:</span>
<span class="source-line-no">862</span><span id="line-862">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">863</span><span id="line-863">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">864</span><span id="line-864">       *    &lt;li&gt;Class annotation:  {@link Rest#config() @Rest(config)}</span>
<span class="source-line-no">865</span><span id="line-865">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">866</span><span id="line-866">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">867</span><span id="line-867">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] Config myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">868</span><span id="line-868">       *       &lt;/p&gt;</span>
<span class="source-line-no">869</span><span id="line-869">       *       Args can be any injected bean.</span>
<span class="source-line-no">870</span><span id="line-870">       * &lt;/ul&gt;</span>
<span class="source-line-no">871</span><span id="line-871">       *</span>
<span class="source-line-no">872</span><span id="line-872">       * &lt;p&gt;</span>
<span class="source-line-no">873</span><span id="line-873">       * If a config file is not set up, then an empty config file will be returned that is not backed by any file.</span>
<span class="source-line-no">874</span><span id="line-874">       *</span>
<span class="source-line-no">875</span><span id="line-875">       * &lt;p&gt;</span>
<span class="source-line-no">876</span><span id="line-876">       * This bean can be accessed directly via {@link RestContext#getConfig()} or passed in as a parameter</span>
<span class="source-line-no">877</span><span id="line-877">       * on a {@link RestOp}-annotated method.</span>
<span class="source-line-no">878</span><span id="line-878">       *</span>
<span class="source-line-no">879</span><span id="line-879">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">880</span><span id="line-880">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ConfigurationFiles"&gt;Configuration Files&lt;/a&gt;</span>
<span class="source-line-no">881</span><span id="line-881">       * &lt;/ul&gt;</span>
<span class="source-line-no">882</span><span id="line-882">       *</span>
<span class="source-line-no">883</span><span id="line-883">       * @return The external configuration file for this resource.</span>
<span class="source-line-no">884</span><span id="line-884">       */</span>
<span class="source-line-no">885</span><span id="line-885">      public Config config() {</span>
<span class="source-line-no">886</span><span id="line-886">         return config;</span>
<span class="source-line-no">887</span><span id="line-887">      }</span>
<span class="source-line-no">888</span><span id="line-888"></span>
<span class="source-line-no">889</span><span id="line-889">      /**</span>
<span class="source-line-no">890</span><span id="line-890">       * Overwrites the default config file with a custom config file.</span>
<span class="source-line-no">891</span><span id="line-891">       *</span>
<span class="source-line-no">892</span><span id="line-892">       * &lt;p&gt;</span>
<span class="source-line-no">893</span><span id="line-893">       * By default, the config file is determined using the {@link Rest#config() @Rest(config)}</span>
<span class="source-line-no">894</span><span id="line-894">       * annotation.</span>
<span class="source-line-no">895</span><span id="line-895">       * This method allows you to programmatically override it with your own custom config file.</span>
<span class="source-line-no">896</span><span id="line-896">       *</span>
<span class="source-line-no">897</span><span id="line-897">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">898</span><span id="line-898">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ConfigurationFiles"&gt;Configuration Files&lt;/a&gt;</span>
<span class="source-line-no">899</span><span id="line-899">       *    &lt;li class='jm'&gt;{@link #config()}</span>
<span class="source-line-no">900</span><span id="line-900">       * &lt;/ul&gt;</span>
<span class="source-line-no">901</span><span id="line-901">       *</span>
<span class="source-line-no">902</span><span id="line-902">       * @param config The new config file.</span>
<span class="source-line-no">903</span><span id="line-903">       * @return This object.</span>
<span class="source-line-no">904</span><span id="line-904">       */</span>
<span class="source-line-no">905</span><span id="line-905">      @FluentSetter</span>
<span class="source-line-no">906</span><span id="line-906">      public Builder config(Config config) {</span>
<span class="source-line-no">907</span><span id="line-907">         this.config = config;</span>
<span class="source-line-no">908</span><span id="line-908">         return this;</span>
<span class="source-line-no">909</span><span id="line-909">      }</span>
<span class="source-line-no">910</span><span id="line-910"></span>
<span class="source-line-no">911</span><span id="line-911">      /**</span>
<span class="source-line-no">912</span><span id="line-912">       * Creates the config for this builder.</span>
<span class="source-line-no">913</span><span id="line-913">       *</span>
<span class="source-line-no">914</span><span id="line-914">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">915</span><span id="line-915">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ConfigurationFiles"&gt;Configuration Files&lt;/a&gt;</span>
<span class="source-line-no">916</span><span id="line-916">       *    &lt;li class='jm'&gt;{@link #config()}</span>
<span class="source-line-no">917</span><span id="line-917">       * &lt;/ul&gt;</span>
<span class="source-line-no">918</span><span id="line-918">       *</span>
<span class="source-line-no">919</span><span id="line-919">       * @param beanStore</span>
<span class="source-line-no">920</span><span id="line-920">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">921</span><span id="line-921">       * @param resource</span>
<span class="source-line-no">922</span><span id="line-922">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">923</span><span id="line-923">       * @param resourceClass</span>
<span class="source-line-no">924</span><span id="line-924">       *    The REST servlet/bean type that this context is defined against.</span>
<span class="source-line-no">925</span><span id="line-925">       * @return A new config.</span>
<span class="source-line-no">926</span><span id="line-926">       */</span>
<span class="source-line-no">927</span><span id="line-927">      protected Config createConfig(BeanStore beanStore, Supplier&lt;?&gt; resource, Class&lt;?&gt; resourceClass) {</span>
<span class="source-line-no">928</span><span id="line-928"></span>
<span class="source-line-no">929</span><span id="line-929">         Value&lt;Config&gt; v = Value.empty();</span>
<span class="source-line-no">930</span><span id="line-930"></span>
<span class="source-line-no">931</span><span id="line-931">         // Find our config file.  It's the last non-empty @RestResource(config).</span>
<span class="source-line-no">932</span><span id="line-932">         VarResolver vr = beanStore.getBean(VarResolver.class).orElseThrow(() -&gt; new IllegalArgumentException("VarResolver not found."));</span>
<span class="source-line-no">933</span><span id="line-933">         Value&lt;String&gt; cfv = Value.empty();</span>
<span class="source-line-no">934</span><span id="line-934">         ClassInfo.of(resourceClass).forEachAnnotation(Rest.class, x -&gt; Utils.isNotEmpty(x.config()), x -&gt; cfv.set(vr.resolve(x.config())));</span>
<span class="source-line-no">935</span><span id="line-935">         String cf = cfv.orElse("");</span>
<span class="source-line-no">936</span><span id="line-936"></span>
<span class="source-line-no">937</span><span id="line-937">         // If not specified or value is set to SYSTEM_DEFAULT, use system default config.</span>
<span class="source-line-no">938</span><span id="line-938">         if (v.isEmpty() &amp;&amp; "SYSTEM_DEFAULT".equals(cf))</span>
<span class="source-line-no">939</span><span id="line-939">            v.set(Config.getSystemDefault());</span>
<span class="source-line-no">940</span><span id="line-940"></span>
<span class="source-line-no">941</span><span id="line-941">         // Otherwise build one.</span>
<span class="source-line-no">942</span><span id="line-942">         if (v.isEmpty()) {</span>
<span class="source-line-no">943</span><span id="line-943">            Config.Builder cb = Config.create().varResolver(vr);</span>
<span class="source-line-no">944</span><span id="line-944">            if (! cf.isEmpty())</span>
<span class="source-line-no">945</span><span id="line-945">               cb.name(cf);</span>
<span class="source-line-no">946</span><span id="line-946">            v.set(cb.build());</span>
<span class="source-line-no">947</span><span id="line-947">         }</span>
<span class="source-line-no">948</span><span id="line-948"></span>
<span class="source-line-no">949</span><span id="line-949">         // Replace with bean from bean store.</span>
<span class="source-line-no">950</span><span id="line-950">         beanStore</span>
<span class="source-line-no">951</span><span id="line-951">            .getBean(Config.class)</span>
<span class="source-line-no">952</span><span id="line-952">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">953</span><span id="line-953"></span>
<span class="source-line-no">954</span><span id="line-954">         // Replace with bean from:  @RestInject public [static] Config xxx(&lt;args&gt;)</span>
<span class="source-line-no">955</span><span id="line-955">         beanStore</span>
<span class="source-line-no">956</span><span id="line-956">            .createMethodFinder(Config.class)</span>
<span class="source-line-no">957</span><span id="line-957">            .addBean(Config.class, v.get())</span>
<span class="source-line-no">958</span><span id="line-958">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">959</span><span id="line-959">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">960</span><span id="line-960"></span>
<span class="source-line-no">961</span><span id="line-961">         return v.get();</span>
<span class="source-line-no">962</span><span id="line-962">      }</span>
<span class="source-line-no">963</span><span id="line-963"></span>
<span class="source-line-no">964</span><span id="line-964">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">965</span><span id="line-965">      // logger</span>
<span class="source-line-no">966</span><span id="line-966">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">967</span><span id="line-967"></span>
<span class="source-line-no">968</span><span id="line-968">      /**</span>
<span class="source-line-no">969</span><span id="line-969">       * Returns the logger for this resource.</span>
<span class="source-line-no">970</span><span id="line-970">       *</span>
<span class="source-line-no">971</span><span id="line-971">       * &lt;p&gt;</span>
<span class="source-line-no">972</span><span id="line-972">       * The logger is used in the following locations:</span>
<span class="source-line-no">973</span><span id="line-973">       * &lt;ul&gt;</span>
<span class="source-line-no">974</span><span id="line-974">       *    &lt;li&gt;{@link RestServlet#log(Level, Throwable, String, Object...)} and related methods.</span>
<span class="source-line-no">975</span><span id="line-975">       *    &lt;li&gt;{@link RestObject#log(Level, Throwable, String, Object...)} and related methods.</span>
<span class="source-line-no">976</span><span id="line-976">       *    &lt;li&gt;In the {@link #callLogger()} of this resource.</span>
<span class="source-line-no">977</span><span id="line-977">       * &lt;/ul&gt;</span>
<span class="source-line-no">978</span><span id="line-978">       * It can also be accessed directly via {@link RestContext#getLogger()} or passed in as a parameter</span>
<span class="source-line-no">979</span><span id="line-979">       * on a {@link RestOp}-annotated method.</span>
<span class="source-line-no">980</span><span id="line-980">       *</span>
<span class="source-line-no">981</span><span id="line-981">       * &lt;p&gt;</span>
<span class="source-line-no">982</span><span id="line-982">       * The default config can be overridden via any of the following:</span>
<span class="source-line-no">983</span><span id="line-983">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">984</span><span id="line-984">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">985</span><span id="line-985">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">986</span><span id="line-986">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">987</span><span id="line-987">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] Logger myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">988</span><span id="line-988">       *       &lt;/p&gt;</span>
<span class="source-line-no">989</span><span id="line-989">       *       Args can be any injected bean.</span>
<span class="source-line-no">990</span><span id="line-990">       * &lt;/ul&gt;</span>
<span class="source-line-no">991</span><span id="line-991">       *</span>
<span class="source-line-no">992</span><span id="line-992">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">993</span><span id="line-993">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">994</span><span id="line-994">       * &lt;/ul&gt;</span>
<span class="source-line-no">995</span><span id="line-995">       *</span>
<span class="source-line-no">996</span><span id="line-996">       * @return The logger for this resource.</span>
<span class="source-line-no">997</span><span id="line-997">       */</span>
<span class="source-line-no">998</span><span id="line-998">      public Logger logger() {</span>
<span class="source-line-no">999</span><span id="line-999">         if (logger == null)</span>
<span class="source-line-no">1000</span><span id="line-1000">            logger = createLogger(beanStore(), resource, resourceClass);</span>
<span class="source-line-no">1001</span><span id="line-1001">         return logger;</span>
<span class="source-line-no">1002</span><span id="line-1002">      }</span>
<span class="source-line-no">1003</span><span id="line-1003"></span>
<span class="source-line-no">1004</span><span id="line-1004">      /**</span>
<span class="source-line-no">1005</span><span id="line-1005">       * Sets the logger for this resource.</span>
<span class="source-line-no">1006</span><span id="line-1006">       *</span>
<span class="source-line-no">1007</span><span id="line-1007">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1008</span><span id="line-1008">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">1009</span><span id="line-1009">       *    &lt;li class='jm'&gt;{@link #logger()}</span>
<span class="source-line-no">1010</span><span id="line-1010">       * &lt;/ul&gt;</span>
<span class="source-line-no">1011</span><span id="line-1011">       *</span>
<span class="source-line-no">1012</span><span id="line-1012">       * @param value The logger to use for the REST resource.</span>
<span class="source-line-no">1013</span><span id="line-1013">       * @return This object.</span>
<span class="source-line-no">1014</span><span id="line-1014">       */</span>
<span class="source-line-no">1015</span><span id="line-1015">      public Builder logger(Logger value) {</span>
<span class="source-line-no">1016</span><span id="line-1016">         logger = value;</span>
<span class="source-line-no">1017</span><span id="line-1017">         return this;</span>
<span class="source-line-no">1018</span><span id="line-1018">      }</span>
<span class="source-line-no">1019</span><span id="line-1019"></span>
<span class="source-line-no">1020</span><span id="line-1020">      /**</span>
<span class="source-line-no">1021</span><span id="line-1021">       * Instantiates the logger for this resource.</span>
<span class="source-line-no">1022</span><span id="line-1022">       *</span>
<span class="source-line-no">1023</span><span id="line-1023">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1024</span><span id="line-1024">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">1025</span><span id="line-1025">       *    &lt;li class='jm'&gt;{@link #logger()}</span>
<span class="source-line-no">1026</span><span id="line-1026">       * &lt;/ul&gt;</span>
<span class="source-line-no">1027</span><span id="line-1027">       *</span>
<span class="source-line-no">1028</span><span id="line-1028">       * @param beanStore</span>
<span class="source-line-no">1029</span><span id="line-1029">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1030</span><span id="line-1030">       * @param resource</span>
<span class="source-line-no">1031</span><span id="line-1031">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1032</span><span id="line-1032">       * @param resourceClass</span>
<span class="source-line-no">1033</span><span id="line-1033">       *    The REST servlet/bean class that this context is defined against.</span>
<span class="source-line-no">1034</span><span id="line-1034">       * @return A new logger.</span>
<span class="source-line-no">1035</span><span id="line-1035">       */</span>
<span class="source-line-no">1036</span><span id="line-1036">      protected Logger createLogger(BeanStore beanStore, Supplier&lt;?&gt; resource, Class&lt;?&gt; resourceClass) {</span>
<span class="source-line-no">1037</span><span id="line-1037"></span>
<span class="source-line-no">1038</span><span id="line-1038">         // Default value.</span>
<span class="source-line-no">1039</span><span id="line-1039">         Value&lt;Logger&gt; v = Value.of(</span>
<span class="source-line-no">1040</span><span id="line-1040">            Logger.getLogger(resourceClass.getClass().getName())</span>
<span class="source-line-no">1041</span><span id="line-1041">         );</span>
<span class="source-line-no">1042</span><span id="line-1042"></span>
<span class="source-line-no">1043</span><span id="line-1043">         // Replace with bean from bean store.</span>
<span class="source-line-no">1044</span><span id="line-1044">         beanStore</span>
<span class="source-line-no">1045</span><span id="line-1045">            .getBean(Logger.class)</span>
<span class="source-line-no">1046</span><span id="line-1046">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">1047</span><span id="line-1047"></span>
<span class="source-line-no">1048</span><span id="line-1048">         // Replace with bean from:  @RestInject public [static] Logger xxx(&lt;args&gt;)</span>
<span class="source-line-no">1049</span><span id="line-1049">         beanStore</span>
<span class="source-line-no">1050</span><span id="line-1050">            .createMethodFinder(Logger.class)</span>
<span class="source-line-no">1051</span><span id="line-1051">            .addBean(Logger.class, v.get())</span>
<span class="source-line-no">1052</span><span id="line-1052">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1053</span><span id="line-1053">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">1054</span><span id="line-1054"></span>
<span class="source-line-no">1055</span><span id="line-1055">         return v.get();</span>
<span class="source-line-no">1056</span><span id="line-1056">      }</span>
<span class="source-line-no">1057</span><span id="line-1057"></span>
<span class="source-line-no">1058</span><span id="line-1058">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1059</span><span id="line-1059">      // thrownStore</span>
<span class="source-line-no">1060</span><span id="line-1060">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1061</span><span id="line-1061"></span>
<span class="source-line-no">1062</span><span id="line-1062">      /**</span>
<span class="source-line-no">1063</span><span id="line-1063">       * Returns the thrown-store sub-builder.</span>
<span class="source-line-no">1064</span><span id="line-1064">       *</span>
<span class="source-line-no">1065</span><span id="line-1065">       * &lt;p&gt;</span>
<span class="source-line-no">1066</span><span id="line-1066">       * The thrown store is an in-memory cache of thrown exceptions.</span>
<span class="source-line-no">1067</span><span id="line-1067">       * It is used to store thrown exceptions when {@link MethodExecStats#error(Throwable)} is called from the {@link MethodExecStore}</span>
<span class="source-line-no">1068</span><span id="line-1068">       * bean of this resource.  It can also be accessed directly via {@link RestContext#getThrownStore()} or passed in as a parameter</span>
<span class="source-line-no">1069</span><span id="line-1069">       * on a {@link RestOp}-annotated method.</span>
<span class="source-line-no">1070</span><span id="line-1070">       *</span>
<span class="source-line-no">1071</span><span id="line-1071">       * &lt;p&gt;</span>
<span class="source-line-no">1072</span><span id="line-1072">       * The default thrown store is inherited from the parent context and can be overridden via any of the following:</span>
<span class="source-line-no">1073</span><span id="line-1073">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1074</span><span id="line-1074">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1075</span><span id="line-1075">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1076</span><span id="line-1076">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1077</span><span id="line-1077">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] ThrownStore myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1078</span><span id="line-1078">       *       &lt;/p&gt;</span>
<span class="source-line-no">1079</span><span id="line-1079">       *       Args can be any injected bean including ThrownStore.Builder, the default builder.</span>
<span class="source-line-no">1080</span><span id="line-1080">       * &lt;/ul&gt;</span>
<span class="source-line-no">1081</span><span id="line-1081">       *</span>
<span class="source-line-no">1082</span><span id="line-1082">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1083</span><span id="line-1083">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1084</span><span id="line-1084">       * &lt;/ul&gt;</span>
<span class="source-line-no">1085</span><span id="line-1085">       *</span>
<span class="source-line-no">1086</span><span id="line-1086">       * @return The builder for the {@link ThrownStore} object in the REST context.</span>
<span class="source-line-no">1087</span><span id="line-1087">       */</span>
<span class="source-line-no">1088</span><span id="line-1088">      public ThrownStore.Builder thrownStore() {</span>
<span class="source-line-no">1089</span><span id="line-1089">         if (thrownStore == null)</span>
<span class="source-line-no">1090</span><span id="line-1090">            thrownStore = createThrownStore(beanStore(), resource(), parentContext);</span>
<span class="source-line-no">1091</span><span id="line-1091">         return thrownStore;</span>
<span class="source-line-no">1092</span><span id="line-1092">      }</span>
<span class="source-line-no">1093</span><span id="line-1093"></span>
<span class="source-line-no">1094</span><span id="line-1094">      /**</span>
<span class="source-line-no">1095</span><span id="line-1095">       * Specifies the thrown store for this class.</span>
<span class="source-line-no">1096</span><span id="line-1096">       *</span>
<span class="source-line-no">1097</span><span id="line-1097">       * &lt;p&gt;</span>
<span class="source-line-no">1098</span><span id="line-1098">       * Equivalent to calling:</span>
<span class="source-line-no">1099</span><span id="line-1099">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1100</span><span id="line-1100">       *    &lt;jv&gt;builder&lt;/jv&gt;.thrownStore().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1101</span><span id="line-1101">       * &lt;/p&gt;</span>
<span class="source-line-no">1102</span><span id="line-1102">       *</span>
<span class="source-line-no">1103</span><span id="line-1103">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1104</span><span id="line-1104">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1105</span><span id="line-1105">       *    &lt;li class='jm'&gt;{@link #thrownStore()}</span>
<span class="source-line-no">1106</span><span id="line-1106">       * &lt;/ul&gt;</span>
<span class="source-line-no">1107</span><span id="line-1107">       *</span>
<span class="source-line-no">1108</span><span id="line-1108">       * @param value The new value.</span>
<span class="source-line-no">1109</span><span id="line-1109">       * @return This object.</span>
<span class="source-line-no">1110</span><span id="line-1110">       */</span>
<span class="source-line-no">1111</span><span id="line-1111">      public Builder thrownStore(Class&lt;? extends ThrownStore&gt; value) {</span>
<span class="source-line-no">1112</span><span id="line-1112">         thrownStore().type(value);</span>
<span class="source-line-no">1113</span><span id="line-1113">         return this;</span>
<span class="source-line-no">1114</span><span id="line-1114">      }</span>
<span class="source-line-no">1115</span><span id="line-1115"></span>
<span class="source-line-no">1116</span><span id="line-1116">      /**</span>
<span class="source-line-no">1117</span><span id="line-1117">       * Specifies the thrown store for this class.</span>
<span class="source-line-no">1118</span><span id="line-1118">       *</span>
<span class="source-line-no">1119</span><span id="line-1119">       * &lt;p&gt;</span>
<span class="source-line-no">1120</span><span id="line-1120">       * Equivalent to calling:</span>
<span class="source-line-no">1121</span><span id="line-1121">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1122</span><span id="line-1122">       *    &lt;jv&gt;builder&lt;/jv&gt;.thrownStore().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1123</span><span id="line-1123">       * &lt;/p&gt;</span>
<span class="source-line-no">1124</span><span id="line-1124">       *</span>
<span class="source-line-no">1125</span><span id="line-1125">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1126</span><span id="line-1126">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1127</span><span id="line-1127">       *    &lt;li class='jm'&gt;{@link #thrownStore()}</span>
<span class="source-line-no">1128</span><span id="line-1128">       * &lt;/ul&gt;</span>
<span class="source-line-no">1129</span><span id="line-1129">       *</span>
<span class="source-line-no">1130</span><span id="line-1130">       * @param value The new value.</span>
<span class="source-line-no">1131</span><span id="line-1131">       * @return This object.</span>
<span class="source-line-no">1132</span><span id="line-1132">       */</span>
<span class="source-line-no">1133</span><span id="line-1133">      public Builder thrownStore(ThrownStore value) {</span>
<span class="source-line-no">1134</span><span id="line-1134">         thrownStore().impl(value);</span>
<span class="source-line-no">1135</span><span id="line-1135">         return this;</span>
<span class="source-line-no">1136</span><span id="line-1136">      }</span>
<span class="source-line-no">1137</span><span id="line-1137"></span>
<span class="source-line-no">1138</span><span id="line-1138">      /**</span>
<span class="source-line-no">1139</span><span id="line-1139">       * Instantiates the thrown-store sub-builder.</span>
<span class="source-line-no">1140</span><span id="line-1140">       *</span>
<span class="source-line-no">1141</span><span id="line-1141">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1142</span><span id="line-1142">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1143</span><span id="line-1143">       * &lt;/ul&gt;</span>
<span class="source-line-no">1144</span><span id="line-1144">       *</span>
<span class="source-line-no">1145</span><span id="line-1145">       * @param resource</span>
<span class="source-line-no">1146</span><span id="line-1146">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1147</span><span id="line-1147">       * @param parent</span>
<span class="source-line-no">1148</span><span id="line-1148">       *    The parent context if the REST bean was registered via {@link Rest#children()}.</span>
<span class="source-line-no">1149</span><span id="line-1149">       *    &lt;br&gt;Will be &lt;jk&gt;null&lt;/jk&gt; if the bean is a top-level resource.</span>
<span class="source-line-no">1150</span><span id="line-1150">       * @param beanStore</span>
<span class="source-line-no">1151</span><span id="line-1151">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1152</span><span id="line-1152">       *    &lt;br&gt;Created by {@link RestContext.Builder#beanStore()}.</span>
<span class="source-line-no">1153</span><span id="line-1153">       * @return A new thrown-store sub-builder.</span>
<span class="source-line-no">1154</span><span id="line-1154">       */</span>
<span class="source-line-no">1155</span><span id="line-1155">      protected ThrownStore.Builder createThrownStore(BeanStore beanStore, Supplier&lt;?&gt; resource, RestContext parent) {</span>
<span class="source-line-no">1156</span><span id="line-1156"></span>
<span class="source-line-no">1157</span><span id="line-1157">         // Default value.</span>
<span class="source-line-no">1158</span><span id="line-1158">         Value&lt;ThrownStore.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1159</span><span id="line-1159">            ThrownStore</span>
<span class="source-line-no">1160</span><span id="line-1160">               .create(beanStore)</span>
<span class="source-line-no">1161</span><span id="line-1161">               .impl(parent == null ? null : parent.getThrownStore())</span>
<span class="source-line-no">1162</span><span id="line-1162">         );</span>
<span class="source-line-no">1163</span><span id="line-1163"></span>
<span class="source-line-no">1164</span><span id="line-1164">         // Specify the implementation class if its set as a default.</span>
<span class="source-line-no">1165</span><span id="line-1165">         defaultClasses()</span>
<span class="source-line-no">1166</span><span id="line-1166">            .get(ThrownStore.class)</span>
<span class="source-line-no">1167</span><span id="line-1167">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">1168</span><span id="line-1168"></span>
<span class="source-line-no">1169</span><span id="line-1169">         // Replace with bean from bean store.</span>
<span class="source-line-no">1170</span><span id="line-1170">         beanStore</span>
<span class="source-line-no">1171</span><span id="line-1171">            .getBean(ThrownStore.class)</span>
<span class="source-line-no">1172</span><span id="line-1172">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1173</span><span id="line-1173"></span>
<span class="source-line-no">1174</span><span id="line-1174">         // Replace with bean from:  @RestInject public [static] ThrownStore xxx(&lt;args&gt;)</span>
<span class="source-line-no">1175</span><span id="line-1175">         beanStore</span>
<span class="source-line-no">1176</span><span id="line-1176">            .createMethodFinder(ThrownStore.class)</span>
<span class="source-line-no">1177</span><span id="line-1177">            .addBean(ThrownStore.Builder.class, v.get())</span>
<span class="source-line-no">1178</span><span id="line-1178">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1179</span><span id="line-1179">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1180</span><span id="line-1180"></span>
<span class="source-line-no">1181</span><span id="line-1181">         return v.get();</span>
<span class="source-line-no">1182</span><span id="line-1182">      }</span>
<span class="source-line-no">1183</span><span id="line-1183"></span>
<span class="source-line-no">1184</span><span id="line-1184">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1185</span><span id="line-1185">      // encoders</span>
<span class="source-line-no">1186</span><span id="line-1186">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1187</span><span id="line-1187"></span>
<span class="source-line-no">1188</span><span id="line-1188">      /**</span>
<span class="source-line-no">1189</span><span id="line-1189">       * Returns the encoder group sub-builder.</span>
<span class="source-line-no">1190</span><span id="line-1190">       *</span>
<span class="source-line-no">1191</span><span id="line-1191">       * &lt;p&gt;</span>
<span class="source-line-no">1192</span><span id="line-1192">       * Encoders are used to decode HTTP requests and encode HTTP responses based on {@code Content-Encoding} and {@code Accept-Encoding}</span>
<span class="source-line-no">1193</span><span id="line-1193">       * headers.</span>
<span class="source-line-no">1194</span><span id="line-1194">       *</span>
<span class="source-line-no">1195</span><span id="line-1195">       * &lt;p&gt;</span>
<span class="source-line-no">1196</span><span id="line-1196">       * The default encoder set has support for identity incoding only.</span>
<span class="source-line-no">1197</span><span id="line-1197">       * It can be overridden via any of the following:</span>
<span class="source-line-no">1198</span><span id="line-1198">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1199</span><span id="line-1199">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1200</span><span id="line-1200">       *    &lt;li&gt;Class annotation: {@link Rest#encoders() @Rest(encoders)}</span>
<span class="source-line-no">1201</span><span id="line-1201">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1202</span><span id="line-1202">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1203</span><span id="line-1203">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] EncoderSet myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1204</span><span id="line-1204">       *       &lt;/p&gt;</span>
<span class="source-line-no">1205</span><span id="line-1205">       *       Args can be any injected bean including EncoderSet.Builder, the default builder.</span>
<span class="source-line-no">1206</span><span id="line-1206">       * &lt;/ul&gt;</span>
<span class="source-line-no">1207</span><span id="line-1207">       *</span>
<span class="source-line-no">1208</span><span id="line-1208">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1209</span><span id="line-1209">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerEncoders"&gt;Encoders&lt;/a&gt;</span>
<span class="source-line-no">1210</span><span id="line-1210">       * &lt;/ul&gt;</span>
<span class="source-line-no">1211</span><span id="line-1211">       *</span>
<span class="source-line-no">1212</span><span id="line-1212">       * @return The builder for the {@link EncoderSet} object in the REST context.</span>
<span class="source-line-no">1213</span><span id="line-1213">       */</span>
<span class="source-line-no">1214</span><span id="line-1214">      public EncoderSet.Builder encoders() {</span>
<span class="source-line-no">1215</span><span id="line-1215">         if (encoders == null)</span>
<span class="source-line-no">1216</span><span id="line-1216">            encoders = createEncoders(beanStore(), resource());</span>
<span class="source-line-no">1217</span><span id="line-1217">         return encoders;</span>
<span class="source-line-no">1218</span><span id="line-1218">      }</span>
<span class="source-line-no">1219</span><span id="line-1219"></span>
<span class="source-line-no">1220</span><span id="line-1220">      /**</span>
<span class="source-line-no">1221</span><span id="line-1221">       * Adds one or more encoders to this class.</span>
<span class="source-line-no">1222</span><span id="line-1222">       *</span>
<span class="source-line-no">1223</span><span id="line-1223">       * &lt;p&gt;</span>
<span class="source-line-no">1224</span><span id="line-1224">       * Equivalent to calling:</span>
<span class="source-line-no">1225</span><span id="line-1225">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1226</span><span id="line-1226">       *    &lt;jv&gt;builder&lt;/jv&gt;.encoders().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1227</span><span id="line-1227">       * &lt;/p&gt;</span>
<span class="source-line-no">1228</span><span id="line-1228">       *</span>
<span class="source-line-no">1229</span><span id="line-1229">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1230</span><span id="line-1230">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerEncoders"&gt;Encoders&lt;/a&gt;</span>
<span class="source-line-no">1231</span><span id="line-1231">       *    &lt;li class='jm'&gt;{@link #encoders()}</span>
<span class="source-line-no">1232</span><span id="line-1232">       * &lt;/ul&gt;</span>
<span class="source-line-no">1233</span><span id="line-1233">       *</span>
<span class="source-line-no">1234</span><span id="line-1234">       * @param value The values to add.</span>
<span class="source-line-no">1235</span><span id="line-1235">       * @return This object.</span>
<span class="source-line-no">1236</span><span id="line-1236">       */</span>
<span class="source-line-no">1237</span><span id="line-1237">      @SafeVarargs</span>
<span class="source-line-no">1238</span><span id="line-1238">      public final Builder encoders(Class&lt;? extends Encoder&gt;...value) {</span>
<span class="source-line-no">1239</span><span id="line-1239">         encoders().add(value);</span>
<span class="source-line-no">1240</span><span id="line-1240">         return this;</span>
<span class="source-line-no">1241</span><span id="line-1241">      }</span>
<span class="source-line-no">1242</span><span id="line-1242"></span>
<span class="source-line-no">1243</span><span id="line-1243">      /**</span>
<span class="source-line-no">1244</span><span id="line-1244">       * Adds one or more encoders to this class.</span>
<span class="source-line-no">1245</span><span id="line-1245">       *</span>
<span class="source-line-no">1246</span><span id="line-1246">       * &lt;p&gt;</span>
<span class="source-line-no">1247</span><span id="line-1247">       * Equivalent to calling:</span>
<span class="source-line-no">1248</span><span id="line-1248">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1249</span><span id="line-1249">       *    &lt;jv&gt;builder&lt;/jv&gt;.encoders().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1250</span><span id="line-1250">       * &lt;/p&gt;</span>
<span class="source-line-no">1251</span><span id="line-1251">       *</span>
<span class="source-line-no">1252</span><span id="line-1252">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1253</span><span id="line-1253">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerEncoders"&gt;Encoders&lt;/a&gt;</span>
<span class="source-line-no">1254</span><span id="line-1254">       *    &lt;li class='jm'&gt;{@link #encoders()}</span>
<span class="source-line-no">1255</span><span id="line-1255">       * &lt;/ul&gt;</span>
<span class="source-line-no">1256</span><span id="line-1256">       *</span>
<span class="source-line-no">1257</span><span id="line-1257">       * @param value The values to add.</span>
<span class="source-line-no">1258</span><span id="line-1258">       * @return This object.</span>
<span class="source-line-no">1259</span><span id="line-1259">       */</span>
<span class="source-line-no">1260</span><span id="line-1260">      public Builder encoders(Encoder...value) {</span>
<span class="source-line-no">1261</span><span id="line-1261">         encoders().add(value);</span>
<span class="source-line-no">1262</span><span id="line-1262">         return this;</span>
<span class="source-line-no">1263</span><span id="line-1263">      }</span>
<span class="source-line-no">1264</span><span id="line-1264"></span>
<span class="source-line-no">1265</span><span id="line-1265">      /**</span>
<span class="source-line-no">1266</span><span id="line-1266">       * Instantiates the encoder group sub-builder.</span>
<span class="source-line-no">1267</span><span id="line-1267">       *</span>
<span class="source-line-no">1268</span><span id="line-1268">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1269</span><span id="line-1269">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerEncoders"&gt;Encoders&lt;/a&gt;</span>
<span class="source-line-no">1270</span><span id="line-1270">       *    &lt;li class='jm'&gt;{@link #encoders()}</span>
<span class="source-line-no">1271</span><span id="line-1271">       * &lt;/ul&gt;</span>
<span class="source-line-no">1272</span><span id="line-1272">       *</span>
<span class="source-line-no">1273</span><span id="line-1273">       * @param resource</span>
<span class="source-line-no">1274</span><span id="line-1274">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1275</span><span id="line-1275">       * @param beanStore</span>
<span class="source-line-no">1276</span><span id="line-1276">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1277</span><span id="line-1277">       *    &lt;br&gt;Created by {@link RestContext.Builder#beanStore()}.</span>
<span class="source-line-no">1278</span><span id="line-1278">       * @return A new encoder group sub-builder.</span>
<span class="source-line-no">1279</span><span id="line-1279">       */</span>
<span class="source-line-no">1280</span><span id="line-1280">      protected EncoderSet.Builder createEncoders(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">1281</span><span id="line-1281"></span>
<span class="source-line-no">1282</span><span id="line-1282">         // Default value.</span>
<span class="source-line-no">1283</span><span id="line-1283">         Value&lt;EncoderSet.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1284</span><span id="line-1284">            EncoderSet</span>
<span class="source-line-no">1285</span><span id="line-1285">               .create(beanStore)</span>
<span class="source-line-no">1286</span><span id="line-1286">               .add(IdentityEncoder.INSTANCE)</span>
<span class="source-line-no">1287</span><span id="line-1287">         );</span>
<span class="source-line-no">1288</span><span id="line-1288"></span>
<span class="source-line-no">1289</span><span id="line-1289">         // Specify the implementation class if its set as a default.</span>
<span class="source-line-no">1290</span><span id="line-1290">         defaultClasses()</span>
<span class="source-line-no">1291</span><span id="line-1291">            .get(EncoderSet.class)</span>
<span class="source-line-no">1292</span><span id="line-1292">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">1293</span><span id="line-1293"></span>
<span class="source-line-no">1294</span><span id="line-1294">         // Replace with bean from bean store.</span>
<span class="source-line-no">1295</span><span id="line-1295">         beanStore</span>
<span class="source-line-no">1296</span><span id="line-1296">            .getBean(EncoderSet.class)</span>
<span class="source-line-no">1297</span><span id="line-1297">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1298</span><span id="line-1298"></span>
<span class="source-line-no">1299</span><span id="line-1299">         // Replace with bean from:  @RestInject public [static] EncoderSet xxx(&lt;args&gt;)</span>
<span class="source-line-no">1300</span><span id="line-1300">         beanStore</span>
<span class="source-line-no">1301</span><span id="line-1301">            .createMethodFinder(EncoderSet.class)</span>
<span class="source-line-no">1302</span><span id="line-1302">            .addBean(EncoderSet.Builder.class, v.get())</span>
<span class="source-line-no">1303</span><span id="line-1303">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1304</span><span id="line-1304">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1305</span><span id="line-1305"></span>
<span class="source-line-no">1306</span><span id="line-1306">         return v.get();</span>
<span class="source-line-no">1307</span><span id="line-1307">      }</span>
<span class="source-line-no">1308</span><span id="line-1308"></span>
<span class="source-line-no">1309</span><span id="line-1309">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1310</span><span id="line-1310">      // serializers</span>
<span class="source-line-no">1311</span><span id="line-1311">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1312</span><span id="line-1312"></span>
<span class="source-line-no">1313</span><span id="line-1313">      /**</span>
<span class="source-line-no">1314</span><span id="line-1314">       * Returns the serializer group sub-builder.</span>
<span class="source-line-no">1315</span><span id="line-1315">       *</span>
<span class="source-line-no">1316</span><span id="line-1316">       * &lt;p&gt;</span>
<span class="source-line-no">1317</span><span id="line-1317">       * Serializers are used to convert POJOs to HTTP response bodies based on the {@code Accept} header.</span>
<span class="source-line-no">1318</span><span id="line-1318">       *</span>
<span class="source-line-no">1319</span><span id="line-1319">       * &lt;p&gt;</span>
<span class="source-line-no">1320</span><span id="line-1320">       * The default serializer set is empty.</span>
<span class="source-line-no">1321</span><span id="line-1321">       * It can be overridden via any of the following:</span>
<span class="source-line-no">1322</span><span id="line-1322">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1323</span><span id="line-1323">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1324</span><span id="line-1324">       *    &lt;li&gt;Class annotation: {@link Rest#serializers() @Rest(serializers)}</span>
<span class="source-line-no">1325</span><span id="line-1325">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1326</span><span id="line-1326">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1327</span><span id="line-1327">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] SerializerSet myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1328</span><span id="line-1328">       *       &lt;/p&gt;</span>
<span class="source-line-no">1329</span><span id="line-1329">       *       Args can be any injected bean including SerializerSet.Builder, the default builder.</span>
<span class="source-line-no">1330</span><span id="line-1330">       * &lt;/ul&gt;</span>
<span class="source-line-no">1331</span><span id="line-1331">       *</span>
<span class="source-line-no">1332</span><span id="line-1332">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1333</span><span id="line-1333">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1334</span><span id="line-1334">       * &lt;/ul&gt;</span>
<span class="source-line-no">1335</span><span id="line-1335">       *</span>
<span class="source-line-no">1336</span><span id="line-1336">       * @return The serializer group sub-builder.</span>
<span class="source-line-no">1337</span><span id="line-1337">       */</span>
<span class="source-line-no">1338</span><span id="line-1338">      public SerializerSet.Builder serializers() {</span>
<span class="source-line-no">1339</span><span id="line-1339">         if (serializers == null)</span>
<span class="source-line-no">1340</span><span id="line-1340">            serializers = createSerializers(beanStore(), resource());</span>
<span class="source-line-no">1341</span><span id="line-1341">         return serializers;</span>
<span class="source-line-no">1342</span><span id="line-1342">      }</span>
<span class="source-line-no">1343</span><span id="line-1343"></span>
<span class="source-line-no">1344</span><span id="line-1344">      /**</span>
<span class="source-line-no">1345</span><span id="line-1345">       * Adds one or more serializers to this class.</span>
<span class="source-line-no">1346</span><span id="line-1346">       *</span>
<span class="source-line-no">1347</span><span id="line-1347">       * &lt;p&gt;</span>
<span class="source-line-no">1348</span><span id="line-1348">       * Equivalent to calling:</span>
<span class="source-line-no">1349</span><span id="line-1349">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1350</span><span id="line-1350">       *    &lt;jv&gt;builder&lt;/jv&gt;.serializers().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1351</span><span id="line-1351">       * &lt;/p&gt;</span>
<span class="source-line-no">1352</span><span id="line-1352">       *</span>
<span class="source-line-no">1353</span><span id="line-1353">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1354</span><span id="line-1354">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1355</span><span id="line-1355">       *    &lt;li class='jm'&gt;{@link #serializers()}</span>
<span class="source-line-no">1356</span><span id="line-1356">       * &lt;/ul&gt;</span>
<span class="source-line-no">1357</span><span id="line-1357">       *</span>
<span class="source-line-no">1358</span><span id="line-1358">       * @param value The values to add.</span>
<span class="source-line-no">1359</span><span id="line-1359">       * @return This object.</span>
<span class="source-line-no">1360</span><span id="line-1360">       */</span>
<span class="source-line-no">1361</span><span id="line-1361">      @SafeVarargs</span>
<span class="source-line-no">1362</span><span id="line-1362">      public final Builder serializers(Class&lt;? extends Serializer&gt;...value) {</span>
<span class="source-line-no">1363</span><span id="line-1363">         serializers().add(value);</span>
<span class="source-line-no">1364</span><span id="line-1364">         return this;</span>
<span class="source-line-no">1365</span><span id="line-1365">      }</span>
<span class="source-line-no">1366</span><span id="line-1366"></span>
<span class="source-line-no">1367</span><span id="line-1367">      /**</span>
<span class="source-line-no">1368</span><span id="line-1368">       * Adds one or more serializers to this class.</span>
<span class="source-line-no">1369</span><span id="line-1369">       *</span>
<span class="source-line-no">1370</span><span id="line-1370">       * &lt;p&gt;</span>
<span class="source-line-no">1371</span><span id="line-1371">       * Equivalent to calling:</span>
<span class="source-line-no">1372</span><span id="line-1372">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1373</span><span id="line-1373">       *    &lt;jv&gt;builder&lt;/jv&gt;.serializers().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1374</span><span id="line-1374">       * &lt;/p&gt;</span>
<span class="source-line-no">1375</span><span id="line-1375">       *</span>
<span class="source-line-no">1376</span><span id="line-1376">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1377</span><span id="line-1377">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1378</span><span id="line-1378">       *    &lt;li class='jm'&gt;{@link #serializers()}</span>
<span class="source-line-no">1379</span><span id="line-1379">       * &lt;/ul&gt;</span>
<span class="source-line-no">1380</span><span id="line-1380">       *</span>
<span class="source-line-no">1381</span><span id="line-1381">       * @param value The values to add.</span>
<span class="source-line-no">1382</span><span id="line-1382">       * @return This object.</span>
<span class="source-line-no">1383</span><span id="line-1383">       */</span>
<span class="source-line-no">1384</span><span id="line-1384">      public Builder serializers(Serializer...value) {</span>
<span class="source-line-no">1385</span><span id="line-1385">         serializers().add(value);</span>
<span class="source-line-no">1386</span><span id="line-1386">         return this;</span>
<span class="source-line-no">1387</span><span id="line-1387">      }</span>
<span class="source-line-no">1388</span><span id="line-1388"></span>
<span class="source-line-no">1389</span><span id="line-1389">      /**</span>
<span class="source-line-no">1390</span><span id="line-1390">       * Instantiates the serializer group sub-builder.</span>
<span class="source-line-no">1391</span><span id="line-1391">       *</span>
<span class="source-line-no">1392</span><span id="line-1392">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1393</span><span id="line-1393">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1394</span><span id="line-1394">       * &lt;/ul&gt;</span>
<span class="source-line-no">1395</span><span id="line-1395">       *</span>
<span class="source-line-no">1396</span><span id="line-1396">       * @param resource</span>
<span class="source-line-no">1397</span><span id="line-1397">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1398</span><span id="line-1398">       * @param beanStore</span>
<span class="source-line-no">1399</span><span id="line-1399">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1400</span><span id="line-1400">       *    &lt;br&gt;Created by {@link RestContext.Builder#beanStore()}.</span>
<span class="source-line-no">1401</span><span id="line-1401">       * @return A new serializer group sub-builder.</span>
<span class="source-line-no">1402</span><span id="line-1402">       */</span>
<span class="source-line-no">1403</span><span id="line-1403">      protected SerializerSet.Builder createSerializers(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">1404</span><span id="line-1404"></span>
<span class="source-line-no">1405</span><span id="line-1405">         // Default value.</span>
<span class="source-line-no">1406</span><span id="line-1406">         Value&lt;SerializerSet.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1407</span><span id="line-1407">            SerializerSet</span>
<span class="source-line-no">1408</span><span id="line-1408">               .create(beanStore)</span>
<span class="source-line-no">1409</span><span id="line-1409">         );</span>
<span class="source-line-no">1410</span><span id="line-1410"></span>
<span class="source-line-no">1411</span><span id="line-1411">         // Specify the implementation class if its set as a default.</span>
<span class="source-line-no">1412</span><span id="line-1412">         defaultClasses()</span>
<span class="source-line-no">1413</span><span id="line-1413">            .get(SerializerSet.class)</span>
<span class="source-line-no">1414</span><span id="line-1414">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">1415</span><span id="line-1415"></span>
<span class="source-line-no">1416</span><span id="line-1416">         // Replace with bean from bean store.</span>
<span class="source-line-no">1417</span><span id="line-1417">         beanStore</span>
<span class="source-line-no">1418</span><span id="line-1418">            .getBean(SerializerSet.class)</span>
<span class="source-line-no">1419</span><span id="line-1419">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1420</span><span id="line-1420"></span>
<span class="source-line-no">1421</span><span id="line-1421">         // Replace with bean from:  @RestInject public [static] SerializerSet xxx(&lt;args&gt;)</span>
<span class="source-line-no">1422</span><span id="line-1422">         beanStore</span>
<span class="source-line-no">1423</span><span id="line-1423">            .createMethodFinder(SerializerSet.class)</span>
<span class="source-line-no">1424</span><span id="line-1424">            .addBean(SerializerSet.Builder.class, v.get())</span>
<span class="source-line-no">1425</span><span id="line-1425">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1426</span><span id="line-1426">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1427</span><span id="line-1427"></span>
<span class="source-line-no">1428</span><span id="line-1428">         return v.get();</span>
<span class="source-line-no">1429</span><span id="line-1429">      }</span>
<span class="source-line-no">1430</span><span id="line-1430"></span>
<span class="source-line-no">1431</span><span id="line-1431">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1432</span><span id="line-1432">      // parsers</span>
<span class="source-line-no">1433</span><span id="line-1433">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1434</span><span id="line-1434"></span>
<span class="source-line-no">1435</span><span id="line-1435">      /**</span>
<span class="source-line-no">1436</span><span id="line-1436">       * Returns the parser group sub-builder.</span>
<span class="source-line-no">1437</span><span id="line-1437">       *</span>
<span class="source-line-no">1438</span><span id="line-1438">       * &lt;p&gt;</span>
<span class="source-line-no">1439</span><span id="line-1439">       * Parsers are used to HTTP request bodies into POJOs based on the {@code Content-Type} header.</span>
<span class="source-line-no">1440</span><span id="line-1440">       *</span>
<span class="source-line-no">1441</span><span id="line-1441">       * &lt;p&gt;</span>
<span class="source-line-no">1442</span><span id="line-1442">       * The default parser set is empty.</span>
<span class="source-line-no">1443</span><span id="line-1443">       * It can be overridden via any of the following:</span>
<span class="source-line-no">1444</span><span id="line-1444">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1445</span><span id="line-1445">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1446</span><span id="line-1446">       *    &lt;li&gt;Class annotation: {@link Rest#parsers() @Rest(parsers)}</span>
<span class="source-line-no">1447</span><span id="line-1447">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1448</span><span id="line-1448">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1449</span><span id="line-1449">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] ParserSet myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1450</span><span id="line-1450">       *       &lt;/p&gt;</span>
<span class="source-line-no">1451</span><span id="line-1451">       *       Args can be any injected bean including ParserSet.Builder, the default builder.</span>
<span class="source-line-no">1452</span><span id="line-1452">       * &lt;/ul&gt;</span>
<span class="source-line-no">1453</span><span id="line-1453">       *</span>
<span class="source-line-no">1454</span><span id="line-1454">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1455</span><span id="line-1455">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1456</span><span id="line-1456">       * &lt;/ul&gt;</span>
<span class="source-line-no">1457</span><span id="line-1457">       *</span>
<span class="source-line-no">1458</span><span id="line-1458">       * @return The parser group sub-builder.</span>
<span class="source-line-no">1459</span><span id="line-1459">       */</span>
<span class="source-line-no">1460</span><span id="line-1460">      public ParserSet.Builder parsers() {</span>
<span class="source-line-no">1461</span><span id="line-1461">         if (parsers == null)</span>
<span class="source-line-no">1462</span><span id="line-1462">            parsers = createParsers(beanStore(), resource());</span>
<span class="source-line-no">1463</span><span id="line-1463">         return parsers;</span>
<span class="source-line-no">1464</span><span id="line-1464">      }</span>
<span class="source-line-no">1465</span><span id="line-1465"></span>
<span class="source-line-no">1466</span><span id="line-1466">      /**</span>
<span class="source-line-no">1467</span><span id="line-1467">       * Adds one or more parsers to this class.</span>
<span class="source-line-no">1468</span><span id="line-1468">       *</span>
<span class="source-line-no">1469</span><span id="line-1469">       * &lt;p&gt;</span>
<span class="source-line-no">1470</span><span id="line-1470">       * Equivalent to calling:</span>
<span class="source-line-no">1471</span><span id="line-1471">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1472</span><span id="line-1472">       *    &lt;jv&gt;builder&lt;/jv&gt;.parsers().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1473</span><span id="line-1473">       * &lt;/p&gt;</span>
<span class="source-line-no">1474</span><span id="line-1474">       *</span>
<span class="source-line-no">1475</span><span id="line-1475">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1476</span><span id="line-1476">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1477</span><span id="line-1477">       *    &lt;li class='jm'&gt;{@link #parsers()}</span>
<span class="source-line-no">1478</span><span id="line-1478">       * &lt;/ul&gt;</span>
<span class="source-line-no">1479</span><span id="line-1479">       *</span>
<span class="source-line-no">1480</span><span id="line-1480">       * @param value The values to add.</span>
<span class="source-line-no">1481</span><span id="line-1481">       * @return This object.</span>
<span class="source-line-no">1482</span><span id="line-1482">       */</span>
<span class="source-line-no">1483</span><span id="line-1483">      @SafeVarargs</span>
<span class="source-line-no">1484</span><span id="line-1484">      public final Builder parsers(Class&lt;? extends Parser&gt;...value) {</span>
<span class="source-line-no">1485</span><span id="line-1485">         parsers().add(value);</span>
<span class="source-line-no">1486</span><span id="line-1486">         return this;</span>
<span class="source-line-no">1487</span><span id="line-1487">      }</span>
<span class="source-line-no">1488</span><span id="line-1488"></span>
<span class="source-line-no">1489</span><span id="line-1489">      /**</span>
<span class="source-line-no">1490</span><span id="line-1490">       * Adds one or more parsers to this class.</span>
<span class="source-line-no">1491</span><span id="line-1491">       *</span>
<span class="source-line-no">1492</span><span id="line-1492">       * &lt;p&gt;</span>
<span class="source-line-no">1493</span><span id="line-1493">       * Equivalent to calling:</span>
<span class="source-line-no">1494</span><span id="line-1494">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1495</span><span id="line-1495">       *    &lt;jv&gt;builder&lt;/jv&gt;.parsers().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1496</span><span id="line-1496">       * &lt;/p&gt;</span>
<span class="source-line-no">1497</span><span id="line-1497">       *</span>
<span class="source-line-no">1498</span><span id="line-1498">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1499</span><span id="line-1499">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1500</span><span id="line-1500">       *    &lt;li class='jm'&gt;{@link #parsers()}</span>
<span class="source-line-no">1501</span><span id="line-1501">       * &lt;/ul&gt;</span>
<span class="source-line-no">1502</span><span id="line-1502">       *</span>
<span class="source-line-no">1503</span><span id="line-1503">       * @param value The values to add.</span>
<span class="source-line-no">1504</span><span id="line-1504">       * @return This object.</span>
<span class="source-line-no">1505</span><span id="line-1505">       */</span>
<span class="source-line-no">1506</span><span id="line-1506">      public Builder parsers(Parser...value) {</span>
<span class="source-line-no">1507</span><span id="line-1507">         parsers().add(value);</span>
<span class="source-line-no">1508</span><span id="line-1508">         return this;</span>
<span class="source-line-no">1509</span><span id="line-1509">      }</span>
<span class="source-line-no">1510</span><span id="line-1510"></span>
<span class="source-line-no">1511</span><span id="line-1511">      /**</span>
<span class="source-line-no">1512</span><span id="line-1512">       * Instantiates the parser group sub-builder.</span>
<span class="source-line-no">1513</span><span id="line-1513">       *</span>
<span class="source-line-no">1514</span><span id="line-1514">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1515</span><span id="line-1515">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">1516</span><span id="line-1516">       * &lt;/ul&gt;</span>
<span class="source-line-no">1517</span><span id="line-1517">       *</span>
<span class="source-line-no">1518</span><span id="line-1518">       * @param resource</span>
<span class="source-line-no">1519</span><span id="line-1519">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1520</span><span id="line-1520">       * @param beanStore</span>
<span class="source-line-no">1521</span><span id="line-1521">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1522</span><span id="line-1522">       *    &lt;br&gt;Created by {@link RestContext.Builder#beanStore()}.</span>
<span class="source-line-no">1523</span><span id="line-1523">       * @return A new parser group sub-builder.</span>
<span class="source-line-no">1524</span><span id="line-1524">       */</span>
<span class="source-line-no">1525</span><span id="line-1525">      protected ParserSet.Builder createParsers(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">1526</span><span id="line-1526"></span>
<span class="source-line-no">1527</span><span id="line-1527">         // Default value.</span>
<span class="source-line-no">1528</span><span id="line-1528">         Value&lt;ParserSet.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1529</span><span id="line-1529">            ParserSet</span>
<span class="source-line-no">1530</span><span id="line-1530">               .create(beanStore)</span>
<span class="source-line-no">1531</span><span id="line-1531">         );</span>
<span class="source-line-no">1532</span><span id="line-1532"></span>
<span class="source-line-no">1533</span><span id="line-1533">         // Specify the implementation class if its set as a default.</span>
<span class="source-line-no">1534</span><span id="line-1534">         defaultClasses()</span>
<span class="source-line-no">1535</span><span id="line-1535">            .get(ParserSet.class)</span>
<span class="source-line-no">1536</span><span id="line-1536">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">1537</span><span id="line-1537"></span>
<span class="source-line-no">1538</span><span id="line-1538">         // Replace with bean from bean store.</span>
<span class="source-line-no">1539</span><span id="line-1539">         beanStore</span>
<span class="source-line-no">1540</span><span id="line-1540">            .getBean(ParserSet.class)</span>
<span class="source-line-no">1541</span><span id="line-1541">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1542</span><span id="line-1542"></span>
<span class="source-line-no">1543</span><span id="line-1543">         // Replace with bean from:  @RestInject public [static] ParserSet xxx(&lt;args&gt;)</span>
<span class="source-line-no">1544</span><span id="line-1544">         beanStore</span>
<span class="source-line-no">1545</span><span id="line-1545">            .createMethodFinder(ParserSet.class)</span>
<span class="source-line-no">1546</span><span id="line-1546">            .addBean(ParserSet.Builder.class, v.get())</span>
<span class="source-line-no">1547</span><span id="line-1547">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1548</span><span id="line-1548">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1549</span><span id="line-1549"></span>
<span class="source-line-no">1550</span><span id="line-1550">         return v.get();</span>
<span class="source-line-no">1551</span><span id="line-1551">      }</span>
<span class="source-line-no">1552</span><span id="line-1552"></span>
<span class="source-line-no">1553</span><span id="line-1553">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1554</span><span id="line-1554">      // methodExecStore</span>
<span class="source-line-no">1555</span><span id="line-1555">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1556</span><span id="line-1556"></span>
<span class="source-line-no">1557</span><span id="line-1557">      /**</span>
<span class="source-line-no">1558</span><span id="line-1558">       * Returns the method execution statistics store sub-builder.</span>
<span class="source-line-no">1559</span><span id="line-1559">       *</span>
<span class="source-line-no">1560</span><span id="line-1560">       * &lt;p&gt;</span>
<span class="source-line-no">1561</span><span id="line-1561">       * Used for tracking basic call statistics on Java methods in this class.</span>
<span class="source-line-no">1562</span><span id="line-1562">       * It can be accessed directly via {@link RestContext#getMethodExecStore()} or passed in as a parameter</span>
<span class="source-line-no">1563</span><span id="line-1563">       * on a {@link RestOp}-annotated method.</span>
<span class="source-line-no">1564</span><span id="line-1564">       *</span>
<span class="source-line-no">1565</span><span id="line-1565">       * &lt;p&gt;</span>
<span class="source-line-no">1566</span><span id="line-1566">       * The default method exec store can overridden via any of the following:</span>
<span class="source-line-no">1567</span><span id="line-1567">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1568</span><span id="line-1568">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1569</span><span id="line-1569">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1570</span><span id="line-1570">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1571</span><span id="line-1571">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] MethodExecStore myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1572</span><span id="line-1572">       *       &lt;/p&gt;</span>
<span class="source-line-no">1573</span><span id="line-1573">       *       Args can be any injected bean including MethodExecStore.Builder, the default builder.</span>
<span class="source-line-no">1574</span><span id="line-1574">       * &lt;/ul&gt;</span>
<span class="source-line-no">1575</span><span id="line-1575">       *</span>
<span class="source-line-no">1576</span><span id="line-1576">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1577</span><span id="line-1577">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1578</span><span id="line-1578">       * &lt;/ul&gt;</span>
<span class="source-line-no">1579</span><span id="line-1579">       *</span>
<span class="source-line-no">1580</span><span id="line-1580">       * @return The method execution statistics store sub-builder.</span>
<span class="source-line-no">1581</span><span id="line-1581">       */</span>
<span class="source-line-no">1582</span><span id="line-1582">      public MethodExecStore.Builder methodExecStore() {</span>
<span class="source-line-no">1583</span><span id="line-1583">         if (methodExecStore == null)</span>
<span class="source-line-no">1584</span><span id="line-1584">            methodExecStore = createMethodExecStore(beanStore(), resource());</span>
<span class="source-line-no">1585</span><span id="line-1585">         return methodExecStore;</span>
<span class="source-line-no">1586</span><span id="line-1586">      }</span>
<span class="source-line-no">1587</span><span id="line-1587"></span>
<span class="source-line-no">1588</span><span id="line-1588">      /**</span>
<span class="source-line-no">1589</span><span id="line-1589">       * Specifies the method execution store for this class.</span>
<span class="source-line-no">1590</span><span id="line-1590">       *</span>
<span class="source-line-no">1591</span><span id="line-1591">       * &lt;p&gt;</span>
<span class="source-line-no">1592</span><span id="line-1592">       * Equivalent to calling:</span>
<span class="source-line-no">1593</span><span id="line-1593">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1594</span><span id="line-1594">       *    &lt;jv&gt;builder&lt;/jv&gt;.methodExecStore().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1595</span><span id="line-1595">       * &lt;/p&gt;</span>
<span class="source-line-no">1596</span><span id="line-1596">       *</span>
<span class="source-line-no">1597</span><span id="line-1597">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1598</span><span id="line-1598">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1599</span><span id="line-1599">       *    &lt;li class='jm'&gt;{@link #methodExecStore()}</span>
<span class="source-line-no">1600</span><span id="line-1600">       * &lt;/ul&gt;</span>
<span class="source-line-no">1601</span><span id="line-1601">       *</span>
<span class="source-line-no">1602</span><span id="line-1602">       * @param value The new value.</span>
<span class="source-line-no">1603</span><span id="line-1603">       * @return This object.</span>
<span class="source-line-no">1604</span><span id="line-1604">       */</span>
<span class="source-line-no">1605</span><span id="line-1605">      public Builder methodExecStore(Class&lt;? extends MethodExecStore&gt; value) {</span>
<span class="source-line-no">1606</span><span id="line-1606">         methodExecStore().type(value);</span>
<span class="source-line-no">1607</span><span id="line-1607">         return this;</span>
<span class="source-line-no">1608</span><span id="line-1608">      }</span>
<span class="source-line-no">1609</span><span id="line-1609"></span>
<span class="source-line-no">1610</span><span id="line-1610">      /**</span>
<span class="source-line-no">1611</span><span id="line-1611">       * Specifies the method execution store for this class.</span>
<span class="source-line-no">1612</span><span id="line-1612">       *</span>
<span class="source-line-no">1613</span><span id="line-1613">       * &lt;p&gt;</span>
<span class="source-line-no">1614</span><span id="line-1614">       * Equivalent to calling:</span>
<span class="source-line-no">1615</span><span id="line-1615">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1616</span><span id="line-1616">       *    &lt;jv&gt;builder&lt;/jv&gt;.methodExecStore().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1617</span><span id="line-1617">       * &lt;/p&gt;</span>
<span class="source-line-no">1618</span><span id="line-1618">       *</span>
<span class="source-line-no">1619</span><span id="line-1619">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1620</span><span id="line-1620">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1621</span><span id="line-1621">       *    &lt;li class='jm'&gt;{@link #methodExecStore()}</span>
<span class="source-line-no">1622</span><span id="line-1622">       * &lt;/ul&gt;</span>
<span class="source-line-no">1623</span><span id="line-1623">       *</span>
<span class="source-line-no">1624</span><span id="line-1624">       * @param value The new value.</span>
<span class="source-line-no">1625</span><span id="line-1625">       * @return This object.</span>
<span class="source-line-no">1626</span><span id="line-1626">       */</span>
<span class="source-line-no">1627</span><span id="line-1627">      public Builder methodExecStore(MethodExecStore value) {</span>
<span class="source-line-no">1628</span><span id="line-1628">         methodExecStore().impl(value);</span>
<span class="source-line-no">1629</span><span id="line-1629">         return this;</span>
<span class="source-line-no">1630</span><span id="line-1630">      }</span>
<span class="source-line-no">1631</span><span id="line-1631"></span>
<span class="source-line-no">1632</span><span id="line-1632">      /**</span>
<span class="source-line-no">1633</span><span id="line-1633">       * Instantiates the method execution statistics store sub-builder.</span>
<span class="source-line-no">1634</span><span id="line-1634">       *</span>
<span class="source-line-no">1635</span><span id="line-1635">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1636</span><span id="line-1636">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ExecutionStatistics"&gt;REST method execution statistics&lt;/a&gt;</span>
<span class="source-line-no">1637</span><span id="line-1637">       * &lt;/ul&gt;</span>
<span class="source-line-no">1638</span><span id="line-1638">       *</span>
<span class="source-line-no">1639</span><span id="line-1639">       * @param beanStore</span>
<span class="source-line-no">1640</span><span id="line-1640">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1641</span><span id="line-1641">       * @param resource</span>
<span class="source-line-no">1642</span><span id="line-1642">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1643</span><span id="line-1643">       * @return A new method execution statistics store sub-builder.</span>
<span class="source-line-no">1644</span><span id="line-1644">       */</span>
<span class="source-line-no">1645</span><span id="line-1645">      protected MethodExecStore.Builder createMethodExecStore(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">1646</span><span id="line-1646"></span>
<span class="source-line-no">1647</span><span id="line-1647">         // Default value.</span>
<span class="source-line-no">1648</span><span id="line-1648">         Value&lt;MethodExecStore.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1649</span><span id="line-1649">            MethodExecStore</span>
<span class="source-line-no">1650</span><span id="line-1650">               .create(beanStore)</span>
<span class="source-line-no">1651</span><span id="line-1651">         );</span>
<span class="source-line-no">1652</span><span id="line-1652"></span>
<span class="source-line-no">1653</span><span id="line-1653">         // Specify the implementation class if its set as a default.</span>
<span class="source-line-no">1654</span><span id="line-1654">         defaultClasses()</span>
<span class="source-line-no">1655</span><span id="line-1655">            .get(MethodExecStore.class)</span>
<span class="source-line-no">1656</span><span id="line-1656">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">1657</span><span id="line-1657"></span>
<span class="source-line-no">1658</span><span id="line-1658">         // Replace with bean from bean store.</span>
<span class="source-line-no">1659</span><span id="line-1659">         beanStore</span>
<span class="source-line-no">1660</span><span id="line-1660">            .getBean(MethodExecStore.class)</span>
<span class="source-line-no">1661</span><span id="line-1661">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1662</span><span id="line-1662"></span>
<span class="source-line-no">1663</span><span id="line-1663">         // Replace with bean from:  @RestInject public [static] MethodExecStore xxx(&lt;args&gt;)</span>
<span class="source-line-no">1664</span><span id="line-1664">         beanStore</span>
<span class="source-line-no">1665</span><span id="line-1665">            .createMethodFinder(MethodExecStore.class)</span>
<span class="source-line-no">1666</span><span id="line-1666">            .addBean(MethodExecStore.Builder.class, v.get())</span>
<span class="source-line-no">1667</span><span id="line-1667">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1668</span><span id="line-1668">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1669</span><span id="line-1669"></span>
<span class="source-line-no">1670</span><span id="line-1670">         return v.get();</span>
<span class="source-line-no">1671</span><span id="line-1671">      }</span>
<span class="source-line-no">1672</span><span id="line-1672"></span>
<span class="source-line-no">1673</span><span id="line-1673">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1674</span><span id="line-1674">      // messages</span>
<span class="source-line-no">1675</span><span id="line-1675">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1676</span><span id="line-1676"></span>
<span class="source-line-no">1677</span><span id="line-1677">      /**</span>
<span class="source-line-no">1678</span><span id="line-1678">       * Returns the messages sub-builder.</span>
<span class="source-line-no">1679</span><span id="line-1679">       *</span>
<span class="source-line-no">1680</span><span id="line-1680">       * &lt;p&gt;</span>
<span class="source-line-no">1681</span><span id="line-1681">       * Messages beans are wrappers around resource bundles containing localized messages.</span>
<span class="source-line-no">1682</span><span id="line-1682">       *</span>
<span class="source-line-no">1683</span><span id="line-1683">       * &lt;p&gt;</span>
<span class="source-line-no">1684</span><span id="line-1684">       * By default, the resource bundle name is assumed to match the class name.  For example, given the class</span>
<span class="source-line-no">1685</span><span id="line-1685">       * &lt;c&gt;MyClass.java&lt;/c&gt;, the resource bundle is assumed to be &lt;c&gt;MyClass.properties&lt;/c&gt;.  This property</span>
<span class="source-line-no">1686</span><span id="line-1686">       * allows you to override this setting to specify a different location such as &lt;c&gt;MyMessages.properties&lt;/c&gt; by</span>
<span class="source-line-no">1687</span><span id="line-1687">       * specifying a value of &lt;js&gt;"MyMessages"&lt;/js&gt;.</span>
<span class="source-line-no">1688</span><span id="line-1688">       *</span>
<span class="source-line-no">1689</span><span id="line-1689">       * &lt;p&gt;</span>
<span class="source-line-no">1690</span><span id="line-1690">       *    Resource bundles are searched using the following base name patterns:</span>
<span class="source-line-no">1691</span><span id="line-1691">       *    &lt;ul&gt;</span>
<span class="source-line-no">1692</span><span id="line-1692">       *       &lt;li&gt;&lt;js&gt;"{package}.{name}"&lt;/js&gt;</span>
<span class="source-line-no">1693</span><span id="line-1693">       *       &lt;li&gt;&lt;js&gt;"{package}.i18n.{name}"&lt;/js&gt;</span>
<span class="source-line-no">1694</span><span id="line-1694">       *       &lt;li&gt;&lt;js&gt;"{package}.nls.{name}"&lt;/js&gt;</span>
<span class="source-line-no">1695</span><span id="line-1695">       *       &lt;li&gt;&lt;js&gt;"{package}.messages.{name}"&lt;/js&gt;</span>
<span class="source-line-no">1696</span><span id="line-1696">       *    &lt;/ul&gt;</span>
<span class="source-line-no">1697</span><span id="line-1697">       *</span>
<span class="source-line-no">1698</span><span id="line-1698">       * &lt;p&gt;</span>
<span class="source-line-no">1699</span><span id="line-1699">       * This annotation is used to provide request-localized (based on &lt;c&gt;Accept-Language&lt;/c&gt;) messages for the following methods:</span>
<span class="source-line-no">1700</span><span id="line-1700">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">1701</span><span id="line-1701">       *    &lt;li class='jm'&gt;{@link RestRequest#getMessage(String, Object...)}</span>
<span class="source-line-no">1702</span><span id="line-1702">       *    &lt;li class='jm'&gt;{@link RestContext#getMessages() RestContext.getMessages()}</span>
<span class="source-line-no">1703</span><span id="line-1703">       * &lt;/ul&gt;</span>
<span class="source-line-no">1704</span><span id="line-1704">       *</span>
<span class="source-line-no">1705</span><span id="line-1705">       * &lt;p&gt;</span>
<span class="source-line-no">1706</span><span id="line-1706">       * Request-localized messages are also available by passing either of the following parameter types into your Java method:</span>
<span class="source-line-no">1707</span><span id="line-1707">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">1708</span><span id="line-1708">       *    &lt;li class='jc'&gt;{@link ResourceBundle} - Basic Java resource bundle.</span>
<span class="source-line-no">1709</span><span id="line-1709">       *    &lt;li class='jc'&gt;{@link Messages} - Extended resource bundle with several convenience methods.</span>
<span class="source-line-no">1710</span><span id="line-1710">       * &lt;/ul&gt;</span>
<span class="source-line-no">1711</span><span id="line-1711">       *</span>
<span class="source-line-no">1712</span><span id="line-1712">       * The value can be a relative path like &lt;js&gt;"nls/Messages"&lt;/js&gt;, indicating to look for the resource bundle</span>
<span class="source-line-no">1713</span><span id="line-1713">       * &lt;js&gt;"com.foo.sample.nls.Messages"&lt;/js&gt; if the resource class is in &lt;js&gt;"com.foo.sample"&lt;/js&gt;, or it can be an</span>
<span class="source-line-no">1714</span><span id="line-1714">       * absolute path like &lt;js&gt;"com.foo.sample.nls.Messages"&lt;/js&gt;</span>
<span class="source-line-no">1715</span><span id="line-1715">       *</span>
<span class="source-line-no">1716</span><span id="line-1716">       * &lt;h5 class='section'&gt;Examples:&lt;/h5&gt;</span>
<span class="source-line-no">1717</span><span id="line-1717">       * &lt;p class='bini'&gt;</span>
<span class="source-line-no">1718</span><span id="line-1718">       *    &lt;cc&gt;# Contents of org/apache/foo/nls/MyMessages.properties&lt;/cc&gt;</span>
<span class="source-line-no">1719</span><span id="line-1719">       *</span>
<span class="source-line-no">1720</span><span id="line-1720">       *    &lt;ck&gt;HelloMessage&lt;/ck&gt; = &lt;cv&gt;Hello {0}!&lt;/cv&gt;</span>
<span class="source-line-no">1721</span><span id="line-1721">       * &lt;/p&gt;</span>
<span class="source-line-no">1722</span><span id="line-1722">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1723</span><span id="line-1723">       *    &lt;jc&gt;// Contents of org/apache/foo/MyResource.java&lt;/jc&gt;</span>
<span class="source-line-no">1724</span><span id="line-1724">       *</span>
<span class="source-line-no">1725</span><span id="line-1725">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(messages=&lt;js&gt;"nls/MyMessages"&lt;/js&gt;)</span>
<span class="source-line-no">1726</span><span id="line-1726">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {...}</span>
<span class="source-line-no">1727</span><span id="line-1727">       *</span>
<span class="source-line-no">1728</span><span id="line-1728">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;(&lt;js&gt;"/hello/{you}"&lt;/js&gt;)</span>
<span class="source-line-no">1729</span><span id="line-1729">       *       &lt;jk&gt;public&lt;/jk&gt; Object helloYou(RestRequest &lt;jv&gt;req&lt;/jv&gt;, Messages &lt;jv&gt;messages&lt;/jv&gt;, &lt;ja&gt;@Path&lt;/ja&gt;(&lt;js&gt;"name"&lt;/js&gt;) String &lt;jv&gt;you&lt;/jv&gt;) {</span>
<span class="source-line-no">1730</span><span id="line-1730">       *          String &lt;jv&gt;string&lt;/jv&gt;;</span>
<span class="source-line-no">1731</span><span id="line-1731">       *</span>
<span class="source-line-no">1732</span><span id="line-1732">       *          &lt;jc&gt;// Get it from the RestRequest object.&lt;/jc&gt;</span>
<span class="source-line-no">1733</span><span id="line-1733">       *          &lt;jv&gt;string&lt;/jv&gt; = &lt;jv&gt;req&lt;/jv&gt;.getMessage(&lt;js&gt;"HelloMessage"&lt;/js&gt;, &lt;jv&gt;you&lt;/jv&gt;);</span>
<span class="source-line-no">1734</span><span id="line-1734">       *</span>
<span class="source-line-no">1735</span><span id="line-1735">       *          &lt;jc&gt;// Or get it from the method parameter.&lt;/jc&gt;</span>
<span class="source-line-no">1736</span><span id="line-1736">       *          &lt;jv&gt;string&lt;/jv&gt; = &lt;jv&gt;messages&lt;/jv&gt;.getString(&lt;js&gt;"HelloMessage"&lt;/js&gt;, &lt;jv&gt;you&lt;/jv&gt;);</span>
<span class="source-line-no">1737</span><span id="line-1737">       *</span>
<span class="source-line-no">1738</span><span id="line-1738">       *          &lt;jc&gt;// Or get the message in a locale different from the request.&lt;/jc&gt;</span>
<span class="source-line-no">1739</span><span id="line-1739">       *          &lt;jv&gt;string&lt;/jv&gt; = &lt;jv&gt;messages&lt;/jv&gt;.forLocale(Locale.&lt;jsf&gt;UK&lt;/jsf&gt;).getString(&lt;js&gt;"HelloMessage"&lt;/js&gt;, &lt;jv&gt;you&lt;/jv&gt;);</span>
<span class="source-line-no">1740</span><span id="line-1740">       *</span>
<span class="source-line-no">1741</span><span id="line-1741">       *          &lt;jk&gt;return&lt;/jk&gt; &lt;jv&gt;string&lt;/jv&gt;;</span>
<span class="source-line-no">1742</span><span id="line-1742">       *       }</span>
<span class="source-line-no">1743</span><span id="line-1743">       *    }</span>
<span class="source-line-no">1744</span><span id="line-1744">       * &lt;/p&gt;</span>
<span class="source-line-no">1745</span><span id="line-1745">       *</span>
<span class="source-line-no">1746</span><span id="line-1746">       * &lt;p&gt;</span>
<span class="source-line-no">1747</span><span id="line-1747">       * The default messages can overridden via any of the following:</span>
<span class="source-line-no">1748</span><span id="line-1748">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1749</span><span id="line-1749">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1750</span><span id="line-1750">       *    &lt;li&gt;Class annotation:  {@link Rest#messages() @Rest(messages)}</span>
<span class="source-line-no">1751</span><span id="line-1751">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1752</span><span id="line-1752">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1753</span><span id="line-1753">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] Messages myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1754</span><span id="line-1754">       *       &lt;/p&gt;</span>
<span class="source-line-no">1755</span><span id="line-1755">       *       Args can be any injected bean including Messages.Builder, the default builder.</span>
<span class="source-line-no">1756</span><span id="line-1756">       * &lt;/ul&gt;</span>
<span class="source-line-no">1757</span><span id="line-1757">       *</span>
<span class="source-line-no">1758</span><span id="line-1758">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1759</span><span id="line-1759">       *    &lt;li class='note'&gt;Mappings are cumulative from super classes.</span>
<span class="source-line-no">1760</span><span id="line-1760">       *       &lt;br&gt;Therefore, you can find and retrieve messages up the class-hierarchy chain.</span>
<span class="source-line-no">1761</span><span id="line-1761">       * &lt;/ul&gt;</span>
<span class="source-line-no">1762</span><span id="line-1762">       *</span>
<span class="source-line-no">1763</span><span id="line-1763">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1764</span><span id="line-1764">       *    &lt;li class='jc'&gt;{@link Messages}</span>
<span class="source-line-no">1765</span><span id="line-1765">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/LocalizedMessages"&gt;Localized Messages&lt;/a&gt;</span>
<span class="source-line-no">1766</span><span id="line-1766">       * &lt;/ul&gt;</span>
<span class="source-line-no">1767</span><span id="line-1767">       *</span>
<span class="source-line-no">1768</span><span id="line-1768">       * @return The messages sub-builder.</span>
<span class="source-line-no">1769</span><span id="line-1769">       */</span>
<span class="source-line-no">1770</span><span id="line-1770">      public Messages.Builder messages() {</span>
<span class="source-line-no">1771</span><span id="line-1771">         if (messages == null)</span>
<span class="source-line-no">1772</span><span id="line-1772">            messages = createMessages(beanStore(), resource());</span>
<span class="source-line-no">1773</span><span id="line-1773">         return messages;</span>
<span class="source-line-no">1774</span><span id="line-1774">      }</span>
<span class="source-line-no">1775</span><span id="line-1775"></span>
<span class="source-line-no">1776</span><span id="line-1776">      /**</span>
<span class="source-line-no">1777</span><span id="line-1777">       * Specifies the messages bundle for this class.</span>
<span class="source-line-no">1778</span><span id="line-1778">       *</span>
<span class="source-line-no">1779</span><span id="line-1779">       * &lt;p&gt;</span>
<span class="source-line-no">1780</span><span id="line-1780">       * Equivalent to calling:</span>
<span class="source-line-no">1781</span><span id="line-1781">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1782</span><span id="line-1782">       *    &lt;jv&gt;builder&lt;/jv&gt;.messages().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1783</span><span id="line-1783">       * &lt;/p&gt;</span>
<span class="source-line-no">1784</span><span id="line-1784">       *</span>
<span class="source-line-no">1785</span><span id="line-1785">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1786</span><span id="line-1786">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/LocalizedMessages"&gt;Localized Messages&lt;/a&gt;</span>
<span class="source-line-no">1787</span><span id="line-1787">       *    &lt;li class='jm'&gt;{@link #messages()}</span>
<span class="source-line-no">1788</span><span id="line-1788">       * &lt;/ul&gt;</span>
<span class="source-line-no">1789</span><span id="line-1789">       *</span>
<span class="source-line-no">1790</span><span id="line-1790">       * @param value The new value.</span>
<span class="source-line-no">1791</span><span id="line-1791">       * @return This object.</span>
<span class="source-line-no">1792</span><span id="line-1792">       */</span>
<span class="source-line-no">1793</span><span id="line-1793">      public Builder messages(Class&lt;? extends Messages&gt; value) {</span>
<span class="source-line-no">1794</span><span id="line-1794">         messages().type(value);</span>
<span class="source-line-no">1795</span><span id="line-1795">         return this;</span>
<span class="source-line-no">1796</span><span id="line-1796">      }</span>
<span class="source-line-no">1797</span><span id="line-1797"></span>
<span class="source-line-no">1798</span><span id="line-1798">      /**</span>
<span class="source-line-no">1799</span><span id="line-1799">       * Specifies the messages bundle for this class.</span>
<span class="source-line-no">1800</span><span id="line-1800">       *</span>
<span class="source-line-no">1801</span><span id="line-1801">       * &lt;p&gt;</span>
<span class="source-line-no">1802</span><span id="line-1802">       * Equivalent to calling:</span>
<span class="source-line-no">1803</span><span id="line-1803">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1804</span><span id="line-1804">       *    &lt;jv&gt;builder&lt;/jv&gt;.messages().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1805</span><span id="line-1805">       * &lt;/p&gt;</span>
<span class="source-line-no">1806</span><span id="line-1806">       *</span>
<span class="source-line-no">1807</span><span id="line-1807">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1808</span><span id="line-1808">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/LocalizedMessages"&gt;Localized Messages&lt;/a&gt;</span>
<span class="source-line-no">1809</span><span id="line-1809">       *    &lt;li class='jm'&gt;{@link #messages()}</span>
<span class="source-line-no">1810</span><span id="line-1810">       * &lt;/ul&gt;</span>
<span class="source-line-no">1811</span><span id="line-1811">       *</span>
<span class="source-line-no">1812</span><span id="line-1812">       * @param value The new value.</span>
<span class="source-line-no">1813</span><span id="line-1813">       * @return This object.</span>
<span class="source-line-no">1814</span><span id="line-1814">       */</span>
<span class="source-line-no">1815</span><span id="line-1815">      public Builder messages(Messages value) {</span>
<span class="source-line-no">1816</span><span id="line-1816">         messages().impl(value);</span>
<span class="source-line-no">1817</span><span id="line-1817">         return this;</span>
<span class="source-line-no">1818</span><span id="line-1818">      }</span>
<span class="source-line-no">1819</span><span id="line-1819"></span>
<span class="source-line-no">1820</span><span id="line-1820">      /**</span>
<span class="source-line-no">1821</span><span id="line-1821">       * Instantiates the messages sub-builder.</span>
<span class="source-line-no">1822</span><span id="line-1822">       *</span>
<span class="source-line-no">1823</span><span id="line-1823">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1824</span><span id="line-1824">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/LocalizedMessages"&gt;Localized Messages&lt;/a&gt;</span>
<span class="source-line-no">1825</span><span id="line-1825">       * &lt;/ul&gt;</span>
<span class="source-line-no">1826</span><span id="line-1826">       *</span>
<span class="source-line-no">1827</span><span id="line-1827">       * @param beanStore</span>
<span class="source-line-no">1828</span><span id="line-1828">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">1829</span><span id="line-1829">       * @param resource</span>
<span class="source-line-no">1830</span><span id="line-1830">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">1831</span><span id="line-1831">       * @return A new messages sub-builder.</span>
<span class="source-line-no">1832</span><span id="line-1832">       */</span>
<span class="source-line-no">1833</span><span id="line-1833">      protected Messages.Builder createMessages(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">1834</span><span id="line-1834"></span>
<span class="source-line-no">1835</span><span id="line-1835">         // Default value.</span>
<span class="source-line-no">1836</span><span id="line-1836">         Value&lt;Messages.Builder&gt; v = Value.of(</span>
<span class="source-line-no">1837</span><span id="line-1837">            Messages</span>
<span class="source-line-no">1838</span><span id="line-1838">            .create(resourceClass)</span>
<span class="source-line-no">1839</span><span id="line-1839">         );</span>
<span class="source-line-no">1840</span><span id="line-1840"></span>
<span class="source-line-no">1841</span><span id="line-1841">         // Replace with bean from bean store.</span>
<span class="source-line-no">1842</span><span id="line-1842">         beanStore</span>
<span class="source-line-no">1843</span><span id="line-1843">            .getBean(Messages.class)</span>
<span class="source-line-no">1844</span><span id="line-1844">            .ifPresent(x-&gt;v.get().impl(x));</span>
<span class="source-line-no">1845</span><span id="line-1845"></span>
<span class="source-line-no">1846</span><span id="line-1846">         // Replace with bean from:  @RestInject public [static] Messages xxx(&lt;args&gt;)</span>
<span class="source-line-no">1847</span><span id="line-1847">         beanStore</span>
<span class="source-line-no">1848</span><span id="line-1848">            .createMethodFinder(Messages.class)</span>
<span class="source-line-no">1849</span><span id="line-1849">            .addBean(Messages.Builder.class, v.get())</span>
<span class="source-line-no">1850</span><span id="line-1850">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">1851</span><span id="line-1851">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">1852</span><span id="line-1852"></span>
<span class="source-line-no">1853</span><span id="line-1853">         return v.get();</span>
<span class="source-line-no">1854</span><span id="line-1854">      }</span>
<span class="source-line-no">1855</span><span id="line-1855"></span>
<span class="source-line-no">1856</span><span id="line-1856">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1857</span><span id="line-1857">      // responseProcessors</span>
<span class="source-line-no">1858</span><span id="line-1858">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">1859</span><span id="line-1859"></span>
<span class="source-line-no">1860</span><span id="line-1860">      /**</span>
<span class="source-line-no">1861</span><span id="line-1861">       * Returns the response processor list sub-builder.</span>
<span class="source-line-no">1862</span><span id="line-1862">       *</span>
<span class="source-line-no">1863</span><span id="line-1863">       * &lt;p&gt;</span>
<span class="source-line-no">1864</span><span id="line-1864">       * Specifies a list of {@link ResponseProcessor} classes that know how to convert POJOs returned by REST methods or</span>
<span class="source-line-no">1865</span><span id="line-1865">       * set via {@link RestResponse#setContent(Object)} into appropriate HTTP responses.</span>
<span class="source-line-no">1866</span><span id="line-1866">       *</span>
<span class="source-line-no">1867</span><span id="line-1867">       * &lt;p&gt;</span>
<span class="source-line-no">1868</span><span id="line-1868">       * By default, the following response handlers are provided in the specified order:</span>
<span class="source-line-no">1869</span><span id="line-1869">       * &lt;ul class='javatreec'&gt;</span>
<span class="source-line-no">1870</span><span id="line-1870">       *    &lt;li class='jc'&gt;{@link ReaderProcessor}</span>
<span class="source-line-no">1871</span><span id="line-1871">       *    &lt;li class='jc'&gt;{@link InputStreamProcessor}</span>
<span class="source-line-no">1872</span><span id="line-1872">       *    &lt;li class='jc'&gt;{@link ThrowableProcessor}</span>
<span class="source-line-no">1873</span><span id="line-1873">       *    &lt;li class='jc'&gt;{@link HttpResponseProcessor}</span>
<span class="source-line-no">1874</span><span id="line-1874">       *    &lt;li class='jc'&gt;{@link HttpResourceProcessor}</span>
<span class="source-line-no">1875</span><span id="line-1875">       *    &lt;li class='jc'&gt;{@link HttpEntityProcessor}</span>
<span class="source-line-no">1876</span><span id="line-1876">       *    &lt;li class='jc'&gt;{@link ResponseBeanProcessor}</span>
<span class="source-line-no">1877</span><span id="line-1877">       *    &lt;li class='jc'&gt;{@link PlainTextPojoProcessor}</span>
<span class="source-line-no">1878</span><span id="line-1878">       *    &lt;li class='jc'&gt;{@link SerializedPojoProcessor}</span>
<span class="source-line-no">1879</span><span id="line-1879">       * &lt;/ul&gt;</span>
<span class="source-line-no">1880</span><span id="line-1880">       *</span>
<span class="source-line-no">1881</span><span id="line-1881">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">1882</span><span id="line-1882">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1883</span><span id="line-1883">       *    &lt;jc&gt;// Our custom response processor for Foo objects. &lt;/jc&gt;</span>
<span class="source-line-no">1884</span><span id="line-1884">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResponseProcessor &lt;jk&gt;implements&lt;/jk&gt; ResponseProcessor {</span>
<span class="source-line-no">1885</span><span id="line-1885">       *</span>
<span class="source-line-no">1886</span><span id="line-1886">       *       &lt;ja&gt;@Override&lt;/ja&gt;</span>
<span class="source-line-no">1887</span><span id="line-1887">       *       &lt;jk&gt;public int&lt;/jk&gt; process(RestOpSession &lt;jv&gt;opSession&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; IOException {</span>
<span class="source-line-no">1888</span><span id="line-1888">       *</span>
<span class="source-line-no">1889</span><span id="line-1889">       *             RestResponse &lt;jv&gt;res&lt;/jv&gt; = &lt;jv&gt;opSession&lt;/jv&gt;.getResponse();</span>
<span class="source-line-no">1890</span><span id="line-1890">       *             Foo &lt;jv&gt;foo&lt;/jv&gt; = &lt;jv&gt;res&lt;/jv&gt;.getOutput(Foo.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">1891</span><span id="line-1891">       *</span>
<span class="source-line-no">1892</span><span id="line-1892">       *             &lt;jk&gt;if&lt;/jk&gt; (&lt;jv&gt;foo&lt;/jv&gt; == &lt;jk&gt;null&lt;/jk&gt;)</span>
<span class="source-line-no">1893</span><span id="line-1893">       *                &lt;jk&gt;return&lt;/jk&gt; &lt;jsf&gt;NEXT&lt;/jsf&gt;;  &lt;jc&gt;// Let the next processor handle it.&lt;/jc&gt;</span>
<span class="source-line-no">1894</span><span id="line-1894">       *</span>
<span class="source-line-no">1895</span><span id="line-1895">       *             &lt;jk&gt;try&lt;/jk&gt; (Writer &lt;jv&gt;writer&lt;/jv&gt; = &lt;jv&gt;res&lt;/jv&gt;.getNegotiatedWriter()) {</span>
<span class="source-line-no">1896</span><span id="line-1896">       *                &lt;jc&gt;//Pipe it to the writer ourselves.&lt;/jc&gt;</span>
<span class="source-line-no">1897</span><span id="line-1897">       *             }</span>
<span class="source-line-no">1898</span><span id="line-1898">       *</span>
<span class="source-line-no">1899</span><span id="line-1899">       *             &lt;jk&gt;return&lt;/jk&gt; &lt;jsf&gt;FINISHED&lt;/jsf&gt;;  &lt;jc&gt;// We handled it.&lt;/jc&gt;</span>
<span class="source-line-no">1900</span><span id="line-1900">       *       }</span>
<span class="source-line-no">1901</span><span id="line-1901">       *       }</span>
<span class="source-line-no">1902</span><span id="line-1902">       *    }</span>
<span class="source-line-no">1903</span><span id="line-1903">       *</span>
<span class="source-line-no">1904</span><span id="line-1904">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">1905</span><span id="line-1905">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(responseProcessors=MyResponseProcessor.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">1906</span><span id="line-1906">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">1907</span><span id="line-1907">       *</span>
<span class="source-line-no">1908</span><span id="line-1908">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">1909</span><span id="line-1909">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">1910</span><span id="line-1910">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">1911</span><span id="line-1911">       *          &lt;jv&gt;builder&lt;/jv&gt;.responseProcessors(MyResponseProcessors.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">1912</span><span id="line-1912">       *       }</span>
<span class="source-line-no">1913</span><span id="line-1913">       *</span>
<span class="source-line-no">1914</span><span id="line-1914">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;(...)</span>
<span class="source-line-no">1915</span><span id="line-1915">       *       &lt;jk&gt;public&lt;/jk&gt; Object myMethod() {</span>
<span class="source-line-no">1916</span><span id="line-1916">       *          &lt;jc&gt;// Return a special object for our handler.&lt;/jc&gt;</span>
<span class="source-line-no">1917</span><span id="line-1917">       *          &lt;jk&gt;return new&lt;/jk&gt; MySpecialObject();</span>
<span class="source-line-no">1918</span><span id="line-1918">       *       }</span>
<span class="source-line-no">1919</span><span id="line-1919">       *    }</span>
<span class="source-line-no">1920</span><span id="line-1920">       * &lt;/p&gt;</span>
<span class="source-line-no">1921</span><span id="line-1921">       *</span>
<span class="source-line-no">1922</span><span id="line-1922">       * &lt;p&gt;</span>
<span class="source-line-no">1923</span><span id="line-1923">       * The default response processors can overridden via any of the following:</span>
<span class="source-line-no">1924</span><span id="line-1924">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">1925</span><span id="line-1925">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">1926</span><span id="line-1926">       *    &lt;li&gt;Class annotation:  {@link Rest#responseProcessors() @Rest(responseProcessors)}</span>
<span class="source-line-no">1927</span><span id="line-1927">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">1928</span><span id="line-1928">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1929</span><span id="line-1929">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] ResponseProcessorList myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">1930</span><span id="line-1930">       *       &lt;/p&gt;</span>
<span class="source-line-no">1931</span><span id="line-1931">       *       Args can be any injected bean including ResponseProcessorList.Builder, the default builder.</span>
<span class="source-line-no">1932</span><span id="line-1932">       * &lt;/ul&gt;</span>
<span class="source-line-no">1933</span><span id="line-1933">       *</span>
<span class="source-line-no">1934</span><span id="line-1934">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1935</span><span id="line-1935">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">1936</span><span id="line-1936">       *       Response processors are always inherited from ascendant resources.</span>
<span class="source-line-no">1937</span><span id="line-1937">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">1938</span><span id="line-1938">       *       When defined as a class, the implementation must have one of the following constructors:</span>
<span class="source-line-no">1939</span><span id="line-1939">       *       &lt;ul&gt;</span>
<span class="source-line-no">1940</span><span id="line-1940">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public&lt;/jk&gt; T(RestContext)&lt;/code&gt;</span>
<span class="source-line-no">1941</span><span id="line-1941">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public&lt;/jk&gt; T()&lt;/code&gt;</span>
<span class="source-line-no">1942</span><span id="line-1942">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public static&lt;/jk&gt; T &lt;jsm&gt;create&lt;/jsm&gt;(RestContext)&lt;/code&gt;</span>
<span class="source-line-no">1943</span><span id="line-1943">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public static&lt;/jk&gt; T &lt;jsm&gt;create&lt;/jsm&gt;()&lt;/code&gt;</span>
<span class="source-line-no">1944</span><span id="line-1944">       *       &lt;/ul&gt;</span>
<span class="source-line-no">1945</span><span id="line-1945">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">1946</span><span id="line-1946">       *       Inner classes of the REST resource class are allowed.</span>
<span class="source-line-no">1947</span><span id="line-1947">       * &lt;/ul&gt;</span>
<span class="source-line-no">1948</span><span id="line-1948">       *</span>
<span class="source-line-no">1949</span><span id="line-1949">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1950</span><span id="line-1950">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ResponseProcessors"&gt;Response Processors&lt;/a&gt;</span>
<span class="source-line-no">1951</span><span id="line-1951">       * &lt;/ul&gt;</span>
<span class="source-line-no">1952</span><span id="line-1952">       *</span>
<span class="source-line-no">1953</span><span id="line-1953">       * @return The response processor list sub-builder.</span>
<span class="source-line-no">1954</span><span id="line-1954">       */</span>
<span class="source-line-no">1955</span><span id="line-1955">      public ResponseProcessorList.Builder responseProcessors() {</span>
<span class="source-line-no">1956</span><span id="line-1956">         if (responseProcessors == null)</span>
<span class="source-line-no">1957</span><span id="line-1957">            responseProcessors = createResponseProcessors(beanStore(), resource());</span>
<span class="source-line-no">1958</span><span id="line-1958">         return responseProcessors;</span>
<span class="source-line-no">1959</span><span id="line-1959">      }</span>
<span class="source-line-no">1960</span><span id="line-1960"></span>
<span class="source-line-no">1961</span><span id="line-1961">      /**</span>
<span class="source-line-no">1962</span><span id="line-1962">       * Adds one or more response processors to this class.</span>
<span class="source-line-no">1963</span><span id="line-1963">       *</span>
<span class="source-line-no">1964</span><span id="line-1964">       * &lt;p&gt;</span>
<span class="source-line-no">1965</span><span id="line-1965">       * Equivalent to calling:</span>
<span class="source-line-no">1966</span><span id="line-1966">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1967</span><span id="line-1967">       *    &lt;jv&gt;builder&lt;/jv&gt;.responseProcessors().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1968</span><span id="line-1968">       * &lt;/p&gt;</span>
<span class="source-line-no">1969</span><span id="line-1969">       *</span>
<span class="source-line-no">1970</span><span id="line-1970">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1971</span><span id="line-1971">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ResponseProcessors"&gt;Response Processors&lt;/a&gt;</span>
<span class="source-line-no">1972</span><span id="line-1972">       *    &lt;li class='jm'&gt;{@link #responseProcessors()}</span>
<span class="source-line-no">1973</span><span id="line-1973">       * &lt;/ul&gt;</span>
<span class="source-line-no">1974</span><span id="line-1974">       *</span>
<span class="source-line-no">1975</span><span id="line-1975">       * @param value The values to add.</span>
<span class="source-line-no">1976</span><span id="line-1976">       * @return This object.</span>
<span class="source-line-no">1977</span><span id="line-1977">       */</span>
<span class="source-line-no">1978</span><span id="line-1978">      @SafeVarargs</span>
<span class="source-line-no">1979</span><span id="line-1979">      public final Builder responseProcessors(Class&lt;? extends ResponseProcessor&gt;...value) {</span>
<span class="source-line-no">1980</span><span id="line-1980">         responseProcessors().add(value);</span>
<span class="source-line-no">1981</span><span id="line-1981">         return this;</span>
<span class="source-line-no">1982</span><span id="line-1982">      }</span>
<span class="source-line-no">1983</span><span id="line-1983"></span>
<span class="source-line-no">1984</span><span id="line-1984">      /**</span>
<span class="source-line-no">1985</span><span id="line-1985">       * Adds one or more response processors to this class.</span>
<span class="source-line-no">1986</span><span id="line-1986">       *</span>
<span class="source-line-no">1987</span><span id="line-1987">       * &lt;p&gt;</span>
<span class="source-line-no">1988</span><span id="line-1988">       * Equivalent to calling:</span>
<span class="source-line-no">1989</span><span id="line-1989">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">1990</span><span id="line-1990">       *    &lt;jv&gt;builder&lt;/jv&gt;.responseProcessors().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">1991</span><span id="line-1991">       * &lt;/p&gt;</span>
<span class="source-line-no">1992</span><span id="line-1992">       *</span>
<span class="source-line-no">1993</span><span id="line-1993">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">1994</span><span id="line-1994">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ResponseProcessors"&gt;Response Processors&lt;/a&gt;</span>
<span class="source-line-no">1995</span><span id="line-1995">       *    &lt;li class='jm'&gt;{@link #responseProcessors()}</span>
<span class="source-line-no">1996</span><span id="line-1996">       * &lt;/ul&gt;</span>
<span class="source-line-no">1997</span><span id="line-1997">       *</span>
<span class="source-line-no">1998</span><span id="line-1998">       * @param value The values to add.</span>
<span class="source-line-no">1999</span><span id="line-1999">       * @return This object.</span>
<span class="source-line-no">2000</span><span id="line-2000">       */</span>
<span class="source-line-no">2001</span><span id="line-2001">      public Builder responseProcessors(ResponseProcessor...value) {</span>
<span class="source-line-no">2002</span><span id="line-2002">         responseProcessors().add(value);</span>
<span class="source-line-no">2003</span><span id="line-2003">         return this;</span>
<span class="source-line-no">2004</span><span id="line-2004">      }</span>
<span class="source-line-no">2005</span><span id="line-2005"></span>
<span class="source-line-no">2006</span><span id="line-2006">      /**</span>
<span class="source-line-no">2007</span><span id="line-2007">       * Instantiates the response processor list sub-builder.</span>
<span class="source-line-no">2008</span><span id="line-2008">       *</span>
<span class="source-line-no">2009</span><span id="line-2009">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2010</span><span id="line-2010">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/ResponseProcessors"&gt;Response Processors&lt;/a&gt;</span>
<span class="source-line-no">2011</span><span id="line-2011">       * &lt;/ul&gt;</span>
<span class="source-line-no">2012</span><span id="line-2012">       *</span>
<span class="source-line-no">2013</span><span id="line-2013">       * @param beanStore</span>
<span class="source-line-no">2014</span><span id="line-2014">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2015</span><span id="line-2015">       * @param resource</span>
<span class="source-line-no">2016</span><span id="line-2016">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2017</span><span id="line-2017">       * @return A new response processor list sub-builder.</span>
<span class="source-line-no">2018</span><span id="line-2018">       */</span>
<span class="source-line-no">2019</span><span id="line-2019">      protected ResponseProcessorList.Builder createResponseProcessors(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2020</span><span id="line-2020"></span>
<span class="source-line-no">2021</span><span id="line-2021">         // Default value.</span>
<span class="source-line-no">2022</span><span id="line-2022">         Value&lt;ResponseProcessorList.Builder&gt; v = Value.of(</span>
<span class="source-line-no">2023</span><span id="line-2023">             ResponseProcessorList</span>
<span class="source-line-no">2024</span><span id="line-2024">               .create(beanStore)</span>
<span class="source-line-no">2025</span><span id="line-2025">               .add(</span>
<span class="source-line-no">2026</span><span id="line-2026">                  ReaderProcessor.class,</span>
<span class="source-line-no">2027</span><span id="line-2027">                  InputStreamProcessor.class,</span>
<span class="source-line-no">2028</span><span id="line-2028">                  ThrowableProcessor.class,</span>
<span class="source-line-no">2029</span><span id="line-2029">                  HttpResponseProcessor.class,</span>
<span class="source-line-no">2030</span><span id="line-2030">                  HttpResourceProcessor.class,</span>
<span class="source-line-no">2031</span><span id="line-2031">                  HttpEntityProcessor.class,</span>
<span class="source-line-no">2032</span><span id="line-2032">                  ResponseBeanProcessor.class,</span>
<span class="source-line-no">2033</span><span id="line-2033">                  PlainTextPojoProcessor.class,</span>
<span class="source-line-no">2034</span><span id="line-2034">                  SerializedPojoProcessor.class</span>
<span class="source-line-no">2035</span><span id="line-2035">               )</span>
<span class="source-line-no">2036</span><span id="line-2036">         );</span>
<span class="source-line-no">2037</span><span id="line-2037"></span>
<span class="source-line-no">2038</span><span id="line-2038">         // Replace with bean from bean store.</span>
<span class="source-line-no">2039</span><span id="line-2039">         beanStore</span>
<span class="source-line-no">2040</span><span id="line-2040">            .getBean(ResponseProcessorList.class)</span>
<span class="source-line-no">2041</span><span id="line-2041">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2042</span><span id="line-2042"></span>
<span class="source-line-no">2043</span><span id="line-2043">         // Replace with bean from:  @RestInject public [static] ResponseProcessorList xxx(&lt;args&gt;)</span>
<span class="source-line-no">2044</span><span id="line-2044">         beanStore</span>
<span class="source-line-no">2045</span><span id="line-2045">            .createMethodFinder(ResponseProcessorList.class)</span>
<span class="source-line-no">2046</span><span id="line-2046">            .addBean(ResponseProcessorList.Builder.class, v.get())</span>
<span class="source-line-no">2047</span><span id="line-2047">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2048</span><span id="line-2048">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2049</span><span id="line-2049"></span>
<span class="source-line-no">2050</span><span id="line-2050">         return v.get();</span>
<span class="source-line-no">2051</span><span id="line-2051">      }</span>
<span class="source-line-no">2052</span><span id="line-2052"></span>
<span class="source-line-no">2053</span><span id="line-2053">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2054</span><span id="line-2054">      // callLogger</span>
<span class="source-line-no">2055</span><span id="line-2055">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2056</span><span id="line-2056"></span>
<span class="source-line-no">2057</span><span id="line-2057">      /**</span>
<span class="source-line-no">2058</span><span id="line-2058">       * Returns the call logger bean creator.</span>
<span class="source-line-no">2059</span><span id="line-2059">       *</span>
<span class="source-line-no">2060</span><span id="line-2060">       * &lt;p&gt;</span>
<span class="source-line-no">2061</span><span id="line-2061">       * Specifies the logger to use for logging of HTTP requests and responses.</span>
<span class="source-line-no">2062</span><span id="line-2062">       *</span>
<span class="source-line-no">2063</span><span id="line-2063">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">2064</span><span id="line-2064">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2065</span><span id="line-2065">       *    &lt;jc&gt;// Our customized logger.&lt;/jc&gt;</span>
<span class="source-line-no">2066</span><span id="line-2066">       *    &lt;jk&gt;public class&lt;/jk&gt; MyLogger &lt;jk&gt;extends&lt;/jk&gt; BasicCallLogger {</span>
<span class="source-line-no">2067</span><span id="line-2067">       *</span>
<span class="source-line-no">2068</span><span id="line-2068">       *       &lt;jk&gt;public&lt;/jk&gt; MyLogger(BeanStore &lt;jv&gt;beanStore&lt;/jv&gt;) {</span>
<span class="source-line-no">2069</span><span id="line-2069">       *       &lt;jk&gt;super&lt;/jk&gt;(&lt;jv&gt;beanStore&lt;/jv&gt;);</span>
<span class="source-line-no">2070</span><span id="line-2070">       *    }</span>
<span class="source-line-no">2071</span><span id="line-2071">       *</span>
<span class="source-line-no">2072</span><span id="line-2072">       *       &lt;ja&gt;@Override&lt;/ja&gt;</span>
<span class="source-line-no">2073</span><span id="line-2073">       *          &lt;jk&gt;protected void&lt;/jk&gt; log(Level &lt;jv&gt;level&lt;/jv&gt;, String &lt;jv&gt;msg&lt;/jv&gt;, Throwable &lt;jv&gt;e&lt;/jv&gt;) {</span>
<span class="source-line-no">2074</span><span id="line-2074">       *          &lt;jc&gt;// Handle logging ourselves.&lt;/jc&gt;</span>
<span class="source-line-no">2075</span><span id="line-2075">       *       }</span>
<span class="source-line-no">2076</span><span id="line-2076">       *    }</span>
<span class="source-line-no">2077</span><span id="line-2077">       *</span>
<span class="source-line-no">2078</span><span id="line-2078">       *    &lt;jc&gt;// Option #1 - Registered via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">2079</span><span id="line-2079">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(callLogger=MyLogger.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">2080</span><span id="line-2080">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">2081</span><span id="line-2081">       *</span>
<span class="source-line-no">2082</span><span id="line-2082">       *       &lt;jc&gt;// Option #2 - Registered via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">2083</span><span id="line-2083">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">2084</span><span id="line-2084">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">2085</span><span id="line-2085">       *          &lt;jv&gt;builder&lt;/jv&gt;.callLogger(MyLogger.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">2086</span><span id="line-2086">       *       }</span>
<span class="source-line-no">2087</span><span id="line-2087">       *    }</span>
<span class="source-line-no">2088</span><span id="line-2088">       * &lt;/p&gt;</span>
<span class="source-line-no">2089</span><span id="line-2089">       *</span>
<span class="source-line-no">2090</span><span id="line-2090">       * &lt;p&gt;</span>
<span class="source-line-no">2091</span><span id="line-2091">       * The default call logger can overridden via any of the following:</span>
<span class="source-line-no">2092</span><span id="line-2092">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2093</span><span id="line-2093">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">2094</span><span id="line-2094">       *    &lt;li&gt;Class annotation:  {@link Rest#callLogger() @Rest(callLogger)}</span>
<span class="source-line-no">2095</span><span id="line-2095">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">2096</span><span id="line-2096">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2097</span><span id="line-2097">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] CallLogger myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">2098</span><span id="line-2098">       *       &lt;/p&gt;</span>
<span class="source-line-no">2099</span><span id="line-2099">       *       Args can be any injected bean.</span>
<span class="source-line-no">2100</span><span id="line-2100">       * &lt;/ul&gt;</span>
<span class="source-line-no">2101</span><span id="line-2101">       *</span>
<span class="source-line-no">2102</span><span id="line-2102">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2103</span><span id="line-2103">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2104</span><span id="line-2104">       *       The default call logger if not specified is {@link BasicCallLogger}.</span>
<span class="source-line-no">2105</span><span id="line-2105">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2106</span><span id="line-2106">       *       The resource class itself will be used if it implements the {@link CallLogger} interface and not</span>
<span class="source-line-no">2107</span><span id="line-2107">       *       explicitly overridden via this annotation.</span>
<span class="source-line-no">2108</span><span id="line-2108">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2109</span><span id="line-2109">       *       When defined as a class, the implementation must have one of the following constructor:</span>
<span class="source-line-no">2110</span><span id="line-2110">       *       &lt;ul&gt;</span>
<span class="source-line-no">2111</span><span id="line-2111">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public&lt;/jk&gt; T(BeanStore)&lt;/code&gt;</span>
<span class="source-line-no">2112</span><span id="line-2112">       *       &lt;/ul&gt;</span>
<span class="source-line-no">2113</span><span id="line-2113">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2114</span><span id="line-2114">       *       Inner classes of the REST resource class are allowed.</span>
<span class="source-line-no">2115</span><span id="line-2115">       * &lt;/ul&gt;</span>
<span class="source-line-no">2116</span><span id="line-2116">       *</span>
<span class="source-line-no">2117</span><span id="line-2117">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2118</span><span id="line-2118">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">2119</span><span id="line-2119">       * &lt;/ul&gt;</span>
<span class="source-line-no">2120</span><span id="line-2120">       *</span>
<span class="source-line-no">2121</span><span id="line-2121">       * @return The call logger sub-builder.</span>
<span class="source-line-no">2122</span><span id="line-2122">       * @throws RuntimeException If {@link #init(Supplier)} has not been called.</span>
<span class="source-line-no">2123</span><span id="line-2123">       */</span>
<span class="source-line-no">2124</span><span id="line-2124">      public BeanCreator&lt;CallLogger&gt; callLogger() {</span>
<span class="source-line-no">2125</span><span id="line-2125">         if (callLogger == null)</span>
<span class="source-line-no">2126</span><span id="line-2126">            callLogger = createCallLogger(beanStore, resource);</span>
<span class="source-line-no">2127</span><span id="line-2127">         return callLogger;</span>
<span class="source-line-no">2128</span><span id="line-2128">      }</span>
<span class="source-line-no">2129</span><span id="line-2129"></span>
<span class="source-line-no">2130</span><span id="line-2130">      /**</span>
<span class="source-line-no">2131</span><span id="line-2131">       * Specifies the call logger for this class.</span>
<span class="source-line-no">2132</span><span id="line-2132">       *</span>
<span class="source-line-no">2133</span><span id="line-2133">       * &lt;p&gt;</span>
<span class="source-line-no">2134</span><span id="line-2134">       * Equivalent to calling:</span>
<span class="source-line-no">2135</span><span id="line-2135">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2136</span><span id="line-2136">       *    &lt;jv&gt;builder&lt;/jv&gt;.callLogger().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2137</span><span id="line-2137">       * &lt;/p&gt;</span>
<span class="source-line-no">2138</span><span id="line-2138">       *</span>
<span class="source-line-no">2139</span><span id="line-2139">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2140</span><span id="line-2140">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">2141</span><span id="line-2141">       *    &lt;li class='jm'&gt;{@link #callLogger()}</span>
<span class="source-line-no">2142</span><span id="line-2142">       * &lt;/ul&gt;</span>
<span class="source-line-no">2143</span><span id="line-2143">       *</span>
<span class="source-line-no">2144</span><span id="line-2144">       * @param value The new value.</span>
<span class="source-line-no">2145</span><span id="line-2145">       * @return This object.</span>
<span class="source-line-no">2146</span><span id="line-2146">       */</span>
<span class="source-line-no">2147</span><span id="line-2147">      public Builder callLogger(Class&lt;? extends CallLogger&gt; value) {</span>
<span class="source-line-no">2148</span><span id="line-2148">         callLogger().type(value);</span>
<span class="source-line-no">2149</span><span id="line-2149">         return this;</span>
<span class="source-line-no">2150</span><span id="line-2150">      }</span>
<span class="source-line-no">2151</span><span id="line-2151"></span>
<span class="source-line-no">2152</span><span id="line-2152">      /**</span>
<span class="source-line-no">2153</span><span id="line-2153">       * Specifies the call logger for this class.</span>
<span class="source-line-no">2154</span><span id="line-2154">       *</span>
<span class="source-line-no">2155</span><span id="line-2155">       * &lt;p&gt;</span>
<span class="source-line-no">2156</span><span id="line-2156">       * Equivalent to calling:</span>
<span class="source-line-no">2157</span><span id="line-2157">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2158</span><span id="line-2158">       *    &lt;jv&gt;builder&lt;/jv&gt;.callLogger().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2159</span><span id="line-2159">       * &lt;/p&gt;</span>
<span class="source-line-no">2160</span><span id="line-2160">       *</span>
<span class="source-line-no">2161</span><span id="line-2161">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2162</span><span id="line-2162">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">2163</span><span id="line-2163">       *    &lt;li class='jm'&gt;{@link #callLogger()}</span>
<span class="source-line-no">2164</span><span id="line-2164">       * &lt;/ul&gt;</span>
<span class="source-line-no">2165</span><span id="line-2165">       *</span>
<span class="source-line-no">2166</span><span id="line-2166">       * @param value The new value.</span>
<span class="source-line-no">2167</span><span id="line-2167">       * @return This object.</span>
<span class="source-line-no">2168</span><span id="line-2168">       */</span>
<span class="source-line-no">2169</span><span id="line-2169">      public Builder callLogger(CallLogger value) {</span>
<span class="source-line-no">2170</span><span id="line-2170">         callLogger().impl(value);</span>
<span class="source-line-no">2171</span><span id="line-2171">         return this;</span>
<span class="source-line-no">2172</span><span id="line-2172">      }</span>
<span class="source-line-no">2173</span><span id="line-2173"></span>
<span class="source-line-no">2174</span><span id="line-2174">      /**</span>
<span class="source-line-no">2175</span><span id="line-2175">       * Instantiates the call logger sub-builder.</span>
<span class="source-line-no">2176</span><span id="line-2176">       *</span>
<span class="source-line-no">2177</span><span id="line-2177">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2178</span><span id="line-2178">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerLoggingAndDebugging"&gt;Logging / Debugging&lt;/a&gt;</span>
<span class="source-line-no">2179</span><span id="line-2179">       * &lt;/ul&gt;</span>
<span class="source-line-no">2180</span><span id="line-2180">       *</span>
<span class="source-line-no">2181</span><span id="line-2181">       * @param beanStore</span>
<span class="source-line-no">2182</span><span id="line-2182">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2183</span><span id="line-2183">       * @param resource</span>
<span class="source-line-no">2184</span><span id="line-2184">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2185</span><span id="line-2185">       * @return A new call logger sub-builder.</span>
<span class="source-line-no">2186</span><span id="line-2186">       */</span>
<span class="source-line-no">2187</span><span id="line-2187">      protected BeanCreator&lt;CallLogger&gt; createCallLogger(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2188</span><span id="line-2188"></span>
<span class="source-line-no">2189</span><span id="line-2189">         BeanCreator&lt;CallLogger&gt; creator = beanStore.createBean(CallLogger.class).type(BasicCallLogger.class);</span>
<span class="source-line-no">2190</span><span id="line-2190"></span>
<span class="source-line-no">2191</span><span id="line-2191">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">2192</span><span id="line-2192">         defaultClasses()</span>
<span class="source-line-no">2193</span><span id="line-2193">            .get(CallLogger.class)</span>
<span class="source-line-no">2194</span><span id="line-2194">            .ifPresent(x -&gt; creator.type(x));</span>
<span class="source-line-no">2195</span><span id="line-2195"></span>
<span class="source-line-no">2196</span><span id="line-2196">         beanStore</span>
<span class="source-line-no">2197</span><span id="line-2197">            .getBean(CallLogger.class)</span>
<span class="source-line-no">2198</span><span id="line-2198">            .ifPresent(x -&gt; creator.impl(x));</span>
<span class="source-line-no">2199</span><span id="line-2199"></span>
<span class="source-line-no">2200</span><span id="line-2200">         // Replace with bean from:  @RestInject public [static] CallLogger xxx(&lt;args&gt;)</span>
<span class="source-line-no">2201</span><span id="line-2201">         beanStore</span>
<span class="source-line-no">2202</span><span id="line-2202">            .createMethodFinder(CallLogger.class)</span>
<span class="source-line-no">2203</span><span id="line-2203">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2204</span><span id="line-2204">            .run(x -&gt; creator.impl(x));</span>
<span class="source-line-no">2205</span><span id="line-2205"></span>
<span class="source-line-no">2206</span><span id="line-2206">         return creator;</span>
<span class="source-line-no">2207</span><span id="line-2207">      }</span>
<span class="source-line-no">2208</span><span id="line-2208"></span>
<span class="source-line-no">2209</span><span id="line-2209">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2210</span><span id="line-2210">      // beanContext</span>
<span class="source-line-no">2211</span><span id="line-2211">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2212</span><span id="line-2212"></span>
<span class="source-line-no">2213</span><span id="line-2213">      /**</span>
<span class="source-line-no">2214</span><span id="line-2214">       * Returns the bean context sub-builder.</span>
<span class="source-line-no">2215</span><span id="line-2215">       *</span>
<span class="source-line-no">2216</span><span id="line-2216">       * &lt;p&gt;</span>
<span class="source-line-no">2217</span><span id="line-2217">       * The bean context is used to retrieve metadata on Java beans.</span>
<span class="source-line-no">2218</span><span id="line-2218">       *</span>
<span class="source-line-no">2219</span><span id="line-2219">       * &lt;p&gt;</span>
<span class="source-line-no">2220</span><span id="line-2220">       * The default bean context can overridden via any of the following:</span>
<span class="source-line-no">2221</span><span id="line-2221">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2222</span><span id="line-2222">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">2223</span><span id="line-2223">       * &lt;/ul&gt;</span>
<span class="source-line-no">2224</span><span id="line-2224">       *</span>
<span class="source-line-no">2225</span><span id="line-2225">       * @return The bean context sub-builder.</span>
<span class="source-line-no">2226</span><span id="line-2226">       */</span>
<span class="source-line-no">2227</span><span id="line-2227">      public BeanContext.Builder beanContext() {</span>
<span class="source-line-no">2228</span><span id="line-2228">         if (beanContext == null)</span>
<span class="source-line-no">2229</span><span id="line-2229">            beanContext = createBeanContext(beanStore(), resource());</span>
<span class="source-line-no">2230</span><span id="line-2230">         return beanContext;</span>
<span class="source-line-no">2231</span><span id="line-2231">      }</span>
<span class="source-line-no">2232</span><span id="line-2232"></span>
<span class="source-line-no">2233</span><span id="line-2233">      /**</span>
<span class="source-line-no">2234</span><span id="line-2234">       * Instantiates the bean context sub-builder.</span>
<span class="source-line-no">2235</span><span id="line-2235">       *</span>
<span class="source-line-no">2236</span><span id="line-2236">       * @param beanStore</span>
<span class="source-line-no">2237</span><span id="line-2237">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2238</span><span id="line-2238">       * @param resource</span>
<span class="source-line-no">2239</span><span id="line-2239">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2240</span><span id="line-2240">       * @return A new bean context sub-builder.</span>
<span class="source-line-no">2241</span><span id="line-2241">       */</span>
<span class="source-line-no">2242</span><span id="line-2242">      protected BeanContext.Builder createBeanContext(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2243</span><span id="line-2243"></span>
<span class="source-line-no">2244</span><span id="line-2244">         // Default value.</span>
<span class="source-line-no">2245</span><span id="line-2245">         Value&lt;BeanContext.Builder&gt; v = Value.of(</span>
<span class="source-line-no">2246</span><span id="line-2246">            BeanContext.create()</span>
<span class="source-line-no">2247</span><span id="line-2247">         );</span>
<span class="source-line-no">2248</span><span id="line-2248"></span>
<span class="source-line-no">2249</span><span id="line-2249">         // Replace with builder from bean store.</span>
<span class="source-line-no">2250</span><span id="line-2250">         beanStore</span>
<span class="source-line-no">2251</span><span id="line-2251">            .getBean(BeanContext.Builder.class)</span>
<span class="source-line-no">2252</span><span id="line-2252">            .map(BeanContext.Builder::copy)</span>
<span class="source-line-no">2253</span><span id="line-2253">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">2254</span><span id="line-2254"></span>
<span class="source-line-no">2255</span><span id="line-2255">         // Replace with bean from bean store.</span>
<span class="source-line-no">2256</span><span id="line-2256">         beanStore</span>
<span class="source-line-no">2257</span><span id="line-2257">            .getBean(BeanContext.class)</span>
<span class="source-line-no">2258</span><span id="line-2258">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2259</span><span id="line-2259"></span>
<span class="source-line-no">2260</span><span id="line-2260">         return v.get();</span>
<span class="source-line-no">2261</span><span id="line-2261">      }</span>
<span class="source-line-no">2262</span><span id="line-2262"></span>
<span class="source-line-no">2263</span><span id="line-2263">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2264</span><span id="line-2264">      // partSerializer</span>
<span class="source-line-no">2265</span><span id="line-2265">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2266</span><span id="line-2266"></span>
<span class="source-line-no">2267</span><span id="line-2267">      /**</span>
<span class="source-line-no">2268</span><span id="line-2268">       * Returns the part serializer sub-builder.</span>
<span class="source-line-no">2269</span><span id="line-2269">       *</span>
<span class="source-line-no">2270</span><span id="line-2270">       * &lt;p&gt;</span>
<span class="source-line-no">2271</span><span id="line-2271">       * The part serializer is used for serializing HTTP parts such as response headers.</span>
<span class="source-line-no">2272</span><span id="line-2272">       *</span>
<span class="source-line-no">2273</span><span id="line-2273">       * &lt;p&gt;</span>
<span class="source-line-no">2274</span><span id="line-2274">       * The default part serializer is an {@link OpenApiSerializer}.</span>
<span class="source-line-no">2275</span><span id="line-2275">       * It can overridden via any of the following:</span>
<span class="source-line-no">2276</span><span id="line-2276">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2277</span><span id="line-2277">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">2278</span><span id="line-2278">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">2279</span><span id="line-2279">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2280</span><span id="line-2280">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] HttpPartSerializer myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">2281</span><span id="line-2281">       *       &lt;/p&gt;</span>
<span class="source-line-no">2282</span><span id="line-2282">       *       Args can be any injected bean including HttpPartSerializer.Builder, the default builder.</span>
<span class="source-line-no">2283</span><span id="line-2283">       * &lt;/ul&gt;</span>
<span class="source-line-no">2284</span><span id="line-2284">       *</span>
<span class="source-line-no">2285</span><span id="line-2285">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2286</span><span id="line-2286">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2287</span><span id="line-2287">       * &lt;/ul&gt;</span>
<span class="source-line-no">2288</span><span id="line-2288">       *</span>
<span class="source-line-no">2289</span><span id="line-2289">       * @return The part serializer sub-builder.</span>
<span class="source-line-no">2290</span><span id="line-2290">       */</span>
<span class="source-line-no">2291</span><span id="line-2291">      public HttpPartSerializer.Creator partSerializer() {</span>
<span class="source-line-no">2292</span><span id="line-2292">         if (partSerializer == null)</span>
<span class="source-line-no">2293</span><span id="line-2293">            partSerializer = createPartSerializer(beanStore(), resource());</span>
<span class="source-line-no">2294</span><span id="line-2294">         return partSerializer;</span>
<span class="source-line-no">2295</span><span id="line-2295">      }</span>
<span class="source-line-no">2296</span><span id="line-2296"></span>
<span class="source-line-no">2297</span><span id="line-2297">      /**</span>
<span class="source-line-no">2298</span><span id="line-2298">       * Specifies the part serializer to use for serializing HTTP parts for this class.</span>
<span class="source-line-no">2299</span><span id="line-2299">       *</span>
<span class="source-line-no">2300</span><span id="line-2300">       * &lt;p&gt;</span>
<span class="source-line-no">2301</span><span id="line-2301">       * Equivalent to calling:</span>
<span class="source-line-no">2302</span><span id="line-2302">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2303</span><span id="line-2303">       *    &lt;jv&gt;builder&lt;/jv&gt;.partSerializer().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2304</span><span id="line-2304">       * &lt;/p&gt;</span>
<span class="source-line-no">2305</span><span id="line-2305">       *</span>
<span class="source-line-no">2306</span><span id="line-2306">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2307</span><span id="line-2307">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2308</span><span id="line-2308">       *    &lt;li class='jm'&gt;{@link #partSerializer()}</span>
<span class="source-line-no">2309</span><span id="line-2309">       * &lt;/ul&gt;</span>
<span class="source-line-no">2310</span><span id="line-2310">       *</span>
<span class="source-line-no">2311</span><span id="line-2311">       * @param value The new value.</span>
<span class="source-line-no">2312</span><span id="line-2312">       * @return This object.</span>
<span class="source-line-no">2313</span><span id="line-2313">       */</span>
<span class="source-line-no">2314</span><span id="line-2314">      public Builder partSerializer(Class&lt;? extends HttpPartSerializer&gt; value) {</span>
<span class="source-line-no">2315</span><span id="line-2315">         partSerializer().type(value);</span>
<span class="source-line-no">2316</span><span id="line-2316">         return this;</span>
<span class="source-line-no">2317</span><span id="line-2317">      }</span>
<span class="source-line-no">2318</span><span id="line-2318"></span>
<span class="source-line-no">2319</span><span id="line-2319">      /**</span>
<span class="source-line-no">2320</span><span id="line-2320">       * Specifies the part serializer to use for serializing HTTP parts for this class.</span>
<span class="source-line-no">2321</span><span id="line-2321">       *</span>
<span class="source-line-no">2322</span><span id="line-2322">       * &lt;p&gt;</span>
<span class="source-line-no">2323</span><span id="line-2323">       * Equivalent to calling:</span>
<span class="source-line-no">2324</span><span id="line-2324">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2325</span><span id="line-2325">       *    &lt;jv&gt;builder&lt;/jv&gt;.partSerializer().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2326</span><span id="line-2326">       * &lt;/p&gt;</span>
<span class="source-line-no">2327</span><span id="line-2327">       *</span>
<span class="source-line-no">2328</span><span id="line-2328">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2329</span><span id="line-2329">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2330</span><span id="line-2330">       *    &lt;li class='jm'&gt;{@link #partSerializer()}</span>
<span class="source-line-no">2331</span><span id="line-2331">       * &lt;/ul&gt;</span>
<span class="source-line-no">2332</span><span id="line-2332">       *</span>
<span class="source-line-no">2333</span><span id="line-2333">       * @param value The new value.</span>
<span class="source-line-no">2334</span><span id="line-2334">       * @return This object.</span>
<span class="source-line-no">2335</span><span id="line-2335">       */</span>
<span class="source-line-no">2336</span><span id="line-2336">      public Builder partSerializer(HttpPartSerializer value) {</span>
<span class="source-line-no">2337</span><span id="line-2337">         partSerializer().impl(value);</span>
<span class="source-line-no">2338</span><span id="line-2338">         return this;</span>
<span class="source-line-no">2339</span><span id="line-2339">      }</span>
<span class="source-line-no">2340</span><span id="line-2340"></span>
<span class="source-line-no">2341</span><span id="line-2341">      /**</span>
<span class="source-line-no">2342</span><span id="line-2342">       * Instantiates the part serializer sub-builder.</span>
<span class="source-line-no">2343</span><span id="line-2343">       *</span>
<span class="source-line-no">2344</span><span id="line-2344">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2345</span><span id="line-2345">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2346</span><span id="line-2346">       * &lt;/ul&gt;</span>
<span class="source-line-no">2347</span><span id="line-2347">       *</span>
<span class="source-line-no">2348</span><span id="line-2348">       * @param beanStore</span>
<span class="source-line-no">2349</span><span id="line-2349">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2350</span><span id="line-2350">       * @param resource</span>
<span class="source-line-no">2351</span><span id="line-2351">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2352</span><span id="line-2352">       * @return A new part serializer sub-builder.</span>
<span class="source-line-no">2353</span><span id="line-2353">       */</span>
<span class="source-line-no">2354</span><span id="line-2354">      protected HttpPartSerializer.Creator createPartSerializer(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2355</span><span id="line-2355"></span>
<span class="source-line-no">2356</span><span id="line-2356">         // Default value.</span>
<span class="source-line-no">2357</span><span id="line-2357">         Value&lt;HttpPartSerializer.Creator&gt; v = Value.of(</span>
<span class="source-line-no">2358</span><span id="line-2358">            HttpPartSerializer</span>
<span class="source-line-no">2359</span><span id="line-2359">               .creator()</span>
<span class="source-line-no">2360</span><span id="line-2360">               .type(OpenApiSerializer.class)</span>
<span class="source-line-no">2361</span><span id="line-2361">         );</span>
<span class="source-line-no">2362</span><span id="line-2362"></span>
<span class="source-line-no">2363</span><span id="line-2363">         // Replace with builder from bean store.</span>
<span class="source-line-no">2364</span><span id="line-2364">         beanStore</span>
<span class="source-line-no">2365</span><span id="line-2365">            .getBean(HttpPartSerializer.Creator.class)</span>
<span class="source-line-no">2366</span><span id="line-2366">            .map(Creator::copy)</span>
<span class="source-line-no">2367</span><span id="line-2367">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">2368</span><span id="line-2368"></span>
<span class="source-line-no">2369</span><span id="line-2369">         // Replace with bean from bean store.</span>
<span class="source-line-no">2370</span><span id="line-2370">         beanStore</span>
<span class="source-line-no">2371</span><span id="line-2371">            .getBean(HttpPartSerializer.class)</span>
<span class="source-line-no">2372</span><span id="line-2372">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2373</span><span id="line-2373"></span>
<span class="source-line-no">2374</span><span id="line-2374">         // Replace with this bean.</span>
<span class="source-line-no">2375</span><span id="line-2375">         resourceAs(HttpPartSerializer.class)</span>
<span class="source-line-no">2376</span><span id="line-2376">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2377</span><span id="line-2377"></span>
<span class="source-line-no">2378</span><span id="line-2378">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">2379</span><span id="line-2379">         defaultClasses()</span>
<span class="source-line-no">2380</span><span id="line-2380">            .get(HttpPartSerializer.class)</span>
<span class="source-line-no">2381</span><span id="line-2381">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">2382</span><span id="line-2382"></span>
<span class="source-line-no">2383</span><span id="line-2383">         // Replace with bean from:  @RestInject public [static] HttpPartSerializer xxx(&lt;args&gt;)</span>
<span class="source-line-no">2384</span><span id="line-2384">         beanStore</span>
<span class="source-line-no">2385</span><span id="line-2385">            .createMethodFinder(HttpPartSerializer.class)</span>
<span class="source-line-no">2386</span><span id="line-2386">            .addBean(HttpPartSerializer.Creator.class, v.get())</span>
<span class="source-line-no">2387</span><span id="line-2387">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2388</span><span id="line-2388">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2389</span><span id="line-2389"></span>
<span class="source-line-no">2390</span><span id="line-2390">         return v.get();</span>
<span class="source-line-no">2391</span><span id="line-2391">      }</span>
<span class="source-line-no">2392</span><span id="line-2392"></span>
<span class="source-line-no">2393</span><span id="line-2393">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2394</span><span id="line-2394">      // partParser</span>
<span class="source-line-no">2395</span><span id="line-2395">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2396</span><span id="line-2396"></span>
<span class="source-line-no">2397</span><span id="line-2397">      /**</span>
<span class="source-line-no">2398</span><span id="line-2398">       * Returns the part parser sub-builder.</span>
<span class="source-line-no">2399</span><span id="line-2399">       *</span>
<span class="source-line-no">2400</span><span id="line-2400">       * &lt;p&gt;</span>
<span class="source-line-no">2401</span><span id="line-2401">       * The part parser is used for parsing HTTP parts such as request headers and query/form/path parameters.</span>
<span class="source-line-no">2402</span><span id="line-2402">       *</span>
<span class="source-line-no">2403</span><span id="line-2403">       * &lt;p&gt;</span>
<span class="source-line-no">2404</span><span id="line-2404">       * The default part parser is an {@link OpenApiParser}.</span>
<span class="source-line-no">2405</span><span id="line-2405">       * It can overridden via any of the following:</span>
<span class="source-line-no">2406</span><span id="line-2406">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2407</span><span id="line-2407">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">2408</span><span id="line-2408">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">2409</span><span id="line-2409">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2410</span><span id="line-2410">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] HttpPartParser myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">2411</span><span id="line-2411">       *       &lt;/p&gt;</span>
<span class="source-line-no">2412</span><span id="line-2412">       *       Args can be any injected bean including HttpPartParser.Builder, the default builder.</span>
<span class="source-line-no">2413</span><span id="line-2413">       * &lt;/ul&gt;</span>
<span class="source-line-no">2414</span><span id="line-2414">       *</span>
<span class="source-line-no">2415</span><span id="line-2415">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2416</span><span id="line-2416">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2417</span><span id="line-2417">       * &lt;/ul&gt;</span>
<span class="source-line-no">2418</span><span id="line-2418">       *</span>
<span class="source-line-no">2419</span><span id="line-2419">       * @return The part parser sub-builder.</span>
<span class="source-line-no">2420</span><span id="line-2420">       */</span>
<span class="source-line-no">2421</span><span id="line-2421">      public HttpPartParser.Creator partParser() {</span>
<span class="source-line-no">2422</span><span id="line-2422">         if (partParser == null)</span>
<span class="source-line-no">2423</span><span id="line-2423">            partParser = createPartParser(beanStore(), resource());</span>
<span class="source-line-no">2424</span><span id="line-2424">         return partParser;</span>
<span class="source-line-no">2425</span><span id="line-2425">      }</span>
<span class="source-line-no">2426</span><span id="line-2426"></span>
<span class="source-line-no">2427</span><span id="line-2427">      /**</span>
<span class="source-line-no">2428</span><span id="line-2428">       * Specifies the part parser to use for parsing HTTP parts for this class.</span>
<span class="source-line-no">2429</span><span id="line-2429">       *</span>
<span class="source-line-no">2430</span><span id="line-2430">       * &lt;p&gt;</span>
<span class="source-line-no">2431</span><span id="line-2431">       * Equivalent to calling:</span>
<span class="source-line-no">2432</span><span id="line-2432">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2433</span><span id="line-2433">       *    &lt;jv&gt;builder&lt;/jv&gt;.partParser().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2434</span><span id="line-2434">       * &lt;/p&gt;</span>
<span class="source-line-no">2435</span><span id="line-2435">       *</span>
<span class="source-line-no">2436</span><span id="line-2436">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2437</span><span id="line-2437">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2438</span><span id="line-2438">       *    &lt;li class='jm'&gt;{@link #partParser()}</span>
<span class="source-line-no">2439</span><span id="line-2439">       * &lt;/ul&gt;</span>
<span class="source-line-no">2440</span><span id="line-2440">       *</span>
<span class="source-line-no">2441</span><span id="line-2441">       * @param value The new value.</span>
<span class="source-line-no">2442</span><span id="line-2442">       * @return This object.</span>
<span class="source-line-no">2443</span><span id="line-2443">       */</span>
<span class="source-line-no">2444</span><span id="line-2444">      public Builder partParser(Class&lt;? extends HttpPartParser&gt; value) {</span>
<span class="source-line-no">2445</span><span id="line-2445">         partParser().type(value);</span>
<span class="source-line-no">2446</span><span id="line-2446">         return this;</span>
<span class="source-line-no">2447</span><span id="line-2447">      }</span>
<span class="source-line-no">2448</span><span id="line-2448"></span>
<span class="source-line-no">2449</span><span id="line-2449">      /**</span>
<span class="source-line-no">2450</span><span id="line-2450">       * Specifies the part parser to use for parsing HTTP parts for this class.</span>
<span class="source-line-no">2451</span><span id="line-2451">       *</span>
<span class="source-line-no">2452</span><span id="line-2452">       * &lt;p&gt;</span>
<span class="source-line-no">2453</span><span id="line-2453">       * Equivalent to calling:</span>
<span class="source-line-no">2454</span><span id="line-2454">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2455</span><span id="line-2455">       *    &lt;jv&gt;builder&lt;/jv&gt;.partParser().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2456</span><span id="line-2456">       * &lt;/p&gt;</span>
<span class="source-line-no">2457</span><span id="line-2457">       *</span>
<span class="source-line-no">2458</span><span id="line-2458">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2459</span><span id="line-2459">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2460</span><span id="line-2460">       *    &lt;li class='jm'&gt;{@link #partParser()}</span>
<span class="source-line-no">2461</span><span id="line-2461">       * &lt;/ul&gt;</span>
<span class="source-line-no">2462</span><span id="line-2462">       *</span>
<span class="source-line-no">2463</span><span id="line-2463">       * @param value The new value.</span>
<span class="source-line-no">2464</span><span id="line-2464">       * @return This object.</span>
<span class="source-line-no">2465</span><span id="line-2465">       */</span>
<span class="source-line-no">2466</span><span id="line-2466">      public Builder partParser(HttpPartParser value) {</span>
<span class="source-line-no">2467</span><span id="line-2467">         partParser().impl(value);</span>
<span class="source-line-no">2468</span><span id="line-2468">         return this;</span>
<span class="source-line-no">2469</span><span id="line-2469">      }</span>
<span class="source-line-no">2470</span><span id="line-2470"></span>
<span class="source-line-no">2471</span><span id="line-2471">      /**</span>
<span class="source-line-no">2472</span><span id="line-2472">       * Instantiates the part parser sub-builder.</span>
<span class="source-line-no">2473</span><span id="line-2473">       *</span>
<span class="source-line-no">2474</span><span id="line-2474">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2475</span><span id="line-2475">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/HttpParts"&gt;HTTP Parts&lt;/a&gt;</span>
<span class="source-line-no">2476</span><span id="line-2476">       * &lt;/ul&gt;</span>
<span class="source-line-no">2477</span><span id="line-2477">       *</span>
<span class="source-line-no">2478</span><span id="line-2478">       * @param beanStore</span>
<span class="source-line-no">2479</span><span id="line-2479">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2480</span><span id="line-2480">       * @param resource</span>
<span class="source-line-no">2481</span><span id="line-2481">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2482</span><span id="line-2482">       * @return A new part parser sub-builder.</span>
<span class="source-line-no">2483</span><span id="line-2483">       */</span>
<span class="source-line-no">2484</span><span id="line-2484">      protected HttpPartParser.Creator createPartParser(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2485</span><span id="line-2485"></span>
<span class="source-line-no">2486</span><span id="line-2486">         // Default value.</span>
<span class="source-line-no">2487</span><span id="line-2487">         Value&lt;HttpPartParser.Creator&gt; v = Value.of(</span>
<span class="source-line-no">2488</span><span id="line-2488">            HttpPartParser</span>
<span class="source-line-no">2489</span><span id="line-2489">               .creator()</span>
<span class="source-line-no">2490</span><span id="line-2490">               .type(OpenApiParser.class)</span>
<span class="source-line-no">2491</span><span id="line-2491">         );</span>
<span class="source-line-no">2492</span><span id="line-2492"></span>
<span class="source-line-no">2493</span><span id="line-2493">         // Replace with builder from bean store.</span>
<span class="source-line-no">2494</span><span id="line-2494">         beanStore</span>
<span class="source-line-no">2495</span><span id="line-2495">            .getBean(HttpPartParser.Creator.class)</span>
<span class="source-line-no">2496</span><span id="line-2496">            .map(HttpPartParser.Creator::copy)</span>
<span class="source-line-no">2497</span><span id="line-2497">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">2498</span><span id="line-2498"></span>
<span class="source-line-no">2499</span><span id="line-2499">         // Replace with bean from bean store.</span>
<span class="source-line-no">2500</span><span id="line-2500">         beanStore</span>
<span class="source-line-no">2501</span><span id="line-2501">            .getBean(HttpPartParser.class)</span>
<span class="source-line-no">2502</span><span id="line-2502">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2503</span><span id="line-2503"></span>
<span class="source-line-no">2504</span><span id="line-2504">         // Replace with this bean.</span>
<span class="source-line-no">2505</span><span id="line-2505">         resourceAs(HttpPartParser.class)</span>
<span class="source-line-no">2506</span><span id="line-2506">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2507</span><span id="line-2507"></span>
<span class="source-line-no">2508</span><span id="line-2508">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">2509</span><span id="line-2509">         defaultClasses()</span>
<span class="source-line-no">2510</span><span id="line-2510">            .get(HttpPartParser.class)</span>
<span class="source-line-no">2511</span><span id="line-2511">            .ifPresent(x -&gt; v.get().type(x));</span>
<span class="source-line-no">2512</span><span id="line-2512"></span>
<span class="source-line-no">2513</span><span id="line-2513">         // Replace with bean from:  @RestInject public [static] HttpPartParser xxx(&lt;args&gt;)</span>
<span class="source-line-no">2514</span><span id="line-2514">         beanStore</span>
<span class="source-line-no">2515</span><span id="line-2515">            .createMethodFinder(HttpPartParser.class)</span>
<span class="source-line-no">2516</span><span id="line-2516">            .addBean(HttpPartParser.Creator.class, v.get())</span>
<span class="source-line-no">2517</span><span id="line-2517">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2518</span><span id="line-2518">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2519</span><span id="line-2519"></span>
<span class="source-line-no">2520</span><span id="line-2520">         return v.get();</span>
<span class="source-line-no">2521</span><span id="line-2521">      }</span>
<span class="source-line-no">2522</span><span id="line-2522"></span>
<span class="source-line-no">2523</span><span id="line-2523">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2524</span><span id="line-2524">      // jsonSchemaGenerator</span>
<span class="source-line-no">2525</span><span id="line-2525">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2526</span><span id="line-2526"></span>
<span class="source-line-no">2527</span><span id="line-2527">      /**</span>
<span class="source-line-no">2528</span><span id="line-2528">       * Returns the JSON schema generator sub-builder.</span>
<span class="source-line-no">2529</span><span id="line-2529">       *</span>
<span class="source-line-no">2530</span><span id="line-2530">       * &lt;p&gt;</span>
<span class="source-line-no">2531</span><span id="line-2531">       * The JSON schema generator is used for generating JSON schema in the auto-generated Swagger documentation.</span>
<span class="source-line-no">2532</span><span id="line-2532">       *</span>
<span class="source-line-no">2533</span><span id="line-2533">       * &lt;p&gt;</span>
<span class="source-line-no">2534</span><span id="line-2534">       * The default JSON schema generator is a default {@link JsonSchemaGenerator}.</span>
<span class="source-line-no">2535</span><span id="line-2535">       * It can overridden via any of the following:</span>
<span class="source-line-no">2536</span><span id="line-2536">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2537</span><span id="line-2537">       *    &lt;li&gt;Injected via bean store.</span>
<span class="source-line-no">2538</span><span id="line-2538">       *    &lt;li&gt;{@link RestInject @RestInject}-annotated method:</span>
<span class="source-line-no">2539</span><span id="line-2539">       *       &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2540</span><span id="line-2540">       *    &lt;ja&gt;@RestInject&lt;/ja&gt; &lt;jk&gt;public&lt;/jk&gt; [&lt;jk&gt;static&lt;/jk&gt;] JsonSchemaGenerator myMethod(&lt;i&gt;&amp;lt;args&amp;gt;&lt;/i&gt;) {...}</span>
<span class="source-line-no">2541</span><span id="line-2541">       *       &lt;/p&gt;</span>
<span class="source-line-no">2542</span><span id="line-2542">       *       Args can be any injected bean including JsonSchemaGenerator.Builder, the default builder.</span>
<span class="source-line-no">2543</span><span id="line-2543">       * &lt;/ul&gt;</span>
<span class="source-line-no">2544</span><span id="line-2544">       *</span>
<span class="source-line-no">2545</span><span id="line-2545">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2546</span><span id="line-2546">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/JuneauBeanSwagger2"&gt;juneau-bean-swagger-v2&lt;/a&gt;</span>
<span class="source-line-no">2547</span><span id="line-2547">       * &lt;/ul&gt;</span>
<span class="source-line-no">2548</span><span id="line-2548">       *</span>
<span class="source-line-no">2549</span><span id="line-2549">       * @return The JSON schema generator sub-builder.</span>
<span class="source-line-no">2550</span><span id="line-2550">       */</span>
<span class="source-line-no">2551</span><span id="line-2551">      public JsonSchemaGenerator.Builder jsonSchemaGenerator() {</span>
<span class="source-line-no">2552</span><span id="line-2552">         if (jsonSchemaGenerator == null)</span>
<span class="source-line-no">2553</span><span id="line-2553">            jsonSchemaGenerator = createJsonSchemaGenerator(beanStore(), resource());</span>
<span class="source-line-no">2554</span><span id="line-2554">         return jsonSchemaGenerator;</span>
<span class="source-line-no">2555</span><span id="line-2555">      }</span>
<span class="source-line-no">2556</span><span id="line-2556"></span>
<span class="source-line-no">2557</span><span id="line-2557">      /**</span>
<span class="source-line-no">2558</span><span id="line-2558">       * Specifies the JSON schema generator for this class.</span>
<span class="source-line-no">2559</span><span id="line-2559">       *</span>
<span class="source-line-no">2560</span><span id="line-2560">       * &lt;p&gt;</span>
<span class="source-line-no">2561</span><span id="line-2561">       * Equivalent to calling:</span>
<span class="source-line-no">2562</span><span id="line-2562">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2563</span><span id="line-2563">       *    &lt;jv&gt;builder&lt;/jv&gt;.jsonSchemaGenerator().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2564</span><span id="line-2564">       * &lt;/p&gt;</span>
<span class="source-line-no">2565</span><span id="line-2565">       *</span>
<span class="source-line-no">2566</span><span id="line-2566">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2567</span><span id="line-2567">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/JuneauBeanSwagger2"&gt;juneau-bean-swagger-v2&lt;/a&gt;</span>
<span class="source-line-no">2568</span><span id="line-2568">       *    &lt;li class='jm'&gt;{@link #jsonSchemaGenerator()}</span>
<span class="source-line-no">2569</span><span id="line-2569">       * &lt;/ul&gt;</span>
<span class="source-line-no">2570</span><span id="line-2570">       *</span>
<span class="source-line-no">2571</span><span id="line-2571">       * @param value The new value.</span>
<span class="source-line-no">2572</span><span id="line-2572">       * @return This object.</span>
<span class="source-line-no">2573</span><span id="line-2573">       */</span>
<span class="source-line-no">2574</span><span id="line-2574">      public Builder jsonSchemaGenerator(Class&lt;? extends JsonSchemaGenerator&gt; value) {</span>
<span class="source-line-no">2575</span><span id="line-2575">         jsonSchemaGenerator().type(value);</span>
<span class="source-line-no">2576</span><span id="line-2576">         return this;</span>
<span class="source-line-no">2577</span><span id="line-2577">      }</span>
<span class="source-line-no">2578</span><span id="line-2578"></span>
<span class="source-line-no">2579</span><span id="line-2579">      /**</span>
<span class="source-line-no">2580</span><span id="line-2580">       * Specifies the JSON schema generator for this class.</span>
<span class="source-line-no">2581</span><span id="line-2581">       *</span>
<span class="source-line-no">2582</span><span id="line-2582">       * &lt;p&gt;</span>
<span class="source-line-no">2583</span><span id="line-2583">       * Equivalent to calling:</span>
<span class="source-line-no">2584</span><span id="line-2584">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2585</span><span id="line-2585">       *    &lt;jv&gt;builder&lt;/jv&gt;.jsonSchemaGenerator().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2586</span><span id="line-2586">       *    &lt;li class='jm'&gt;{@link #jsonSchemaGenerator()}</span>
<span class="source-line-no">2587</span><span id="line-2587">       * &lt;/p&gt;</span>
<span class="source-line-no">2588</span><span id="line-2588">       *</span>
<span class="source-line-no">2589</span><span id="line-2589">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2590</span><span id="line-2590">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/JuneauBeanSwagger2"&gt;juneau-bean-swagger-v2&lt;/a&gt;</span>
<span class="source-line-no">2591</span><span id="line-2591">       * &lt;/ul&gt;</span>
<span class="source-line-no">2592</span><span id="line-2592">       *</span>
<span class="source-line-no">2593</span><span id="line-2593">       * @param value The new value.</span>
<span class="source-line-no">2594</span><span id="line-2594">       * @return This object.</span>
<span class="source-line-no">2595</span><span id="line-2595">       */</span>
<span class="source-line-no">2596</span><span id="line-2596">      public Builder jsonSchemaGenerator(JsonSchemaGenerator value) {</span>
<span class="source-line-no">2597</span><span id="line-2597">         jsonSchemaGenerator().impl(value);</span>
<span class="source-line-no">2598</span><span id="line-2598">         return this;</span>
<span class="source-line-no">2599</span><span id="line-2599">      }</span>
<span class="source-line-no">2600</span><span id="line-2600"></span>
<span class="source-line-no">2601</span><span id="line-2601">      /**</span>
<span class="source-line-no">2602</span><span id="line-2602">       * Instantiates the JSON schema generator sub-builder.</span>
<span class="source-line-no">2603</span><span id="line-2603">       *</span>
<span class="source-line-no">2604</span><span id="line-2604">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2605</span><span id="line-2605">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/JuneauBeanSwagger2"&gt;juneau-bean-swagger-v2&lt;/a&gt;</span>
<span class="source-line-no">2606</span><span id="line-2606">       * &lt;/ul&gt;</span>
<span class="source-line-no">2607</span><span id="line-2607">       *</span>
<span class="source-line-no">2608</span><span id="line-2608">       * @param beanStore</span>
<span class="source-line-no">2609</span><span id="line-2609">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2610</span><span id="line-2610">       * @param resource</span>
<span class="source-line-no">2611</span><span id="line-2611">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2612</span><span id="line-2612">       * @return A new JSON schema generator sub-builder.</span>
<span class="source-line-no">2613</span><span id="line-2613">       */</span>
<span class="source-line-no">2614</span><span id="line-2614">      protected JsonSchemaGenerator.Builder createJsonSchemaGenerator(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2615</span><span id="line-2615"></span>
<span class="source-line-no">2616</span><span id="line-2616">         // Default value.</span>
<span class="source-line-no">2617</span><span id="line-2617">         Value&lt;JsonSchemaGenerator.Builder&gt; v = Value.of(</span>
<span class="source-line-no">2618</span><span id="line-2618">            JsonSchemaGenerator.create()</span>
<span class="source-line-no">2619</span><span id="line-2619">         );</span>
<span class="source-line-no">2620</span><span id="line-2620"></span>
<span class="source-line-no">2621</span><span id="line-2621">         // Replace with builder from bean store.</span>
<span class="source-line-no">2622</span><span id="line-2622">         beanStore</span>
<span class="source-line-no">2623</span><span id="line-2623">            .getBean(JsonSchemaGenerator.Builder.class)</span>
<span class="source-line-no">2624</span><span id="line-2624">            .map(JsonSchemaGenerator.Builder::copy)</span>
<span class="source-line-no">2625</span><span id="line-2625">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">2626</span><span id="line-2626"></span>
<span class="source-line-no">2627</span><span id="line-2627">         // Replace with bean from bean store.</span>
<span class="source-line-no">2628</span><span id="line-2628">         beanStore</span>
<span class="source-line-no">2629</span><span id="line-2629">            .getBean(JsonSchemaGenerator.class)</span>
<span class="source-line-no">2630</span><span id="line-2630">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2631</span><span id="line-2631"></span>
<span class="source-line-no">2632</span><span id="line-2632">         // Replace with bean from:  @RestInject public [static] JsonSchemaGenerator xxx(&lt;args&gt;)</span>
<span class="source-line-no">2633</span><span id="line-2633">         beanStore</span>
<span class="source-line-no">2634</span><span id="line-2634">            .createMethodFinder(JsonSchemaGenerator.class)</span>
<span class="source-line-no">2635</span><span id="line-2635">            .addBean(JsonSchemaGenerator.Builder.class, v.get())</span>
<span class="source-line-no">2636</span><span id="line-2636">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2637</span><span id="line-2637">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">2638</span><span id="line-2638"></span>
<span class="source-line-no">2639</span><span id="line-2639">         return v.get();</span>
<span class="source-line-no">2640</span><span id="line-2640">      }</span>
<span class="source-line-no">2641</span><span id="line-2641"></span>
<span class="source-line-no">2642</span><span id="line-2642">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2643</span><span id="line-2643">      // staticFiles</span>
<span class="source-line-no">2644</span><span id="line-2644">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2645</span><span id="line-2645"></span>
<span class="source-line-no">2646</span><span id="line-2646">      /**</span>
<span class="source-line-no">2647</span><span id="line-2647">       * Returns the static files bean creator.</span>
<span class="source-line-no">2648</span><span id="line-2648">       *</span>
<span class="source-line-no">2649</span><span id="line-2649">       * &lt;p&gt;</span>
<span class="source-line-no">2650</span><span id="line-2650">       * Used to retrieve localized files to be served up as static files through the REST API via the following</span>
<span class="source-line-no">2651</span><span id="line-2651">       * predefined methods:</span>
<span class="source-line-no">2652</span><span id="line-2652">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">2653</span><span id="line-2653">       *    &lt;li class='jm'&gt;{@link BasicRestObject#getHtdoc(String, Locale)}.</span>
<span class="source-line-no">2654</span><span id="line-2654">       *    &lt;li class='jm'&gt;{@link BasicRestServlet#getHtdoc(String, Locale)}.</span>
<span class="source-line-no">2655</span><span id="line-2655">       * &lt;/ul&gt;</span>
<span class="source-line-no">2656</span><span id="line-2656">       *</span>
<span class="source-line-no">2657</span><span id="line-2657">       * &lt;p&gt;</span>
<span class="source-line-no">2658</span><span id="line-2658">       * The static file finder can be accessed through the following methods:</span>
<span class="source-line-no">2659</span><span id="line-2659">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">2660</span><span id="line-2660">       *    &lt;li class='jm'&gt;{@link RestContext#getStaticFiles()}</span>
<span class="source-line-no">2661</span><span id="line-2661">       *    &lt;li class='jm'&gt;{@link RestRequest#getStaticFiles()}</span>
<span class="source-line-no">2662</span><span id="line-2662">       * &lt;/ul&gt;</span>
<span class="source-line-no">2663</span><span id="line-2663">       *</span>
<span class="source-line-no">2664</span><span id="line-2664">       * &lt;p&gt;</span>
<span class="source-line-no">2665</span><span id="line-2665">       * The default static files finder implementation class is {@link BasicStaticFiles}.  This can be overridden via the following:</span>
<span class="source-line-no">2666</span><span id="line-2666">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">2667</span><span id="line-2667">       *    &lt;li&gt;</span>
<span class="source-line-no">2668</span><span id="line-2668">       *       The {@link Rest#staticFiles() @Rest(staticFiles)} annotation.</span>
<span class="source-line-no">2669</span><span id="line-2669">       *    &lt;li&gt;</span>
<span class="source-line-no">2670</span><span id="line-2670">       *       Overridden {@link StaticFiles} implementation class name specified in {@link #defaultClasses()}.</span>
<span class="source-line-no">2671</span><span id="line-2671">       *    &lt;li&gt;</span>
<span class="source-line-no">2672</span><span id="line-2672">       *       Type specified via &lt;c&gt;{@link RestContext.Builder}.{@link #staticFiles() staticFiles()}.{@link org.apache.juneau.rest.staticfile.StaticFiles.Builder#type(Class) type(Class)}&lt;/c&gt;.</span>
<span class="source-line-no">2673</span><span id="line-2673">       *    &lt;li&gt;</span>
<span class="source-line-no">2674</span><span id="line-2674">       *       Bean specified via &lt;c&gt;{@link RestContext.Builder}.{@link #staticFiles() staticFiles()}.{@link org.apache.juneau.rest.staticfile.StaticFiles.Builder#impl(Object) impl(Object)}&lt;/c&gt;.</span>
<span class="source-line-no">2675</span><span id="line-2675">       * &lt;/ul&gt;</span>
<span class="source-line-no">2676</span><span id="line-2676">       *</span>
<span class="source-line-no">2677</span><span id="line-2677">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">2678</span><span id="line-2678">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2679</span><span id="line-2679">       *    &lt;jc&gt;// Create a static file finder that looks for files in the /files working subdirectory, but</span>
<span class="source-line-no">2680</span><span id="line-2680">       *    // overrides the find() and resolve methods for special handling of special cases and adds a</span>
<span class="source-line-no">2681</span><span id="line-2681">       * // Foo header to all requests.&lt;/jc&gt;</span>
<span class="source-line-no">2682</span><span id="line-2682">       *    &lt;jk&gt;public class&lt;/jk&gt; MyStaticFiles &lt;jk&gt;extends&lt;/jk&gt; BasicStaticFiles {</span>
<span class="source-line-no">2683</span><span id="line-2683">       *</span>
<span class="source-line-no">2684</span><span id="line-2684">       *       &lt;jk&gt;public&lt;/jk&gt; MyStaticFiles() {</span>
<span class="source-line-no">2685</span><span id="line-2685">       *          &lt;jk&gt;super&lt;/jk&gt;(</span>
<span class="source-line-no">2686</span><span id="line-2686">       *             StaticFiles</span>
<span class="source-line-no">2687</span><span id="line-2687">       *                .&lt;jsm&gt;create&lt;/jsm&gt;()</span>
<span class="source-line-no">2688</span><span id="line-2688">       *                .dir(&lt;js&gt;"/files"&lt;/js&gt;)</span>
<span class="source-line-no">2689</span><span id="line-2689">       *                .headers(BasicStringHeader.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"Foo"&lt;/js&gt;, &lt;js&gt;"bar"&lt;/js&gt;))</span>
<span class="source-line-no">2690</span><span id="line-2690">       *          );</span>
<span class="source-line-no">2691</span><span id="line-2691">       *       }</span>
<span class="source-line-no">2692</span><span id="line-2692">       *    }</span>
<span class="source-line-no">2693</span><span id="line-2693">       * &lt;/p&gt;</span>
<span class="source-line-no">2694</span><span id="line-2694">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2695</span><span id="line-2695">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(staticFiles=MyStaticFiles.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">2696</span><span id="line-2696">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {...}</span>
<span class="source-line-no">2697</span><span id="line-2697">       * &lt;/p&gt;</span>
<span class="source-line-no">2698</span><span id="line-2698">       *</span>
<span class="source-line-no">2699</span><span id="line-2699">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2700</span><span id="line-2700">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/StaticFiles"&gt;Static files&lt;/a&gt;</span>
<span class="source-line-no">2701</span><span id="line-2701">       * &lt;/ul&gt;</span>
<span class="source-line-no">2702</span><span id="line-2702">       *</span>
<span class="source-line-no">2703</span><span id="line-2703">       * @return The static files bean creator.</span>
<span class="source-line-no">2704</span><span id="line-2704">       */</span>
<span class="source-line-no">2705</span><span id="line-2705">      public BeanCreator&lt;StaticFiles&gt; staticFiles() {</span>
<span class="source-line-no">2706</span><span id="line-2706">         if (staticFiles == null)</span>
<span class="source-line-no">2707</span><span id="line-2707">            staticFiles = createStaticFiles(beanStore, resource);</span>
<span class="source-line-no">2708</span><span id="line-2708">         return staticFiles;</span>
<span class="source-line-no">2709</span><span id="line-2709">      }</span>
<span class="source-line-no">2710</span><span id="line-2710"></span>
<span class="source-line-no">2711</span><span id="line-2711">      /**</span>
<span class="source-line-no">2712</span><span id="line-2712">       * Specifies the static files resource finder for this class.</span>
<span class="source-line-no">2713</span><span id="line-2713">       *</span>
<span class="source-line-no">2714</span><span id="line-2714">       * &lt;p&gt;</span>
<span class="source-line-no">2715</span><span id="line-2715">       * Equivalent to calling:</span>
<span class="source-line-no">2716</span><span id="line-2716">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2717</span><span id="line-2717">       *    &lt;jv&gt;builder&lt;/jv&gt;.staticFiles().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2718</span><span id="line-2718">       * &lt;/p&gt;</span>
<span class="source-line-no">2719</span><span id="line-2719">       *</span>
<span class="source-line-no">2720</span><span id="line-2720">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2721</span><span id="line-2721">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/StaticFiles"&gt;Static files&lt;/a&gt;</span>
<span class="source-line-no">2722</span><span id="line-2722">       * &lt;/ul&gt;</span>
<span class="source-line-no">2723</span><span id="line-2723">       *</span>
<span class="source-line-no">2724</span><span id="line-2724">       * @param value The new value.</span>
<span class="source-line-no">2725</span><span id="line-2725">       * @return This object.</span>
<span class="source-line-no">2726</span><span id="line-2726">       */</span>
<span class="source-line-no">2727</span><span id="line-2727">      public Builder staticFiles(Class&lt;? extends StaticFiles&gt; value) {</span>
<span class="source-line-no">2728</span><span id="line-2728">         staticFiles().type(value);</span>
<span class="source-line-no">2729</span><span id="line-2729">         return this;</span>
<span class="source-line-no">2730</span><span id="line-2730">      }</span>
<span class="source-line-no">2731</span><span id="line-2731"></span>
<span class="source-line-no">2732</span><span id="line-2732">      /**</span>
<span class="source-line-no">2733</span><span id="line-2733">       * Specifies the static files resource finder for this class.</span>
<span class="source-line-no">2734</span><span id="line-2734">       *</span>
<span class="source-line-no">2735</span><span id="line-2735">       * &lt;p&gt;</span>
<span class="source-line-no">2736</span><span id="line-2736">       * Equivalent to calling:</span>
<span class="source-line-no">2737</span><span id="line-2737">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2738</span><span id="line-2738">       *    &lt;jv&gt;builder&lt;/jv&gt;.staticFiles().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">2739</span><span id="line-2739">       * &lt;/p&gt;</span>
<span class="source-line-no">2740</span><span id="line-2740">       *</span>
<span class="source-line-no">2741</span><span id="line-2741">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2742</span><span id="line-2742">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/StaticFiles"&gt;Static files&lt;/a&gt;</span>
<span class="source-line-no">2743</span><span id="line-2743">       * &lt;/ul&gt;</span>
<span class="source-line-no">2744</span><span id="line-2744">       *</span>
<span class="source-line-no">2745</span><span id="line-2745">       * @param value The new value.</span>
<span class="source-line-no">2746</span><span id="line-2746">       * @return This object.</span>
<span class="source-line-no">2747</span><span id="line-2747">       */</span>
<span class="source-line-no">2748</span><span id="line-2748">      public Builder staticFiles(StaticFiles value) {</span>
<span class="source-line-no">2749</span><span id="line-2749">         staticFiles().impl(value);</span>
<span class="source-line-no">2750</span><span id="line-2750">         return this;</span>
<span class="source-line-no">2751</span><span id="line-2751">      }</span>
<span class="source-line-no">2752</span><span id="line-2752"></span>
<span class="source-line-no">2753</span><span id="line-2753">      /**</span>
<span class="source-line-no">2754</span><span id="line-2754">       * Instantiates the static files bean creator.</span>
<span class="source-line-no">2755</span><span id="line-2755">       *</span>
<span class="source-line-no">2756</span><span id="line-2756">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2757</span><span id="line-2757">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/StaticFiles"&gt;Static files&lt;/a&gt;</span>
<span class="source-line-no">2758</span><span id="line-2758">       * &lt;/ul&gt;</span>
<span class="source-line-no">2759</span><span id="line-2759">       *</span>
<span class="source-line-no">2760</span><span id="line-2760">       * @param beanStore</span>
<span class="source-line-no">2761</span><span id="line-2761">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2762</span><span id="line-2762">       * @param resource</span>
<span class="source-line-no">2763</span><span id="line-2763">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2764</span><span id="line-2764">       * @return A new static files sub-builder.</span>
<span class="source-line-no">2765</span><span id="line-2765">       */</span>
<span class="source-line-no">2766</span><span id="line-2766">      protected BeanCreator&lt;StaticFiles&gt; createStaticFiles(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2767</span><span id="line-2767"></span>
<span class="source-line-no">2768</span><span id="line-2768">         BeanCreator&lt;StaticFiles&gt; creator = beanStore.createBean(StaticFiles.class).type(BasicStaticFiles.class);</span>
<span class="source-line-no">2769</span><span id="line-2769"></span>
<span class="source-line-no">2770</span><span id="line-2770">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">2771</span><span id="line-2771">         defaultClasses()</span>
<span class="source-line-no">2772</span><span id="line-2772">            .get(StaticFiles.class)</span>
<span class="source-line-no">2773</span><span id="line-2773">            .ifPresent(x -&gt; creator.type(x));</span>
<span class="source-line-no">2774</span><span id="line-2774"></span>
<span class="source-line-no">2775</span><span id="line-2775">         beanStore</span>
<span class="source-line-no">2776</span><span id="line-2776">            .getBean(StaticFiles.class)</span>
<span class="source-line-no">2777</span><span id="line-2777">            .ifPresent(x -&gt; creator.impl(x));</span>
<span class="source-line-no">2778</span><span id="line-2778"></span>
<span class="source-line-no">2779</span><span id="line-2779">         // Replace with bean from:  @RestInject public [static] StaticFiles xxx(&lt;args&gt;)</span>
<span class="source-line-no">2780</span><span id="line-2780">         beanStore</span>
<span class="source-line-no">2781</span><span id="line-2781">            .createMethodFinder(StaticFiles.class)</span>
<span class="source-line-no">2782</span><span id="line-2782">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">2783</span><span id="line-2783">            .run(x -&gt; creator.impl(x));</span>
<span class="source-line-no">2784</span><span id="line-2784"></span>
<span class="source-line-no">2785</span><span id="line-2785">         return creator;</span>
<span class="source-line-no">2786</span><span id="line-2786">      }</span>
<span class="source-line-no">2787</span><span id="line-2787"></span>
<span class="source-line-no">2788</span><span id="line-2788">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2789</span><span id="line-2789">      // defaultRequestHeaders</span>
<span class="source-line-no">2790</span><span id="line-2790">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2791</span><span id="line-2791"></span>
<span class="source-line-no">2792</span><span id="line-2792">      /**</span>
<span class="source-line-no">2793</span><span id="line-2793">       * Returns the default request headers.</span>
<span class="source-line-no">2794</span><span id="line-2794">       *</span>
<span class="source-line-no">2795</span><span id="line-2795">       * @return The default request headers.</span>
<span class="source-line-no">2796</span><span id="line-2796">       */</span>
<span class="source-line-no">2797</span><span id="line-2797">      public HeaderList defaultRequestHeaders() {</span>
<span class="source-line-no">2798</span><span id="line-2798">         if (defaultRequestHeaders == null)</span>
<span class="source-line-no">2799</span><span id="line-2799">            defaultRequestHeaders = createDefaultRequestHeaders(beanStore(), resource());</span>
<span class="source-line-no">2800</span><span id="line-2800">         return defaultRequestHeaders;</span>
<span class="source-line-no">2801</span><span id="line-2801">      }</span>
<span class="source-line-no">2802</span><span id="line-2802"></span>
<span class="source-line-no">2803</span><span id="line-2803">      /**</span>
<span class="source-line-no">2804</span><span id="line-2804">       * Default request headers.</span>
<span class="source-line-no">2805</span><span id="line-2805">       *</span>
<span class="source-line-no">2806</span><span id="line-2806">       * &lt;p&gt;</span>
<span class="source-line-no">2807</span><span id="line-2807">       * Specifies default values for request headers if they're not passed in through the request.</span>
<span class="source-line-no">2808</span><span id="line-2808">       *</span>
<span class="source-line-no">2809</span><span id="line-2809">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2810</span><span id="line-2810">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2811</span><span id="line-2811">       *       Affects values returned by {@link RestRequest#getHeader(String)} when the header is not present on the request.</span>
<span class="source-line-no">2812</span><span id="line-2812">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2813</span><span id="line-2813">       *       The most useful reason for this annotation is to provide a default &lt;c&gt;Accept&lt;/c&gt; header when one is not</span>
<span class="source-line-no">2814</span><span id="line-2814">       *       specified so that a particular default {@link Serializer} is picked.</span>
<span class="source-line-no">2815</span><span id="line-2815">       * &lt;/ul&gt;</span>
<span class="source-line-no">2816</span><span id="line-2816">       *</span>
<span class="source-line-no">2817</span><span id="line-2817">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">2818</span><span id="line-2818">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2819</span><span id="line-2819">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">2820</span><span id="line-2820">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(defaultRequestHeaders={&lt;js&gt;"Accept: application/json"&lt;/js&gt;, &lt;js&gt;"My-Header=$C{REST/myHeaderValue}"&lt;/js&gt;})</span>
<span class="source-line-no">2821</span><span id="line-2821">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">2822</span><span id="line-2822">       *</span>
<span class="source-line-no">2823</span><span id="line-2823">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">2824</span><span id="line-2824">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">2825</span><span id="line-2825">       *</span>
<span class="source-line-no">2826</span><span id="line-2826">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">2827</span><span id="line-2827">       *          &lt;jv&gt;builder&lt;/jv&gt;</span>
<span class="source-line-no">2828</span><span id="line-2828">       *             .defaultRequestHeaders(</span>
<span class="source-line-no">2829</span><span id="line-2829">       *                Accept.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"application/json"&lt;/js&gt;),</span>
<span class="source-line-no">2830</span><span id="line-2830">       *                BasicHeader.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"My-Header"&lt;/js&gt;, &lt;js&gt;"foo"&lt;/js&gt;)</span>
<span class="source-line-no">2831</span><span id="line-2831">       *             );</span>
<span class="source-line-no">2832</span><span id="line-2832">       *       }</span>
<span class="source-line-no">2833</span><span id="line-2833">       *</span>
<span class="source-line-no">2834</span><span id="line-2834">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">2835</span><span id="line-2835">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">2836</span><span id="line-2836">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">2837</span><span id="line-2837">       *          &lt;jv&gt;builder&lt;/jv&gt;.defaultRequestHeaders(Accept.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"application/json"&lt;/js&gt;));</span>
<span class="source-line-no">2838</span><span id="line-2838">       *       }</span>
<span class="source-line-no">2839</span><span id="line-2839">       *</span>
<span class="source-line-no">2840</span><span id="line-2840">       *       &lt;jc&gt;// Override at the method level.&lt;/jc&gt;</span>
<span class="source-line-no">2841</span><span id="line-2841">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;(defaultRequestHeaders={&lt;js&gt;"Accept: text/xml"&lt;/js&gt;})</span>
<span class="source-line-no">2842</span><span id="line-2842">       *       &lt;jk&gt;public&lt;/jk&gt; Object myMethod() {...}</span>
<span class="source-line-no">2843</span><span id="line-2843">       *    }</span>
<span class="source-line-no">2844</span><span id="line-2844">       * &lt;/p&gt;</span>
<span class="source-line-no">2845</span><span id="line-2845">       *</span>
<span class="source-line-no">2846</span><span id="line-2846">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2847</span><span id="line-2847">       *    &lt;li class='ja'&gt;{@link Rest#defaultRequestHeaders}</span>
<span class="source-line-no">2848</span><span id="line-2848">       *    &lt;li class='ja'&gt;{@link RestOp#defaultRequestHeaders}</span>
<span class="source-line-no">2849</span><span id="line-2849">       *    &lt;li class='ja'&gt;{@link RestGet#defaultRequestHeaders}</span>
<span class="source-line-no">2850</span><span id="line-2850">       *    &lt;li class='ja'&gt;{@link RestPut#defaultRequestHeaders}</span>
<span class="source-line-no">2851</span><span id="line-2851">       *    &lt;li class='ja'&gt;{@link RestPost#defaultRequestHeaders}</span>
<span class="source-line-no">2852</span><span id="line-2852">       *    &lt;li class='ja'&gt;{@link RestDelete#defaultRequestHeaders}</span>
<span class="source-line-no">2853</span><span id="line-2853">       * &lt;/ul&gt;</span>
<span class="source-line-no">2854</span><span id="line-2854">       *</span>
<span class="source-line-no">2855</span><span id="line-2855">       * @param values The headers to add.</span>
<span class="source-line-no">2856</span><span id="line-2856">       * @return This object.</span>
<span class="source-line-no">2857</span><span id="line-2857">       */</span>
<span class="source-line-no">2858</span><span id="line-2858">      @FluentSetter</span>
<span class="source-line-no">2859</span><span id="line-2859">      public Builder defaultRequestHeaders(Header...values) {</span>
<span class="source-line-no">2860</span><span id="line-2860">         defaultRequestHeaders().setDefault(values);</span>
<span class="source-line-no">2861</span><span id="line-2861">         return this;</span>
<span class="source-line-no">2862</span><span id="line-2862">      }</span>
<span class="source-line-no">2863</span><span id="line-2863"></span>
<span class="source-line-no">2864</span><span id="line-2864">      /**</span>
<span class="source-line-no">2865</span><span id="line-2865">       * Specifies a default &lt;c&gt;Accept&lt;/c&gt; header value if not specified on a request.</span>
<span class="source-line-no">2866</span><span id="line-2866">       *</span>
<span class="source-line-no">2867</span><span id="line-2867">       * @param value</span>
<span class="source-line-no">2868</span><span id="line-2868">       *    The default value of the &lt;c&gt;Accept&lt;/c&gt; header.</span>
<span class="source-line-no">2869</span><span id="line-2869">       *    &lt;br&gt;Ignored if &lt;jk&gt;null&lt;/jk&gt; or empty.</span>
<span class="source-line-no">2870</span><span id="line-2870">       * @return This object.</span>
<span class="source-line-no">2871</span><span id="line-2871">       */</span>
<span class="source-line-no">2872</span><span id="line-2872">      @FluentSetter</span>
<span class="source-line-no">2873</span><span id="line-2873">      public Builder defaultAccept(String value) {</span>
<span class="source-line-no">2874</span><span id="line-2874">         if (Utils.isNotEmpty(value))</span>
<span class="source-line-no">2875</span><span id="line-2875">            defaultRequestHeaders(accept(value));</span>
<span class="source-line-no">2876</span><span id="line-2876">         return this;</span>
<span class="source-line-no">2877</span><span id="line-2877">      }</span>
<span class="source-line-no">2878</span><span id="line-2878"></span>
<span class="source-line-no">2879</span><span id="line-2879">      /**</span>
<span class="source-line-no">2880</span><span id="line-2880">       * Specifies a default &lt;c&gt;Content-Type&lt;/c&gt; header value if not specified on a request.</span>
<span class="source-line-no">2881</span><span id="line-2881">       *</span>
<span class="source-line-no">2882</span><span id="line-2882">       * @param value</span>
<span class="source-line-no">2883</span><span id="line-2883">       *    The default value of the &lt;c&gt;Content-Type&lt;/c&gt; header.</span>
<span class="source-line-no">2884</span><span id="line-2884">       *    &lt;br&gt;Ignored if &lt;jk&gt;null&lt;/jk&gt; or empty.</span>
<span class="source-line-no">2885</span><span id="line-2885">       * @return This object.</span>
<span class="source-line-no">2886</span><span id="line-2886">       */</span>
<span class="source-line-no">2887</span><span id="line-2887">      @FluentSetter</span>
<span class="source-line-no">2888</span><span id="line-2888">      public Builder defaultContentType(String value) {</span>
<span class="source-line-no">2889</span><span id="line-2889">         if (Utils.isNotEmpty(value))</span>
<span class="source-line-no">2890</span><span id="line-2890">            defaultRequestHeaders(contentType(value));</span>
<span class="source-line-no">2891</span><span id="line-2891">         return this;</span>
<span class="source-line-no">2892</span><span id="line-2892">      }</span>
<span class="source-line-no">2893</span><span id="line-2893"></span>
<span class="source-line-no">2894</span><span id="line-2894">      /**</span>
<span class="source-line-no">2895</span><span id="line-2895">       * Instantiates the default request headers sub-builder.</span>
<span class="source-line-no">2896</span><span id="line-2896">       *</span>
<span class="source-line-no">2897</span><span id="line-2897">       * @param beanStore</span>
<span class="source-line-no">2898</span><span id="line-2898">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">2899</span><span id="line-2899">       * @param resource</span>
<span class="source-line-no">2900</span><span id="line-2900">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">2901</span><span id="line-2901">       * @return A new default request headers sub-builder.</span>
<span class="source-line-no">2902</span><span id="line-2902">       */</span>
<span class="source-line-no">2903</span><span id="line-2903">      protected HeaderList createDefaultRequestHeaders(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">2904</span><span id="line-2904"></span>
<span class="source-line-no">2905</span><span id="line-2905">         // Default value.</span>
<span class="source-line-no">2906</span><span id="line-2906">         Value&lt;HeaderList&gt; v = Value.of(</span>
<span class="source-line-no">2907</span><span id="line-2907">            HeaderList.create()</span>
<span class="source-line-no">2908</span><span id="line-2908">         );</span>
<span class="source-line-no">2909</span><span id="line-2909"></span>
<span class="source-line-no">2910</span><span id="line-2910">         // Replace with bean from bean store.</span>
<span class="source-line-no">2911</span><span id="line-2911">         beanStore</span>
<span class="source-line-no">2912</span><span id="line-2912">            .getBean(HeaderList.class, "defaultRequestHeaders")</span>
<span class="source-line-no">2913</span><span id="line-2913">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">2914</span><span id="line-2914"></span>
<span class="source-line-no">2915</span><span id="line-2915">         // Replace with bean from:  @RestInject(name="defaultRequestHeaders") public [static] HeaderList xxx(&lt;args&gt;)</span>
<span class="source-line-no">2916</span><span id="line-2916">         beanStore</span>
<span class="source-line-no">2917</span><span id="line-2917">            .createMethodFinder(HeaderList.class)</span>
<span class="source-line-no">2918</span><span id="line-2918">            .addBean(HeaderList.class, v.get())</span>
<span class="source-line-no">2919</span><span id="line-2919">            .find(x -&gt; isRestBeanMethod(x, "defaultRequestHeaders"))</span>
<span class="source-line-no">2920</span><span id="line-2920">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">2921</span><span id="line-2921"></span>
<span class="source-line-no">2922</span><span id="line-2922">         return v.get();</span>
<span class="source-line-no">2923</span><span id="line-2923">      }</span>
<span class="source-line-no">2924</span><span id="line-2924"></span>
<span class="source-line-no">2925</span><span id="line-2925">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2926</span><span id="line-2926">      // defaultResponseHeaders</span>
<span class="source-line-no">2927</span><span id="line-2927">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">2928</span><span id="line-2928"></span>
<span class="source-line-no">2929</span><span id="line-2929">      /**</span>
<span class="source-line-no">2930</span><span id="line-2930">       * Returns the default response headers.</span>
<span class="source-line-no">2931</span><span id="line-2931">       *</span>
<span class="source-line-no">2932</span><span id="line-2932">       * @return The default response headers.</span>
<span class="source-line-no">2933</span><span id="line-2933">       */</span>
<span class="source-line-no">2934</span><span id="line-2934">      public HeaderList defaultResponseHeaders() {</span>
<span class="source-line-no">2935</span><span id="line-2935">         if (defaultResponseHeaders == null)</span>
<span class="source-line-no">2936</span><span id="line-2936">            defaultResponseHeaders = createDefaultResponseHeaders(beanStore(), resource());</span>
<span class="source-line-no">2937</span><span id="line-2937">         return defaultResponseHeaders;</span>
<span class="source-line-no">2938</span><span id="line-2938">      }</span>
<span class="source-line-no">2939</span><span id="line-2939"></span>
<span class="source-line-no">2940</span><span id="line-2940">      /**</span>
<span class="source-line-no">2941</span><span id="line-2941">       * Default response headers.</span>
<span class="source-line-no">2942</span><span id="line-2942">       *</span>
<span class="source-line-no">2943</span><span id="line-2943">       * &lt;p&gt;</span>
<span class="source-line-no">2944</span><span id="line-2944">       * Specifies default values for response headers if they're not set after the Java REST method is called.</span>
<span class="source-line-no">2945</span><span id="line-2945">       *</span>
<span class="source-line-no">2946</span><span id="line-2946">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2947</span><span id="line-2947">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2948</span><span id="line-2948">       *       This is equivalent to calling {@link RestResponse#setHeader(String, String)} programmatically in each of</span>
<span class="source-line-no">2949</span><span id="line-2949">       *       the Java methods.</span>
<span class="source-line-no">2950</span><span id="line-2950">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">2951</span><span id="line-2951">       *       The header value will not be set if the header value has already been specified (hence the 'default' in the name).</span>
<span class="source-line-no">2952</span><span id="line-2952">       * &lt;/ul&gt;</span>
<span class="source-line-no">2953</span><span id="line-2953">       *</span>
<span class="source-line-no">2954</span><span id="line-2954">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">2955</span><span id="line-2955">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">2956</span><span id="line-2956">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">2957</span><span id="line-2957">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(defaultResponseHeaders={&lt;js&gt;"Content-Type: $C{REST/defaultContentType,text/plain}"&lt;/js&gt;,&lt;js&gt;"My-Header: $C{REST/myHeaderValue}"&lt;/js&gt;})</span>
<span class="source-line-no">2958</span><span id="line-2958">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">2959</span><span id="line-2959">       *</span>
<span class="source-line-no">2960</span><span id="line-2960">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">2961</span><span id="line-2961">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">2962</span><span id="line-2962">       *</span>
<span class="source-line-no">2963</span><span id="line-2963">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">2964</span><span id="line-2964">       *          &lt;jv&gt;builder&lt;/jv&gt;</span>
<span class="source-line-no">2965</span><span id="line-2965">       *             .defaultResponseHeaders(</span>
<span class="source-line-no">2966</span><span id="line-2966">       *                ContentType.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"text/plain"&lt;/js&gt;),</span>
<span class="source-line-no">2967</span><span id="line-2967">       *                BasicHeader.&lt;jsm&gt;ofPair&lt;/jsm&gt;(&lt;js&gt;"My-Header: foo"&lt;/js&gt;)</span>
<span class="source-line-no">2968</span><span id="line-2968">       *             );</span>
<span class="source-line-no">2969</span><span id="line-2969">       *       }</span>
<span class="source-line-no">2970</span><span id="line-2970">       *</span>
<span class="source-line-no">2971</span><span id="line-2971">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">2972</span><span id="line-2972">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">2973</span><span id="line-2973">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">2974</span><span id="line-2974">       *          &lt;jv&gt;builder&lt;/jv&gt;.defaultResponseHeaders(ContentType.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"text/plain"&lt;/js&gt;));</span>
<span class="source-line-no">2975</span><span id="line-2975">       *       }</span>
<span class="source-line-no">2976</span><span id="line-2976">       *    }</span>
<span class="source-line-no">2977</span><span id="line-2977">       * &lt;/p&gt;</span>
<span class="source-line-no">2978</span><span id="line-2978">       *</span>
<span class="source-line-no">2979</span><span id="line-2979">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">2980</span><span id="line-2980">       *    &lt;li class='ja'&gt;{@link Rest#defaultResponseHeaders}</span>
<span class="source-line-no">2981</span><span id="line-2981">       *    &lt;li class='ja'&gt;{@link RestOp#defaultResponseHeaders}</span>
<span class="source-line-no">2982</span><span id="line-2982">       *    &lt;li class='ja'&gt;{@link RestGet#defaultResponseHeaders}</span>
<span class="source-line-no">2983</span><span id="line-2983">       *    &lt;li class='ja'&gt;{@link RestPut#defaultResponseHeaders}</span>
<span class="source-line-no">2984</span><span id="line-2984">       *    &lt;li class='ja'&gt;{@link RestPost#defaultResponseHeaders}</span>
<span class="source-line-no">2985</span><span id="line-2985">       *    &lt;li class='ja'&gt;{@link RestDelete#defaultResponseHeaders}</span>
<span class="source-line-no">2986</span><span id="line-2986">       * &lt;/ul&gt;</span>
<span class="source-line-no">2987</span><span id="line-2987">       *</span>
<span class="source-line-no">2988</span><span id="line-2988">       * @param values The headers to add.</span>
<span class="source-line-no">2989</span><span id="line-2989">       * @return This object.</span>
<span class="source-line-no">2990</span><span id="line-2990">       */</span>
<span class="source-line-no">2991</span><span id="line-2991">      @FluentSetter</span>
<span class="source-line-no">2992</span><span id="line-2992">      public Builder defaultResponseHeaders(Header...values) {</span>
<span class="source-line-no">2993</span><span id="line-2993">         defaultResponseHeaders().setDefault(values);</span>
<span class="source-line-no">2994</span><span id="line-2994">         return this;</span>
<span class="source-line-no">2995</span><span id="line-2995">      }</span>
<span class="source-line-no">2996</span><span id="line-2996"></span>
<span class="source-line-no">2997</span><span id="line-2997">      /**</span>
<span class="source-line-no">2998</span><span id="line-2998">       * Instantiates the default response headers sub-builder.</span>
<span class="source-line-no">2999</span><span id="line-2999">       *</span>
<span class="source-line-no">3000</span><span id="line-3000">       * @param beanStore</span>
<span class="source-line-no">3001</span><span id="line-3001">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3002</span><span id="line-3002">       * @param resource</span>
<span class="source-line-no">3003</span><span id="line-3003">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3004</span><span id="line-3004">       * @return A new default response headers sub-builder.</span>
<span class="source-line-no">3005</span><span id="line-3005">       */</span>
<span class="source-line-no">3006</span><span id="line-3006">      protected HeaderList createDefaultResponseHeaders(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3007</span><span id="line-3007"></span>
<span class="source-line-no">3008</span><span id="line-3008">         // Default value.</span>
<span class="source-line-no">3009</span><span id="line-3009">         Value&lt;HeaderList&gt; v = Value.of(</span>
<span class="source-line-no">3010</span><span id="line-3010">            HeaderList.create()</span>
<span class="source-line-no">3011</span><span id="line-3011">         );</span>
<span class="source-line-no">3012</span><span id="line-3012"></span>
<span class="source-line-no">3013</span><span id="line-3013">         // Replace with bean from bean store.</span>
<span class="source-line-no">3014</span><span id="line-3014">         beanStore</span>
<span class="source-line-no">3015</span><span id="line-3015">            .getBean(HeaderList.class, "defaultResponseHeaders")</span>
<span class="source-line-no">3016</span><span id="line-3016">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">3017</span><span id="line-3017"></span>
<span class="source-line-no">3018</span><span id="line-3018">         // Replace with bean from:  @RestInject(name="defaultResponseHeaders") public [static] HeaderList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3019</span><span id="line-3019">         beanStore</span>
<span class="source-line-no">3020</span><span id="line-3020">            .createMethodFinder(HeaderList.class)</span>
<span class="source-line-no">3021</span><span id="line-3021">            .addBean(HeaderList.class, v.get())</span>
<span class="source-line-no">3022</span><span id="line-3022">            .find(x -&gt; isRestBeanMethod(x, "defaultResponseHeaders"))</span>
<span class="source-line-no">3023</span><span id="line-3023">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3024</span><span id="line-3024"></span>
<span class="source-line-no">3025</span><span id="line-3025">         return v.get();</span>
<span class="source-line-no">3026</span><span id="line-3026">      }</span>
<span class="source-line-no">3027</span><span id="line-3027"></span>
<span class="source-line-no">3028</span><span id="line-3028">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3029</span><span id="line-3029">      // defaultRequestAttributes</span>
<span class="source-line-no">3030</span><span id="line-3030">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3031</span><span id="line-3031"></span>
<span class="source-line-no">3032</span><span id="line-3032">      /**</span>
<span class="source-line-no">3033</span><span id="line-3033">       * Returns the default request attributes sub-builder.</span>
<span class="source-line-no">3034</span><span id="line-3034">       *</span>
<span class="source-line-no">3035</span><span id="line-3035">       * @return The default request attributes sub-builder.</span>
<span class="source-line-no">3036</span><span id="line-3036">       */</span>
<span class="source-line-no">3037</span><span id="line-3037">      public NamedAttributeMap defaultRequestAttributes() {</span>
<span class="source-line-no">3038</span><span id="line-3038">         if (defaultRequestAttributes == null)</span>
<span class="source-line-no">3039</span><span id="line-3039">            defaultRequestAttributes = createDefaultRequestAttributes(beanStore(), resource());</span>
<span class="source-line-no">3040</span><span id="line-3040">         return defaultRequestAttributes;</span>
<span class="source-line-no">3041</span><span id="line-3041">      }</span>
<span class="source-line-no">3042</span><span id="line-3042"></span>
<span class="source-line-no">3043</span><span id="line-3043">      /**</span>
<span class="source-line-no">3044</span><span id="line-3044">       * Default request attributes.</span>
<span class="source-line-no">3045</span><span id="line-3045">       *</span>
<span class="source-line-no">3046</span><span id="line-3046">       * &lt;p&gt;</span>
<span class="source-line-no">3047</span><span id="line-3047">       * Specifies default values for request attributes if they're not already set on the request.</span>
<span class="source-line-no">3048</span><span id="line-3048">       *</span>
<span class="source-line-no">3049</span><span id="line-3049">       * Affects values returned by the following methods:</span>
<span class="source-line-no">3050</span><span id="line-3050">       * &lt;ul&gt;</span>
<span class="source-line-no">3051</span><span id="line-3051">       *    &lt;li class='jm'&gt;{@link RestRequest#getAttribute(String)}.</span>
<span class="source-line-no">3052</span><span id="line-3052">       *    &lt;li class='jm'&gt;{@link RestRequest#getAttributes()}.</span>
<span class="source-line-no">3053</span><span id="line-3053">       * &lt;/ul&gt;</span>
<span class="source-line-no">3054</span><span id="line-3054">       *</span>
<span class="source-line-no">3055</span><span id="line-3055">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">3056</span><span id="line-3056">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">3057</span><span id="line-3057">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">3058</span><span id="line-3058">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(defaultRequestAttributes={&lt;js&gt;"Foo=bar"&lt;/js&gt;, &lt;js&gt;"Baz: $C{REST/myAttributeValue}"&lt;/js&gt;})</span>
<span class="source-line-no">3059</span><span id="line-3059">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">3060</span><span id="line-3060">       *</span>
<span class="source-line-no">3061</span><span id="line-3061">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">3062</span><span id="line-3062">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">3063</span><span id="line-3063">       *</span>
<span class="source-line-no">3064</span><span id="line-3064">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">3065</span><span id="line-3065">       *          &lt;jv&gt;builder&lt;/jv&gt;</span>
<span class="source-line-no">3066</span><span id="line-3066">       *             .defaultRequestAttributes(</span>
<span class="source-line-no">3067</span><span id="line-3067">       *                BasicNamedAttribute.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"Foo"&lt;/js&gt;, &lt;js&gt;"bar"&lt;/js&gt;),</span>
<span class="source-line-no">3068</span><span id="line-3068">       *                BasicNamedAttribute.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"Baz"&lt;/js&gt;, &lt;jk&gt;true&lt;/jk&gt;)</span>
<span class="source-line-no">3069</span><span id="line-3069">       *             );</span>
<span class="source-line-no">3070</span><span id="line-3070">       *       }</span>
<span class="source-line-no">3071</span><span id="line-3071">       *</span>
<span class="source-line-no">3072</span><span id="line-3072">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">3073</span><span id="line-3073">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">3074</span><span id="line-3074">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">3075</span><span id="line-3075">       *          &lt;jv&gt;builder&lt;/jv&gt;.defaultRequestAttribute(&lt;js&gt;"Foo"&lt;/js&gt;, &lt;js&gt;"bar"&lt;/js&gt;);</span>
<span class="source-line-no">3076</span><span id="line-3076">       *       }</span>
<span class="source-line-no">3077</span><span id="line-3077">       *</span>
<span class="source-line-no">3078</span><span id="line-3078">       *       &lt;jc&gt;// Override at the method level.&lt;/jc&gt;</span>
<span class="source-line-no">3079</span><span id="line-3079">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;(defaultRequestAttributes={&lt;js&gt;"Foo: bar"&lt;/js&gt;})</span>
<span class="source-line-no">3080</span><span id="line-3080">       *       &lt;jk&gt;public&lt;/jk&gt; Object myMethod() {...}</span>
<span class="source-line-no">3081</span><span id="line-3081">       *    }</span>
<span class="source-line-no">3082</span><span id="line-3082">       * &lt;/p&gt;</span>
<span class="source-line-no">3083</span><span id="line-3083">       *</span>
<span class="source-line-no">3084</span><span id="line-3084">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">3085</span><span id="line-3085">       *    &lt;li class='note'&gt;Use {@link BasicNamedAttribute#of(String, Supplier)} to provide a dynamically changeable attribute value.</span>
<span class="source-line-no">3086</span><span id="line-3086">       * &lt;/ul&gt;</span>
<span class="source-line-no">3087</span><span id="line-3087">       *</span>
<span class="source-line-no">3088</span><span id="line-3088">       * @param values The attributes.</span>
<span class="source-line-no">3089</span><span id="line-3089">       * @return This object.</span>
<span class="source-line-no">3090</span><span id="line-3090">       */</span>
<span class="source-line-no">3091</span><span id="line-3091">      @FluentSetter</span>
<span class="source-line-no">3092</span><span id="line-3092">      public Builder defaultRequestAttributes(NamedAttribute...values) {</span>
<span class="source-line-no">3093</span><span id="line-3093">         defaultRequestAttributes().add(values);</span>
<span class="source-line-no">3094</span><span id="line-3094">         return this;</span>
<span class="source-line-no">3095</span><span id="line-3095">      }</span>
<span class="source-line-no">3096</span><span id="line-3096"></span>
<span class="source-line-no">3097</span><span id="line-3097">      /**</span>
<span class="source-line-no">3098</span><span id="line-3098">       * Instantiates the default request attributes sub-builder.</span>
<span class="source-line-no">3099</span><span id="line-3099">       *</span>
<span class="source-line-no">3100</span><span id="line-3100">       * @param beanStore</span>
<span class="source-line-no">3101</span><span id="line-3101">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3102</span><span id="line-3102">       * @param resource</span>
<span class="source-line-no">3103</span><span id="line-3103">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3104</span><span id="line-3104">       * @return A new default request attributes sub-builder.</span>
<span class="source-line-no">3105</span><span id="line-3105">       */</span>
<span class="source-line-no">3106</span><span id="line-3106">      protected NamedAttributeMap createDefaultRequestAttributes(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3107</span><span id="line-3107"></span>
<span class="source-line-no">3108</span><span id="line-3108">         // Default value.</span>
<span class="source-line-no">3109</span><span id="line-3109">         Value&lt;NamedAttributeMap&gt; v = Value.of(</span>
<span class="source-line-no">3110</span><span id="line-3110">            NamedAttributeMap.create()</span>
<span class="source-line-no">3111</span><span id="line-3111">         );</span>
<span class="source-line-no">3112</span><span id="line-3112"></span>
<span class="source-line-no">3113</span><span id="line-3113">         beanStore</span>
<span class="source-line-no">3114</span><span id="line-3114">            .getBean(NamedAttributeMap.class, "defaultRequestAttributes")</span>
<span class="source-line-no">3115</span><span id="line-3115">            .ifPresent(x -&gt; v.set(x));</span>
<span class="source-line-no">3116</span><span id="line-3116"></span>
<span class="source-line-no">3117</span><span id="line-3117">         // Replace with bean from:  @RestInject(name="defaultRequestAttributes") public [static] NamedAttributeMap xxx(&lt;args&gt;)</span>
<span class="source-line-no">3118</span><span id="line-3118">         beanStore</span>
<span class="source-line-no">3119</span><span id="line-3119">            .createMethodFinder(NamedAttributeMap.class)</span>
<span class="source-line-no">3120</span><span id="line-3120">            .addBean(NamedAttributeMap.class, v.get())</span>
<span class="source-line-no">3121</span><span id="line-3121">            .find(x -&gt; isRestBeanMethod(x, "defaultRequestAttributes"))</span>
<span class="source-line-no">3122</span><span id="line-3122">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3123</span><span id="line-3123"></span>
<span class="source-line-no">3124</span><span id="line-3124">         return v.get();</span>
<span class="source-line-no">3125</span><span id="line-3125">      }</span>
<span class="source-line-no">3126</span><span id="line-3126"></span>
<span class="source-line-no">3127</span><span id="line-3127">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3128</span><span id="line-3128">      // restOpArgs</span>
<span class="source-line-no">3129</span><span id="line-3129">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3130</span><span id="line-3130"></span>
<span class="source-line-no">3131</span><span id="line-3131">      /**</span>
<span class="source-line-no">3132</span><span id="line-3132">       * Returns the REST operation args sub-builder.</span>
<span class="source-line-no">3133</span><span id="line-3133">       *</span>
<span class="source-line-no">3134</span><span id="line-3134">       * @return The REST operation args sub-builder.</span>
<span class="source-line-no">3135</span><span id="line-3135">       */</span>
<span class="source-line-no">3136</span><span id="line-3136">      public RestOpArgList.Builder restOpArgs() {</span>
<span class="source-line-no">3137</span><span id="line-3137">         if (restOpArgs == null)</span>
<span class="source-line-no">3138</span><span id="line-3138">            restOpArgs = createRestOpArgs(beanStore(), resource());</span>
<span class="source-line-no">3139</span><span id="line-3139">         return restOpArgs;</span>
<span class="source-line-no">3140</span><span id="line-3140">      }</span>
<span class="source-line-no">3141</span><span id="line-3141"></span>
<span class="source-line-no">3142</span><span id="line-3142">      /**</span>
<span class="source-line-no">3143</span><span id="line-3143">       * Adds one or more REST operation args to this class.</span>
<span class="source-line-no">3144</span><span id="line-3144">       *</span>
<span class="source-line-no">3145</span><span id="line-3145">       * &lt;p&gt;</span>
<span class="source-line-no">3146</span><span id="line-3146">       * Equivalent to calling:</span>
<span class="source-line-no">3147</span><span id="line-3147">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">3148</span><span id="line-3148">       *    &lt;jv&gt;builder&lt;/jv&gt;.restOpArgs().add(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">3149</span><span id="line-3149">       * &lt;/p&gt;</span>
<span class="source-line-no">3150</span><span id="line-3150">       *</span>
<span class="source-line-no">3151</span><span id="line-3151">       * @param value The new value.</span>
<span class="source-line-no">3152</span><span id="line-3152">       * @return This object.</span>
<span class="source-line-no">3153</span><span id="line-3153">       */</span>
<span class="source-line-no">3154</span><span id="line-3154">      @SafeVarargs</span>
<span class="source-line-no">3155</span><span id="line-3155">      @FluentSetter</span>
<span class="source-line-no">3156</span><span id="line-3156">      public final Builder restOpArgs(Class&lt;? extends RestOpArg&gt;...value) {</span>
<span class="source-line-no">3157</span><span id="line-3157">         restOpArgs().add(value);</span>
<span class="source-line-no">3158</span><span id="line-3158">         return this;</span>
<span class="source-line-no">3159</span><span id="line-3159">      }</span>
<span class="source-line-no">3160</span><span id="line-3160"></span>
<span class="source-line-no">3161</span><span id="line-3161">      /**</span>
<span class="source-line-no">3162</span><span id="line-3162">       * Instantiates the REST operation args sub-builder.</span>
<span class="source-line-no">3163</span><span id="line-3163">       *</span>
<span class="source-line-no">3164</span><span id="line-3164">       * &lt;p&gt;</span>
<span class="source-line-no">3165</span><span id="line-3165">       * Instantiates based on the following logic:</span>
<span class="source-line-no">3166</span><span id="line-3166">       * &lt;ul&gt;</span>
<span class="source-line-no">3167</span><span id="line-3167">       *    &lt;li&gt;Looks for REST op args set via any of the following:</span>
<span class="source-line-no">3168</span><span id="line-3168">       *       &lt;ul&gt;</span>
<span class="source-line-no">3169</span><span id="line-3169">       *          &lt;li&gt;{@link RestContext.Builder#restOpArgs(Class...)}/{@link RestContext.Builder#restOpArgs(Class...)}</span>
<span class="source-line-no">3170</span><span id="line-3170">       *          &lt;li&gt;{@link Rest#restOpArgs()}.</span>
<span class="source-line-no">3171</span><span id="line-3171">       *       &lt;/ul&gt;</span>
<span class="source-line-no">3172</span><span id="line-3172">       *    &lt;li&gt;Looks for a static or non-static &lt;c&gt;createRestParams()&lt;/c&gt; method that returns &lt;c&gt;{@link Class}[]&lt;/c&gt;.</span>
<span class="source-line-no">3173</span><span id="line-3173">       *    &lt;li&gt;Resolves it via the bean store registered in this context.</span>
<span class="source-line-no">3174</span><span id="line-3174">       *    &lt;li&gt;Instantiates a default set of parameters.</span>
<span class="source-line-no">3175</span><span id="line-3175">       * &lt;/ul&gt;</span>
<span class="source-line-no">3176</span><span id="line-3176">       *</span>
<span class="source-line-no">3177</span><span id="line-3177">       * @param beanStore</span>
<span class="source-line-no">3178</span><span id="line-3178">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3179</span><span id="line-3179">       * @param resource</span>
<span class="source-line-no">3180</span><span id="line-3180">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3181</span><span id="line-3181">       * @return A new REST operation args sub-builder.</span>
<span class="source-line-no">3182</span><span id="line-3182">       */</span>
<span class="source-line-no">3183</span><span id="line-3183">      protected RestOpArgList.Builder createRestOpArgs(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3184</span><span id="line-3184"></span>
<span class="source-line-no">3185</span><span id="line-3185">         // Default value.</span>
<span class="source-line-no">3186</span><span id="line-3186">         Value&lt;RestOpArgList.Builder&gt; v = Value.of(</span>
<span class="source-line-no">3187</span><span id="line-3187">            RestOpArgList</span>
<span class="source-line-no">3188</span><span id="line-3188">               .create(beanStore)</span>
<span class="source-line-no">3189</span><span id="line-3189">               .add(</span>
<span class="source-line-no">3190</span><span id="line-3190">                  AttributeArg.class,</span>
<span class="source-line-no">3191</span><span id="line-3191">                  ContentArg.class,</span>
<span class="source-line-no">3192</span><span id="line-3192">                  FormDataArg.class,</span>
<span class="source-line-no">3193</span><span id="line-3193">                  HasFormDataArg.class,</span>
<span class="source-line-no">3194</span><span id="line-3194">                  HasQueryArg.class,</span>
<span class="source-line-no">3195</span><span id="line-3195">                  HeaderArg.class,</span>
<span class="source-line-no">3196</span><span id="line-3196">                  HttpServletRequestArgs.class,</span>
<span class="source-line-no">3197</span><span id="line-3197">                  HttpServletResponseArgs.class,</span>
<span class="source-line-no">3198</span><span id="line-3198">                  HttpSessionArgs.class,</span>
<span class="source-line-no">3199</span><span id="line-3199">                  InputStreamParserArg.class,</span>
<span class="source-line-no">3200</span><span id="line-3200">                  MethodArg.class,</span>
<span class="source-line-no">3201</span><span id="line-3201">                  ParserArg.class,</span>
<span class="source-line-no">3202</span><span id="line-3202">                  PathArg.class,</span>
<span class="source-line-no">3203</span><span id="line-3203">                  QueryArg.class,</span>
<span class="source-line-no">3204</span><span id="line-3204">                  ReaderParserArg.class,</span>
<span class="source-line-no">3205</span><span id="line-3205">                  RequestBeanArg.class,</span>
<span class="source-line-no">3206</span><span id="line-3206">                  ResponseBeanArg.class,</span>
<span class="source-line-no">3207</span><span id="line-3207">                  ResponseHeaderArg.class,</span>
<span class="source-line-no">3208</span><span id="line-3208">                  ResponseCodeArg.class,</span>
<span class="source-line-no">3209</span><span id="line-3209">                  RestContextArgs.class,</span>
<span class="source-line-no">3210</span><span id="line-3210">                  RestSessionArgs.class,</span>
<span class="source-line-no">3211</span><span id="line-3211">                  RestOpContextArgs.class,</span>
<span class="source-line-no">3212</span><span id="line-3212">                  RestOpSessionArgs.class,</span>
<span class="source-line-no">3213</span><span id="line-3213">                  RestRequestArgs.class,</span>
<span class="source-line-no">3214</span><span id="line-3214">                  RestResponseArgs.class,</span>
<span class="source-line-no">3215</span><span id="line-3215">                  DefaultArg.class</span>
<span class="source-line-no">3216</span><span id="line-3216">               )</span>
<span class="source-line-no">3217</span><span id="line-3217">         );</span>
<span class="source-line-no">3218</span><span id="line-3218"></span>
<span class="source-line-no">3219</span><span id="line-3219">         // Replace with bean from bean store.</span>
<span class="source-line-no">3220</span><span id="line-3220">         beanStore</span>
<span class="source-line-no">3221</span><span id="line-3221">            .getBean(RestOpArgList.class)</span>
<span class="source-line-no">3222</span><span id="line-3222">            .ifPresent(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">3223</span><span id="line-3223"></span>
<span class="source-line-no">3224</span><span id="line-3224">         // Replace with bean from:  @RestInject public [static] RestOpArgList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3225</span><span id="line-3225">         beanStore</span>
<span class="source-line-no">3226</span><span id="line-3226">            .createMethodFinder(RestOpArgList.class)</span>
<span class="source-line-no">3227</span><span id="line-3227">            .addBean(RestOpArgList.Builder.class, v.get())</span>
<span class="source-line-no">3228</span><span id="line-3228">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">3229</span><span id="line-3229">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">3230</span><span id="line-3230"></span>
<span class="source-line-no">3231</span><span id="line-3231">         return v.get();</span>
<span class="source-line-no">3232</span><span id="line-3232">      }</span>
<span class="source-line-no">3233</span><span id="line-3233"></span>
<span class="source-line-no">3234</span><span id="line-3234">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3235</span><span id="line-3235">      // debugEnablement</span>
<span class="source-line-no">3236</span><span id="line-3236">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3237</span><span id="line-3237"></span>
<span class="source-line-no">3238</span><span id="line-3238">      /**</span>
<span class="source-line-no">3239</span><span id="line-3239">       * Returns the debug enablement bean creator.</span>
<span class="source-line-no">3240</span><span id="line-3240">       *</span>
<span class="source-line-no">3241</span><span id="line-3241">       * &lt;p&gt;</span>
<span class="source-line-no">3242</span><span id="line-3242">       * Enables the following:</span>
<span class="source-line-no">3243</span><span id="line-3243">       * &lt;ul class='spaced-list'&gt;</span>
<span class="source-line-no">3244</span><span id="line-3244">       *    &lt;li&gt;</span>
<span class="source-line-no">3245</span><span id="line-3245">       *       HTTP request/response bodies are cached in memory for logging purposes.</span>
<span class="source-line-no">3246</span><span id="line-3246">       *    &lt;li&gt;</span>
<span class="source-line-no">3247</span><span id="line-3247">       *       Request/response messages are automatically logged always or per request.</span>
<span class="source-line-no">3248</span><span id="line-3248">       * &lt;/ul&gt;</span>
<span class="source-line-no">3249</span><span id="line-3249">       *</span>
<span class="source-line-no">3250</span><span id="line-3250">       * @return The debug enablement sub-builder.</span>
<span class="source-line-no">3251</span><span id="line-3251">       */</span>
<span class="source-line-no">3252</span><span id="line-3252">      public BeanCreator&lt;DebugEnablement&gt; debugEnablement() {</span>
<span class="source-line-no">3253</span><span id="line-3253">         if (debugEnablement == null)</span>
<span class="source-line-no">3254</span><span id="line-3254">            debugEnablement = createDebugEnablement(beanStore, resource);</span>
<span class="source-line-no">3255</span><span id="line-3255">         return debugEnablement;</span>
<span class="source-line-no">3256</span><span id="line-3256">      }</span>
<span class="source-line-no">3257</span><span id="line-3257"></span>
<span class="source-line-no">3258</span><span id="line-3258">      /**</span>
<span class="source-line-no">3259</span><span id="line-3259">       * Specifies the debug enablement class to use for this REST context.</span>
<span class="source-line-no">3260</span><span id="line-3260">       *</span>
<span class="source-line-no">3261</span><span id="line-3261">       * @param value The new value for this setting.</span>
<span class="source-line-no">3262</span><span id="line-3262">       * @return This object.</span>
<span class="source-line-no">3263</span><span id="line-3263">       */</span>
<span class="source-line-no">3264</span><span id="line-3264">      public Builder debugEnablement(Class&lt;? extends DebugEnablement&gt; value) {</span>
<span class="source-line-no">3265</span><span id="line-3265">         debugEnablement().type(value);</span>
<span class="source-line-no">3266</span><span id="line-3266">         return this;</span>
<span class="source-line-no">3267</span><span id="line-3267">      }</span>
<span class="source-line-no">3268</span><span id="line-3268"></span>
<span class="source-line-no">3269</span><span id="line-3269">      /**</span>
<span class="source-line-no">3270</span><span id="line-3270">       * Specifies the debug enablement class to use for this REST context.</span>
<span class="source-line-no">3271</span><span id="line-3271">       *</span>
<span class="source-line-no">3272</span><span id="line-3272">       * @param value The new value for this setting.</span>
<span class="source-line-no">3273</span><span id="line-3273">       * @return This object.</span>
<span class="source-line-no">3274</span><span id="line-3274">       */</span>
<span class="source-line-no">3275</span><span id="line-3275">      public Builder debugEnablement(DebugEnablement value) {</span>
<span class="source-line-no">3276</span><span id="line-3276">         debugEnablement().impl(value);</span>
<span class="source-line-no">3277</span><span id="line-3277">         return this;</span>
<span class="source-line-no">3278</span><span id="line-3278">      }</span>
<span class="source-line-no">3279</span><span id="line-3279"></span>
<span class="source-line-no">3280</span><span id="line-3280">      /**</span>
<span class="source-line-no">3281</span><span id="line-3281">       * Sets the debug default value.</span>
<span class="source-line-no">3282</span><span id="line-3282">       *</span>
<span class="source-line-no">3283</span><span id="line-3283">       * &lt;p&gt;</span>
<span class="source-line-no">3284</span><span id="line-3284">       * The default debug value is the enablement value if not otherwise overridden at the class or method level.</span>
<span class="source-line-no">3285</span><span id="line-3285">       *</span>
<span class="source-line-no">3286</span><span id="line-3286">       * @param value The debug default value.</span>
<span class="source-line-no">3287</span><span id="line-3287">       * @return This object.</span>
<span class="source-line-no">3288</span><span id="line-3288">       */</span>
<span class="source-line-no">3289</span><span id="line-3289">      @FluentSetter</span>
<span class="source-line-no">3290</span><span id="line-3290">      public Builder debugDefault(Enablement value) {</span>
<span class="source-line-no">3291</span><span id="line-3291">         defaultSettings().set("RestContext.debugDefault", value);</span>
<span class="source-line-no">3292</span><span id="line-3292">         return this;</span>
<span class="source-line-no">3293</span><span id="line-3293">      }</span>
<span class="source-line-no">3294</span><span id="line-3294"></span>
<span class="source-line-no">3295</span><span id="line-3295">      /**</span>
<span class="source-line-no">3296</span><span id="line-3296">       * Instantiates the debug enablement bean creator.</span>
<span class="source-line-no">3297</span><span id="line-3297">       *</span>
<span class="source-line-no">3298</span><span id="line-3298">       * @param beanStore</span>
<span class="source-line-no">3299</span><span id="line-3299">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3300</span><span id="line-3300">       * @param resource</span>
<span class="source-line-no">3301</span><span id="line-3301">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3302</span><span id="line-3302">       * @return A new debug enablement bean creator.</span>
<span class="source-line-no">3303</span><span id="line-3303">       */</span>
<span class="source-line-no">3304</span><span id="line-3304">      protected BeanCreator&lt;DebugEnablement&gt; createDebugEnablement(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3305</span><span id="line-3305"></span>
<span class="source-line-no">3306</span><span id="line-3306">         BeanCreator&lt;DebugEnablement&gt; creator = beanStore.createBean(DebugEnablement.class).type(BasicDebugEnablement.class);</span>
<span class="source-line-no">3307</span><span id="line-3307"></span>
<span class="source-line-no">3308</span><span id="line-3308">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">3309</span><span id="line-3309">         defaultClasses()</span>
<span class="source-line-no">3310</span><span id="line-3310">            .get(DebugEnablement.class)</span>
<span class="source-line-no">3311</span><span id="line-3311">            .ifPresent(x -&gt; creator.type(x));</span>
<span class="source-line-no">3312</span><span id="line-3312"></span>
<span class="source-line-no">3313</span><span id="line-3313">         beanStore</span>
<span class="source-line-no">3314</span><span id="line-3314">            .getBean(DebugEnablement.class)</span>
<span class="source-line-no">3315</span><span id="line-3315">            .ifPresent(x -&gt; creator.impl(x));</span>
<span class="source-line-no">3316</span><span id="line-3316"></span>
<span class="source-line-no">3317</span><span id="line-3317">         // Replace with bean from:  @RestInject public [static] DebugEnablement xxx(&lt;args&gt;)</span>
<span class="source-line-no">3318</span><span id="line-3318">         beanStore</span>
<span class="source-line-no">3319</span><span id="line-3319">            .createMethodFinder(DebugEnablement.class)</span>
<span class="source-line-no">3320</span><span id="line-3320">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">3321</span><span id="line-3321">            .run(x -&gt; creator.impl(x));</span>
<span class="source-line-no">3322</span><span id="line-3322"></span>
<span class="source-line-no">3323</span><span id="line-3323">         return creator;</span>
<span class="source-line-no">3324</span><span id="line-3324">      }</span>
<span class="source-line-no">3325</span><span id="line-3325"></span>
<span class="source-line-no">3326</span><span id="line-3326">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3327</span><span id="line-3327">      // HookEvent.START_CALL methods</span>
<span class="source-line-no">3328</span><span id="line-3328">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3329</span><span id="line-3329"></span>
<span class="source-line-no">3330</span><span id="line-3330">      /**</span>
<span class="source-line-no">3331</span><span id="line-3331">       * Returns the start call method list.</span>
<span class="source-line-no">3332</span><span id="line-3332">       *</span>
<span class="source-line-no">3333</span><span id="line-3333">       * @return The start call method list.</span>
<span class="source-line-no">3334</span><span id="line-3334">       */</span>
<span class="source-line-no">3335</span><span id="line-3335">      public MethodList startCallMethods() {</span>
<span class="source-line-no">3336</span><span id="line-3336">         if (startCallMethods == null)</span>
<span class="source-line-no">3337</span><span id="line-3337">            startCallMethods = createStartCallMethods(beanStore(), resource());</span>
<span class="source-line-no">3338</span><span id="line-3338">         return startCallMethods;</span>
<span class="source-line-no">3339</span><span id="line-3339">      }</span>
<span class="source-line-no">3340</span><span id="line-3340"></span>
<span class="source-line-no">3341</span><span id="line-3341">      /**</span>
<span class="source-line-no">3342</span><span id="line-3342">       * Instantiates the start call method list.</span>
<span class="source-line-no">3343</span><span id="line-3343">       *</span>
<span class="source-line-no">3344</span><span id="line-3344">       * @param beanStore</span>
<span class="source-line-no">3345</span><span id="line-3345">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3346</span><span id="line-3346">       * @param resource</span>
<span class="source-line-no">3347</span><span id="line-3347">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3348</span><span id="line-3348">       * @return A new start call method list.</span>
<span class="source-line-no">3349</span><span id="line-3349">       */</span>
<span class="source-line-no">3350</span><span id="line-3350">      protected MethodList createStartCallMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3351</span><span id="line-3351"></span>
<span class="source-line-no">3352</span><span id="line-3352">         // Default value.</span>
<span class="source-line-no">3353</span><span id="line-3353">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3354</span><span id="line-3354">            getAnnotatedMethods(resource, RestStartCall.class, x -&gt; true)</span>
<span class="source-line-no">3355</span><span id="line-3355">         );</span>
<span class="source-line-no">3356</span><span id="line-3356"></span>
<span class="source-line-no">3357</span><span id="line-3357">         // Replace with bean from:  @RestInject(name="startCallMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3358</span><span id="line-3358">         beanStore</span>
<span class="source-line-no">3359</span><span id="line-3359">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3360</span><span id="line-3360">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3361</span><span id="line-3361">            .find(x -&gt; isRestBeanMethod(x, "startCallMethods"))</span>
<span class="source-line-no">3362</span><span id="line-3362">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3363</span><span id="line-3363"></span>
<span class="source-line-no">3364</span><span id="line-3364">         return v.get();</span>
<span class="source-line-no">3365</span><span id="line-3365">      }</span>
<span class="source-line-no">3366</span><span id="line-3366"></span>
<span class="source-line-no">3367</span><span id="line-3367">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3368</span><span id="line-3368">      // HookEvent.END_CALL methods</span>
<span class="source-line-no">3369</span><span id="line-3369">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3370</span><span id="line-3370"></span>
<span class="source-line-no">3371</span><span id="line-3371">      /**</span>
<span class="source-line-no">3372</span><span id="line-3372">       * Returns the end call method list.</span>
<span class="source-line-no">3373</span><span id="line-3373">       *</span>
<span class="source-line-no">3374</span><span id="line-3374">       * @return The end call method list.</span>
<span class="source-line-no">3375</span><span id="line-3375">       */</span>
<span class="source-line-no">3376</span><span id="line-3376">      public MethodList endCallMethods() {</span>
<span class="source-line-no">3377</span><span id="line-3377">         if (endCallMethods == null)</span>
<span class="source-line-no">3378</span><span id="line-3378">            endCallMethods = createEndCallMethods(beanStore(), resource());</span>
<span class="source-line-no">3379</span><span id="line-3379">         return endCallMethods;</span>
<span class="source-line-no">3380</span><span id="line-3380">      }</span>
<span class="source-line-no">3381</span><span id="line-3381"></span>
<span class="source-line-no">3382</span><span id="line-3382">      /**</span>
<span class="source-line-no">3383</span><span id="line-3383">       * Instantiates the end call method list.</span>
<span class="source-line-no">3384</span><span id="line-3384">       *</span>
<span class="source-line-no">3385</span><span id="line-3385">       * @param beanStore</span>
<span class="source-line-no">3386</span><span id="line-3386">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3387</span><span id="line-3387">       * @param resource</span>
<span class="source-line-no">3388</span><span id="line-3388">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3389</span><span id="line-3389">       * @return A new end call method list.</span>
<span class="source-line-no">3390</span><span id="line-3390">       */</span>
<span class="source-line-no">3391</span><span id="line-3391">      protected MethodList createEndCallMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3392</span><span id="line-3392"></span>
<span class="source-line-no">3393</span><span id="line-3393">         // Default value.</span>
<span class="source-line-no">3394</span><span id="line-3394">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3395</span><span id="line-3395">            getAnnotatedMethods(resource, RestEndCall.class, x -&gt; true)</span>
<span class="source-line-no">3396</span><span id="line-3396">         );</span>
<span class="source-line-no">3397</span><span id="line-3397"></span>
<span class="source-line-no">3398</span><span id="line-3398">         // Replace with bean from:  @RestInject(name="endCallMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3399</span><span id="line-3399">         beanStore</span>
<span class="source-line-no">3400</span><span id="line-3400">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3401</span><span id="line-3401">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3402</span><span id="line-3402">            .find(x -&gt; isRestBeanMethod(x, "endCallMethods"))</span>
<span class="source-line-no">3403</span><span id="line-3403">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3404</span><span id="line-3404"></span>
<span class="source-line-no">3405</span><span id="line-3405">         return v.get();</span>
<span class="source-line-no">3406</span><span id="line-3406">      }</span>
<span class="source-line-no">3407</span><span id="line-3407"></span>
<span class="source-line-no">3408</span><span id="line-3408">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3409</span><span id="line-3409">      // HookEvent.POST_INIT methods</span>
<span class="source-line-no">3410</span><span id="line-3410">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3411</span><span id="line-3411"></span>
<span class="source-line-no">3412</span><span id="line-3412">      /**</span>
<span class="source-line-no">3413</span><span id="line-3413">       * Returns the post-init method list.</span>
<span class="source-line-no">3414</span><span id="line-3414">       *</span>
<span class="source-line-no">3415</span><span id="line-3415">       * @return The post-init method list.</span>
<span class="source-line-no">3416</span><span id="line-3416">       */</span>
<span class="source-line-no">3417</span><span id="line-3417">      public MethodList postInitMethods() {</span>
<span class="source-line-no">3418</span><span id="line-3418">         if (postInitMethods == null)</span>
<span class="source-line-no">3419</span><span id="line-3419">            postInitMethods = createPostInitMethods(beanStore(), resource());</span>
<span class="source-line-no">3420</span><span id="line-3420">         return postInitMethods;</span>
<span class="source-line-no">3421</span><span id="line-3421">      }</span>
<span class="source-line-no">3422</span><span id="line-3422"></span>
<span class="source-line-no">3423</span><span id="line-3423">      /**</span>
<span class="source-line-no">3424</span><span id="line-3424">       * Instantiates the post-init method list.</span>
<span class="source-line-no">3425</span><span id="line-3425">       *</span>
<span class="source-line-no">3426</span><span id="line-3426">       * @param beanStore</span>
<span class="source-line-no">3427</span><span id="line-3427">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3428</span><span id="line-3428">       * @param resource</span>
<span class="source-line-no">3429</span><span id="line-3429">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3430</span><span id="line-3430">       * @return A new post-init method list.</span>
<span class="source-line-no">3431</span><span id="line-3431">       */</span>
<span class="source-line-no">3432</span><span id="line-3432">      protected MethodList createPostInitMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3433</span><span id="line-3433"></span>
<span class="source-line-no">3434</span><span id="line-3434">         // Default value.</span>
<span class="source-line-no">3435</span><span id="line-3435">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3436</span><span id="line-3436">            getAnnotatedMethods(resource, RestPostInit.class, x -&gt; ! x.childFirst())</span>
<span class="source-line-no">3437</span><span id="line-3437">         );</span>
<span class="source-line-no">3438</span><span id="line-3438"></span>
<span class="source-line-no">3439</span><span id="line-3439">         // Replace with bean from:  @RestInject(name="postInitMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3440</span><span id="line-3440">         beanStore</span>
<span class="source-line-no">3441</span><span id="line-3441">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3442</span><span id="line-3442">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3443</span><span id="line-3443">            .find(x -&gt; isRestBeanMethod(x, "postInitMethods"))</span>
<span class="source-line-no">3444</span><span id="line-3444">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3445</span><span id="line-3445"></span>
<span class="source-line-no">3446</span><span id="line-3446">         return v.get();</span>
<span class="source-line-no">3447</span><span id="line-3447">      }</span>
<span class="source-line-no">3448</span><span id="line-3448"></span>
<span class="source-line-no">3449</span><span id="line-3449">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3450</span><span id="line-3450">      // HookEvent.POST_INIT_CHILD_FIRST methods</span>
<span class="source-line-no">3451</span><span id="line-3451">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3452</span><span id="line-3452"></span>
<span class="source-line-no">3453</span><span id="line-3453">      /**</span>
<span class="source-line-no">3454</span><span id="line-3454">       * Returns the post-init-child-first method list.</span>
<span class="source-line-no">3455</span><span id="line-3455">       *</span>
<span class="source-line-no">3456</span><span id="line-3456">       * @return The post-init-child-first method list.</span>
<span class="source-line-no">3457</span><span id="line-3457">       */</span>
<span class="source-line-no">3458</span><span id="line-3458">      public MethodList postInitChildFirstMethods() {</span>
<span class="source-line-no">3459</span><span id="line-3459">         if (postInitChildFirstMethods == null)</span>
<span class="source-line-no">3460</span><span id="line-3460">            postInitChildFirstMethods = createPostInitChildFirstMethods(beanStore(), resource());</span>
<span class="source-line-no">3461</span><span id="line-3461">         return postInitChildFirstMethods;</span>
<span class="source-line-no">3462</span><span id="line-3462">      }</span>
<span class="source-line-no">3463</span><span id="line-3463"></span>
<span class="source-line-no">3464</span><span id="line-3464">      /**</span>
<span class="source-line-no">3465</span><span id="line-3465">       * Instantiates the post-init-child-first method list.</span>
<span class="source-line-no">3466</span><span id="line-3466">       *</span>
<span class="source-line-no">3467</span><span id="line-3467">       * @param beanStore</span>
<span class="source-line-no">3468</span><span id="line-3468">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3469</span><span id="line-3469">       * @param resource</span>
<span class="source-line-no">3470</span><span id="line-3470">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3471</span><span id="line-3471">       * @return A new post-init-child-first method list.</span>
<span class="source-line-no">3472</span><span id="line-3472">       */</span>
<span class="source-line-no">3473</span><span id="line-3473">      protected MethodList createPostInitChildFirstMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3474</span><span id="line-3474"></span>
<span class="source-line-no">3475</span><span id="line-3475">         // Default value.</span>
<span class="source-line-no">3476</span><span id="line-3476">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3477</span><span id="line-3477">            getAnnotatedMethods(resource, RestPostInit.class, RestPostInit::childFirst)</span>
<span class="source-line-no">3478</span><span id="line-3478">         );</span>
<span class="source-line-no">3479</span><span id="line-3479"></span>
<span class="source-line-no">3480</span><span id="line-3480">         // Replace with bean from:  @RestInject(name="postInitChildFirstMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3481</span><span id="line-3481">         beanStore</span>
<span class="source-line-no">3482</span><span id="line-3482">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3483</span><span id="line-3483">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3484</span><span id="line-3484">            .find(x -&gt; isRestBeanMethod(x, "postInitChildFirstMethods"))</span>
<span class="source-line-no">3485</span><span id="line-3485">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3486</span><span id="line-3486"></span>
<span class="source-line-no">3487</span><span id="line-3487">         return v.get();</span>
<span class="source-line-no">3488</span><span id="line-3488">      }</span>
<span class="source-line-no">3489</span><span id="line-3489"></span>
<span class="source-line-no">3490</span><span id="line-3490">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3491</span><span id="line-3491">      // HookEvent.DESTROY methods</span>
<span class="source-line-no">3492</span><span id="line-3492">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3493</span><span id="line-3493"></span>
<span class="source-line-no">3494</span><span id="line-3494">      /**</span>
<span class="source-line-no">3495</span><span id="line-3495">       * Returns the destroy method list.</span>
<span class="source-line-no">3496</span><span id="line-3496">       *</span>
<span class="source-line-no">3497</span><span id="line-3497">       * @return The destroy method list.</span>
<span class="source-line-no">3498</span><span id="line-3498">       */</span>
<span class="source-line-no">3499</span><span id="line-3499">      public MethodList destroyMethods() {</span>
<span class="source-line-no">3500</span><span id="line-3500">         if (destroyMethods == null)</span>
<span class="source-line-no">3501</span><span id="line-3501">            destroyMethods = createDestroyMethods(beanStore(), resource());</span>
<span class="source-line-no">3502</span><span id="line-3502">         return destroyMethods;</span>
<span class="source-line-no">3503</span><span id="line-3503">      }</span>
<span class="source-line-no">3504</span><span id="line-3504"></span>
<span class="source-line-no">3505</span><span id="line-3505">      /**</span>
<span class="source-line-no">3506</span><span id="line-3506">       * Instantiates the destroy method list.</span>
<span class="source-line-no">3507</span><span id="line-3507">       *</span>
<span class="source-line-no">3508</span><span id="line-3508">       * @param beanStore</span>
<span class="source-line-no">3509</span><span id="line-3509">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3510</span><span id="line-3510">       * @param resource</span>
<span class="source-line-no">3511</span><span id="line-3511">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3512</span><span id="line-3512">       * @return A new destroy method list.</span>
<span class="source-line-no">3513</span><span id="line-3513">       */</span>
<span class="source-line-no">3514</span><span id="line-3514">      protected MethodList createDestroyMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3515</span><span id="line-3515"></span>
<span class="source-line-no">3516</span><span id="line-3516">         // Default value.</span>
<span class="source-line-no">3517</span><span id="line-3517">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3518</span><span id="line-3518">            getAnnotatedMethods(resource, RestDestroy.class, x -&gt; true)</span>
<span class="source-line-no">3519</span><span id="line-3519">         );</span>
<span class="source-line-no">3520</span><span id="line-3520"></span>
<span class="source-line-no">3521</span><span id="line-3521">         // Replace with bean from:  @RestInject(name="destroyMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3522</span><span id="line-3522">         beanStore</span>
<span class="source-line-no">3523</span><span id="line-3523">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3524</span><span id="line-3524">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3525</span><span id="line-3525">            .find(x -&gt; isRestBeanMethod(x, "destroyMethods"))</span>
<span class="source-line-no">3526</span><span id="line-3526">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3527</span><span id="line-3527"></span>
<span class="source-line-no">3528</span><span id="line-3528">         return v.get();</span>
<span class="source-line-no">3529</span><span id="line-3529">      }</span>
<span class="source-line-no">3530</span><span id="line-3530"></span>
<span class="source-line-no">3531</span><span id="line-3531">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3532</span><span id="line-3532">      // HookEvent.PRE_CALL methods</span>
<span class="source-line-no">3533</span><span id="line-3533">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3534</span><span id="line-3534"></span>
<span class="source-line-no">3535</span><span id="line-3535">      /**</span>
<span class="source-line-no">3536</span><span id="line-3536">       * Returns the pre-call method list.</span>
<span class="source-line-no">3537</span><span id="line-3537">       *</span>
<span class="source-line-no">3538</span><span id="line-3538">       * &lt;p&gt;</span>
<span class="source-line-no">3539</span><span id="line-3539">       * The list of methods that gets called immediately before the &lt;ja&gt;@RestOp&lt;/ja&gt; annotated method gets called.</span>
<span class="source-line-no">3540</span><span id="line-3540">       *</span>
<span class="source-line-no">3541</span><span id="line-3541">       * @return The pre-call method list.</span>
<span class="source-line-no">3542</span><span id="line-3542">       */</span>
<span class="source-line-no">3543</span><span id="line-3543">      public MethodList preCallMethods() {</span>
<span class="source-line-no">3544</span><span id="line-3544">         if (preCallMethods == null)</span>
<span class="source-line-no">3545</span><span id="line-3545">            preCallMethods = createPreCallMethods(beanStore(), resource());</span>
<span class="source-line-no">3546</span><span id="line-3546">         return preCallMethods;</span>
<span class="source-line-no">3547</span><span id="line-3547">      }</span>
<span class="source-line-no">3548</span><span id="line-3548"></span>
<span class="source-line-no">3549</span><span id="line-3549">      /**</span>
<span class="source-line-no">3550</span><span id="line-3550">       * Instantiates the pre-call method list.</span>
<span class="source-line-no">3551</span><span id="line-3551">       *</span>
<span class="source-line-no">3552</span><span id="line-3552">       * @param beanStore</span>
<span class="source-line-no">3553</span><span id="line-3553">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3554</span><span id="line-3554">       * @param resource</span>
<span class="source-line-no">3555</span><span id="line-3555">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3556</span><span id="line-3556">       * @return A new pre-call method list.</span>
<span class="source-line-no">3557</span><span id="line-3557">       */</span>
<span class="source-line-no">3558</span><span id="line-3558">      protected MethodList createPreCallMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3559</span><span id="line-3559"></span>
<span class="source-line-no">3560</span><span id="line-3560">         // Default value.</span>
<span class="source-line-no">3561</span><span id="line-3561">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3562</span><span id="line-3562">            getAnnotatedMethods(resource, RestPreCall.class, x -&gt; true)</span>
<span class="source-line-no">3563</span><span id="line-3563">         );</span>
<span class="source-line-no">3564</span><span id="line-3564"></span>
<span class="source-line-no">3565</span><span id="line-3565">         // Replace with bean from:  @RestInject(name="preCallMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3566</span><span id="line-3566">         beanStore</span>
<span class="source-line-no">3567</span><span id="line-3567">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3568</span><span id="line-3568">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3569</span><span id="line-3569">            .find(x -&gt; isRestBeanMethod(x, "preCallMethods"))</span>
<span class="source-line-no">3570</span><span id="line-3570">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3571</span><span id="line-3571"></span>
<span class="source-line-no">3572</span><span id="line-3572">         return v.get();</span>
<span class="source-line-no">3573</span><span id="line-3573">      }</span>
<span class="source-line-no">3574</span><span id="line-3574"></span>
<span class="source-line-no">3575</span><span id="line-3575">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3576</span><span id="line-3576">      // HookEvent.POST_CALL methods</span>
<span class="source-line-no">3577</span><span id="line-3577">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3578</span><span id="line-3578"></span>
<span class="source-line-no">3579</span><span id="line-3579">      /**</span>
<span class="source-line-no">3580</span><span id="line-3580">       * Returns the post-call method list.</span>
<span class="source-line-no">3581</span><span id="line-3581">       *</span>
<span class="source-line-no">3582</span><span id="line-3582">       * &lt;p&gt;</span>
<span class="source-line-no">3583</span><span id="line-3583">       * The list of methods that gets called immediately after the &lt;ja&gt;@RestOp&lt;/ja&gt; annotated method gets called..</span>
<span class="source-line-no">3584</span><span id="line-3584">       *</span>
<span class="source-line-no">3585</span><span id="line-3585">       * @return The list of methods that gets called immediately after the &lt;ja&gt;@RestOp&lt;/ja&gt; annotated method gets called..</span>
<span class="source-line-no">3586</span><span id="line-3586">       */</span>
<span class="source-line-no">3587</span><span id="line-3587">      public MethodList postCallMethods() {</span>
<span class="source-line-no">3588</span><span id="line-3588">         if (postCallMethods == null)</span>
<span class="source-line-no">3589</span><span id="line-3589">            postCallMethods = createPostCallMethods(beanStore(), resource());</span>
<span class="source-line-no">3590</span><span id="line-3590">         return postCallMethods;</span>
<span class="source-line-no">3591</span><span id="line-3591">      }</span>
<span class="source-line-no">3592</span><span id="line-3592"></span>
<span class="source-line-no">3593</span><span id="line-3593">      /**</span>
<span class="source-line-no">3594</span><span id="line-3594">       * Instantiates the post-call method list.</span>
<span class="source-line-no">3595</span><span id="line-3595">       *</span>
<span class="source-line-no">3596</span><span id="line-3596">       * @param beanStore</span>
<span class="source-line-no">3597</span><span id="line-3597">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3598</span><span id="line-3598">       * @param resource</span>
<span class="source-line-no">3599</span><span id="line-3599">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3600</span><span id="line-3600">       * @return A new post-call method list.</span>
<span class="source-line-no">3601</span><span id="line-3601">       */</span>
<span class="source-line-no">3602</span><span id="line-3602">      protected MethodList createPostCallMethods(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3603</span><span id="line-3603"></span>
<span class="source-line-no">3604</span><span id="line-3604">         // Default value.</span>
<span class="source-line-no">3605</span><span id="line-3605">         Value&lt;MethodList&gt; v = Value.of(</span>
<span class="source-line-no">3606</span><span id="line-3606">            getAnnotatedMethods(resource, RestPostCall.class, x -&gt; true)</span>
<span class="source-line-no">3607</span><span id="line-3607">         );</span>
<span class="source-line-no">3608</span><span id="line-3608"></span>
<span class="source-line-no">3609</span><span id="line-3609">         // Replace with bean from:  @RestInject(name="postCallMethods") public [static] MethodList xxx(&lt;args&gt;)</span>
<span class="source-line-no">3610</span><span id="line-3610">         beanStore</span>
<span class="source-line-no">3611</span><span id="line-3611">            .createMethodFinder(MethodList.class)</span>
<span class="source-line-no">3612</span><span id="line-3612">            .addBean(MethodList.class, v.get())</span>
<span class="source-line-no">3613</span><span id="line-3613">            .find(x -&gt; isRestBeanMethod(x, "postCallMethods"))</span>
<span class="source-line-no">3614</span><span id="line-3614">            .run(x -&gt; v.set(x));</span>
<span class="source-line-no">3615</span><span id="line-3615"></span>
<span class="source-line-no">3616</span><span id="line-3616">         return v.get();</span>
<span class="source-line-no">3617</span><span id="line-3617">      }</span>
<span class="source-line-no">3618</span><span id="line-3618"></span>
<span class="source-line-no">3619</span><span id="line-3619">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3620</span><span id="line-3620">      // restOperations</span>
<span class="source-line-no">3621</span><span id="line-3621">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3622</span><span id="line-3622"></span>
<span class="source-line-no">3623</span><span id="line-3623">      /**</span>
<span class="source-line-no">3624</span><span id="line-3624">       * Returns the REST operations list.</span>
<span class="source-line-no">3625</span><span id="line-3625">       *</span>
<span class="source-line-no">3626</span><span id="line-3626">       * @param restContext The rest context.</span>
<span class="source-line-no">3627</span><span id="line-3627">       * @return The REST operations list.</span>
<span class="source-line-no">3628</span><span id="line-3628">       * @throws ServletException If a problem occurred instantiating one of the child rest contexts.</span>
<span class="source-line-no">3629</span><span id="line-3629">       */</span>
<span class="source-line-no">3630</span><span id="line-3630">      public RestOperations.Builder restOperations(RestContext restContext) throws ServletException {</span>
<span class="source-line-no">3631</span><span id="line-3631">         if (restOperations == null)</span>
<span class="source-line-no">3632</span><span id="line-3632">            restOperations = createRestOperations(beanStore(), resource(), restContext);</span>
<span class="source-line-no">3633</span><span id="line-3633">         return restOperations;</span>
<span class="source-line-no">3634</span><span id="line-3634">      }</span>
<span class="source-line-no">3635</span><span id="line-3635"></span>
<span class="source-line-no">3636</span><span id="line-3636">      /**</span>
<span class="source-line-no">3637</span><span id="line-3637">       * Instantiates the REST operations list.</span>
<span class="source-line-no">3638</span><span id="line-3638">       *</span>
<span class="source-line-no">3639</span><span id="line-3639">       * &lt;p&gt;</span>
<span class="source-line-no">3640</span><span id="line-3640">       * The set of {@link RestOpContext} objects that represent the methods on this resource.</span>
<span class="source-line-no">3641</span><span id="line-3641">       *</span>
<span class="source-line-no">3642</span><span id="line-3642">       * @param restContext The rest context.</span>
<span class="source-line-no">3643</span><span id="line-3643">       * @param beanStore</span>
<span class="source-line-no">3644</span><span id="line-3644">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3645</span><span id="line-3645">       * @param resource</span>
<span class="source-line-no">3646</span><span id="line-3646">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3647</span><span id="line-3647">       * @return A new REST operations list.</span>
<span class="source-line-no">3648</span><span id="line-3648">       * @throws ServletException If a problem occurred instantiating one of the child rest contexts.</span>
<span class="source-line-no">3649</span><span id="line-3649">       */</span>
<span class="source-line-no">3650</span><span id="line-3650">      protected RestOperations.Builder createRestOperations(BeanStore beanStore, Supplier&lt;?&gt; resource, RestContext restContext) throws ServletException {</span>
<span class="source-line-no">3651</span><span id="line-3651"></span>
<span class="source-line-no">3652</span><span id="line-3652">         // Default value.</span>
<span class="source-line-no">3653</span><span id="line-3653">         Value&lt;RestOperations.Builder&gt; v = Value.of(</span>
<span class="source-line-no">3654</span><span id="line-3654">            RestOperations.create(beanStore)</span>
<span class="source-line-no">3655</span><span id="line-3655">         );</span>
<span class="source-line-no">3656</span><span id="line-3656"></span>
<span class="source-line-no">3657</span><span id="line-3657">         ClassInfo rci = ClassInfo.of(resource.get());</span>
<span class="source-line-no">3658</span><span id="line-3658"></span>
<span class="source-line-no">3659</span><span id="line-3659">         Map&lt;String,MethodInfo&gt; initMap = map();</span>
<span class="source-line-no">3660</span><span id="line-3660">         ClassInfo.ofProxy(resource.get()).forEachAllMethodParentFirst(</span>
<span class="source-line-no">3661</span><span id="line-3661">            y -&gt; y.hasAnnotation(RestInit.class) &amp;&amp; y.hasArg(RestOpContext.Builder.class),</span>
<span class="source-line-no">3662</span><span id="line-3662">            y -&gt; {</span>
<span class="source-line-no">3663</span><span id="line-3663">               String sig = y.getSignature();</span>
<span class="source-line-no">3664</span><span id="line-3664">               if (! initMap.containsKey(sig))</span>
<span class="source-line-no">3665</span><span id="line-3665">                  initMap.put(sig, y.accessible());</span>
<span class="source-line-no">3666</span><span id="line-3666">            }</span>
<span class="source-line-no">3667</span><span id="line-3667">         );</span>
<span class="source-line-no">3668</span><span id="line-3668"></span>
<span class="source-line-no">3669</span><span id="line-3669">         for (MethodInfo mi : rci.getPublicMethods()) {</span>
<span class="source-line-no">3670</span><span id="line-3670">            AnnotationList al = mi.getAnnotationList(REST_OP_GROUP);</span>
<span class="source-line-no">3671</span><span id="line-3671"></span>
<span class="source-line-no">3672</span><span id="line-3672">            // Also include methods on @Rest-annotated interfaces.</span>
<span class="source-line-no">3673</span><span id="line-3673">            if (al.isEmpty()) {</span>
<span class="source-line-no">3674</span><span id="line-3674">               Predicate&lt;MethodInfo&gt; isRestAnnotatedInterface = x -&gt; x.getDeclaringClass().isInterface() &amp;&amp; x.getDeclaringClass().getAnnotation(Rest.class) != null;</span>
<span class="source-line-no">3675</span><span id="line-3675">               mi.forEachMatching(isRestAnnotatedInterface, x -&gt; al.add(AnnotationInfo.of(x, RestOpAnnotation.DEFAULT)));</span>
<span class="source-line-no">3676</span><span id="line-3676">            }</span>
<span class="source-line-no">3677</span><span id="line-3677"></span>
<span class="source-line-no">3678</span><span id="line-3678">            if (al.size() &gt; 0) {</span>
<span class="source-line-no">3679</span><span id="line-3679">               try {</span>
<span class="source-line-no">3680</span><span id="line-3680">                  if (mi.isNotPublic())</span>
<span class="source-line-no">3681</span><span id="line-3681">                     throw servletException("@RestOp method {0}.{1} must be defined as public.", rci.inner().getName(), mi.getSimpleName());</span>
<span class="source-line-no">3682</span><span id="line-3682"></span>
<span class="source-line-no">3683</span><span id="line-3683">                  RestOpContext.Builder rocb = RestOpContext</span>
<span class="source-line-no">3684</span><span id="line-3684">                     .create(mi.inner(), restContext)</span>
<span class="source-line-no">3685</span><span id="line-3685">                     .beanStore(beanStore)</span>
<span class="source-line-no">3686</span><span id="line-3686">                     .type(opContextClass);</span>
<span class="source-line-no">3687</span><span id="line-3687"></span>
<span class="source-line-no">3688</span><span id="line-3688">                  beanStore = BeanStore.of(beanStore, resource.get()).addBean(RestOpContext.Builder.class, rocb);</span>
<span class="source-line-no">3689</span><span id="line-3689">                  for (MethodInfo m : initMap.values()) {</span>
<span class="source-line-no">3690</span><span id="line-3690">                     if (! beanStore.hasAllParams(m)) {</span>
<span class="source-line-no">3691</span><span id="line-3691">                        throw servletException("Could not call @RestInit method {0}.{1}.  Could not find prerequisites: {2}.", m.getDeclaringClass().getSimpleName(), m.getSignature(), beanStore.getMissingParams(m));</span>
<span class="source-line-no">3692</span><span id="line-3692">                     }</span>
<span class="source-line-no">3693</span><span id="line-3693">                     try {</span>
<span class="source-line-no">3694</span><span id="line-3694">                        m.invoke(resource.get(), beanStore.getParams(m));</span>
<span class="source-line-no">3695</span><span id="line-3695">                     } catch (Exception e) {</span>
<span class="source-line-no">3696</span><span id="line-3696">                        throw servletException(e, "Exception thrown from @RestInit method {0}.{1}.", m.getDeclaringClass().getSimpleName(), m.getSignature());</span>
<span class="source-line-no">3697</span><span id="line-3697">                     }</span>
<span class="source-line-no">3698</span><span id="line-3698">                  }</span>
<span class="source-line-no">3699</span><span id="line-3699"></span>
<span class="source-line-no">3700</span><span id="line-3700">                  RestOpContext roc = rocb.build();</span>
<span class="source-line-no">3701</span><span id="line-3701"></span>
<span class="source-line-no">3702</span><span id="line-3702">                  String httpMethod = roc.getHttpMethod();</span>
<span class="source-line-no">3703</span><span id="line-3703"></span>
<span class="source-line-no">3704</span><span id="line-3704">                  // RRPC is a special case where a method returns an interface that we</span>
<span class="source-line-no">3705</span><span id="line-3705">                  // can perform REST calls against.</span>
<span class="source-line-no">3706</span><span id="line-3706">                  // We override the CallMethod.invoke() method to insert our logic.</span>
<span class="source-line-no">3707</span><span id="line-3707">                  if ("RRPC".equals(httpMethod)) {</span>
<span class="source-line-no">3708</span><span id="line-3708"></span>
<span class="source-line-no">3709</span><span id="line-3709">                     RestOpContext roc2 = RestOpContext</span>
<span class="source-line-no">3710</span><span id="line-3710">                        .create(mi.inner(), restContext)</span>
<span class="source-line-no">3711</span><span id="line-3711">                        .dotAll()</span>
<span class="source-line-no">3712</span><span id="line-3712">                        .beanStore(restContext.getRootBeanStore())</span>
<span class="source-line-no">3713</span><span id="line-3713">                        .type(RrpcRestOpContext.class)</span>
<span class="source-line-no">3714</span><span id="line-3714">                        .build();</span>
<span class="source-line-no">3715</span><span id="line-3715">                     v.get()</span>
<span class="source-line-no">3716</span><span id="line-3716">                        .add("GET", roc2)</span>
<span class="source-line-no">3717</span><span id="line-3717">                        .add("POST", roc2);</span>
<span class="source-line-no">3718</span><span id="line-3718"></span>
<span class="source-line-no">3719</span><span id="line-3719">                  } else {</span>
<span class="source-line-no">3720</span><span id="line-3720">                     v.get().add(roc);</span>
<span class="source-line-no">3721</span><span id="line-3721">                  }</span>
<span class="source-line-no">3722</span><span id="line-3722">               } catch (Throwable e) {</span>
<span class="source-line-no">3723</span><span id="line-3723">                  throw servletException(e, "Problem occurred trying to initialize methods on class {0}", rci.inner().getName());</span>
<span class="source-line-no">3724</span><span id="line-3724">               }</span>
<span class="source-line-no">3725</span><span id="line-3725">            }</span>
<span class="source-line-no">3726</span><span id="line-3726">         }</span>
<span class="source-line-no">3727</span><span id="line-3727"></span>
<span class="source-line-no">3728</span><span id="line-3728">         // Replace with bean from:  @RestInject public [static] RestOperations xxx(&lt;args&gt;)</span>
<span class="source-line-no">3729</span><span id="line-3729">         beanStore</span>
<span class="source-line-no">3730</span><span id="line-3730">            .createMethodFinder(RestOperations.class)</span>
<span class="source-line-no">3731</span><span id="line-3731">            .addBean(RestOperations.Builder.class, v.get())</span>
<span class="source-line-no">3732</span><span id="line-3732">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">3733</span><span id="line-3733">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">3734</span><span id="line-3734"></span>
<span class="source-line-no">3735</span><span id="line-3735">         return v.get();</span>
<span class="source-line-no">3736</span><span id="line-3736">      }</span>
<span class="source-line-no">3737</span><span id="line-3737"></span>
<span class="source-line-no">3738</span><span id="line-3738">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3739</span><span id="line-3739">      // restChildren</span>
<span class="source-line-no">3740</span><span id="line-3740">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3741</span><span id="line-3741"></span>
<span class="source-line-no">3742</span><span id="line-3742">      /**</span>
<span class="source-line-no">3743</span><span id="line-3743">       * Returns the REST children list.</span>
<span class="source-line-no">3744</span><span id="line-3744">       *</span>
<span class="source-line-no">3745</span><span id="line-3745">       * @param restContext The rest context.</span>
<span class="source-line-no">3746</span><span id="line-3746">       * @return The REST children list.</span>
<span class="source-line-no">3747</span><span id="line-3747">       * @throws Exception If a problem occurred instantiating one of the child rest contexts.</span>
<span class="source-line-no">3748</span><span id="line-3748">       */</span>
<span class="source-line-no">3749</span><span id="line-3749">      public RestChildren.Builder restChildren(RestContext restContext) throws Exception {</span>
<span class="source-line-no">3750</span><span id="line-3750">         if (restChildren == null)</span>
<span class="source-line-no">3751</span><span id="line-3751">            restChildren = createRestChildren(beanStore(), resource(), restContext);</span>
<span class="source-line-no">3752</span><span id="line-3752">         return restChildren;</span>
<span class="source-line-no">3753</span><span id="line-3753">      }</span>
<span class="source-line-no">3754</span><span id="line-3754"></span>
<span class="source-line-no">3755</span><span id="line-3755">      /**</span>
<span class="source-line-no">3756</span><span id="line-3756">       * Instantiates the REST children list.</span>
<span class="source-line-no">3757</span><span id="line-3757">       *</span>
<span class="source-line-no">3758</span><span id="line-3758">       * @param restContext The rest context.</span>
<span class="source-line-no">3759</span><span id="line-3759">       * @param beanStore</span>
<span class="source-line-no">3760</span><span id="line-3760">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3761</span><span id="line-3761">       * @param resource</span>
<span class="source-line-no">3762</span><span id="line-3762">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3763</span><span id="line-3763">       * @return A new REST children list.</span>
<span class="source-line-no">3764</span><span id="line-3764">       * @throws Exception If a problem occurred instantiating one of the child rest contexts.</span>
<span class="source-line-no">3765</span><span id="line-3765">       */</span>
<span class="source-line-no">3766</span><span id="line-3766">      protected RestChildren.Builder createRestChildren(BeanStore beanStore, Supplier&lt;?&gt; resource, RestContext restContext) throws Exception {</span>
<span class="source-line-no">3767</span><span id="line-3767"></span>
<span class="source-line-no">3768</span><span id="line-3768">         // Default value.</span>
<span class="source-line-no">3769</span><span id="line-3769">         Value&lt;RestChildren.Builder&gt; v = Value.of(</span>
<span class="source-line-no">3770</span><span id="line-3770">            RestChildren</span>
<span class="source-line-no">3771</span><span id="line-3771">               .create(beanStore)</span>
<span class="source-line-no">3772</span><span id="line-3772">               .type(childrenClass)</span>
<span class="source-line-no">3773</span><span id="line-3773">            );</span>
<span class="source-line-no">3774</span><span id="line-3774"></span>
<span class="source-line-no">3775</span><span id="line-3775">         // Initialize our child resources.</span>
<span class="source-line-no">3776</span><span id="line-3776">         for (Object o : children) {</span>
<span class="source-line-no">3777</span><span id="line-3777">            String path = null;</span>
<span class="source-line-no">3778</span><span id="line-3778">            Supplier&lt;?&gt; so;</span>
<span class="source-line-no">3779</span><span id="line-3779"></span>
<span class="source-line-no">3780</span><span id="line-3780">            if (o instanceof RestChild) {</span>
<span class="source-line-no">3781</span><span id="line-3781">               RestChild rc = (RestChild)o;</span>
<span class="source-line-no">3782</span><span id="line-3782">               path = rc.path;</span>
<span class="source-line-no">3783</span><span id="line-3783">               Object o2 = rc.resource;</span>
<span class="source-line-no">3784</span><span id="line-3784">               so = ()-&gt;o2;</span>
<span class="source-line-no">3785</span><span id="line-3785">            }</span>
<span class="source-line-no">3786</span><span id="line-3786"></span>
<span class="source-line-no">3787</span><span id="line-3787">            Builder cb = null;</span>
<span class="source-line-no">3788</span><span id="line-3788"></span>
<span class="source-line-no">3789</span><span id="line-3789">            if (o instanceof Class) {</span>
<span class="source-line-no">3790</span><span id="line-3790">               Class&lt;?&gt; oc = (Class&lt;?&gt;)o;</span>
<span class="source-line-no">3791</span><span id="line-3791">               // Don't allow specifying yourself as a child.  Causes an infinite loop.</span>
<span class="source-line-no">3792</span><span id="line-3792">               if (oc == resourceClass)</span>
<span class="source-line-no">3793</span><span id="line-3793">                  continue;</span>
<span class="source-line-no">3794</span><span id="line-3794">               cb = RestContext.create(oc, restContext, inner);</span>
<span class="source-line-no">3795</span><span id="line-3795">               if (beanStore.getBean(oc).isPresent()) {</span>
<span class="source-line-no">3796</span><span id="line-3796">                  so = ()-&gt;beanStore.getBean(oc).get();  // If we resolved via injection, always get it this way.</span>
<span class="source-line-no">3797</span><span id="line-3797">               } else {</span>
<span class="source-line-no">3798</span><span id="line-3798">                  Object o2 = beanStore.createBean(oc).builder(RestContext.Builder.class, cb).run();</span>
<span class="source-line-no">3799</span><span id="line-3799">                  so = ()-&gt;o2;</span>
<span class="source-line-no">3800</span><span id="line-3800">               }</span>
<span class="source-line-no">3801</span><span id="line-3801">            } else {</span>
<span class="source-line-no">3802</span><span id="line-3802">               cb = RestContext.create(o.getClass(), restContext, inner);</span>
<span class="source-line-no">3803</span><span id="line-3803">               so = ()-&gt;o;</span>
<span class="source-line-no">3804</span><span id="line-3804">            }</span>
<span class="source-line-no">3805</span><span id="line-3805"></span>
<span class="source-line-no">3806</span><span id="line-3806">            if (path != null)</span>
<span class="source-line-no">3807</span><span id="line-3807">               cb.path(path);</span>
<span class="source-line-no">3808</span><span id="line-3808"></span>
<span class="source-line-no">3809</span><span id="line-3809">            RestContext cc = cb.init(so).build();</span>
<span class="source-line-no">3810</span><span id="line-3810"></span>
<span class="source-line-no">3811</span><span id="line-3811">            MethodInfo mi = ClassInfo.of(so.get()).getMethod(</span>
<span class="source-line-no">3812</span><span id="line-3812">               x -&gt; x.hasName("setContext")</span>
<span class="source-line-no">3813</span><span id="line-3813">               &amp;&amp; x.hasParamTypes(RestContext.class)</span>
<span class="source-line-no">3814</span><span id="line-3814">            );</span>
<span class="source-line-no">3815</span><span id="line-3815">            if (mi != null)</span>
<span class="source-line-no">3816</span><span id="line-3816">               mi.accessible().invoke(so.get(), cc);</span>
<span class="source-line-no">3817</span><span id="line-3817"></span>
<span class="source-line-no">3818</span><span id="line-3818">            v.get().add(cc);</span>
<span class="source-line-no">3819</span><span id="line-3819">         }</span>
<span class="source-line-no">3820</span><span id="line-3820"></span>
<span class="source-line-no">3821</span><span id="line-3821">         // Replace with bean from:  @RestInject public [static] RestChildren xxx(&lt;args&gt;)</span>
<span class="source-line-no">3822</span><span id="line-3822">         beanStore</span>
<span class="source-line-no">3823</span><span id="line-3823">            .createMethodFinder(RestChildren.class)</span>
<span class="source-line-no">3824</span><span id="line-3824">            .addBean(RestChildren.Builder.class, v.get())</span>
<span class="source-line-no">3825</span><span id="line-3825">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">3826</span><span id="line-3826">            .run(x -&gt; v.get().impl(x));</span>
<span class="source-line-no">3827</span><span id="line-3827"></span>
<span class="source-line-no">3828</span><span id="line-3828">         return v.get();</span>
<span class="source-line-no">3829</span><span id="line-3829">      }</span>
<span class="source-line-no">3830</span><span id="line-3830"></span>
<span class="source-line-no">3831</span><span id="line-3831">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3832</span><span id="line-3832">      // swaggerProvider</span>
<span class="source-line-no">3833</span><span id="line-3833">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3834</span><span id="line-3834"></span>
<span class="source-line-no">3835</span><span id="line-3835">      /**</span>
<span class="source-line-no">3836</span><span id="line-3836">       * Returns the swagger provider sub-builder.</span>
<span class="source-line-no">3837</span><span id="line-3837">       *</span>
<span class="source-line-no">3838</span><span id="line-3838">       * @return The swagger provider sub-builder.</span>
<span class="source-line-no">3839</span><span id="line-3839">       */</span>
<span class="source-line-no">3840</span><span id="line-3840">      public BeanCreator&lt;SwaggerProvider&gt; swaggerProvider() {</span>
<span class="source-line-no">3841</span><span id="line-3841">         if (swaggerProvider == null)</span>
<span class="source-line-no">3842</span><span id="line-3842">            swaggerProvider = createSwaggerProvider(beanStore, resource);</span>
<span class="source-line-no">3843</span><span id="line-3843">         return swaggerProvider;</span>
<span class="source-line-no">3844</span><span id="line-3844">      }</span>
<span class="source-line-no">3845</span><span id="line-3845"></span>
<span class="source-line-no">3846</span><span id="line-3846">      /**</span>
<span class="source-line-no">3847</span><span id="line-3847">       * Specifies the swagger provider for this class.</span>
<span class="source-line-no">3848</span><span id="line-3848">       *</span>
<span class="source-line-no">3849</span><span id="line-3849">       * &lt;p&gt;</span>
<span class="source-line-no">3850</span><span id="line-3850">       * Equivalent to calling:</span>
<span class="source-line-no">3851</span><span id="line-3851">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">3852</span><span id="line-3852">       *    &lt;jv&gt;builder&lt;/jv&gt;.swaggerProvider().type(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">3853</span><span id="line-3853">       * &lt;/p&gt;</span>
<span class="source-line-no">3854</span><span id="line-3854">       *</span>
<span class="source-line-no">3855</span><span id="line-3855">       * @param value The new value.</span>
<span class="source-line-no">3856</span><span id="line-3856">       * @return This object.</span>
<span class="source-line-no">3857</span><span id="line-3857">       */</span>
<span class="source-line-no">3858</span><span id="line-3858">      public Builder swaggerProvider(Class&lt;? extends SwaggerProvider&gt; value) {</span>
<span class="source-line-no">3859</span><span id="line-3859">         swaggerProvider().type(value);</span>
<span class="source-line-no">3860</span><span id="line-3860">         return this;</span>
<span class="source-line-no">3861</span><span id="line-3861">      }</span>
<span class="source-line-no">3862</span><span id="line-3862"></span>
<span class="source-line-no">3863</span><span id="line-3863">      /**</span>
<span class="source-line-no">3864</span><span id="line-3864">       * Specifies the swagger provider for this class.</span>
<span class="source-line-no">3865</span><span id="line-3865">       *</span>
<span class="source-line-no">3866</span><span id="line-3866">       * &lt;p&gt;</span>
<span class="source-line-no">3867</span><span id="line-3867">       * Equivalent to calling:</span>
<span class="source-line-no">3868</span><span id="line-3868">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">3869</span><span id="line-3869">       *    &lt;jv&gt;builder&lt;/jv&gt;.swaggerProvider().impl(&lt;jv&gt;value&lt;/jv&gt;);</span>
<span class="source-line-no">3870</span><span id="line-3870">       * &lt;/p&gt;</span>
<span class="source-line-no">3871</span><span id="line-3871">       *</span>
<span class="source-line-no">3872</span><span id="line-3872">       * @param value The new value.</span>
<span class="source-line-no">3873</span><span id="line-3873">       * @return This object.</span>
<span class="source-line-no">3874</span><span id="line-3874">       */</span>
<span class="source-line-no">3875</span><span id="line-3875">      public Builder swaggerProvider(SwaggerProvider value) {</span>
<span class="source-line-no">3876</span><span id="line-3876">         swaggerProvider().impl(value);</span>
<span class="source-line-no">3877</span><span id="line-3877">         return this;</span>
<span class="source-line-no">3878</span><span id="line-3878">      }</span>
<span class="source-line-no">3879</span><span id="line-3879"></span>
<span class="source-line-no">3880</span><span id="line-3880">      /**</span>
<span class="source-line-no">3881</span><span id="line-3881">       * Instantiates the swagger provider sub-builder.</span>
<span class="source-line-no">3882</span><span id="line-3882">       *</span>
<span class="source-line-no">3883</span><span id="line-3883">       * &lt;p&gt;</span>
<span class="source-line-no">3884</span><span id="line-3884">       * Instantiates based on the following logic:</span>
<span class="source-line-no">3885</span><span id="line-3885">       * &lt;ul&gt;</span>
<span class="source-line-no">3886</span><span id="line-3886">       *    &lt;li&gt;Returns the resource class itself is an instance of {@link SwaggerProvider}.</span>
<span class="source-line-no">3887</span><span id="line-3887">       *    &lt;li&gt;Looks for swagger provider set via any of the following:</span>
<span class="source-line-no">3888</span><span id="line-3888">       *       &lt;ul&gt;</span>
<span class="source-line-no">3889</span><span id="line-3889">       *          &lt;li&gt;{@link RestContext.Builder#swaggerProvider(Class)}/{@link RestContext.Builder#swaggerProvider(SwaggerProvider)}</span>
<span class="source-line-no">3890</span><span id="line-3890">       *          &lt;li&gt;{@link Rest#swaggerProvider()}.</span>
<span class="source-line-no">3891</span><span id="line-3891">       *       &lt;/ul&gt;</span>
<span class="source-line-no">3892</span><span id="line-3892">       *    &lt;li&gt;Looks for a static or non-static &lt;c&gt;createSwaggerProvider()&lt;/c&gt; method that returns {@link SwaggerProvider} on the</span>
<span class="source-line-no">3893</span><span id="line-3893">       *       resource class with any of the following arguments:</span>
<span class="source-line-no">3894</span><span id="line-3894">       *       &lt;ul&gt;</span>
<span class="source-line-no">3895</span><span id="line-3895">       *          &lt;li&gt;{@link RestContext}</span>
<span class="source-line-no">3896</span><span id="line-3896">       *          &lt;li&gt;{@link BeanStore}</span>
<span class="source-line-no">3897</span><span id="line-3897">       *          &lt;li&gt;Any &lt;a class="doclink" href="https://juneau.apache.org/docs/topics/JuneauRestServerSpringbootBasics"&gt;juneau-rest-server-springboot Basics&lt;/a&gt;.</span>
<span class="source-line-no">3898</span><span id="line-3898">       *       &lt;/ul&gt;</span>
<span class="source-line-no">3899</span><span id="line-3899">       *    &lt;li&gt;Resolves it via the bean store registered in this context.</span>
<span class="source-line-no">3900</span><span id="line-3900">       *    &lt;li&gt;Instantiates a default {@link BasicSwaggerProvider}.</span>
<span class="source-line-no">3901</span><span id="line-3901">       * &lt;/ul&gt;</span>
<span class="source-line-no">3902</span><span id="line-3902">       *</span>
<span class="source-line-no">3903</span><span id="line-3903">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">3904</span><span id="line-3904">       *    &lt;li class='jm'&gt;{@link RestContext.Builder#swaggerProvider(Class)}</span>
<span class="source-line-no">3905</span><span id="line-3905">       *    &lt;li class='jm'&gt;{@link RestContext.Builder#swaggerProvider(SwaggerProvider)}</span>
<span class="source-line-no">3906</span><span id="line-3906">       * &lt;/ul&gt;</span>
<span class="source-line-no">3907</span><span id="line-3907">       *</span>
<span class="source-line-no">3908</span><span id="line-3908">       * @param beanStore</span>
<span class="source-line-no">3909</span><span id="line-3909">       *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">3910</span><span id="line-3910">       * @param resource</span>
<span class="source-line-no">3911</span><span id="line-3911">       *    The REST servlet/bean instance that this context is defined against.</span>
<span class="source-line-no">3912</span><span id="line-3912">       * @return A new swagger provider sub-builder.</span>
<span class="source-line-no">3913</span><span id="line-3913">       */</span>
<span class="source-line-no">3914</span><span id="line-3914">      protected BeanCreator&lt;SwaggerProvider&gt; createSwaggerProvider(BeanStore beanStore, Supplier&lt;?&gt; resource) {</span>
<span class="source-line-no">3915</span><span id="line-3915"></span>
<span class="source-line-no">3916</span><span id="line-3916">         BeanCreator&lt;SwaggerProvider&gt; creator = beanStore.createBean(SwaggerProvider.class).type(BasicSwaggerProvider.class);</span>
<span class="source-line-no">3917</span><span id="line-3917"></span>
<span class="source-line-no">3918</span><span id="line-3918">         // Specify the bean type if its set as a default.</span>
<span class="source-line-no">3919</span><span id="line-3919">         defaultClasses()</span>
<span class="source-line-no">3920</span><span id="line-3920">            .get(SwaggerProvider.class)</span>
<span class="source-line-no">3921</span><span id="line-3921">            .ifPresent(x -&gt; creator.type(x));</span>
<span class="source-line-no">3922</span><span id="line-3922"></span>
<span class="source-line-no">3923</span><span id="line-3923">         beanStore</span>
<span class="source-line-no">3924</span><span id="line-3924">            .getBean(SwaggerProvider.class)</span>
<span class="source-line-no">3925</span><span id="line-3925">            .ifPresent(x -&gt; creator.impl(x));</span>
<span class="source-line-no">3926</span><span id="line-3926"></span>
<span class="source-line-no">3927</span><span id="line-3927">         // Replace with bean from:  @RestInject public [static] SwaggerProvider xxx(&lt;args&gt;)</span>
<span class="source-line-no">3928</span><span id="line-3928">         beanStore</span>
<span class="source-line-no">3929</span><span id="line-3929">            .createMethodFinder(SwaggerProvider.class)</span>
<span class="source-line-no">3930</span><span id="line-3930">            .find(Builder::isRestBeanMethod)</span>
<span class="source-line-no">3931</span><span id="line-3931">            .run(x -&gt; creator.impl(x));</span>
<span class="source-line-no">3932</span><span id="line-3932"></span>
<span class="source-line-no">3933</span><span id="line-3933">         return creator;</span>
<span class="source-line-no">3934</span><span id="line-3934">      }</span>
<span class="source-line-no">3935</span><span id="line-3935"></span>
<span class="source-line-no">3936</span><span id="line-3936">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3937</span><span id="line-3937">      // Miscellaneous settings</span>
<span class="source-line-no">3938</span><span id="line-3938">      //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">3939</span><span id="line-3939"></span>
<span class="source-line-no">3940</span><span id="line-3940">      /**</span>
<span class="source-line-no">3941</span><span id="line-3941">       * Allowed header URL parameters.</span>
<span class="source-line-no">3942</span><span id="line-3942">       *</span>
<span class="source-line-no">3943</span><span id="line-3943">       * &lt;p&gt;</span>
<span class="source-line-no">3944</span><span id="line-3944">       * When specified, allows headers such as &lt;js&gt;"Accept"&lt;/js&gt; and &lt;js&gt;"Content-Type"&lt;/js&gt; to be passed in as URL query</span>
<span class="source-line-no">3945</span><span id="line-3945">       * parameters.</span>
<span class="source-line-no">3946</span><span id="line-3946">       * &lt;br&gt;</span>
<span class="source-line-no">3947</span><span id="line-3947">       * For example:</span>
<span class="source-line-no">3948</span><span id="line-3948">       * &lt;p class='burlenc'&gt;</span>
<span class="source-line-no">3949</span><span id="line-3949">       *  ?Accept=text/json&amp;amp;Content-Type=text/json</span>
<span class="source-line-no">3950</span><span id="line-3950">       * &lt;/p&gt;</span>
<span class="source-line-no">3951</span><span id="line-3951">       *</span>
<span class="source-line-no">3952</span><span id="line-3952">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">3953</span><span id="line-3953">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">3954</span><span id="line-3954">       *       Useful for debugging REST interface using only a browser so that you can quickly simulate header values</span>
<span class="source-line-no">3955</span><span id="line-3955">       *       in the URL bar.</span>
<span class="source-line-no">3956</span><span id="line-3956">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">3957</span><span id="line-3957">       *       Header names are case-insensitive.</span>
<span class="source-line-no">3958</span><span id="line-3958">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">3959</span><span id="line-3959">       *       Use &lt;js&gt;"*"&lt;/js&gt; to allow any headers to be specified as URL parameters.</span>
<span class="source-line-no">3960</span><span id="line-3960">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">3961</span><span id="line-3961">       *       Use &lt;js&gt;"NONE"&lt;/js&gt; (case insensitive) to suppress inheriting a value from a parent class.</span>
<span class="source-line-no">3962</span><span id="line-3962">       * &lt;/ul&gt;</span>
<span class="source-line-no">3963</span><span id="line-3963"></span>
<span class="source-line-no">3964</span><span id="line-3964">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">3965</span><span id="line-3965">       *    &lt;li class='ja'&gt;{@link Rest#allowedHeaderParams}</span>
<span class="source-line-no">3966</span><span id="line-3966">       * &lt;/ul&gt;</span>
<span class="source-line-no">3967</span><span id="line-3967">       *</span>
<span class="source-line-no">3968</span><span id="line-3968">       * @param value</span>
<span class="source-line-no">3969</span><span id="line-3969">       *    The new value for this setting.</span>
<span class="source-line-no">3970</span><span id="line-3970">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">3971</span><span id="line-3971">       *    &lt;ul&gt;</span>
<span class="source-line-no">3972</span><span id="line-3972">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.allowedHeaderParams"</span>
<span class="source-line-no">3973</span><span id="line-3973">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_ALLOWEDHEADERPARAMS"</span>
<span class="source-line-no">3974</span><span id="line-3974">       *       &lt;li&gt;&lt;js&gt;"Accept,Content-Type"&lt;/js&gt;</span>
<span class="source-line-no">3975</span><span id="line-3975">       *    &lt;/ul&gt;</span>
<span class="source-line-no">3976</span><span id="line-3976">       * @return This object.</span>
<span class="source-line-no">3977</span><span id="line-3977">       */</span>
<span class="source-line-no">3978</span><span id="line-3978">      @FluentSetter</span>
<span class="source-line-no">3979</span><span id="line-3979">      public Builder allowedHeaderParams(String value) {</span>
<span class="source-line-no">3980</span><span id="line-3980">         allowedHeaderParams = value;</span>
<span class="source-line-no">3981</span><span id="line-3981">         return this;</span>
<span class="source-line-no">3982</span><span id="line-3982">      }</span>
<span class="source-line-no">3983</span><span id="line-3983"></span>
<span class="source-line-no">3984</span><span id="line-3984">      /**</span>
<span class="source-line-no">3985</span><span id="line-3985">       * Allowed method headers.</span>
<span class="source-line-no">3986</span><span id="line-3986">       *</span>
<span class="source-line-no">3987</span><span id="line-3987">       * &lt;p&gt;</span>
<span class="source-line-no">3988</span><span id="line-3988">       * A comma-delimited list of HTTP method names that are allowed to be passed as values in an &lt;c&gt;X-Method&lt;/c&gt; HTTP header</span>
<span class="source-line-no">3989</span><span id="line-3989">       * to override the real HTTP method name.</span>
<span class="source-line-no">3990</span><span id="line-3990">       *</span>
<span class="source-line-no">3991</span><span id="line-3991">       * &lt;p&gt;</span>
<span class="source-line-no">3992</span><span id="line-3992">       * Allows you to override the actual HTTP method with a simulated method.</span>
<span class="source-line-no">3993</span><span id="line-3993">       * &lt;br&gt;For example, if an HTTP Client API doesn't support &lt;c&gt;PATCH&lt;/c&gt; but does support &lt;c&gt;POST&lt;/c&gt; (because</span>
<span class="source-line-no">3994</span><span id="line-3994">       * &lt;c&gt;PATCH&lt;/c&gt; is not part of the original HTTP spec), you can add a &lt;c&gt;X-Method: PATCH&lt;/c&gt; header on a normal</span>
<span class="source-line-no">3995</span><span id="line-3995">       * &lt;c&gt;HTTP POST /foo&lt;/c&gt; request call which will make the HTTP call look like a &lt;c&gt;PATCH&lt;/c&gt; request in any of the REST APIs.</span>
<span class="source-line-no">3996</span><span id="line-3996">       *</span>
<span class="source-line-no">3997</span><span id="line-3997">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">3998</span><span id="line-3998">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">3999</span><span id="line-3999">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4000</span><span id="line-4000">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(allowedMethodHeaders=&lt;js&gt;"PATCH"&lt;/js&gt;)</span>
<span class="source-line-no">4001</span><span id="line-4001">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4002</span><span id="line-4002">       *</span>
<span class="source-line-no">4003</span><span id="line-4003">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4004</span><span id="line-4004">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4005</span><span id="line-4005">       *</span>
<span class="source-line-no">4006</span><span id="line-4006">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4007</span><span id="line-4007">       *          &lt;jv&gt;builder&lt;/jv&gt;.allowedMethodHeaders(&lt;js&gt;"PATCH"&lt;/js&gt;);</span>
<span class="source-line-no">4008</span><span id="line-4008">       *       }</span>
<span class="source-line-no">4009</span><span id="line-4009">       *</span>
<span class="source-line-no">4010</span><span id="line-4010">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4011</span><span id="line-4011">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4012</span><span id="line-4012">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4013</span><span id="line-4013">       *          &lt;jv&gt;builder&lt;/jv&gt;.allowedMethodHeaders(&lt;js&gt;"PATCH"&lt;/js&gt;);</span>
<span class="source-line-no">4014</span><span id="line-4014">       *       }</span>
<span class="source-line-no">4015</span><span id="line-4015">       *    }</span>
<span class="source-line-no">4016</span><span id="line-4016">       * &lt;/p&gt;</span>
<span class="source-line-no">4017</span><span id="line-4017">       *</span>
<span class="source-line-no">4018</span><span id="line-4018">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4019</span><span id="line-4019">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4020</span><span id="line-4020">       *       Method names are case-insensitive.</span>
<span class="source-line-no">4021</span><span id="line-4021">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4022</span><span id="line-4022">       *       Use &lt;js&gt;"*"&lt;/js&gt; to represent all methods.</span>
<span class="source-line-no">4023</span><span id="line-4023">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4024</span><span id="line-4024">       *       Use &lt;js&gt;"NONE"&lt;/js&gt; (case insensitive) to suppress inheriting a value from a parent class.</span>
<span class="source-line-no">4025</span><span id="line-4025">       * &lt;/ul&gt;</span>
<span class="source-line-no">4026</span><span id="line-4026">       *</span>
<span class="source-line-no">4027</span><span id="line-4027">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4028</span><span id="line-4028">       *    &lt;li class='ja'&gt;{@link Rest#allowedMethodHeaders}</span>
<span class="source-line-no">4029</span><span id="line-4029">       * &lt;/ul&gt;</span>
<span class="source-line-no">4030</span><span id="line-4030">       *</span>
<span class="source-line-no">4031</span><span id="line-4031">       * @param value</span>
<span class="source-line-no">4032</span><span id="line-4032">       *    The new value for this setting.</span>
<span class="source-line-no">4033</span><span id="line-4033">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4034</span><span id="line-4034">       *    &lt;ul&gt;</span>
<span class="source-line-no">4035</span><span id="line-4035">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.allowedMethodHeaders"</span>
<span class="source-line-no">4036</span><span id="line-4036">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_ALLOWEDMETHODHEADERS"</span>
<span class="source-line-no">4037</span><span id="line-4037">       *       &lt;li&gt;&lt;js&gt;""&lt;/js&gt;</span>
<span class="source-line-no">4038</span><span id="line-4038">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4039</span><span id="line-4039">       * @return This object.</span>
<span class="source-line-no">4040</span><span id="line-4040">       */</span>
<span class="source-line-no">4041</span><span id="line-4041">      @FluentSetter</span>
<span class="source-line-no">4042</span><span id="line-4042">      public Builder allowedMethodHeaders(String value) {</span>
<span class="source-line-no">4043</span><span id="line-4043">         allowedMethodHeaders = value;</span>
<span class="source-line-no">4044</span><span id="line-4044">         return this;</span>
<span class="source-line-no">4045</span><span id="line-4045">      }</span>
<span class="source-line-no">4046</span><span id="line-4046"></span>
<span class="source-line-no">4047</span><span id="line-4047">      /**</span>
<span class="source-line-no">4048</span><span id="line-4048">       * Allowed method parameters.</span>
<span class="source-line-no">4049</span><span id="line-4049">       *</span>
<span class="source-line-no">4050</span><span id="line-4050">       * &lt;p&gt;</span>
<span class="source-line-no">4051</span><span id="line-4051">       * When specified, the HTTP method can be overridden by passing in a &lt;js&gt;"method"&lt;/js&gt; URL parameter on a regular</span>
<span class="source-line-no">4052</span><span id="line-4052">       * GET request.</span>
<span class="source-line-no">4053</span><span id="line-4053">       * &lt;br&gt;</span>
<span class="source-line-no">4054</span><span id="line-4054">       * For example:</span>
<span class="source-line-no">4055</span><span id="line-4055">       * &lt;p class='burlenc'&gt;</span>
<span class="source-line-no">4056</span><span id="line-4056">       *  ?method=OPTIONS</span>
<span class="source-line-no">4057</span><span id="line-4057">       * &lt;/p&gt;</span>
<span class="source-line-no">4058</span><span id="line-4058">       *</span>
<span class="source-line-no">4059</span><span id="line-4059">       * &lt;p&gt;</span>
<span class="source-line-no">4060</span><span id="line-4060">       *    Useful in cases where you want to simulate a non-GET request in a browser by simply adding a parameter.</span>
<span class="source-line-no">4061</span><span id="line-4061">       *    &lt;br&gt;Also useful if you want to construct hyperlinks to non-GET REST endpoints such as links to &lt;c&gt;OPTIONS&lt;/c&gt;</span>
<span class="source-line-no">4062</span><span id="line-4062">       * pages.</span>
<span class="source-line-no">4063</span><span id="line-4063">       *</span>
<span class="source-line-no">4064</span><span id="line-4064">       * &lt;p&gt;</span>
<span class="source-line-no">4065</span><span id="line-4065">       * Note that per the &lt;a class="doclink" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html"&gt;HTTP specification&lt;/a&gt;, special care should</span>
<span class="source-line-no">4066</span><span id="line-4066">       * be taken when allowing non-safe (&lt;c&gt;POST&lt;/c&gt;, &lt;c&gt;PUT&lt;/c&gt;, &lt;c&gt;DELETE&lt;/c&gt;) methods to be invoked through GET requests.</span>
<span class="source-line-no">4067</span><span id="line-4067">       *</span>
<span class="source-line-no">4068</span><span id="line-4068">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4069</span><span id="line-4069">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4070</span><span id="line-4070">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">4071</span><span id="line-4071">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(allowedMethodParams=&lt;js&gt;"HEAD,OPTIONS,PUT"&lt;/js&gt;)</span>
<span class="source-line-no">4072</span><span id="line-4072">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4073</span><span id="line-4073">       *</span>
<span class="source-line-no">4074</span><span id="line-4074">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4075</span><span id="line-4075">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4076</span><span id="line-4076">       *</span>
<span class="source-line-no">4077</span><span id="line-4077">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4078</span><span id="line-4078">       *          &lt;jv&gt;builder&lt;/jv&gt;.allowedMethodParams(&lt;js&gt;"HEAD,OPTIONS,PUT"&lt;/js&gt;);</span>
<span class="source-line-no">4079</span><span id="line-4079">       *       }</span>
<span class="source-line-no">4080</span><span id="line-4080">       *</span>
<span class="source-line-no">4081</span><span id="line-4081">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4082</span><span id="line-4082">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4083</span><span id="line-4083">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder builder) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4084</span><span id="line-4084">       *          &lt;jv&gt;builder&lt;/jv&gt;.allowedMethodParams(&lt;js&gt;"HEAD,OPTIONS,PUT"&lt;/js&gt;);</span>
<span class="source-line-no">4085</span><span id="line-4085">       *       }</span>
<span class="source-line-no">4086</span><span id="line-4086">       *    }</span>
<span class="source-line-no">4087</span><span id="line-4087">       * &lt;/p&gt;</span>
<span class="source-line-no">4088</span><span id="line-4088">       *</span>
<span class="source-line-no">4089</span><span id="line-4089">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4090</span><span id="line-4090">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4091</span><span id="line-4091">       *       Format is a comma-delimited list of HTTP method names that can be passed in as a method parameter.</span>
<span class="source-line-no">4092</span><span id="line-4092">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4093</span><span id="line-4093">       *       &lt;js&gt;'method'&lt;/js&gt; parameter name is case-insensitive.</span>
<span class="source-line-no">4094</span><span id="line-4094">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4095</span><span id="line-4095">       *       Use &lt;js&gt;"*"&lt;/js&gt; to represent all methods.</span>
<span class="source-line-no">4096</span><span id="line-4096">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4097</span><span id="line-4097">       *       Use &lt;js&gt;"NONE"&lt;/js&gt; (case insensitive) to suppress inheriting a value from a parent class.</span>
<span class="source-line-no">4098</span><span id="line-4098">       * &lt;/ul&gt;</span>
<span class="source-line-no">4099</span><span id="line-4099">       *</span>
<span class="source-line-no">4100</span><span id="line-4100">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4101</span><span id="line-4101">       *    &lt;li class='ja'&gt;{@link Rest#allowedMethodParams}</span>
<span class="source-line-no">4102</span><span id="line-4102">       * &lt;/ul&gt;</span>
<span class="source-line-no">4103</span><span id="line-4103">       *</span>
<span class="source-line-no">4104</span><span id="line-4104">       * @param value</span>
<span class="source-line-no">4105</span><span id="line-4105">       *    The new value for this setting.</span>
<span class="source-line-no">4106</span><span id="line-4106">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4107</span><span id="line-4107">       *    &lt;ul&gt;</span>
<span class="source-line-no">4108</span><span id="line-4108">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.allowedMethodParams"</span>
<span class="source-line-no">4109</span><span id="line-4109">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_ALLOWEDMETHODPARAMS"</span>
<span class="source-line-no">4110</span><span id="line-4110">       *       &lt;li&gt;&lt;js&gt;"HEAD,OPTIONS"&lt;/js&gt;</span>
<span class="source-line-no">4111</span><span id="line-4111">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4112</span><span id="line-4112">       * @return This object.</span>
<span class="source-line-no">4113</span><span id="line-4113">       */</span>
<span class="source-line-no">4114</span><span id="line-4114">      @FluentSetter</span>
<span class="source-line-no">4115</span><span id="line-4115">      public Builder allowedMethodParams(String value) {</span>
<span class="source-line-no">4116</span><span id="line-4116">         allowedMethodParams = value;</span>
<span class="source-line-no">4117</span><span id="line-4117">         return this;</span>
<span class="source-line-no">4118</span><span id="line-4118">      }</span>
<span class="source-line-no">4119</span><span id="line-4119"></span>
<span class="source-line-no">4120</span><span id="line-4120">      /**</span>
<span class="source-line-no">4121</span><span id="line-4121">       * Client version header.</span>
<span class="source-line-no">4122</span><span id="line-4122">       *</span>
<span class="source-line-no">4123</span><span id="line-4123">       * &lt;p&gt;</span>
<span class="source-line-no">4124</span><span id="line-4124">       * Specifies the name of the header used to denote the client version on HTTP requests.</span>
<span class="source-line-no">4125</span><span id="line-4125">       *</span>
<span class="source-line-no">4126</span><span id="line-4126">       * &lt;p&gt;</span>
<span class="source-line-no">4127</span><span id="line-4127">       * The client version is used to support backwards compatibility for breaking REST interface changes.</span>
<span class="source-line-no">4128</span><span id="line-4128">       * &lt;br&gt;Used in conjunction with {@link RestOp#clientVersion() @RestOp(clientVersion)} annotation.</span>
<span class="source-line-no">4129</span><span id="line-4129">       *</span>
<span class="source-line-no">4130</span><span id="line-4130">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4131</span><span id="line-4131">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4132</span><span id="line-4132">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4133</span><span id="line-4133">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(clientVersionHeader=&lt;js&gt;"$C{REST/clientVersionHeader,Client-Version}"&lt;/js&gt;)</span>
<span class="source-line-no">4134</span><span id="line-4134">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4135</span><span id="line-4135">       *</span>
<span class="source-line-no">4136</span><span id="line-4136">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4137</span><span id="line-4137">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4138</span><span id="line-4138">       *</span>
<span class="source-line-no">4139</span><span id="line-4139">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4140</span><span id="line-4140">       *          &lt;jv&gt;builder&lt;/jv&gt;.clientVersionHeader(&lt;js&gt;"Client-Version"&lt;/js&gt;);</span>
<span class="source-line-no">4141</span><span id="line-4141">       *       }</span>
<span class="source-line-no">4142</span><span id="line-4142">       *</span>
<span class="source-line-no">4143</span><span id="line-4143">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4144</span><span id="line-4144">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4145</span><span id="line-4145">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4146</span><span id="line-4146">       *          &lt;jv&gt;builder&lt;/jv&gt;.clientVersionHeader(&lt;js&gt;"Client-Version"&lt;/js&gt;);</span>
<span class="source-line-no">4147</span><span id="line-4147">       *       }</span>
<span class="source-line-no">4148</span><span id="line-4148">       *    }</span>
<span class="source-line-no">4149</span><span id="line-4149">       * &lt;/p&gt;</span>
<span class="source-line-no">4150</span><span id="line-4150">       *</span>
<span class="source-line-no">4151</span><span id="line-4151">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4152</span><span id="line-4152">       *    &lt;jc&gt;// Call this method if Client-Version is at least 2.0.</span>
<span class="source-line-no">4153</span><span id="line-4153">       *    // Note that this also matches 2.0.1.&lt;/jc&gt;</span>
<span class="source-line-no">4154</span><span id="line-4154">       *    &lt;ja&gt;@RestGet&lt;/ja&gt;(path=&lt;js&gt;"/foobar"&lt;/js&gt;, clientVersion=&lt;js&gt;"2.0"&lt;/js&gt;)</span>
<span class="source-line-no">4155</span><span id="line-4155">       *    &lt;jk&gt;public&lt;/jk&gt; Object method1() {</span>
<span class="source-line-no">4156</span><span id="line-4156">       *       ...</span>
<span class="source-line-no">4157</span><span id="line-4157">       *    }</span>
<span class="source-line-no">4158</span><span id="line-4158">       *</span>
<span class="source-line-no">4159</span><span id="line-4159">       *    &lt;jc&gt;// Call this method if Client-Version is at least 1.1, but less than 2.0.&lt;/jc&gt;</span>
<span class="source-line-no">4160</span><span id="line-4160">       *    &lt;ja&gt;@RestGet&lt;/ja&gt;(path=&lt;js&gt;"/foobar"&lt;/js&gt;, clientVersion=&lt;js&gt;"[1.1,2.0)"&lt;/js&gt;)</span>
<span class="source-line-no">4161</span><span id="line-4161">       *    &lt;jk&gt;public&lt;/jk&gt; Object method2() {</span>
<span class="source-line-no">4162</span><span id="line-4162">       *       ...</span>
<span class="source-line-no">4163</span><span id="line-4163">       *    }</span>
<span class="source-line-no">4164</span><span id="line-4164">       *</span>
<span class="source-line-no">4165</span><span id="line-4165">       *    &lt;jc&gt;// Call this method if Client-Version is less than 1.1.&lt;/jc&gt;</span>
<span class="source-line-no">4166</span><span id="line-4166">       *    &lt;ja&gt;@RestGet&lt;/ja&gt;(path=&lt;js&gt;"/foobar"&lt;/js&gt;, clientVersion=&lt;js&gt;"[0,1.1)"&lt;/js&gt;)</span>
<span class="source-line-no">4167</span><span id="line-4167">       *    &lt;jk&gt;public&lt;/jk&gt; Object method3() {</span>
<span class="source-line-no">4168</span><span id="line-4168">       *       ...</span>
<span class="source-line-no">4169</span><span id="line-4169">       *    }</span>
<span class="source-line-no">4170</span><span id="line-4170">       * &lt;/p&gt;</span>
<span class="source-line-no">4171</span><span id="line-4171">       *</span>
<span class="source-line-no">4172</span><span id="line-4172">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4173</span><span id="line-4173">       *    &lt;li class='ja'&gt;{@link Rest#clientVersionHeader}</span>
<span class="source-line-no">4174</span><span id="line-4174">       * &lt;/ul&gt;</span>
<span class="source-line-no">4175</span><span id="line-4175">       *</span>
<span class="source-line-no">4176</span><span id="line-4176">       * @param value</span>
<span class="source-line-no">4177</span><span id="line-4177">       *    The new value for this setting.</span>
<span class="source-line-no">4178</span><span id="line-4178">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4179</span><span id="line-4179">       *    &lt;ul&gt;</span>
<span class="source-line-no">4180</span><span id="line-4180">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.clientVersionHeader"</span>
<span class="source-line-no">4181</span><span id="line-4181">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_CLIENTVERSIONHEADER"</span>
<span class="source-line-no">4182</span><span id="line-4182">       *       &lt;li&gt;&lt;js&gt;"Client-Version"&lt;/js&gt;</span>
<span class="source-line-no">4183</span><span id="line-4183">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4184</span><span id="line-4184">       * @return This object.</span>
<span class="source-line-no">4185</span><span id="line-4185">       */</span>
<span class="source-line-no">4186</span><span id="line-4186">      @FluentSetter</span>
<span class="source-line-no">4187</span><span id="line-4187">      public Builder clientVersionHeader(String value) {</span>
<span class="source-line-no">4188</span><span id="line-4188">         clientVersionHeader = value;</span>
<span class="source-line-no">4189</span><span id="line-4189">         return this;</span>
<span class="source-line-no">4190</span><span id="line-4190">      }</span>
<span class="source-line-no">4191</span><span id="line-4191"></span>
<span class="source-line-no">4192</span><span id="line-4192">      /**</span>
<span class="source-line-no">4193</span><span id="line-4193">       * Default character encoding.</span>
<span class="source-line-no">4194</span><span id="line-4194">       *</span>
<span class="source-line-no">4195</span><span id="line-4195">       * &lt;p&gt;</span>
<span class="source-line-no">4196</span><span id="line-4196">       * The default character encoding for the request and response if not specified on the request.</span>
<span class="source-line-no">4197</span><span id="line-4197">       *</span>
<span class="source-line-no">4198</span><span id="line-4198">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4199</span><span id="line-4199">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4200</span><span id="line-4200">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4201</span><span id="line-4201">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(defaultCharset=&lt;js&gt;"$C{REST/defaultCharset,US-ASCII}"&lt;/js&gt;)</span>
<span class="source-line-no">4202</span><span id="line-4202">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4203</span><span id="line-4203">       *</span>
<span class="source-line-no">4204</span><span id="line-4204">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4205</span><span id="line-4205">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4206</span><span id="line-4206">       *</span>
<span class="source-line-no">4207</span><span id="line-4207">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4208</span><span id="line-4208">       *          &lt;jv&gt;builder&lt;/jv&gt;.defaultCharset(&lt;js&gt;"US-ASCII"&lt;/js&gt;);</span>
<span class="source-line-no">4209</span><span id="line-4209">       *       }</span>
<span class="source-line-no">4210</span><span id="line-4210">       *</span>
<span class="source-line-no">4211</span><span id="line-4211">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4212</span><span id="line-4212">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4213</span><span id="line-4213">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4214</span><span id="line-4214">       *          &lt;jv&gt;builder&lt;/jv&gt;.defaultCharset(&lt;js&gt;"US-ASCII"&lt;/js&gt;);</span>
<span class="source-line-no">4215</span><span id="line-4215">       *       }</span>
<span class="source-line-no">4216</span><span id="line-4216">       *</span>
<span class="source-line-no">4217</span><span id="line-4217">       *       &lt;jc&gt;// Override at the method level.&lt;/jc&gt;</span>
<span class="source-line-no">4218</span><span id="line-4218">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;(defaultCharset=&lt;js&gt;"UTF-16"&lt;/js&gt;)</span>
<span class="source-line-no">4219</span><span id="line-4219">       *       &lt;jk&gt;public&lt;/jk&gt; Object myMethod() {...}</span>
<span class="source-line-no">4220</span><span id="line-4220">       *    }</span>
<span class="source-line-no">4221</span><span id="line-4221">       * &lt;/p&gt;</span>
<span class="source-line-no">4222</span><span id="line-4222">       *</span>
<span class="source-line-no">4223</span><span id="line-4223">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4224</span><span id="line-4224">       *    &lt;li class='ja'&gt;{@link Rest#defaultCharset}</span>
<span class="source-line-no">4225</span><span id="line-4225">       *    &lt;li class='ja'&gt;{@link RestOp#defaultCharset}</span>
<span class="source-line-no">4226</span><span id="line-4226">       * &lt;/ul&gt;</span>
<span class="source-line-no">4227</span><span id="line-4227">       *</span>
<span class="source-line-no">4228</span><span id="line-4228">       * @param value</span>
<span class="source-line-no">4229</span><span id="line-4229">       *    The new value for this setting.</span>
<span class="source-line-no">4230</span><span id="line-4230">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4231</span><span id="line-4231">       *    &lt;ul&gt;</span>
<span class="source-line-no">4232</span><span id="line-4232">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.defaultCharset"</span>
<span class="source-line-no">4233</span><span id="line-4233">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_defaultCharset"</span>
<span class="source-line-no">4234</span><span id="line-4234">       *       &lt;li&gt;&lt;js&gt;"utf-8"&lt;/js&gt;</span>
<span class="source-line-no">4235</span><span id="line-4235">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4236</span><span id="line-4236">       * @return This object.</span>
<span class="source-line-no">4237</span><span id="line-4237">       */</span>
<span class="source-line-no">4238</span><span id="line-4238">      @FluentSetter</span>
<span class="source-line-no">4239</span><span id="line-4239">      public Builder defaultCharset(Charset value) {</span>
<span class="source-line-no">4240</span><span id="line-4240">         defaultCharset = value;</span>
<span class="source-line-no">4241</span><span id="line-4241">         return this;</span>
<span class="source-line-no">4242</span><span id="line-4242">      }</span>
<span class="source-line-no">4243</span><span id="line-4243"></span>
<span class="source-line-no">4244</span><span id="line-4244">      /**</span>
<span class="source-line-no">4245</span><span id="line-4245">       * Disable content URL parameter.</span>
<span class="source-line-no">4246</span><span id="line-4246">       *</span>
<span class="source-line-no">4247</span><span id="line-4247">       * &lt;p&gt;</span>
<span class="source-line-no">4248</span><span id="line-4248">       * When enabled, the HTTP content content on PUT and POST requests can be passed in as text using the &lt;js&gt;"content"&lt;/js&gt;</span>
<span class="source-line-no">4249</span><span id="line-4249">       * URL parameter.</span>
<span class="source-line-no">4250</span><span id="line-4250">       * &lt;br&gt;</span>
<span class="source-line-no">4251</span><span id="line-4251">       * For example:</span>
<span class="source-line-no">4252</span><span id="line-4252">       * &lt;p class='burlenc'&gt;</span>
<span class="source-line-no">4253</span><span id="line-4253">       *  ?content=(name='John%20Smith',age=45)</span>
<span class="source-line-no">4254</span><span id="line-4254">       * &lt;/p&gt;</span>
<span class="source-line-no">4255</span><span id="line-4255">       *</span>
<span class="source-line-no">4256</span><span id="line-4256">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4257</span><span id="line-4257">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4258</span><span id="line-4258">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4259</span><span id="line-4259">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(disableContentParam=&lt;js&gt;"$C{REST/disableContentParam,true}"&lt;/js&gt;)</span>
<span class="source-line-no">4260</span><span id="line-4260">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4261</span><span id="line-4261">       *</span>
<span class="source-line-no">4262</span><span id="line-4262">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4263</span><span id="line-4263">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4264</span><span id="line-4264">       *</span>
<span class="source-line-no">4265</span><span id="line-4265">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4266</span><span id="line-4266">       *          &lt;jv&gt;builder&lt;/jv&gt;.disableContentParam();</span>
<span class="source-line-no">4267</span><span id="line-4267">       *       }</span>
<span class="source-line-no">4268</span><span id="line-4268">       *</span>
<span class="source-line-no">4269</span><span id="line-4269">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4270</span><span id="line-4270">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4271</span><span id="line-4271">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4272</span><span id="line-4272">       *          &lt;jv&gt;builder&lt;/jv&gt;.disableContentParam();</span>
<span class="source-line-no">4273</span><span id="line-4273">       *       }</span>
<span class="source-line-no">4274</span><span id="line-4274">       *    }</span>
<span class="source-line-no">4275</span><span id="line-4275">       * &lt;/p&gt;</span>
<span class="source-line-no">4276</span><span id="line-4276">       *</span>
<span class="source-line-no">4277</span><span id="line-4277">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4278</span><span id="line-4278">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4279</span><span id="line-4279">       *       &lt;js&gt;'content'&lt;/js&gt; parameter name is case-insensitive.</span>
<span class="source-line-no">4280</span><span id="line-4280">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4281</span><span id="line-4281">       *       Useful for debugging PUT and POST methods using only a browser.</span>
<span class="source-line-no">4282</span><span id="line-4282">       * &lt;/ul&gt;</span>
<span class="source-line-no">4283</span><span id="line-4283">       *</span>
<span class="source-line-no">4284</span><span id="line-4284">       * @return This object.</span>
<span class="source-line-no">4285</span><span id="line-4285">       */</span>
<span class="source-line-no">4286</span><span id="line-4286">      @FluentSetter</span>
<span class="source-line-no">4287</span><span id="line-4287">      public Builder disableContentParam() {</span>
<span class="source-line-no">4288</span><span id="line-4288">         return disableContentParam(true);</span>
<span class="source-line-no">4289</span><span id="line-4289">      }</span>
<span class="source-line-no">4290</span><span id="line-4290"></span>
<span class="source-line-no">4291</span><span id="line-4291">      /**</span>
<span class="source-line-no">4292</span><span id="line-4292">       * Disable content URL parameter.</span>
<span class="source-line-no">4293</span><span id="line-4293">       *</span>
<span class="source-line-no">4294</span><span id="line-4294">       * &lt;p&gt;</span>
<span class="source-line-no">4295</span><span id="line-4295">       * Same as {@link #disableContentParam()} but allows you to set it as a boolean value.</span>
<span class="source-line-no">4296</span><span id="line-4296">       *</span>
<span class="source-line-no">4297</span><span id="line-4297">       * @param value The new value for this setting.</span>
<span class="source-line-no">4298</span><span id="line-4298">       * @return This object.</span>
<span class="source-line-no">4299</span><span id="line-4299">       */</span>
<span class="source-line-no">4300</span><span id="line-4300">      @FluentSetter</span>
<span class="source-line-no">4301</span><span id="line-4301">      public Builder disableContentParam(boolean value) {</span>
<span class="source-line-no">4302</span><span id="line-4302">         disableContentParam = value;</span>
<span class="source-line-no">4303</span><span id="line-4303">         return this;</span>
<span class="source-line-no">4304</span><span id="line-4304">      }</span>
<span class="source-line-no">4305</span><span id="line-4305"></span>
<span class="source-line-no">4306</span><span id="line-4306">      /**</span>
<span class="source-line-no">4307</span><span id="line-4307">       * The maximum allowed input size (in bytes) on HTTP requests.</span>
<span class="source-line-no">4308</span><span id="line-4308">       *</span>
<span class="source-line-no">4309</span><span id="line-4309">       * &lt;p&gt;</span>
<span class="source-line-no">4310</span><span id="line-4310">       * Useful for alleviating DoS attacks by throwing an exception when too much input is received instead of resulting</span>
<span class="source-line-no">4311</span><span id="line-4311">       * in out-of-memory errors which could affect system stability.</span>
<span class="source-line-no">4312</span><span id="line-4312">       *</span>
<span class="source-line-no">4313</span><span id="line-4313">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4314</span><span id="line-4314">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4315</span><span id="line-4315">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4316</span><span id="line-4316">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(maxInput=&lt;js&gt;"$C{REST/maxInput,10M}"&lt;/js&gt;)</span>
<span class="source-line-no">4317</span><span id="line-4317">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4318</span><span id="line-4318">       *</span>
<span class="source-line-no">4319</span><span id="line-4319">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4320</span><span id="line-4320">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4321</span><span id="line-4321">       *</span>
<span class="source-line-no">4322</span><span id="line-4322">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4323</span><span id="line-4323">       *          &lt;jv&gt;builder&lt;/jv&gt;.maxInput(&lt;js&gt;"10M"&lt;/js&gt;);</span>
<span class="source-line-no">4324</span><span id="line-4324">       *       }</span>
<span class="source-line-no">4325</span><span id="line-4325">       *</span>
<span class="source-line-no">4326</span><span id="line-4326">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4327</span><span id="line-4327">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4328</span><span id="line-4328">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4329</span><span id="line-4329">       *          &lt;jv&gt;builder&lt;/jv&gt;.maxInput(&lt;js&gt;"10M"&lt;/js&gt;);</span>
<span class="source-line-no">4330</span><span id="line-4330">       *       }</span>
<span class="source-line-no">4331</span><span id="line-4331">       *</span>
<span class="source-line-no">4332</span><span id="line-4332">       *       &lt;jc&gt;// Override at the method level.&lt;/jc&gt;</span>
<span class="source-line-no">4333</span><span id="line-4333">       *       &lt;ja&gt;@RestPost&lt;/ja&gt;(maxInput=&lt;js&gt;"10M"&lt;/js&gt;)</span>
<span class="source-line-no">4334</span><span id="line-4334">       *       &lt;jk&gt;public&lt;/jk&gt; Object myMethod() {...}</span>
<span class="source-line-no">4335</span><span id="line-4335">       *    }</span>
<span class="source-line-no">4336</span><span id="line-4336">       * &lt;/p&gt;</span>
<span class="source-line-no">4337</span><span id="line-4337">       *</span>
<span class="source-line-no">4338</span><span id="line-4338">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4339</span><span id="line-4339">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4340</span><span id="line-4340">       *       String value that gets resolved to a &lt;jk&gt;long&lt;/jk&gt;.</span>
<span class="source-line-no">4341</span><span id="line-4341">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4342</span><span id="line-4342">       *       Can be suffixed with any of the following representing kilobytes, megabytes, and gigabytes:</span>
<span class="source-line-no">4343</span><span id="line-4343">       *       &lt;js&gt;'K'&lt;/js&gt;, &lt;js&gt;'M'&lt;/js&gt;, &lt;js&gt;'G'&lt;/js&gt;.</span>
<span class="source-line-no">4344</span><span id="line-4344">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4345</span><span id="line-4345">       *       A value of &lt;js&gt;"-1"&lt;/js&gt; can be used to represent no limit.</span>
<span class="source-line-no">4346</span><span id="line-4346">       * &lt;/ul&gt;</span>
<span class="source-line-no">4347</span><span id="line-4347">       *</span>
<span class="source-line-no">4348</span><span id="line-4348">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4349</span><span id="line-4349">       *    &lt;li class='ja'&gt;{@link Rest#maxInput}</span>
<span class="source-line-no">4350</span><span id="line-4350">       *    &lt;li class='ja'&gt;{@link RestOp#maxInput}</span>
<span class="source-line-no">4351</span><span id="line-4351">       *    &lt;li class='jm'&gt;{@link RestOpContext.Builder#maxInput(String)}</span>
<span class="source-line-no">4352</span><span id="line-4352">       * &lt;/ul&gt;</span>
<span class="source-line-no">4353</span><span id="line-4353">       *</span>
<span class="source-line-no">4354</span><span id="line-4354">       * @param value</span>
<span class="source-line-no">4355</span><span id="line-4355">       *    The new value for this setting.</span>
<span class="source-line-no">4356</span><span id="line-4356">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4357</span><span id="line-4357">       *    &lt;ul&gt;</span>
<span class="source-line-no">4358</span><span id="line-4358">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.maxInput"</span>
<span class="source-line-no">4359</span><span id="line-4359">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_MAXINPUT"</span>
<span class="source-line-no">4360</span><span id="line-4360">       *       &lt;li&gt;&lt;js&gt;"100M"&lt;/js&gt;</span>
<span class="source-line-no">4361</span><span id="line-4361">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4362</span><span id="line-4362">       *    &lt;br&gt;The default is &lt;js&gt;"100M"&lt;/js&gt;.</span>
<span class="source-line-no">4363</span><span id="line-4363">       * @return This object.</span>
<span class="source-line-no">4364</span><span id="line-4364">       */</span>
<span class="source-line-no">4365</span><span id="line-4365">      @FluentSetter</span>
<span class="source-line-no">4366</span><span id="line-4366">      public Builder maxInput(String value) {</span>
<span class="source-line-no">4367</span><span id="line-4367">         maxInput = StringUtils.parseLongWithSuffix(value);</span>
<span class="source-line-no">4368</span><span id="line-4368">         return this;</span>
<span class="source-line-no">4369</span><span id="line-4369">      }</span>
<span class="source-line-no">4370</span><span id="line-4370"></span>
<span class="source-line-no">4371</span><span id="line-4371">      /**</span>
<span class="source-line-no">4372</span><span id="line-4372">       * &lt;i&gt;&lt;l&gt;RestContext&lt;/l&gt; configuration property:&amp;emsp;&lt;/i&gt;  Render response stack traces in responses.</span>
<span class="source-line-no">4373</span><span id="line-4373">       *</span>
<span class="source-line-no">4374</span><span id="line-4374">       * &lt;p&gt;</span>
<span class="source-line-no">4375</span><span id="line-4375">       * Render stack traces in HTTP response bodies when errors occur.</span>
<span class="source-line-no">4376</span><span id="line-4376">       *</span>
<span class="source-line-no">4377</span><span id="line-4377">       * @param value</span>
<span class="source-line-no">4378</span><span id="line-4378">       *    The new value for this setting.</span>
<span class="source-line-no">4379</span><span id="line-4379">       *    &lt;br&gt;The default is &lt;jk&gt;false&lt;/jk&gt;.</span>
<span class="source-line-no">4380</span><span id="line-4380">       * @return This object.</span>
<span class="source-line-no">4381</span><span id="line-4381">       */</span>
<span class="source-line-no">4382</span><span id="line-4382">      @FluentSetter</span>
<span class="source-line-no">4383</span><span id="line-4383">      public Builder renderResponseStackTraces(boolean value) {</span>
<span class="source-line-no">4384</span><span id="line-4384">         renderResponseStackTraces = value;</span>
<span class="source-line-no">4385</span><span id="line-4385">         return this;</span>
<span class="source-line-no">4386</span><span id="line-4386">      }</span>
<span class="source-line-no">4387</span><span id="line-4387"></span>
<span class="source-line-no">4388</span><span id="line-4388">      /**</span>
<span class="source-line-no">4389</span><span id="line-4389">       * &lt;i&gt;&lt;l&gt;RestContext&lt;/l&gt; configuration property:&amp;emsp;&lt;/i&gt;  Render response stack traces in responses.</span>
<span class="source-line-no">4390</span><span id="line-4390">       *</span>
<span class="source-line-no">4391</span><span id="line-4391">       * &lt;p&gt;</span>
<span class="source-line-no">4392</span><span id="line-4392">       * Shortcut for calling &lt;code&gt;renderResponseStackTraces(&lt;jk&gt;true&lt;/jk&gt;)&lt;/code&gt;.</span>
<span class="source-line-no">4393</span><span id="line-4393">       *</span>
<span class="source-line-no">4394</span><span id="line-4394">       * @return This object.</span>
<span class="source-line-no">4395</span><span id="line-4395">       */</span>
<span class="source-line-no">4396</span><span id="line-4396">      @FluentSetter</span>
<span class="source-line-no">4397</span><span id="line-4397">      public Builder renderResponseStackTraces() {</span>
<span class="source-line-no">4398</span><span id="line-4398">         renderResponseStackTraces = true;</span>
<span class="source-line-no">4399</span><span id="line-4399">         return this;</span>
<span class="source-line-no">4400</span><span id="line-4400">      }</span>
<span class="source-line-no">4401</span><span id="line-4401"></span>
<span class="source-line-no">4402</span><span id="line-4402">      /**</span>
<span class="source-line-no">4403</span><span id="line-4403">       * Resource authority path.</span>
<span class="source-line-no">4404</span><span id="line-4404">       *</span>
<span class="source-line-no">4405</span><span id="line-4405">       * &lt;p&gt;</span>
<span class="source-line-no">4406</span><span id="line-4406">       * Overrides the authority path value for this resource and any child resources.</span>
<span class="source-line-no">4407</span><span id="line-4407">       *</span>
<span class="source-line-no">4408</span><span id="line-4408">       * &lt;p&gt;</span>
<span class="source-line-no">4409</span><span id="line-4409">       * This setting is useful if you want to resolve relative URIs to absolute paths and want to explicitly specify the hostname/port.</span>
<span class="source-line-no">4410</span><span id="line-4410">       *</span>
<span class="source-line-no">4411</span><span id="line-4411">       * &lt;p&gt;</span>
<span class="source-line-no">4412</span><span id="line-4412">       * Affects the following methods:</span>
<span class="source-line-no">4413</span><span id="line-4413">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4414</span><span id="line-4414">       *    &lt;li class='jm'&gt;{@link RestRequest#getAuthorityPath()}</span>
<span class="source-line-no">4415</span><span id="line-4415">       * &lt;/ul&gt;</span>
<span class="source-line-no">4416</span><span id="line-4416">       *</span>
<span class="source-line-no">4417</span><span id="line-4417">       * &lt;p&gt;</span>
<span class="source-line-no">4418</span><span id="line-4418">       * If you do not specify the authority, it is automatically calculated via the following:</span>
<span class="source-line-no">4419</span><span id="line-4419">       *</span>
<span class="source-line-no">4420</span><span id="line-4420">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4421</span><span id="line-4421">       *    String &lt;jv&gt;scheme&lt;/jv&gt; = &lt;jv&gt;request&lt;/jv&gt;.getScheme();</span>
<span class="source-line-no">4422</span><span id="line-4422">       *    &lt;jk&gt;int&lt;/jk&gt; &lt;jv&gt;port&lt;/jv&gt; = &lt;jv&gt;request&lt;/jv&gt;.getServerPort();</span>
<span class="source-line-no">4423</span><span id="line-4423">       *    StringBuilder &lt;jv&gt;sb&lt;/jv&gt; = &lt;jk&gt;new&lt;/jk&gt; StringBuilder(&lt;jv&gt;request&lt;/jv&gt;.getScheme()).append(&lt;js&gt;"://"&lt;/js&gt;).append(&lt;jv&gt;request&lt;/jv&gt;.getServerName());</span>
<span class="source-line-no">4424</span><span id="line-4424">       *    &lt;jk&gt;if&lt;/jk&gt; (! (&lt;jv&gt;port&lt;/jv&gt; == 80 &amp;amp;&amp;amp; &lt;js&gt;"http"&lt;/js&gt;.equals(&lt;jv&gt;scheme&lt;/jv&gt;) || port == 443 &amp;amp;&amp;amp; &lt;js&gt;"https"&lt;/js&gt;.equals(&lt;jv&gt;scheme&lt;/jv&gt;)))</span>
<span class="source-line-no">4425</span><span id="line-4425">       *       &lt;jv&gt;sb&lt;/jv&gt;.append(&lt;js&gt;':'&lt;/js&gt;).append(&lt;jv&gt;port&lt;/jv&gt;);</span>
<span class="source-line-no">4426</span><span id="line-4426">       *    &lt;jv&gt;authorityPath&lt;/jv&gt; = &lt;jv&gt;sb&lt;/jv&gt;.toString();</span>
<span class="source-line-no">4427</span><span id="line-4427">       * &lt;/p&gt;</span>
<span class="source-line-no">4428</span><span id="line-4428">       *</span>
<span class="source-line-no">4429</span><span id="line-4429">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4430</span><span id="line-4430">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4431</span><span id="line-4431">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4432</span><span id="line-4432">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(</span>
<span class="source-line-no">4433</span><span id="line-4433">       *       path=&lt;js&gt;"/servlet"&lt;/js&gt;,</span>
<span class="source-line-no">4434</span><span id="line-4434">       *       uriAuthority=&lt;js&gt;"$C{REST/authorityPathOverride,http://localhost:10000}"&lt;/js&gt;</span>
<span class="source-line-no">4435</span><span id="line-4435">       *    )</span>
<span class="source-line-no">4436</span><span id="line-4436">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4437</span><span id="line-4437">       *</span>
<span class="source-line-no">4438</span><span id="line-4438">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4439</span><span id="line-4439">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4440</span><span id="line-4440">       *</span>
<span class="source-line-no">4441</span><span id="line-4441">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4442</span><span id="line-4442">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriAuthority(&lt;js&gt;"http://localhost:10000"&lt;/js&gt;);</span>
<span class="source-line-no">4443</span><span id="line-4443">       *       }</span>
<span class="source-line-no">4444</span><span id="line-4444">       *</span>
<span class="source-line-no">4445</span><span id="line-4445">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4446</span><span id="line-4446">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4447</span><span id="line-4447">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4448</span><span id="line-4448">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriAuthority(&lt;js&gt;"http://localhost:10000"&lt;/js&gt;);</span>
<span class="source-line-no">4449</span><span id="line-4449">       *       }</span>
<span class="source-line-no">4450</span><span id="line-4450">       *    }</span>
<span class="source-line-no">4451</span><span id="line-4451">       * &lt;/p&gt;</span>
<span class="source-line-no">4452</span><span id="line-4452">       *</span>
<span class="source-line-no">4453</span><span id="line-4453">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4454</span><span id="line-4454">       *    &lt;li class='ja'&gt;{@link Rest#uriAuthority}</span>
<span class="source-line-no">4455</span><span id="line-4455">       * &lt;/ul&gt;</span>
<span class="source-line-no">4456</span><span id="line-4456">       *</span>
<span class="source-line-no">4457</span><span id="line-4457">       * @param value</span>
<span class="source-line-no">4458</span><span id="line-4458">       *    The new value for this setting.</span>
<span class="source-line-no">4459</span><span id="line-4459">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4460</span><span id="line-4460">       *    &lt;ul&gt;</span>
<span class="source-line-no">4461</span><span id="line-4461">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.uriAuthority"</span>
<span class="source-line-no">4462</span><span id="line-4462">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_URIAUTHORITY"</span>
<span class="source-line-no">4463</span><span id="line-4463">       *       &lt;li&gt;&lt;jk&gt;null&lt;/jk&gt;</span>
<span class="source-line-no">4464</span><span id="line-4464">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4465</span><span id="line-4465">       * @return This object.</span>
<span class="source-line-no">4466</span><span id="line-4466">       */</span>
<span class="source-line-no">4467</span><span id="line-4467">      @FluentSetter</span>
<span class="source-line-no">4468</span><span id="line-4468">      public Builder uriAuthority(String value) {</span>
<span class="source-line-no">4469</span><span id="line-4469">         uriAuthority = value;</span>
<span class="source-line-no">4470</span><span id="line-4470">         return this;</span>
<span class="source-line-no">4471</span><span id="line-4471">      }</span>
<span class="source-line-no">4472</span><span id="line-4472"></span>
<span class="source-line-no">4473</span><span id="line-4473">      /**</span>
<span class="source-line-no">4474</span><span id="line-4474">       * Resource context path.</span>
<span class="source-line-no">4475</span><span id="line-4475">       *</span>
<span class="source-line-no">4476</span><span id="line-4476">       * &lt;p&gt;</span>
<span class="source-line-no">4477</span><span id="line-4477">       * Overrides the context path value for this resource and any child resources.</span>
<span class="source-line-no">4478</span><span id="line-4478">       *</span>
<span class="source-line-no">4479</span><span id="line-4479">       * &lt;p&gt;</span>
<span class="source-line-no">4480</span><span id="line-4480">       * This setting is useful if you want to use &lt;js&gt;"context:/child/path"&lt;/js&gt; URLs in child resource POJOs but</span>
<span class="source-line-no">4481</span><span id="line-4481">       * the context path is not actually specified on the servlet container.</span>
<span class="source-line-no">4482</span><span id="line-4482">       *</span>
<span class="source-line-no">4483</span><span id="line-4483">       * &lt;p&gt;</span>
<span class="source-line-no">4484</span><span id="line-4484">       * Affects the following methods:</span>
<span class="source-line-no">4485</span><span id="line-4485">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4486</span><span id="line-4486">       *    &lt;li class='jm'&gt;{@link RestRequest#getContextPath()} - Returns the overridden context path for the resource.</span>
<span class="source-line-no">4487</span><span id="line-4487">       *    &lt;li class='jm'&gt;{@link RestRequest#getServletPath()} - Includes the overridden context path for the resource.</span>
<span class="source-line-no">4488</span><span id="line-4488">       * &lt;/ul&gt;</span>
<span class="source-line-no">4489</span><span id="line-4489">       *</span>
<span class="source-line-no">4490</span><span id="line-4490">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4491</span><span id="line-4491">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4492</span><span id="line-4492">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4493</span><span id="line-4493">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(</span>
<span class="source-line-no">4494</span><span id="line-4494">       *       path=&lt;js&gt;"/servlet"&lt;/js&gt;,</span>
<span class="source-line-no">4495</span><span id="line-4495">       *       uriContext=&lt;js&gt;"$C{REST/contextPathOverride,/foo}"&lt;/js&gt;</span>
<span class="source-line-no">4496</span><span id="line-4496">       *    )</span>
<span class="source-line-no">4497</span><span id="line-4497">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4498</span><span id="line-4498">       *</span>
<span class="source-line-no">4499</span><span id="line-4499">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4500</span><span id="line-4500">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4501</span><span id="line-4501">       *</span>
<span class="source-line-no">4502</span><span id="line-4502">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4503</span><span id="line-4503">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriContext(&lt;js&gt;"/foo"&lt;/js&gt;);</span>
<span class="source-line-no">4504</span><span id="line-4504">       *       }</span>
<span class="source-line-no">4505</span><span id="line-4505">       *</span>
<span class="source-line-no">4506</span><span id="line-4506">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4507</span><span id="line-4507">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4508</span><span id="line-4508">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4509</span><span id="line-4509">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriContext(&lt;js&gt;"/foo"&lt;/js&gt;);</span>
<span class="source-line-no">4510</span><span id="line-4510">       *       }</span>
<span class="source-line-no">4511</span><span id="line-4511">       *    }</span>
<span class="source-line-no">4512</span><span id="line-4512">       * &lt;/p&gt;</span>
<span class="source-line-no">4513</span><span id="line-4513">       *</span>
<span class="source-line-no">4514</span><span id="line-4514">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4515</span><span id="line-4515">       *    &lt;li class='ja'&gt;{@link Rest#uriContext}</span>
<span class="source-line-no">4516</span><span id="line-4516">       * &lt;/ul&gt;</span>
<span class="source-line-no">4517</span><span id="line-4517">       *</span>
<span class="source-line-no">4518</span><span id="line-4518">       * @param value</span>
<span class="source-line-no">4519</span><span id="line-4519">       *    The new value for this setting.</span>
<span class="source-line-no">4520</span><span id="line-4520">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4521</span><span id="line-4521">       *    &lt;ul&gt;</span>
<span class="source-line-no">4522</span><span id="line-4522">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.uriContext"</span>
<span class="source-line-no">4523</span><span id="line-4523">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_URICONTEXT"</span>
<span class="source-line-no">4524</span><span id="line-4524">       *       &lt;li&gt;&lt;jk&gt;null&lt;/jk&gt;</span>
<span class="source-line-no">4525</span><span id="line-4525">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4526</span><span id="line-4526">       * @return This object.</span>
<span class="source-line-no">4527</span><span id="line-4527">       */</span>
<span class="source-line-no">4528</span><span id="line-4528">      @FluentSetter</span>
<span class="source-line-no">4529</span><span id="line-4529">      public Builder uriContext(String value) {</span>
<span class="source-line-no">4530</span><span id="line-4530">         uriContext = value;</span>
<span class="source-line-no">4531</span><span id="line-4531">         return this;</span>
<span class="source-line-no">4532</span><span id="line-4532">      }</span>
<span class="source-line-no">4533</span><span id="line-4533"></span>
<span class="source-line-no">4534</span><span id="line-4534">      /**</span>
<span class="source-line-no">4535</span><span id="line-4535">       * URI resolution relativity.</span>
<span class="source-line-no">4536</span><span id="line-4536">       *</span>
<span class="source-line-no">4537</span><span id="line-4537">       * &lt;p&gt;</span>
<span class="source-line-no">4538</span><span id="line-4538">       * Specifies how relative URIs should be interpreted by serializers.</span>
<span class="source-line-no">4539</span><span id="line-4539">       *</span>
<span class="source-line-no">4540</span><span id="line-4540">       * &lt;p&gt;</span>
<span class="source-line-no">4541</span><span id="line-4541">       * See {@link UriResolution} for possible values.</span>
<span class="source-line-no">4542</span><span id="line-4542">       *</span>
<span class="source-line-no">4543</span><span id="line-4543">       * &lt;p&gt;</span>
<span class="source-line-no">4544</span><span id="line-4544">       * Affects the following methods:</span>
<span class="source-line-no">4545</span><span id="line-4545">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4546</span><span id="line-4546">       *    &lt;li class='jm'&gt;{@link RestRequest#getUriResolver()}</span>
<span class="source-line-no">4547</span><span id="line-4547">       * &lt;/ul&gt;</span>
<span class="source-line-no">4548</span><span id="line-4548">       *</span>
<span class="source-line-no">4549</span><span id="line-4549">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4550</span><span id="line-4550">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4551</span><span id="line-4551">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4552</span><span id="line-4552">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(</span>
<span class="source-line-no">4553</span><span id="line-4553">       *       path=&lt;js&gt;"/servlet"&lt;/js&gt;,</span>
<span class="source-line-no">4554</span><span id="line-4554">       *       uriRelativity=&lt;js&gt;"$C{REST/uriRelativity,PATH_INFO}"&lt;/js&gt;</span>
<span class="source-line-no">4555</span><span id="line-4555">       *    )</span>
<span class="source-line-no">4556</span><span id="line-4556">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4557</span><span id="line-4557">       *</span>
<span class="source-line-no">4558</span><span id="line-4558">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4559</span><span id="line-4559">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4560</span><span id="line-4560">       *</span>
<span class="source-line-no">4561</span><span id="line-4561">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4562</span><span id="line-4562">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriRelativity(&lt;jsf&gt;PATH_INFO&lt;/jsf&gt;);</span>
<span class="source-line-no">4563</span><span id="line-4563">       *       }</span>
<span class="source-line-no">4564</span><span id="line-4564">       *</span>
<span class="source-line-no">4565</span><span id="line-4565">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4566</span><span id="line-4566">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4567</span><span id="line-4567">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4568</span><span id="line-4568">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriRelativity(&lt;jsf&gt;PATH_INFO&lt;/jsf&gt;);</span>
<span class="source-line-no">4569</span><span id="line-4569">       *       }</span>
<span class="source-line-no">4570</span><span id="line-4570">       *    }</span>
<span class="source-line-no">4571</span><span id="line-4571">       * &lt;/p&gt;</span>
<span class="source-line-no">4572</span><span id="line-4572">       *</span>
<span class="source-line-no">4573</span><span id="line-4573">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4574</span><span id="line-4574">       *    &lt;li class='ja'&gt;{@link Rest#uriRelativity}</span>
<span class="source-line-no">4575</span><span id="line-4575">       * &lt;/ul&gt;</span>
<span class="source-line-no">4576</span><span id="line-4576">       *</span>
<span class="source-line-no">4577</span><span id="line-4577">       * @param value</span>
<span class="source-line-no">4578</span><span id="line-4578">       *    The new value for this setting.</span>
<span class="source-line-no">4579</span><span id="line-4579">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4580</span><span id="line-4580">       *    &lt;ul&gt;</span>
<span class="source-line-no">4581</span><span id="line-4581">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.uriRelativity"</span>
<span class="source-line-no">4582</span><span id="line-4582">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_URIRELATIVITY"</span>
<span class="source-line-no">4583</span><span id="line-4583">       *       &lt;li&gt;{@link UriRelativity#RESOURCE}</span>
<span class="source-line-no">4584</span><span id="line-4584">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4585</span><span id="line-4585">       * @return This object.</span>
<span class="source-line-no">4586</span><span id="line-4586">       */</span>
<span class="source-line-no">4587</span><span id="line-4587">      @FluentSetter</span>
<span class="source-line-no">4588</span><span id="line-4588">      public Builder uriRelativity(UriRelativity value) {</span>
<span class="source-line-no">4589</span><span id="line-4589">         uriRelativity = value;</span>
<span class="source-line-no">4590</span><span id="line-4590">         return this;</span>
<span class="source-line-no">4591</span><span id="line-4591">      }</span>
<span class="source-line-no">4592</span><span id="line-4592"></span>
<span class="source-line-no">4593</span><span id="line-4593">      /**</span>
<span class="source-line-no">4594</span><span id="line-4594">       * URI resolution.</span>
<span class="source-line-no">4595</span><span id="line-4595">       *</span>
<span class="source-line-no">4596</span><span id="line-4596">       * &lt;p&gt;</span>
<span class="source-line-no">4597</span><span id="line-4597">       * Specifies how relative URIs should be interpreted by serializers.</span>
<span class="source-line-no">4598</span><span id="line-4598">       *</span>
<span class="source-line-no">4599</span><span id="line-4599">       * &lt;p&gt;</span>
<span class="source-line-no">4600</span><span id="line-4600">       * See {@link UriResolution} for possible values.</span>
<span class="source-line-no">4601</span><span id="line-4601">       *</span>
<span class="source-line-no">4602</span><span id="line-4602">       * &lt;p&gt;</span>
<span class="source-line-no">4603</span><span id="line-4603">       * Affects the following methods:</span>
<span class="source-line-no">4604</span><span id="line-4604">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4605</span><span id="line-4605">       *    &lt;li class='jm'&gt;{@link RestRequest#getUriResolver()}</span>
<span class="source-line-no">4606</span><span id="line-4606">       * &lt;/ul&gt;</span>
<span class="source-line-no">4607</span><span id="line-4607">       *</span>
<span class="source-line-no">4608</span><span id="line-4608">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4609</span><span id="line-4609">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4610</span><span id="line-4610">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">4611</span><span id="line-4611">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(</span>
<span class="source-line-no">4612</span><span id="line-4612">       *       path=&lt;js&gt;"/servlet"&lt;/js&gt;,</span>
<span class="source-line-no">4613</span><span id="line-4613">       *       uriResolution=&lt;js&gt;"$C{REST/uriResolution,ABSOLUTE}"&lt;/js&gt;</span>
<span class="source-line-no">4614</span><span id="line-4614">       *    )</span>
<span class="source-line-no">4615</span><span id="line-4615">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4616</span><span id="line-4616">       *</span>
<span class="source-line-no">4617</span><span id="line-4617">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4618</span><span id="line-4618">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4619</span><span id="line-4619">       *</span>
<span class="source-line-no">4620</span><span id="line-4620">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4621</span><span id="line-4621">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriResolution(&lt;jsf&gt;ABSOLUTE&lt;/jsf&gt;);</span>
<span class="source-line-no">4622</span><span id="line-4622">       *       }</span>
<span class="source-line-no">4623</span><span id="line-4623">       *</span>
<span class="source-line-no">4624</span><span id="line-4624">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4625</span><span id="line-4625">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4626</span><span id="line-4626">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4627</span><span id="line-4627">       *          &lt;jv&gt;builder&lt;/jv&gt;.uriResolution(&lt;jsf&gt;ABSOLUTE&lt;/jsf&gt;);</span>
<span class="source-line-no">4628</span><span id="line-4628">       *       }</span>
<span class="source-line-no">4629</span><span id="line-4629">       *    }</span>
<span class="source-line-no">4630</span><span id="line-4630">       * &lt;/p&gt;</span>
<span class="source-line-no">4631</span><span id="line-4631">       *</span>
<span class="source-line-no">4632</span><span id="line-4632">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4633</span><span id="line-4633">       *    &lt;li class='ja'&gt;{@link Rest#uriResolution}</span>
<span class="source-line-no">4634</span><span id="line-4634">       * &lt;/ul&gt;</span>
<span class="source-line-no">4635</span><span id="line-4635">       *</span>
<span class="source-line-no">4636</span><span id="line-4636">       * @param value</span>
<span class="source-line-no">4637</span><span id="line-4637">       *    The new value for this setting.</span>
<span class="source-line-no">4638</span><span id="line-4638">       *    &lt;br&gt;The default is the first value found:</span>
<span class="source-line-no">4639</span><span id="line-4639">       *    &lt;ul&gt;</span>
<span class="source-line-no">4640</span><span id="line-4640">       *       &lt;li&gt;System property &lt;js&gt;"RestContext.uriResolution"</span>
<span class="source-line-no">4641</span><span id="line-4641">       *       &lt;li&gt;Environment variable &lt;js&gt;"RESTCONTEXT_URIRESOLUTION"</span>
<span class="source-line-no">4642</span><span id="line-4642">       *       &lt;li&gt;{@link UriResolution#ROOT_RELATIVE}</span>
<span class="source-line-no">4643</span><span id="line-4643">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4644</span><span id="line-4644">       * @return This object.</span>
<span class="source-line-no">4645</span><span id="line-4645">       */</span>
<span class="source-line-no">4646</span><span id="line-4646">      @FluentSetter</span>
<span class="source-line-no">4647</span><span id="line-4647">      public Builder uriResolution(UriResolution value) {</span>
<span class="source-line-no">4648</span><span id="line-4648">         uriResolution = value;</span>
<span class="source-line-no">4649</span><span id="line-4649">         return this;</span>
<span class="source-line-no">4650</span><span id="line-4650">      }</span>
<span class="source-line-no">4651</span><span id="line-4651"></span>
<span class="source-line-no">4652</span><span id="line-4652">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">4653</span><span id="line-4653">      // Methods that give access to the config file, var resolver, and properties.</span>
<span class="source-line-no">4654</span><span id="line-4654">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">4655</span><span id="line-4655"></span>
<span class="source-line-no">4656</span><span id="line-4656">      /**</span>
<span class="source-line-no">4657</span><span id="line-4657">       * Returns the serializer group builder containing the serializers for marshalling POJOs into response bodies.</span>
<span class="source-line-no">4658</span><span id="line-4658">       *</span>
<span class="source-line-no">4659</span><span id="line-4659">       * &lt;p&gt;</span>
<span class="source-line-no">4660</span><span id="line-4660">       * Serializer are used to convert POJOs to HTTP response bodies.</span>
<span class="source-line-no">4661</span><span id="line-4661">       * &lt;br&gt;Any of the Juneau framework serializers can be used in this setting.</span>
<span class="source-line-no">4662</span><span id="line-4662">       * &lt;br&gt;The serializer selected is based on the request &lt;c&gt;Accept&lt;/c&gt; header matched against the values returned by the following method</span>
<span class="source-line-no">4663</span><span id="line-4663">       * using a best-match algorithm:</span>
<span class="source-line-no">4664</span><span id="line-4664">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4665</span><span id="line-4665">       *    &lt;li class='jm'&gt;{@link Serializer#getMediaTypeRanges()}</span>
<span class="source-line-no">4666</span><span id="line-4666">       * &lt;/ul&gt;</span>
<span class="source-line-no">4667</span><span id="line-4667">       *</span>
<span class="source-line-no">4668</span><span id="line-4668">       * &lt;p&gt;</span>
<span class="source-line-no">4669</span><span id="line-4669">       * The builder is initialized with serializers defined via the {@link Rest#serializers()} annotation.  That annotation is applied</span>
<span class="source-line-no">4670</span><span id="line-4670">       * from parent-to-child order with child entries given priority over parent entries.</span>
<span class="source-line-no">4671</span><span id="line-4671">       *</span>
<span class="source-line-no">4672</span><span id="line-4672">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4673</span><span id="line-4673">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">4674</span><span id="line-4674">       * &lt;/ul&gt;</span>
<span class="source-line-no">4675</span><span id="line-4675">       *</span>
<span class="source-line-no">4676</span><span id="line-4676">       * @return The serializer group builder for this context builder.</span>
<span class="source-line-no">4677</span><span id="line-4677">       */</span>
<span class="source-line-no">4678</span><span id="line-4678">      public SerializerSet.Builder getSerializers() {</span>
<span class="source-line-no">4679</span><span id="line-4679">         return serializers;</span>
<span class="source-line-no">4680</span><span id="line-4680">      }</span>
<span class="source-line-no">4681</span><span id="line-4681"></span>
<span class="source-line-no">4682</span><span id="line-4682">      /**</span>
<span class="source-line-no">4683</span><span id="line-4683">       * Returns the parser group builder containing the parsers for converting HTTP request bodies into POJOs.</span>
<span class="source-line-no">4684</span><span id="line-4684">       *</span>
<span class="source-line-no">4685</span><span id="line-4685">       * &lt;p&gt;</span>
<span class="source-line-no">4686</span><span id="line-4686">       * Parsers are used to convert the content of HTTP requests into POJOs.</span>
<span class="source-line-no">4687</span><span id="line-4687">       * &lt;br&gt;Any of the Juneau framework parsers can be used in this setting.</span>
<span class="source-line-no">4688</span><span id="line-4688">       * &lt;br&gt;The parser selected is based on the request &lt;c&gt;Content-Type&lt;/c&gt; header matched against the values returned by the following method</span>
<span class="source-line-no">4689</span><span id="line-4689">       * using a best-match algorithm:</span>
<span class="source-line-no">4690</span><span id="line-4690">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">4691</span><span id="line-4691">       *    &lt;li class='jm'&gt;{@link Parser#getMediaTypes()}</span>
<span class="source-line-no">4692</span><span id="line-4692">       * &lt;/ul&gt;</span>
<span class="source-line-no">4693</span><span id="line-4693">       *</span>
<span class="source-line-no">4694</span><span id="line-4694">       * &lt;p&gt;</span>
<span class="source-line-no">4695</span><span id="line-4695">       * The builder is initialized with parsers defined via the {@link Rest#parsers()} annotation.  That annotation is applied</span>
<span class="source-line-no">4696</span><span id="line-4696">       * from parent-to-child order with child entries given priority over parent entries.</span>
<span class="source-line-no">4697</span><span id="line-4697">       *</span>
<span class="source-line-no">4698</span><span id="line-4698">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4699</span><span id="line-4699">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/Marshalling"&gt;Marshalling&lt;/a&gt;</span>
<span class="source-line-no">4700</span><span id="line-4700">       * &lt;/ul&gt;</span>
<span class="source-line-no">4701</span><span id="line-4701">       *</span>
<span class="source-line-no">4702</span><span id="line-4702">       * @return The parser group builder for this context builder.</span>
<span class="source-line-no">4703</span><span id="line-4703">       */</span>
<span class="source-line-no">4704</span><span id="line-4704">      public ParserSet.Builder getParsers() {</span>
<span class="source-line-no">4705</span><span id="line-4705">         return parsers;</span>
<span class="source-line-no">4706</span><span id="line-4706">      }</span>
<span class="source-line-no">4707</span><span id="line-4707"></span>
<span class="source-line-no">4708</span><span id="line-4708">      /**</span>
<span class="source-line-no">4709</span><span id="line-4709">       * Returns the encoder group builder containing the encoders for compressing/decompressing input and output streams.</span>
<span class="source-line-no">4710</span><span id="line-4710">       *</span>
<span class="source-line-no">4711</span><span id="line-4711">       * &lt;p&gt;</span>
<span class="source-line-no">4712</span><span id="line-4712">       * These can be used to enable various kinds of compression (e.g. &lt;js&gt;"gzip"&lt;/js&gt;) on requests and responses.</span>
<span class="source-line-no">4713</span><span id="line-4713">       *</span>
<span class="source-line-no">4714</span><span id="line-4714">       * &lt;p&gt;</span>
<span class="source-line-no">4715</span><span id="line-4715">       * The builder is initialized with encoders defined via the {@link Rest#encoders()} annotation.  That annotation is applied</span>
<span class="source-line-no">4716</span><span id="line-4716">       * from parent-to-child order with child entries given priority over parent entries.</span>
<span class="source-line-no">4717</span><span id="line-4717">       *</span>
<span class="source-line-no">4718</span><span id="line-4718">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4719</span><span id="line-4719">       *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerEncoders"&gt;Encoders&lt;/a&gt;</span>
<span class="source-line-no">4720</span><span id="line-4720">       * &lt;/ul&gt;</span>
<span class="source-line-no">4721</span><span id="line-4721">       *</span>
<span class="source-line-no">4722</span><span id="line-4722">       * @return The encoder group builder for this context builder.</span>
<span class="source-line-no">4723</span><span id="line-4723">       */</span>
<span class="source-line-no">4724</span><span id="line-4724">      public EncoderSet.Builder getEncoders() {</span>
<span class="source-line-no">4725</span><span id="line-4725">         return encoders;</span>
<span class="source-line-no">4726</span><span id="line-4726">      }</span>
<span class="source-line-no">4727</span><span id="line-4727"></span>
<span class="source-line-no">4728</span><span id="line-4728">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">4729</span><span id="line-4729">      // Properties</span>
<span class="source-line-no">4730</span><span id="line-4730">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">4731</span><span id="line-4731"></span>
<span class="source-line-no">4732</span><span id="line-4732">      /**</span>
<span class="source-line-no">4733</span><span id="line-4733">       * Child REST resources.</span>
<span class="source-line-no">4734</span><span id="line-4734">       *</span>
<span class="source-line-no">4735</span><span id="line-4735">       * &lt;p&gt;</span>
<span class="source-line-no">4736</span><span id="line-4736">       * Defines children of this resource.</span>
<span class="source-line-no">4737</span><span id="line-4737">       *</span>
<span class="source-line-no">4738</span><span id="line-4738">       * &lt;p&gt;</span>
<span class="source-line-no">4739</span><span id="line-4739">       * A REST child resource is simply another servlet or object that is initialized as part of the ascendant resource and has a</span>
<span class="source-line-no">4740</span><span id="line-4740">       * servlet path directly under the ascendant resource object path.</span>
<span class="source-line-no">4741</span><span id="line-4741">       * &lt;br&gt;The main advantage to defining servlets as REST children is that you do not need to define them in the</span>
<span class="source-line-no">4742</span><span id="line-4742">       * &lt;c&gt;web.xml&lt;/c&gt; file of the web application.</span>
<span class="source-line-no">4743</span><span id="line-4743">       * &lt;br&gt;This can cut down on the number of entries that show up in the &lt;c&gt;web.xml&lt;/c&gt; file if you are defining</span>
<span class="source-line-no">4744</span><span id="line-4744">       * large numbers of servlets.</span>
<span class="source-line-no">4745</span><span id="line-4745">       *</span>
<span class="source-line-no">4746</span><span id="line-4746">       * &lt;p&gt;</span>
<span class="source-line-no">4747</span><span id="line-4747">       * Child resources must specify a value for {@link Rest#path() @Rest(path)} that identifies the subpath of the child resource</span>
<span class="source-line-no">4748</span><span id="line-4748">       * relative to the ascendant path UNLESS you use the {@link RestContext.Builder#child(String, Object)} method to register it.</span>
<span class="source-line-no">4749</span><span id="line-4749">       *</span>
<span class="source-line-no">4750</span><span id="line-4750">       * &lt;p&gt;</span>
<span class="source-line-no">4751</span><span id="line-4751">       * Child resources can be nested arbitrarily deep using this technique (i.e. children can also have children).</span>
<span class="source-line-no">4752</span><span id="line-4752">       *</span>
<span class="source-line-no">4753</span><span id="line-4753">       * &lt;dl&gt;</span>
<span class="source-line-no">4754</span><span id="line-4754">       *    &lt;dt&gt;Servlet initialization:&lt;/dt&gt;</span>
<span class="source-line-no">4755</span><span id="line-4755">       *    &lt;dd&gt;</span>
<span class="source-line-no">4756</span><span id="line-4756">       *       &lt;p&gt;</span>
<span class="source-line-no">4757</span><span id="line-4757">       *          A child resource will be initialized immediately after the ascendant servlet/resource is initialized.</span>
<span class="source-line-no">4758</span><span id="line-4758">       *          &lt;br&gt;The child resource receives the same servlet config as the ascendant servlet/resource.</span>
<span class="source-line-no">4759</span><span id="line-4759">       *          &lt;br&gt;This allows configuration information such as servlet initialization parameters to filter to child</span>
<span class="source-line-no">4760</span><span id="line-4760">       *          resources.</span>
<span class="source-line-no">4761</span><span id="line-4761">       *       &lt;/p&gt;</span>
<span class="source-line-no">4762</span><span id="line-4762">       *    &lt;/dd&gt;</span>
<span class="source-line-no">4763</span><span id="line-4763">       *    &lt;dt&gt;Runtime behavior:&lt;/dt&gt;</span>
<span class="source-line-no">4764</span><span id="line-4764">       *    &lt;dd&gt;</span>
<span class="source-line-no">4765</span><span id="line-4765">       *       &lt;p&gt;</span>
<span class="source-line-no">4766</span><span id="line-4766">       *          As a rule, methods defined on the &lt;c&gt;HttpServletRequest&lt;/c&gt; object will behave as if the child</span>
<span class="source-line-no">4767</span><span id="line-4767">       *          servlet were deployed as a top-level resource under the child's servlet path.</span>
<span class="source-line-no">4768</span><span id="line-4768">       *          &lt;br&gt;For example, the &lt;c&gt;getServletPath()&lt;/c&gt; and &lt;c&gt;getPathInfo()&lt;/c&gt; methods on the</span>
<span class="source-line-no">4769</span><span id="line-4769">       *          &lt;c&gt;HttpServletRequest&lt;/c&gt; object will behave as if the child resource were deployed using the</span>
<span class="source-line-no">4770</span><span id="line-4770">       *          child's servlet path.</span>
<span class="source-line-no">4771</span><span id="line-4771">       *          &lt;br&gt;Therefore, the runtime behavior should be equivalent to deploying the child servlet in the</span>
<span class="source-line-no">4772</span><span id="line-4772">       *          &lt;c&gt;web.xml&lt;/c&gt; file of the web application.</span>
<span class="source-line-no">4773</span><span id="line-4773">       *       &lt;/p&gt;</span>
<span class="source-line-no">4774</span><span id="line-4774">       *    &lt;/dd&gt;</span>
<span class="source-line-no">4775</span><span id="line-4775">       * &lt;/dl&gt;</span>
<span class="source-line-no">4776</span><span id="line-4776">       *</span>
<span class="source-line-no">4777</span><span id="line-4777">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4778</span><span id="line-4778">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4779</span><span id="line-4779">       *    &lt;jc&gt;// Our child resource.&lt;/jc&gt;</span>
<span class="source-line-no">4780</span><span id="line-4780">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(path=&lt;js&gt;"/child"&lt;/js&gt;)</span>
<span class="source-line-no">4781</span><span id="line-4781">       *    &lt;jk&gt;public class&lt;/jk&gt; MyChildResource {...}</span>
<span class="source-line-no">4782</span><span id="line-4782">       *</span>
<span class="source-line-no">4783</span><span id="line-4783">       *    &lt;jc&gt;// Option #1 - Registered via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">4784</span><span id="line-4784">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(children={MyChildResource.&lt;jk&gt;class&lt;/jk&gt;})</span>
<span class="source-line-no">4785</span><span id="line-4785">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4786</span><span id="line-4786">       *</span>
<span class="source-line-no">4787</span><span id="line-4787">       *       &lt;jc&gt;// Option #2 - Registered via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4788</span><span id="line-4788">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4789</span><span id="line-4789">       *</span>
<span class="source-line-no">4790</span><span id="line-4790">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4791</span><span id="line-4791">       *          &lt;jv&gt;builder&lt;/jv&gt;.children(MyChildResource.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">4792</span><span id="line-4792">       *</span>
<span class="source-line-no">4793</span><span id="line-4793">       *          &lt;jc&gt;// Use a pre-instantiated object instead.&lt;/jc&gt;</span>
<span class="source-line-no">4794</span><span id="line-4794">       *          &lt;jv&gt;builder&lt;/jv&gt;.child(&lt;js&gt;"/child"&lt;/js&gt;, &lt;jk&gt;new&lt;/jk&gt; MyChildResource());</span>
<span class="source-line-no">4795</span><span id="line-4795">       *       }</span>
<span class="source-line-no">4796</span><span id="line-4796">       *</span>
<span class="source-line-no">4797</span><span id="line-4797">       *       &lt;jc&gt;// Option #3 - Registered via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4798</span><span id="line-4798">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4799</span><span id="line-4799">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4800</span><span id="line-4800">       *          &lt;jv&gt;builder&lt;/jv&gt;.children(MyChildResource.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">4801</span><span id="line-4801">       *       }</span>
<span class="source-line-no">4802</span><span id="line-4802">       *    }</span>
<span class="source-line-no">4803</span><span id="line-4803">       * &lt;/p&gt;</span>
<span class="source-line-no">4804</span><span id="line-4804">       *</span>
<span class="source-line-no">4805</span><span id="line-4805">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4806</span><span id="line-4806">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4807</span><span id="line-4807">       *       When defined as classes, instances are resolved using the registered bean store which</span>
<span class="source-line-no">4808</span><span id="line-4808">       *       by default is {@link BeanStore} which requires the class have one of the following</span>
<span class="source-line-no">4809</span><span id="line-4809">       *       constructors:</span>
<span class="source-line-no">4810</span><span id="line-4810">       *       &lt;ul&gt;</span>
<span class="source-line-no">4811</span><span id="line-4811">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public&lt;/jk&gt; T(RestContext.Builder)&lt;/code&gt;</span>
<span class="source-line-no">4812</span><span id="line-4812">       *          &lt;li&gt;&lt;code&gt;&lt;jk&gt;public&lt;/jk&gt; T()&lt;/code&gt;</span>
<span class="source-line-no">4813</span><span id="line-4813">       *       &lt;/ul&gt;</span>
<span class="source-line-no">4814</span><span id="line-4814">       * &lt;/ul&gt;</span>
<span class="source-line-no">4815</span><span id="line-4815">       *</span>
<span class="source-line-no">4816</span><span id="line-4816">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4817</span><span id="line-4817">       *    &lt;li class='ja'&gt;{@link Rest#children()}</span>
<span class="source-line-no">4818</span><span id="line-4818">       * &lt;/ul&gt;</span>
<span class="source-line-no">4819</span><span id="line-4819">       *</span>
<span class="source-line-no">4820</span><span id="line-4820">       * @param values</span>
<span class="source-line-no">4821</span><span id="line-4821">       *    The values to add to this setting.</span>
<span class="source-line-no">4822</span><span id="line-4822">       *    &lt;br&gt;Objects can be any of the specified types:</span>
<span class="source-line-no">4823</span><span id="line-4823">       *    &lt;ul&gt;</span>
<span class="source-line-no">4824</span><span id="line-4824">       *       &lt;li&gt;A class that has a constructor described above.</span>
<span class="source-line-no">4825</span><span id="line-4825">       *       &lt;li&gt;An instantiated resource object (such as a servlet object instantiated by a servlet container).</span>
<span class="source-line-no">4826</span><span id="line-4826">       *       &lt;li&gt;An instance of {@link RestChild} containing an instantiated resource object and a subpath.</span>
<span class="source-line-no">4827</span><span id="line-4827">       *    &lt;/ul&gt;</span>
<span class="source-line-no">4828</span><span id="line-4828">       * @return This object.</span>
<span class="source-line-no">4829</span><span id="line-4829">       */</span>
<span class="source-line-no">4830</span><span id="line-4830">      @FluentSetter</span>
<span class="source-line-no">4831</span><span id="line-4831">      public Builder children(Object...values) {</span>
<span class="source-line-no">4832</span><span id="line-4832">         addAll(children, values);</span>
<span class="source-line-no">4833</span><span id="line-4833">         return this;</span>
<span class="source-line-no">4834</span><span id="line-4834">      }</span>
<span class="source-line-no">4835</span><span id="line-4835"></span>
<span class="source-line-no">4836</span><span id="line-4836">      /**</span>
<span class="source-line-no">4837</span><span id="line-4837">       * Add a child REST resource.</span>
<span class="source-line-no">4838</span><span id="line-4838">       *</span>
<span class="source-line-no">4839</span><span id="line-4839">       * &lt;p&gt;</span>
<span class="source-line-no">4840</span><span id="line-4840">       * Shortcut for adding a single child to this resource.</span>
<span class="source-line-no">4841</span><span id="line-4841">       *</span>
<span class="source-line-no">4842</span><span id="line-4842">       * &lt;p&gt;</span>
<span class="source-line-no">4843</span><span id="line-4843">       * This can be used for resources that don't have a {@link Rest#path() @Rest(path)} annotation.</span>
<span class="source-line-no">4844</span><span id="line-4844">       *</span>
<span class="source-line-no">4845</span><span id="line-4845">       * @param path The child path relative to the parent resource URI.</span>
<span class="source-line-no">4846</span><span id="line-4846">       * @param child The child to add to this resource.</span>
<span class="source-line-no">4847</span><span id="line-4847">       * @return This object.</span>
<span class="source-line-no">4848</span><span id="line-4848">       */</span>
<span class="source-line-no">4849</span><span id="line-4849">      @FluentSetter</span>
<span class="source-line-no">4850</span><span id="line-4850">      public Builder child(String path, Object child) {</span>
<span class="source-line-no">4851</span><span id="line-4851">         children.add(new RestChild(path, child));</span>
<span class="source-line-no">4852</span><span id="line-4852">         return this;</span>
<span class="source-line-no">4853</span><span id="line-4853">      }</span>
<span class="source-line-no">4854</span><span id="line-4854"></span>
<span class="source-line-no">4855</span><span id="line-4855">      /**</span>
<span class="source-line-no">4856</span><span id="line-4856">       * &lt;i&gt;&lt;l&gt;RestContext&lt;/l&gt; configuration property:&amp;emsp;&lt;/i&gt;  Parser listener.</span>
<span class="source-line-no">4857</span><span id="line-4857">       *</span>
<span class="source-line-no">4858</span><span id="line-4858">       * &lt;p&gt;</span>
<span class="source-line-no">4859</span><span id="line-4859">       * Specifies the parser listener class to use for listening to non-fatal parsing errors.</span>
<span class="source-line-no">4860</span><span id="line-4860">       *</span>
<span class="source-line-no">4861</span><span id="line-4861">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4862</span><span id="line-4862">       *    &lt;li class='jm'&gt;{@link org.apache.juneau.parser.Parser.Builder#listener(Class)}</span>
<span class="source-line-no">4863</span><span id="line-4863">       * &lt;/ul&gt;</span>
<span class="source-line-no">4864</span><span id="line-4864">       *</span>
<span class="source-line-no">4865</span><span id="line-4865">       * @param value The new value for this setting.</span>
<span class="source-line-no">4866</span><span id="line-4866">       * @return This object.</span>
<span class="source-line-no">4867</span><span id="line-4867">       */</span>
<span class="source-line-no">4868</span><span id="line-4868">      @FluentSetter</span>
<span class="source-line-no">4869</span><span id="line-4869">      public Builder parserListener(Class&lt;? extends ParserListener&gt; value) {</span>
<span class="source-line-no">4870</span><span id="line-4870">         if (isNotVoid(value))</span>
<span class="source-line-no">4871</span><span id="line-4871">            parsers.forEach(x -&gt; x.listener(value));</span>
<span class="source-line-no">4872</span><span id="line-4872">         return this;</span>
<span class="source-line-no">4873</span><span id="line-4873">      }</span>
<span class="source-line-no">4874</span><span id="line-4874"></span>
<span class="source-line-no">4875</span><span id="line-4875">      /**</span>
<span class="source-line-no">4876</span><span id="line-4876">       * Resource path.</span>
<span class="source-line-no">4877</span><span id="line-4877">       *</span>
<span class="source-line-no">4878</span><span id="line-4878">       * &lt;p&gt;</span>
<span class="source-line-no">4879</span><span id="line-4879">       * Identifies the URL subpath relative to the parent resource.</span>
<span class="source-line-no">4880</span><span id="line-4880">       *</span>
<span class="source-line-no">4881</span><span id="line-4881">       * &lt;p&gt;</span>
<span class="source-line-no">4882</span><span id="line-4882">       * This setting is critical for the routing of HTTP requests from ascendant to child resources.</span>
<span class="source-line-no">4883</span><span id="line-4883">       *</span>
<span class="source-line-no">4884</span><span id="line-4884">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4885</span><span id="line-4885">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4886</span><span id="line-4886">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">4887</span><span id="line-4887">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(path=&lt;js&gt;"/myResource"&lt;/js&gt;)</span>
<span class="source-line-no">4888</span><span id="line-4888">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4889</span><span id="line-4889">       *</span>
<span class="source-line-no">4890</span><span id="line-4890">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">4891</span><span id="line-4891">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4892</span><span id="line-4892">       *</span>
<span class="source-line-no">4893</span><span id="line-4893">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">4894</span><span id="line-4894">       *          &lt;jv&gt;builder&lt;/jv&gt;.path(&lt;js&gt;"/myResource"&lt;/js&gt;);</span>
<span class="source-line-no">4895</span><span id="line-4895">       *       }</span>
<span class="source-line-no">4896</span><span id="line-4896">       *</span>
<span class="source-line-no">4897</span><span id="line-4897">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4898</span><span id="line-4898">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4899</span><span id="line-4899">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4900</span><span id="line-4900">       *          &lt;jv&gt;builder&lt;/jv&gt;.path(&lt;js&gt;"/myResource"&lt;/js&gt;);</span>
<span class="source-line-no">4901</span><span id="line-4901">       *       }</span>
<span class="source-line-no">4902</span><span id="line-4902">       *    }</span>
<span class="source-line-no">4903</span><span id="line-4903">       * &lt;/p&gt;</span>
<span class="source-line-no">4904</span><span id="line-4904">       *</span>
<span class="source-line-no">4905</span><span id="line-4905">       * &lt;p&gt;</span>
<span class="source-line-no">4906</span><span id="line-4906">       * &lt;h5 class='section'&gt;Notes:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4907</span><span id="line-4907">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4908</span><span id="line-4908">       *       This annotation is ignored on top-level servlets (i.e. servlets defined in &lt;c&gt;web.xml&lt;/c&gt; files).</span>
<span class="source-line-no">4909</span><span id="line-4909">       *       &lt;br&gt;Therefore, implementers can optionally specify a path value for documentation purposes.</span>
<span class="source-line-no">4910</span><span id="line-4910">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4911</span><span id="line-4911">       *       Typically, this setting is only applicable to resources defined as children through the</span>
<span class="source-line-no">4912</span><span id="line-4912">       *       {@link Rest#children() @Rest(children)} annotation.</span>
<span class="source-line-no">4913</span><span id="line-4913">       *       &lt;br&gt;However, it may be used in other ways (e.g. defining paths for top-level resources in microservices).</span>
<span class="source-line-no">4914</span><span id="line-4914">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4915</span><span id="line-4915">       *       Slashes are trimmed from the path ends.</span>
<span class="source-line-no">4916</span><span id="line-4916">       *       &lt;br&gt;As a convention, you may want to start your path with &lt;js&gt;'/'&lt;/js&gt; simple because it make it easier to read.</span>
<span class="source-line-no">4917</span><span id="line-4917">       *    &lt;li class='note'&gt;</span>
<span class="source-line-no">4918</span><span id="line-4918">       *       This path is available through the following method:</span>
<span class="source-line-no">4919</span><span id="line-4919">       *       &lt;ul&gt;</span>
<span class="source-line-no">4920</span><span id="line-4920">       *          &lt;li class='jm'&gt;{@link RestContext#getPath() RestContext.getPath()}</span>
<span class="source-line-no">4921</span><span id="line-4921">       *       &lt;/ul&gt;</span>
<span class="source-line-no">4922</span><span id="line-4922">       * &lt;/ul&gt;</span>
<span class="source-line-no">4923</span><span id="line-4923">       *</span>
<span class="source-line-no">4924</span><span id="line-4924">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">4925</span><span id="line-4925">       *    &lt;li class='ja'&gt;{@link Rest#path}</span>
<span class="source-line-no">4926</span><span id="line-4926">       * &lt;/ul&gt;</span>
<span class="source-line-no">4927</span><span id="line-4927">       *</span>
<span class="source-line-no">4928</span><span id="line-4928">       * @param value The new value for this setting.</span>
<span class="source-line-no">4929</span><span id="line-4929">       * @return This object.</span>
<span class="source-line-no">4930</span><span id="line-4930">       */</span>
<span class="source-line-no">4931</span><span id="line-4931">      @FluentSetter</span>
<span class="source-line-no">4932</span><span id="line-4932">      public Builder path(String value) {</span>
<span class="source-line-no">4933</span><span id="line-4933">         value = trimLeadingSlashes(value);</span>
<span class="source-line-no">4934</span><span id="line-4934">         if (Utils.isNotEmpty(value))</span>
<span class="source-line-no">4935</span><span id="line-4935">            path = value;</span>
<span class="source-line-no">4936</span><span id="line-4936">         return this;</span>
<span class="source-line-no">4937</span><span id="line-4937">      }</span>
<span class="source-line-no">4938</span><span id="line-4938"></span>
<span class="source-line-no">4939</span><span id="line-4939">      /**</span>
<span class="source-line-no">4940</span><span id="line-4940">       * REST children class.</span>
<span class="source-line-no">4941</span><span id="line-4941">       *</span>
<span class="source-line-no">4942</span><span id="line-4942">       * &lt;p&gt;</span>
<span class="source-line-no">4943</span><span id="line-4943">       * Allows you to extend the {@link RestChildren} class to modify how any of the methods are implemented.</span>
<span class="source-line-no">4944</span><span id="line-4944">       *</span>
<span class="source-line-no">4945</span><span id="line-4945">       * &lt;p&gt;</span>
<span class="source-line-no">4946</span><span id="line-4946">       * The subclass must have a public constructor that takes in any of the following arguments:</span>
<span class="source-line-no">4947</span><span id="line-4947">       * &lt;ul&gt;</span>
<span class="source-line-no">4948</span><span id="line-4948">       *    &lt;li&gt;{@link RestChildren.Builder} - The builder for the object.</span>
<span class="source-line-no">4949</span><span id="line-4949">       *    &lt;li&gt;Any beans found in the specified bean store.</span>
<span class="source-line-no">4950</span><span id="line-4950">       *    &lt;li&gt;Any {@link Optional} beans that may or may not be found in the specified bean store.</span>
<span class="source-line-no">4951</span><span id="line-4951">       * &lt;/ul&gt;</span>
<span class="source-line-no">4952</span><span id="line-4952">       *</span>
<span class="source-line-no">4953</span><span id="line-4953">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">4954</span><span id="line-4954">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4955</span><span id="line-4955">       *    &lt;jc&gt;// Our extended context class&lt;/jc&gt;</span>
<span class="source-line-no">4956</span><span id="line-4956">       *    &lt;jk&gt;public&lt;/jk&gt; MyRestChildren &lt;jk&gt;extends&lt;/jk&gt; RestChildren {</span>
<span class="source-line-no">4957</span><span id="line-4957">       *       &lt;jk&gt;public&lt;/jk&gt; MyRestChildren(RestChildren.Builder &lt;jv&gt;builder&lt;/jv&gt;, ARequiredSpringBean &lt;jv&gt;bean1&lt;/jv&gt;, Optional&amp;lt;AnOptionalSpringBean&amp;gt; &lt;jv&gt;bean2&lt;/jv&gt;) {</span>
<span class="source-line-no">4958</span><span id="line-4958">       *          &lt;jk&gt;super&lt;/jk&gt;(&lt;jv&gt;builder&lt;/jv&gt;);</span>
<span class="source-line-no">4959</span><span id="line-4959">       *       }</span>
<span class="source-line-no">4960</span><span id="line-4960">       *</span>
<span class="source-line-no">4961</span><span id="line-4961">       *       &lt;jc&gt;// Override any methods.&lt;/jc&gt;</span>
<span class="source-line-no">4962</span><span id="line-4962">       *</span>
<span class="source-line-no">4963</span><span id="line-4963">       *       &lt;ja&gt;@Override&lt;/ja&gt;</span>
<span class="source-line-no">4964</span><span id="line-4964">       *       &lt;jk&gt;public&lt;/jk&gt; Optional&amp;lt;RestChildMatch&amp;gt; findMatch(RestCall &lt;jv&gt;call&lt;/jv&gt;) {</span>
<span class="source-line-no">4965</span><span id="line-4965">       *          String &lt;jv&gt;path&lt;/jv&gt; = &lt;jv&gt;call&lt;/jv&gt;.getPathInfo();</span>
<span class="source-line-no">4966</span><span id="line-4966">       *          &lt;jk&gt;if&lt;/jk&gt; (&lt;jv&gt;path&lt;/jv&gt;.endsWith(&lt;js&gt;"/foo"&lt;/js&gt;)) {</span>
<span class="source-line-no">4967</span><span id="line-4967">       *             &lt;jc&gt;// Do our own special handling.&lt;/jc&gt;</span>
<span class="source-line-no">4968</span><span id="line-4968">       *          }</span>
<span class="source-line-no">4969</span><span id="line-4969">       *          &lt;jk&gt;return super&lt;/jk&gt;.findMatch(&lt;jv&gt;call&lt;/jv&gt;);</span>
<span class="source-line-no">4970</span><span id="line-4970">       *       }</span>
<span class="source-line-no">4971</span><span id="line-4971">       *    }</span>
<span class="source-line-no">4972</span><span id="line-4972">       * &lt;/p&gt;</span>
<span class="source-line-no">4973</span><span id="line-4973">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">4974</span><span id="line-4974">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">4975</span><span id="line-4975">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(restChildrenClass=MyRestChildren.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">4976</span><span id="line-4976">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">4977</span><span id="line-4977">       *       ...</span>
<span class="source-line-no">4978</span><span id="line-4978">       *</span>
<span class="source-line-no">4979</span><span id="line-4979">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">4980</span><span id="line-4980">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">4981</span><span id="line-4981">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">4982</span><span id="line-4982">       *          &lt;jv&gt;builder&lt;/jv&gt;.restChildrenClass(MyRestChildren.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">4983</span><span id="line-4983">       *       }</span>
<span class="source-line-no">4984</span><span id="line-4984">       *    }</span>
<span class="source-line-no">4985</span><span id="line-4985">       * &lt;/p&gt;</span>
<span class="source-line-no">4986</span><span id="line-4986">       *</span>
<span class="source-line-no">4987</span><span id="line-4987">       * @param value The new value for this setting.</span>
<span class="source-line-no">4988</span><span id="line-4988">       * @return This object.</span>
<span class="source-line-no">4989</span><span id="line-4989">       */</span>
<span class="source-line-no">4990</span><span id="line-4990">      @FluentSetter</span>
<span class="source-line-no">4991</span><span id="line-4991">      public Builder restChildrenClass(Class&lt;? extends RestChildren&gt; value) {</span>
<span class="source-line-no">4992</span><span id="line-4992">         childrenClass = value;</span>
<span class="source-line-no">4993</span><span id="line-4993">         return this;</span>
<span class="source-line-no">4994</span><span id="line-4994">      }</span>
<span class="source-line-no">4995</span><span id="line-4995"></span>
<span class="source-line-no">4996</span><span id="line-4996">      /**</span>
<span class="source-line-no">4997</span><span id="line-4997">       * REST operation context class.</span>
<span class="source-line-no">4998</span><span id="line-4998">       *</span>
<span class="source-line-no">4999</span><span id="line-4999">       * &lt;p&gt;</span>
<span class="source-line-no">5000</span><span id="line-5000">       * Allows you to extend the {@link RestOpContext} class to modify how any of the methods are implemented.</span>
<span class="source-line-no">5001</span><span id="line-5001">       *</span>
<span class="source-line-no">5002</span><span id="line-5002">       * &lt;p&gt;</span>
<span class="source-line-no">5003</span><span id="line-5003">       * The subclass must have a public constructor that takes in any of the following arguments:</span>
<span class="source-line-no">5004</span><span id="line-5004">       * &lt;ul&gt;</span>
<span class="source-line-no">5005</span><span id="line-5005">       *    &lt;li&gt;{@link RestOpContext.Builder} - The builder for the object.</span>
<span class="source-line-no">5006</span><span id="line-5006">       *    &lt;li&gt;Any beans found in the specified bean store.</span>
<span class="source-line-no">5007</span><span id="line-5007">       *    &lt;li&gt;Any {@link Optional} beans that may or may not be found in the specified bean store.</span>
<span class="source-line-no">5008</span><span id="line-5008">       * &lt;/ul&gt;</span>
<span class="source-line-no">5009</span><span id="line-5009">       *</span>
<span class="source-line-no">5010</span><span id="line-5010">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">5011</span><span id="line-5011">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5012</span><span id="line-5012">       *    &lt;jc&gt;// Our extended context class that adds a request attribute to all requests.&lt;/jc&gt;</span>
<span class="source-line-no">5013</span><span id="line-5013">       *    &lt;jc&gt;// The attribute value is provided by an injected spring bean.&lt;/jc&gt;</span>
<span class="source-line-no">5014</span><span id="line-5014">       *    &lt;jk&gt;public&lt;/jk&gt; MyRestOperationContext &lt;jk&gt;extends&lt;/jk&gt; RestOpContext {</span>
<span class="source-line-no">5015</span><span id="line-5015">       *</span>
<span class="source-line-no">5016</span><span id="line-5016">       *       &lt;jk&gt;private final&lt;/jk&gt; Optional&amp;lt;? &lt;jk&gt;extends&lt;/jk&gt; Supplier&amp;lt;Object&amp;gt;&amp;gt; &lt;jf&gt;fooSupplier&lt;/jf&gt;;</span>
<span class="source-line-no">5017</span><span id="line-5017">       *</span>
<span class="source-line-no">5018</span><span id="line-5018">       *       &lt;jc&gt;// Constructor that takes in builder and optional injected attribute provider.&lt;/jc&gt;</span>
<span class="source-line-no">5019</span><span id="line-5019">       *       &lt;jk&gt;public&lt;/jk&gt; MyRestOperationContext(RestOpContext.Builder &lt;jv&gt;builder&lt;/jv&gt;, Optional&amp;lt;AnInjectedFooSupplier&amp;gt; &lt;jv&gt;fooSupplier&lt;/jv&gt;) {</span>
<span class="source-line-no">5020</span><span id="line-5020">       *          &lt;jk&gt;super&lt;/jk&gt;(&lt;jv&gt;builder&lt;/jv&gt;);</span>
<span class="source-line-no">5021</span><span id="line-5021">       *          &lt;jk&gt;this&lt;/jk&gt;.&lt;jf&gt;fooSupplier&lt;/jf&gt; = &lt;jv&gt;fooSupplier&lt;/jv&gt;.orElseGet(()-&amp;gt;&lt;jk&gt;null&lt;/jk&gt;);</span>
<span class="source-line-no">5022</span><span id="line-5022">       *       }</span>
<span class="source-line-no">5023</span><span id="line-5023">       *</span>
<span class="source-line-no">5024</span><span id="line-5024">       *       &lt;jc&gt;// Override the method used to create default request attributes.&lt;/jc&gt;</span>
<span class="source-line-no">5025</span><span id="line-5025">       *       &lt;ja&gt;@Override&lt;/ja&gt;</span>
<span class="source-line-no">5026</span><span id="line-5026">       *       &lt;jk&gt;protected&lt;/jk&gt; NamedAttributeMap createDefaultRequestAttributes(Object &lt;jv&gt;resource&lt;/jv&gt;, BeanStore &lt;jv&gt;beanStore&lt;/jv&gt;, Method &lt;jv&gt;method&lt;/jv&gt;, RestContext &lt;jv&gt;context&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5027</span><span id="line-5027">       *          &lt;jk&gt;return super&lt;/jk&gt;</span>
<span class="source-line-no">5028</span><span id="line-5028">       *             .createDefaultRequestAttributes(&lt;jv&gt;resource&lt;/jv&gt;, &lt;jv&gt;beanStore&lt;/jv&gt;, &lt;jv&gt;method&lt;/jv&gt;, &lt;jv&gt;context&lt;/jv&gt;)</span>
<span class="source-line-no">5029</span><span id="line-5029">       *             .append(NamedAttribute.&lt;jsm&gt;of&lt;/jsm&gt;(&lt;js&gt;"foo"&lt;/js&gt;, ()-&amp;gt;&lt;jf&gt;fooSupplier&lt;/jf&gt;.get());</span>
<span class="source-line-no">5030</span><span id="line-5030">       *       }</span>
<span class="source-line-no">5031</span><span id="line-5031">       *    }</span>
<span class="source-line-no">5032</span><span id="line-5032">       * &lt;/p&gt;</span>
<span class="source-line-no">5033</span><span id="line-5033">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5034</span><span id="line-5034">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">5035</span><span id="line-5035">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(restOpContextClass=MyRestOperationContext.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">5036</span><span id="line-5036">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">5037</span><span id="line-5037">       *       ...</span>
<span class="source-line-no">5038</span><span id="line-5038">       *</span>
<span class="source-line-no">5039</span><span id="line-5039">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">5040</span><span id="line-5040">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">5041</span><span id="line-5041">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5042</span><span id="line-5042">       *          &lt;jv&gt;builder&lt;/jv&gt;.methodContextClass(MyRestOperationContext.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">5043</span><span id="line-5043">       *       }</span>
<span class="source-line-no">5044</span><span id="line-5044">       *</span>
<span class="source-line-no">5045</span><span id="line-5045">       *       &lt;ja&gt;@RestGet&lt;/ja&gt;</span>
<span class="source-line-no">5046</span><span id="line-5046">       *       &lt;jk&gt;public&lt;/jk&gt; Object foo(RequestAttributes &lt;jv&gt;attributes&lt;/jv&gt;) {</span>
<span class="source-line-no">5047</span><span id="line-5047">       *          &lt;jk&gt;return&lt;/jk&gt; &lt;jv&gt;attributes&lt;/jv&gt;.get(&lt;js&gt;"foo"&lt;/js&gt;);</span>
<span class="source-line-no">5048</span><span id="line-5048">       *       }</span>
<span class="source-line-no">5049</span><span id="line-5049">       *    }</span>
<span class="source-line-no">5050</span><span id="line-5050">       * &lt;/p&gt;</span>
<span class="source-line-no">5051</span><span id="line-5051">       *</span>
<span class="source-line-no">5052</span><span id="line-5052">       * @param value The new value for this setting.</span>
<span class="source-line-no">5053</span><span id="line-5053">       * @return This object.</span>
<span class="source-line-no">5054</span><span id="line-5054">       */</span>
<span class="source-line-no">5055</span><span id="line-5055">      @FluentSetter</span>
<span class="source-line-no">5056</span><span id="line-5056">      public Builder restOpContextClass(Class&lt;? extends RestOpContext&gt; value) {</span>
<span class="source-line-no">5057</span><span id="line-5057">         opContextClass = value;</span>
<span class="source-line-no">5058</span><span id="line-5058">         return this;</span>
<span class="source-line-no">5059</span><span id="line-5059">      }</span>
<span class="source-line-no">5060</span><span id="line-5060"></span>
<span class="source-line-no">5061</span><span id="line-5061">      /**</span>
<span class="source-line-no">5062</span><span id="line-5062">       * REST operations class.</span>
<span class="source-line-no">5063</span><span id="line-5063">       *</span>
<span class="source-line-no">5064</span><span id="line-5064">       * &lt;p&gt;</span>
<span class="source-line-no">5065</span><span id="line-5065">       * Allows you to extend the {@link RestOperations} class to modify how any of the methods are implemented.</span>
<span class="source-line-no">5066</span><span id="line-5066">       *</span>
<span class="source-line-no">5067</span><span id="line-5067">       * &lt;p&gt;</span>
<span class="source-line-no">5068</span><span id="line-5068">       * The subclass must have a public constructor that takes in any of the following arguments:</span>
<span class="source-line-no">5069</span><span id="line-5069">       * &lt;ul&gt;</span>
<span class="source-line-no">5070</span><span id="line-5070">       *    &lt;li&gt;{@link RestOperations.Builder} - The builder for the object.</span>
<span class="source-line-no">5071</span><span id="line-5071">       *    &lt;li&gt;Any beans found in the specified bean store.</span>
<span class="source-line-no">5072</span><span id="line-5072">       *    &lt;li&gt;Any {@link Optional} beans that may or may not be found in the specified bean store.</span>
<span class="source-line-no">5073</span><span id="line-5073">       * &lt;/ul&gt;</span>
<span class="source-line-no">5074</span><span id="line-5074">       *</span>
<span class="source-line-no">5075</span><span id="line-5075">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">5076</span><span id="line-5076">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5077</span><span id="line-5077">       *    &lt;jc&gt;// Our extended context class&lt;/jc&gt;</span>
<span class="source-line-no">5078</span><span id="line-5078">       *    &lt;jk&gt;public&lt;/jk&gt; MyRestOperations &lt;jk&gt;extends&lt;/jk&gt; RestOperations {</span>
<span class="source-line-no">5079</span><span id="line-5079">       *       &lt;jk&gt;public&lt;/jk&gt; MyRestOperations(RestOperations.Builder &lt;jv&gt;builder&lt;/jv&gt;, ARequiredSpringBean &lt;jv&gt;bean1&lt;/jv&gt;, Optional&amp;lt;AnOptionalSpringBean&amp;gt; &lt;jv&gt;bean2&lt;/jv&gt;) {</span>
<span class="source-line-no">5080</span><span id="line-5080">       *          &lt;jk&gt;super&lt;/jk&gt;(&lt;jv&gt;builder&lt;/jv&gt;);</span>
<span class="source-line-no">5081</span><span id="line-5081">       *       }</span>
<span class="source-line-no">5082</span><span id="line-5082">       *</span>
<span class="source-line-no">5083</span><span id="line-5083">       *       &lt;jc&gt;// Override any methods.&lt;/jc&gt;</span>
<span class="source-line-no">5084</span><span id="line-5084">       *</span>
<span class="source-line-no">5085</span><span id="line-5085">       *       &lt;ja&gt;@Override&lt;/ja&gt;</span>
<span class="source-line-no">5086</span><span id="line-5086">       *       &lt;jk&gt;public&lt;/jk&gt; RestOpContext findMethod(RestCall &lt;jv&gt;call&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; MethodNotAllowed, PreconditionFailed, NotFound {</span>
<span class="source-line-no">5087</span><span id="line-5087">       *          String &lt;jv&gt;path&lt;/jv&gt; = &lt;jv&gt;call&lt;/jv&gt;.getPathInfo();</span>
<span class="source-line-no">5088</span><span id="line-5088">       *          &lt;jk&gt;if&lt;/jk&gt; (&lt;jv&gt;path&lt;/jv&gt;.endsWith(&lt;js&gt;"/foo"&lt;/js&gt;)) {</span>
<span class="source-line-no">5089</span><span id="line-5089">       *             &lt;jc&gt;// Do our own special handling.&lt;/jc&gt;</span>
<span class="source-line-no">5090</span><span id="line-5090">       *          }</span>
<span class="source-line-no">5091</span><span id="line-5091">       *          &lt;jk&gt;return super&lt;/jk&gt;.findMethod(&lt;jv&gt;call&lt;/jv&gt;);</span>
<span class="source-line-no">5092</span><span id="line-5092">       *       }</span>
<span class="source-line-no">5093</span><span id="line-5093">       *    }</span>
<span class="source-line-no">5094</span><span id="line-5094">       * &lt;/p&gt;</span>
<span class="source-line-no">5095</span><span id="line-5095">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5096</span><span id="line-5096">       *    &lt;jc&gt;// Option #1 - Defined via annotation.&lt;/jc&gt;</span>
<span class="source-line-no">5097</span><span id="line-5097">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(restMethodsClass=MyRestOperations.&lt;jk&gt;class&lt;/jk&gt;)</span>
<span class="source-line-no">5098</span><span id="line-5098">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">5099</span><span id="line-5099">       *       ...</span>
<span class="source-line-no">5100</span><span id="line-5100">       *</span>
<span class="source-line-no">5101</span><span id="line-5101">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">5102</span><span id="line-5102">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">5103</span><span id="line-5103">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5104</span><span id="line-5104">       *          &lt;jv&gt;builder&lt;/jv&gt;.restMethodsClass(MyRestOperations.&lt;jk&gt;class&lt;/jk&gt;);</span>
<span class="source-line-no">5105</span><span id="line-5105">       *       }</span>
<span class="source-line-no">5106</span><span id="line-5106">       *    }</span>
<span class="source-line-no">5107</span><span id="line-5107">       * &lt;/p&gt;</span>
<span class="source-line-no">5108</span><span id="line-5108">       *</span>
<span class="source-line-no">5109</span><span id="line-5109">       * @param value The new value for this setting.</span>
<span class="source-line-no">5110</span><span id="line-5110">       * @return This object.</span>
<span class="source-line-no">5111</span><span id="line-5111">       */</span>
<span class="source-line-no">5112</span><span id="line-5112">      @FluentSetter</span>
<span class="source-line-no">5113</span><span id="line-5113">      public Builder restOperationsClass(Class&lt;? extends RestOperations&gt; value) {</span>
<span class="source-line-no">5114</span><span id="line-5114">         operationsClass = value;</span>
<span class="source-line-no">5115</span><span id="line-5115">         return this;</span>
<span class="source-line-no">5116</span><span id="line-5116">      }</span>
<span class="source-line-no">5117</span><span id="line-5117"></span>
<span class="source-line-no">5118</span><span id="line-5118">      /**</span>
<span class="source-line-no">5119</span><span id="line-5119">       * &lt;i&gt;&lt;l&gt;RestContext&lt;/l&gt; configuration property:&amp;emsp;&lt;/i&gt;  Serializer listener.</span>
<span class="source-line-no">5120</span><span id="line-5120">       *</span>
<span class="source-line-no">5121</span><span id="line-5121">       * &lt;p&gt;</span>
<span class="source-line-no">5122</span><span id="line-5122">       * Specifies the serializer listener class to use for listening to non-fatal serialization errors.</span>
<span class="source-line-no">5123</span><span id="line-5123">       *</span>
<span class="source-line-no">5124</span><span id="line-5124">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5125</span><span id="line-5125">       *    &lt;li class='jm'&gt;{@link org.apache.juneau.serializer.Serializer.Builder#listener(Class)}</span>
<span class="source-line-no">5126</span><span id="line-5126">       * &lt;/ul&gt;</span>
<span class="source-line-no">5127</span><span id="line-5127">       *</span>
<span class="source-line-no">5128</span><span id="line-5128">       * @param value The new value for this setting.</span>
<span class="source-line-no">5129</span><span id="line-5129">       * @return This object.</span>
<span class="source-line-no">5130</span><span id="line-5130">       */</span>
<span class="source-line-no">5131</span><span id="line-5131">      @FluentSetter</span>
<span class="source-line-no">5132</span><span id="line-5132">      public Builder serializerListener(Class&lt;? extends SerializerListener&gt; value) {</span>
<span class="source-line-no">5133</span><span id="line-5133">         if (isNotVoid(value))</span>
<span class="source-line-no">5134</span><span id="line-5134">            serializers.forEach(x -&gt; x.listener(value));</span>
<span class="source-line-no">5135</span><span id="line-5135">         return this;</span>
<span class="source-line-no">5136</span><span id="line-5136">      }</span>
<span class="source-line-no">5137</span><span id="line-5137"></span>
<span class="source-line-no">5138</span><span id="line-5138">      /**</span>
<span class="source-line-no">5139</span><span id="line-5139">       * Supported accept media types.</span>
<span class="source-line-no">5140</span><span id="line-5140">       *</span>
<span class="source-line-no">5141</span><span id="line-5141">       * &lt;p&gt;</span>
<span class="source-line-no">5142</span><span id="line-5142">       * Overrides the media types inferred from the serializers that identify what media types can be produced by the resource.</span>
<span class="source-line-no">5143</span><span id="line-5143">       * &lt;br&gt;An example where this might be useful if you have serializers registered that handle media types that you</span>
<span class="source-line-no">5144</span><span id="line-5144">       * don't want exposed in the Swagger documentation.</span>
<span class="source-line-no">5145</span><span id="line-5145">       *</span>
<span class="source-line-no">5146</span><span id="line-5146">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">5147</span><span id="line-5147">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5148</span><span id="line-5148">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">5149</span><span id="line-5149">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(produces={&lt;js&gt;"$C{REST/supportedProduces,application/json}"&lt;/js&gt;})</span>
<span class="source-line-no">5150</span><span id="line-5150">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">5151</span><span id="line-5151">       *</span>
<span class="source-line-no">5152</span><span id="line-5152">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">5153</span><span id="line-5153">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5154</span><span id="line-5154">       *</span>
<span class="source-line-no">5155</span><span id="line-5155">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">5156</span><span id="line-5156">       *          &lt;jv&gt;builder&lt;/jv&gt;.produces(&lt;jk&gt;false&lt;/jk&gt;, &lt;js&gt;"application/json"&lt;/js&gt;)</span>
<span class="source-line-no">5157</span><span id="line-5157">       *       }</span>
<span class="source-line-no">5158</span><span id="line-5158">       *</span>
<span class="source-line-no">5159</span><span id="line-5159">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">5160</span><span id="line-5160">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">5161</span><span id="line-5161">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5162</span><span id="line-5162">       *          &lt;jv&gt;builder&lt;/jv&gt;.produces(&lt;jk&gt;false&lt;/jk&gt;, &lt;js&gt;"application/json"&lt;/js&gt;);</span>
<span class="source-line-no">5163</span><span id="line-5163">       *       }</span>
<span class="source-line-no">5164</span><span id="line-5164">       *    }</span>
<span class="source-line-no">5165</span><span id="line-5165">       * &lt;/p&gt;</span>
<span class="source-line-no">5166</span><span id="line-5166">       *</span>
<span class="source-line-no">5167</span><span id="line-5167">       * &lt;p&gt;</span>
<span class="source-line-no">5168</span><span id="line-5168">       * This affects the returned values from the following:</span>
<span class="source-line-no">5169</span><span id="line-5169">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">5170</span><span id="line-5170">       *    &lt;li class='jm'&gt;{@link RestContext#getProduces() RestContext.getProduces()}</span>
<span class="source-line-no">5171</span><span id="line-5171">       *    &lt;li class='jm'&gt;{@link SwaggerProvider#getSwagger(RestContext,Locale)} - Affects produces field.</span>
<span class="source-line-no">5172</span><span id="line-5172">       * &lt;/ul&gt;</span>
<span class="source-line-no">5173</span><span id="line-5173">       *</span>
<span class="source-line-no">5174</span><span id="line-5174">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5175</span><span id="line-5175">       *    &lt;li class='ja'&gt;{@link Rest#produces}</span>
<span class="source-line-no">5176</span><span id="line-5176">       *    &lt;li class='ja'&gt;{@link RestOp#produces}</span>
<span class="source-line-no">5177</span><span id="line-5177">       *    &lt;li class='ja'&gt;{@link RestGet#produces}</span>
<span class="source-line-no">5178</span><span id="line-5178">       *    &lt;li class='ja'&gt;{@link RestPut#produces}</span>
<span class="source-line-no">5179</span><span id="line-5179">       *    &lt;li class='ja'&gt;{@link RestPost#produces}</span>
<span class="source-line-no">5180</span><span id="line-5180">       * &lt;/ul&gt;</span>
<span class="source-line-no">5181</span><span id="line-5181">       *</span>
<span class="source-line-no">5182</span><span id="line-5182">       * @param values The values to add to this setting.</span>
<span class="source-line-no">5183</span><span id="line-5183">       * @return This object.</span>
<span class="source-line-no">5184</span><span id="line-5184">       */</span>
<span class="source-line-no">5185</span><span id="line-5185">      @FluentSetter</span>
<span class="source-line-no">5186</span><span id="line-5186">      public Builder produces(MediaType...values) {</span>
<span class="source-line-no">5187</span><span id="line-5187">         produces = addAll(produces, values);</span>
<span class="source-line-no">5188</span><span id="line-5188">         return this;</span>
<span class="source-line-no">5189</span><span id="line-5189">      }</span>
<span class="source-line-no">5190</span><span id="line-5190"></span>
<span class="source-line-no">5191</span><span id="line-5191">      /**</span>
<span class="source-line-no">5192</span><span id="line-5192">       * Returns the media types produced by this resource if it's manually specified.</span>
<span class="source-line-no">5193</span><span id="line-5193">       *</span>
<span class="source-line-no">5194</span><span id="line-5194">       * @return The media types.</span>
<span class="source-line-no">5195</span><span id="line-5195">       */</span>
<span class="source-line-no">5196</span><span id="line-5196">      public Optional&lt;List&lt;MediaType&gt;&gt; produces() {</span>
<span class="source-line-no">5197</span><span id="line-5197">         return Utils.opt(produces);</span>
<span class="source-line-no">5198</span><span id="line-5198">      }</span>
<span class="source-line-no">5199</span><span id="line-5199"></span>
<span class="source-line-no">5200</span><span id="line-5200">      /**</span>
<span class="source-line-no">5201</span><span id="line-5201">       * Supported content media types.</span>
<span class="source-line-no">5202</span><span id="line-5202">       *</span>
<span class="source-line-no">5203</span><span id="line-5203">       * &lt;p&gt;</span>
<span class="source-line-no">5204</span><span id="line-5204">       * Overrides the media types inferred from the parsers that identify what media types can be consumed by the resource.</span>
<span class="source-line-no">5205</span><span id="line-5205">       * &lt;br&gt;An example where this might be useful if you have parsers registered that handle media types that you</span>
<span class="source-line-no">5206</span><span id="line-5206">       * don't want exposed in the Swagger documentation.</span>
<span class="source-line-no">5207</span><span id="line-5207">       *</span>
<span class="source-line-no">5208</span><span id="line-5208">       * &lt;h5 class='section'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">5209</span><span id="line-5209">       * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5210</span><span id="line-5210">       *    &lt;jc&gt;// Option #1 - Defined via annotation resolving to a config file setting with default value.&lt;/jc&gt;</span>
<span class="source-line-no">5211</span><span id="line-5211">       *    &lt;ja&gt;@Rest&lt;/ja&gt;(consumes={&lt;js&gt;"$C{REST/supportedConsumes,application/json}"&lt;/js&gt;})</span>
<span class="source-line-no">5212</span><span id="line-5212">       *    &lt;jk&gt;public class&lt;/jk&gt; MyResource {</span>
<span class="source-line-no">5213</span><span id="line-5213">       *</span>
<span class="source-line-no">5214</span><span id="line-5214">       *       &lt;jc&gt;// Option #2 - Defined via builder passed in through resource constructor.&lt;/jc&gt;</span>
<span class="source-line-no">5215</span><span id="line-5215">       *       &lt;jk&gt;public&lt;/jk&gt; MyResource(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5216</span><span id="line-5216">       *</span>
<span class="source-line-no">5217</span><span id="line-5217">       *          &lt;jc&gt;// Using method on builder.&lt;/jc&gt;</span>
<span class="source-line-no">5218</span><span id="line-5218">       *          &lt;jv&gt;builder&lt;/jv&gt;.consumes(&lt;jk&gt;false&lt;/jk&gt;, &lt;js&gt;"application/json"&lt;/js&gt;)</span>
<span class="source-line-no">5219</span><span id="line-5219">       *       }</span>
<span class="source-line-no">5220</span><span id="line-5220">       *</span>
<span class="source-line-no">5221</span><span id="line-5221">       *       &lt;jc&gt;// Option #3 - Defined via builder passed in through init method.&lt;/jc&gt;</span>
<span class="source-line-no">5222</span><span id="line-5222">       *       &lt;ja&gt;@RestInit&lt;/ja&gt;</span>
<span class="source-line-no">5223</span><span id="line-5223">       *       &lt;jk&gt;public void&lt;/jk&gt; init(RestContext.Builder &lt;jv&gt;builder&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5224</span><span id="line-5224">       *          &lt;jv&gt;builder&lt;/jv&gt;.consumes(&lt;jk&gt;false&lt;/jk&gt;, &lt;js&gt;"application/json"&lt;/js&gt;);</span>
<span class="source-line-no">5225</span><span id="line-5225">       *       }</span>
<span class="source-line-no">5226</span><span id="line-5226">       *    }</span>
<span class="source-line-no">5227</span><span id="line-5227">       * &lt;/p&gt;</span>
<span class="source-line-no">5228</span><span id="line-5228">       *</span>
<span class="source-line-no">5229</span><span id="line-5229">       * &lt;p&gt;</span>
<span class="source-line-no">5230</span><span id="line-5230">       * This affects the returned values from the following:</span>
<span class="source-line-no">5231</span><span id="line-5231">       * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">5232</span><span id="line-5232">       *    &lt;li class='jm'&gt;{@link RestContext#getConsumes() RestContext.getConsumes()}</span>
<span class="source-line-no">5233</span><span id="line-5233">       * &lt;/ul&gt;</span>
<span class="source-line-no">5234</span><span id="line-5234">       *</span>
<span class="source-line-no">5235</span><span id="line-5235">       * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5236</span><span id="line-5236">       *    &lt;li class='ja'&gt;{@link Rest#consumes}</span>
<span class="source-line-no">5237</span><span id="line-5237">       *    &lt;li class='ja'&gt;{@link RestOp#consumes}</span>
<span class="source-line-no">5238</span><span id="line-5238">       *    &lt;li class='ja'&gt;{@link RestPut#consumes}</span>
<span class="source-line-no">5239</span><span id="line-5239">       *    &lt;li class='ja'&gt;{@link RestPost#consumes}</span>
<span class="source-line-no">5240</span><span id="line-5240">       * &lt;/ul&gt;</span>
<span class="source-line-no">5241</span><span id="line-5241">       *</span>
<span class="source-line-no">5242</span><span id="line-5242">       * @param values The values to add to this setting.</span>
<span class="source-line-no">5243</span><span id="line-5243">       * @return This object.</span>
<span class="source-line-no">5244</span><span id="line-5244">       */</span>
<span class="source-line-no">5245</span><span id="line-5245">      @FluentSetter</span>
<span class="source-line-no">5246</span><span id="line-5246">      public Builder consumes(MediaType...values) {</span>
<span class="source-line-no">5247</span><span id="line-5247">         consumes = addAll(consumes, values);</span>
<span class="source-line-no">5248</span><span id="line-5248">         return this;</span>
<span class="source-line-no">5249</span><span id="line-5249">      }</span>
<span class="source-line-no">5250</span><span id="line-5250"></span>
<span class="source-line-no">5251</span><span id="line-5251">      /**</span>
<span class="source-line-no">5252</span><span id="line-5252">       * Returns the media types consumed by this resource if it's manually specified.</span>
<span class="source-line-no">5253</span><span id="line-5253">       *</span>
<span class="source-line-no">5254</span><span id="line-5254">       * @return The media types.</span>
<span class="source-line-no">5255</span><span id="line-5255">       */</span>
<span class="source-line-no">5256</span><span id="line-5256">      public Optional&lt;List&lt;MediaType&gt;&gt; consumes() {</span>
<span class="source-line-no">5257</span><span id="line-5257">         return Utils.opt(consumes);</span>
<span class="source-line-no">5258</span><span id="line-5258">      }</span>
<span class="source-line-no">5259</span><span id="line-5259"></span>
<span class="source-line-no">5260</span><span id="line-5260">      // &lt;FluentSetters&gt;</span>
<span class="source-line-no">5261</span><span id="line-5261"></span>
<span class="source-line-no">5262</span><span id="line-5262">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5263</span><span id="line-5263">      public Builder annotations(Annotation...values) {</span>
<span class="source-line-no">5264</span><span id="line-5264">         super.annotations(values);</span>
<span class="source-line-no">5265</span><span id="line-5265">         return this;</span>
<span class="source-line-no">5266</span><span id="line-5266">      }</span>
<span class="source-line-no">5267</span><span id="line-5267"></span>
<span class="source-line-no">5268</span><span id="line-5268">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5269</span><span id="line-5269">      public Builder apply(AnnotationWorkList work) {</span>
<span class="source-line-no">5270</span><span id="line-5270">         super.apply(work);</span>
<span class="source-line-no">5271</span><span id="line-5271">         return this;</span>
<span class="source-line-no">5272</span><span id="line-5272">      }</span>
<span class="source-line-no">5273</span><span id="line-5273"></span>
<span class="source-line-no">5274</span><span id="line-5274">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5275</span><span id="line-5275">      public Builder applyAnnotations(Object...from) {</span>
<span class="source-line-no">5276</span><span id="line-5276">         super.applyAnnotations(from);</span>
<span class="source-line-no">5277</span><span id="line-5277">         return this;</span>
<span class="source-line-no">5278</span><span id="line-5278">      }</span>
<span class="source-line-no">5279</span><span id="line-5279"></span>
<span class="source-line-no">5280</span><span id="line-5280">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5281</span><span id="line-5281">      public Builder applyAnnotations(Class&lt;?&gt;...from) {</span>
<span class="source-line-no">5282</span><span id="line-5282">         super.applyAnnotations(from);</span>
<span class="source-line-no">5283</span><span id="line-5283">         return this;</span>
<span class="source-line-no">5284</span><span id="line-5284">      }</span>
<span class="source-line-no">5285</span><span id="line-5285"></span>
<span class="source-line-no">5286</span><span id="line-5286">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5287</span><span id="line-5287">      public Builder cache(Cache&lt;HashKey,? extends org.apache.juneau.Context&gt; value) {</span>
<span class="source-line-no">5288</span><span id="line-5288">         super.cache(value);</span>
<span class="source-line-no">5289</span><span id="line-5289">         return this;</span>
<span class="source-line-no">5290</span><span id="line-5290">      }</span>
<span class="source-line-no">5291</span><span id="line-5291"></span>
<span class="source-line-no">5292</span><span id="line-5292">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5293</span><span id="line-5293">      public Builder debug() {</span>
<span class="source-line-no">5294</span><span id="line-5294">         super.debug();</span>
<span class="source-line-no">5295</span><span id="line-5295">         return this;</span>
<span class="source-line-no">5296</span><span id="line-5296">      }</span>
<span class="source-line-no">5297</span><span id="line-5297"></span>
<span class="source-line-no">5298</span><span id="line-5298">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5299</span><span id="line-5299">      public Builder debug(boolean value) {</span>
<span class="source-line-no">5300</span><span id="line-5300">         super.debug(value);</span>
<span class="source-line-no">5301</span><span id="line-5301">         return this;</span>
<span class="source-line-no">5302</span><span id="line-5302">      }</span>
<span class="source-line-no">5303</span><span id="line-5303"></span>
<span class="source-line-no">5304</span><span id="line-5304">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5305</span><span id="line-5305">      public Builder impl(Context value) {</span>
<span class="source-line-no">5306</span><span id="line-5306">         super.impl(value);</span>
<span class="source-line-no">5307</span><span id="line-5307">         return this;</span>
<span class="source-line-no">5308</span><span id="line-5308">      }</span>
<span class="source-line-no">5309</span><span id="line-5309"></span>
<span class="source-line-no">5310</span><span id="line-5310">      @Override /* GENERATED - org.apache.juneau.Context.Builder */</span>
<span class="source-line-no">5311</span><span id="line-5311">      public Builder type(Class&lt;? extends org.apache.juneau.Context&gt; value) {</span>
<span class="source-line-no">5312</span><span id="line-5312">         super.type(value);</span>
<span class="source-line-no">5313</span><span id="line-5313">         return this;</span>
<span class="source-line-no">5314</span><span id="line-5314">      }</span>
<span class="source-line-no">5315</span><span id="line-5315"></span>
<span class="source-line-no">5316</span><span id="line-5316">      // &lt;/FluentSetters&gt;</span>
<span class="source-line-no">5317</span><span id="line-5317"></span>
<span class="source-line-no">5318</span><span id="line-5318">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5319</span><span id="line-5319">      // Helper methods</span>
<span class="source-line-no">5320</span><span id="line-5320">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5321</span><span id="line-5321"></span>
<span class="source-line-no">5322</span><span id="line-5322">      private static &lt;T extends Annotation&gt; MethodList getAnnotatedMethods(Supplier&lt;?&gt; resource, Class&lt;T&gt; annotation, Predicate&lt;T&gt; predicate) {</span>
<span class="source-line-no">5323</span><span id="line-5323">         Map&lt;String,Method&gt; x = map();</span>
<span class="source-line-no">5324</span><span id="line-5324">         Object r = resource.get();</span>
<span class="source-line-no">5325</span><span id="line-5325"></span>
<span class="source-line-no">5326</span><span id="line-5326">         ClassInfo.ofProxy(r).forEachAllMethodParentFirst(</span>
<span class="source-line-no">5327</span><span id="line-5327">            y -&gt; y.hasAnnotation(annotation),</span>
<span class="source-line-no">5328</span><span id="line-5328">            y -&gt; y.forEachAnnotation(annotation, predicate, z -&gt; x.put(y.getSignature(), y.accessible().inner()))</span>
<span class="source-line-no">5329</span><span id="line-5329">         );</span>
<span class="source-line-no">5330</span><span id="line-5330"></span>
<span class="source-line-no">5331</span><span id="line-5331">         MethodList x2 = MethodList.of(x.values());</span>
<span class="source-line-no">5332</span><span id="line-5332">         return x2;</span>
<span class="source-line-no">5333</span><span id="line-5333">      }</span>
<span class="source-line-no">5334</span><span id="line-5334"></span>
<span class="source-line-no">5335</span><span id="line-5335">      private static boolean isRestBeanMethod(MethodInfo mi) {</span>
<span class="source-line-no">5336</span><span id="line-5336">         RestInject x = mi.getAnnotation(RestInject.class);</span>
<span class="source-line-no">5337</span><span id="line-5337">         return x != null &amp;&amp; x.methodScope().length == 0;</span>
<span class="source-line-no">5338</span><span id="line-5338">      }</span>
<span class="source-line-no">5339</span><span id="line-5339"></span>
<span class="source-line-no">5340</span><span id="line-5340">      private static boolean isRestBeanMethod(MethodInfo mi, String name) {</span>
<span class="source-line-no">5341</span><span id="line-5341">         RestInject x = mi.getAnnotation(RestInject.class);</span>
<span class="source-line-no">5342</span><span id="line-5342">         return x != null &amp;&amp; x.methodScope().length == 0 &amp;&amp; x.name().equals(name);</span>
<span class="source-line-no">5343</span><span id="line-5343">      }</span>
<span class="source-line-no">5344</span><span id="line-5344"></span>
<span class="source-line-no">5345</span><span id="line-5345">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5346</span><span id="line-5346">      // Methods inherited from ServletConfig</span>
<span class="source-line-no">5347</span><span id="line-5347">      //----------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5348</span><span id="line-5348"></span>
<span class="source-line-no">5349</span><span id="line-5349">      @Override /* ServletConfig */</span>
<span class="source-line-no">5350</span><span id="line-5350">      public String getInitParameter(String name) {</span>
<span class="source-line-no">5351</span><span id="line-5351">         return inner == null ? null : inner.getInitParameter(name);</span>
<span class="source-line-no">5352</span><span id="line-5352">      }</span>
<span class="source-line-no">5353</span><span id="line-5353"></span>
<span class="source-line-no">5354</span><span id="line-5354">      @Override /* ServletConfig */</span>
<span class="source-line-no">5355</span><span id="line-5355">      public Enumeration&lt;String&gt; getInitParameterNames() {</span>
<span class="source-line-no">5356</span><span id="line-5356">         return inner == null ? new Vector&lt;String&gt;().elements() : inner.getInitParameterNames();</span>
<span class="source-line-no">5357</span><span id="line-5357">      }</span>
<span class="source-line-no">5358</span><span id="line-5358"></span>
<span class="source-line-no">5359</span><span id="line-5359">      @Override /* ServletConfig */</span>
<span class="source-line-no">5360</span><span id="line-5360">      public ServletContext getServletContext() {</span>
<span class="source-line-no">5361</span><span id="line-5361">         return inner != null ? inner.getServletContext() : parentContext != null ? parentContext.getBuilder().getServletContext() : null;</span>
<span class="source-line-no">5362</span><span id="line-5362">      }</span>
<span class="source-line-no">5363</span><span id="line-5363"></span>
<span class="source-line-no">5364</span><span id="line-5364">      @Override /* ServletConfig */</span>
<span class="source-line-no">5365</span><span id="line-5365">      public String getServletName() {</span>
<span class="source-line-no">5366</span><span id="line-5366">         return inner == null ? null : inner.getServletName();</span>
<span class="source-line-no">5367</span><span id="line-5367">      }</span>
<span class="source-line-no">5368</span><span id="line-5368">   }</span>
<span class="source-line-no">5369</span><span id="line-5369"></span>
<span class="source-line-no">5370</span><span id="line-5370">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5371</span><span id="line-5371">   // Instance</span>
<span class="source-line-no">5372</span><span id="line-5372">   //-------------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">5373</span><span id="line-5373"></span>
<span class="source-line-no">5374</span><span id="line-5374">   private final Supplier&lt;?&gt; resource;</span>
<span class="source-line-no">5375</span><span id="line-5375">   private final Class&lt;?&gt; resourceClass;</span>
<span class="source-line-no">5376</span><span id="line-5376"></span>
<span class="source-line-no">5377</span><span id="line-5377">   final Builder builder;</span>
<span class="source-line-no">5378</span><span id="line-5378">   private final boolean</span>
<span class="source-line-no">5379</span><span id="line-5379">      allowContentParam,</span>
<span class="source-line-no">5380</span><span id="line-5380">      renderResponseStackTraces;</span>
<span class="source-line-no">5381</span><span id="line-5381">   private final String</span>
<span class="source-line-no">5382</span><span id="line-5382">      clientVersionHeader,</span>
<span class="source-line-no">5383</span><span id="line-5383">      uriAuthority,</span>
<span class="source-line-no">5384</span><span id="line-5384">      uriContext;</span>
<span class="source-line-no">5385</span><span id="line-5385">   private final String path, fullPath;</span>
<span class="source-line-no">5386</span><span id="line-5386">   private final UrlPathMatcher pathMatcher;</span>
<span class="source-line-no">5387</span><span id="line-5387"></span>
<span class="source-line-no">5388</span><span id="line-5388">   private final Set&lt;String&gt; allowedMethodParams, allowedHeaderParams, allowedMethodHeaders;</span>
<span class="source-line-no">5389</span><span id="line-5389"></span>
<span class="source-line-no">5390</span><span id="line-5390">   private final Class&lt;? extends RestOpArg&gt;[] restOpArgs;</span>
<span class="source-line-no">5391</span><span id="line-5391">   private final BeanContext beanContext;</span>
<span class="source-line-no">5392</span><span id="line-5392">   private final EncoderSet encoders;</span>
<span class="source-line-no">5393</span><span id="line-5393">   private final SerializerSet serializers;</span>
<span class="source-line-no">5394</span><span id="line-5394">   private final ParserSet parsers;</span>
<span class="source-line-no">5395</span><span id="line-5395">   private final HttpPartSerializer partSerializer;</span>
<span class="source-line-no">5396</span><span id="line-5396">   private final HttpPartParser partParser;</span>
<span class="source-line-no">5397</span><span id="line-5397">   private final JsonSchemaGenerator jsonSchemaGenerator;</span>
<span class="source-line-no">5398</span><span id="line-5398">   private final List&lt;MediaType&gt; consumes, produces;</span>
<span class="source-line-no">5399</span><span id="line-5399">   private final HeaderList defaultRequestHeaders, defaultResponseHeaders;</span>
<span class="source-line-no">5400</span><span id="line-5400">   private final NamedAttributeMap defaultRequestAttributes;</span>
<span class="source-line-no">5401</span><span id="line-5401">   private final ResponseProcessor[] responseProcessors;</span>
<span class="source-line-no">5402</span><span id="line-5402">   private final Messages messages;</span>
<span class="source-line-no">5403</span><span id="line-5403">   private final Config config;</span>
<span class="source-line-no">5404</span><span id="line-5404">   private final VarResolver varResolver;</span>
<span class="source-line-no">5405</span><span id="line-5405">   private final RestOperations restOperations;</span>
<span class="source-line-no">5406</span><span id="line-5406">   private final RestChildren restChildren;</span>
<span class="source-line-no">5407</span><span id="line-5407">   private final Logger logger;</span>
<span class="source-line-no">5408</span><span id="line-5408">   private final SwaggerProvider swaggerProvider;</span>
<span class="source-line-no">5409</span><span id="line-5409">   private final BasicHttpException initException;</span>
<span class="source-line-no">5410</span><span id="line-5410">   private final RestContext parentContext;</span>
<span class="source-line-no">5411</span><span id="line-5411">   private final BeanStore beanStore;</span>
<span class="source-line-no">5412</span><span id="line-5412">   private final UriResolution uriResolution;</span>
<span class="source-line-no">5413</span><span id="line-5413">   private final UriRelativity uriRelativity;</span>
<span class="source-line-no">5414</span><span id="line-5414">   private final MethodExecStore methodExecStore;</span>
<span class="source-line-no">5415</span><span id="line-5415">   private final ThrownStore thrownStore;</span>
<span class="source-line-no">5416</span><span id="line-5416">   private final ConcurrentHashMap&lt;Locale,Swagger&gt; swaggerCache = new ConcurrentHashMap&lt;&gt;();</span>
<span class="source-line-no">5417</span><span id="line-5417">   private final Instant startTime;</span>
<span class="source-line-no">5418</span><span id="line-5418">   final Charset defaultCharset;</span>
<span class="source-line-no">5419</span><span id="line-5419">   final long maxInput;</span>
<span class="source-line-no">5420</span><span id="line-5420"></span>
<span class="source-line-no">5421</span><span id="line-5421">   final DefaultClassList defaultClasses;</span>
<span class="source-line-no">5422</span><span id="line-5422">   final DefaultSettingsMap defaultSettings;</span>
<span class="source-line-no">5423</span><span id="line-5423">   final BeanStore rootBeanStore;</span>
<span class="source-line-no">5424</span><span id="line-5424"></span>
<span class="source-line-no">5425</span><span id="line-5425">   // Lifecycle methods</span>
<span class="source-line-no">5426</span><span id="line-5426">   private final MethodInvoker[]</span>
<span class="source-line-no">5427</span><span id="line-5427">      postInitMethods,</span>
<span class="source-line-no">5428</span><span id="line-5428">      postInitChildFirstMethods,</span>
<span class="source-line-no">5429</span><span id="line-5429">      startCallMethods,</span>
<span class="source-line-no">5430</span><span id="line-5430">      endCallMethods,</span>
<span class="source-line-no">5431</span><span id="line-5431">      destroyMethods;</span>
<span class="source-line-no">5432</span><span id="line-5432"></span>
<span class="source-line-no">5433</span><span id="line-5433">   private final MethodList</span>
<span class="source-line-no">5434</span><span id="line-5434">      preCallMethods,</span>
<span class="source-line-no">5435</span><span id="line-5435">      postCallMethods;</span>
<span class="source-line-no">5436</span><span id="line-5436"></span>
<span class="source-line-no">5437</span><span id="line-5437">   private final StaticFiles staticFiles;</span>
<span class="source-line-no">5438</span><span id="line-5438">   private final CallLogger callLogger;</span>
<span class="source-line-no">5439</span><span id="line-5439">   private final DebugEnablement debugEnablement;</span>
<span class="source-line-no">5440</span><span id="line-5440"></span>
<span class="source-line-no">5441</span><span id="line-5441">   private final ThreadLocal&lt;RestSession&gt; localSession = new ThreadLocal&lt;&gt;();</span>
<span class="source-line-no">5442</span><span id="line-5442"></span>
<span class="source-line-no">5443</span><span id="line-5443">   // Gets set when postInitChildFirst() gets called.</span>
<span class="source-line-no">5444</span><span id="line-5444">   private final AtomicBoolean initialized = new AtomicBoolean(false);</span>
<span class="source-line-no">5445</span><span id="line-5445"></span>
<span class="source-line-no">5446</span><span id="line-5446">   /**</span>
<span class="source-line-no">5447</span><span id="line-5447">    * Constructor.</span>
<span class="source-line-no">5448</span><span id="line-5448">    *</span>
<span class="source-line-no">5449</span><span id="line-5449">    * @param builder The builder containing the settings for this bean.</span>
<span class="source-line-no">5450</span><span id="line-5450">    * @throws Exception If any initialization problems were encountered.</span>
<span class="source-line-no">5451</span><span id="line-5451">    */</span>
<span class="source-line-no">5452</span><span id="line-5452">   public RestContext(Builder builder) throws Exception {</span>
<span class="source-line-no">5453</span><span id="line-5453">      super(builder);</span>
<span class="source-line-no">5454</span><span id="line-5454"></span>
<span class="source-line-no">5455</span><span id="line-5455">      startTime = Instant.now();</span>
<span class="source-line-no">5456</span><span id="line-5456"></span>
<span class="source-line-no">5457</span><span id="line-5457">      REGISTRY.put(builder.resourceClass, this);</span>
<span class="source-line-no">5458</span><span id="line-5458"></span>
<span class="source-line-no">5459</span><span id="line-5459">      BasicHttpException _initException = null;</span>
<span class="source-line-no">5460</span><span id="line-5460"></span>
<span class="source-line-no">5461</span><span id="line-5461">      try {</span>
<span class="source-line-no">5462</span><span id="line-5462">         this.builder = builder;</span>
<span class="source-line-no">5463</span><span id="line-5463"></span>
<span class="source-line-no">5464</span><span id="line-5464">         resourceClass = builder.resourceClass;</span>
<span class="source-line-no">5465</span><span id="line-5465">         resource = builder.resource;</span>
<span class="source-line-no">5466</span><span id="line-5466">         parentContext = builder.parentContext;</span>
<span class="source-line-no">5467</span><span id="line-5467">         rootBeanStore = builder.rootBeanStore();</span>
<span class="source-line-no">5468</span><span id="line-5468">         defaultClasses = builder.defaultClasses();</span>
<span class="source-line-no">5469</span><span id="line-5469">         defaultSettings = builder.defaultSettings();</span>
<span class="source-line-no">5470</span><span id="line-5470"></span>
<span class="source-line-no">5471</span><span id="line-5471">         BeanStore bs = beanStore = builder.beanStore();</span>
<span class="source-line-no">5472</span><span id="line-5472">         beanStore</span>
<span class="source-line-no">5473</span><span id="line-5473">            .addBean(BeanStore.class, beanStore)</span>
<span class="source-line-no">5474</span><span id="line-5474">            .addBean(RestContext.class, this)</span>
<span class="source-line-no">5475</span><span id="line-5475">            .addBean(Object.class, resource.get())</span>
<span class="source-line-no">5476</span><span id="line-5476">            .addBean(DefaultSettingsMap.class, defaultSettings)</span>
<span class="source-line-no">5477</span><span id="line-5477">            .addBean(Builder.class, builder)</span>
<span class="source-line-no">5478</span><span id="line-5478">            .addBean(AnnotationWorkList.class, builder.getApplied());</span>
<span class="source-line-no">5479</span><span id="line-5479"></span>
<span class="source-line-no">5480</span><span id="line-5480">         path = builder.path != null ? builder.path : "";</span>
<span class="source-line-no">5481</span><span id="line-5481">         fullPath = (parentContext == null ? "" : (parentContext.fullPath + '/')) + path;</span>
<span class="source-line-no">5482</span><span id="line-5482">         String p = path;</span>
<span class="source-line-no">5483</span><span id="line-5483">         if (! p.endsWith("/*"))</span>
<span class="source-line-no">5484</span><span id="line-5484">            p += "/*";</span>
<span class="source-line-no">5485</span><span id="line-5485">         pathMatcher = UrlPathMatcher.of(p);</span>
<span class="source-line-no">5486</span><span id="line-5486"></span>
<span class="source-line-no">5487</span><span id="line-5487">         allowContentParam = ! builder.disableContentParam;</span>
<span class="source-line-no">5488</span><span id="line-5488">         allowedHeaderParams = newCaseInsensitiveSet(ofNullable(builder.allowedHeaderParams).map(x -&gt; "NONE".equals(x) ? "" : x).orElse(""));</span>
<span class="source-line-no">5489</span><span id="line-5489">         allowedMethodParams = newCaseInsensitiveSet(ofNullable(builder.allowedMethodParams).map(x -&gt; "NONE".equals(x) ? "" : x).orElse(""));</span>
<span class="source-line-no">5490</span><span id="line-5490">         allowedMethodHeaders = newCaseInsensitiveSet(ofNullable(builder.allowedMethodHeaders).map(x -&gt; "NONE".equals(x) ? "" : x).orElse(""));</span>
<span class="source-line-no">5491</span><span id="line-5491">         clientVersionHeader = builder.clientVersionHeader;</span>
<span class="source-line-no">5492</span><span id="line-5492">         defaultCharset = builder.defaultCharset;</span>
<span class="source-line-no">5493</span><span id="line-5493">         maxInput = builder.maxInput;</span>
<span class="source-line-no">5494</span><span id="line-5494">         renderResponseStackTraces = builder.renderResponseStackTraces;</span>
<span class="source-line-no">5495</span><span id="line-5495">         uriContext = builder.uriContext;</span>
<span class="source-line-no">5496</span><span id="line-5496">         uriAuthority = builder.uriAuthority;</span>
<span class="source-line-no">5497</span><span id="line-5497">         uriResolution = builder.uriResolution;</span>
<span class="source-line-no">5498</span><span id="line-5498">         uriRelativity = builder.uriRelativity;</span>
<span class="source-line-no">5499</span><span id="line-5499"></span>
<span class="source-line-no">5500</span><span id="line-5500">         beanContext = bs.add(BeanContext.class, builder.beanContext().build());</span>
<span class="source-line-no">5501</span><span id="line-5501">         encoders = bs.add(EncoderSet.class, builder.encoders().build());</span>
<span class="source-line-no">5502</span><span id="line-5502">         serializers = bs.add(SerializerSet.class, builder.serializers().build());</span>
<span class="source-line-no">5503</span><span id="line-5503">         parsers = bs.add(ParserSet.class, builder.parsers().build());</span>
<span class="source-line-no">5504</span><span id="line-5504">         logger = bs.add(Logger.class, builder.logger());</span>
<span class="source-line-no">5505</span><span id="line-5505">         thrownStore = bs.add(ThrownStore.class, builder.thrownStore().build());</span>
<span class="source-line-no">5506</span><span id="line-5506">         methodExecStore = bs.add(MethodExecStore.class, builder.methodExecStore().thrownStoreOnce(thrownStore).build());</span>
<span class="source-line-no">5507</span><span id="line-5507">         messages = bs.add(Messages.class, builder.messages().build());</span>
<span class="source-line-no">5508</span><span id="line-5508">         varResolver = bs.add(VarResolver.class, builder.varResolver().bean(Messages.class, messages).build());</span>
<span class="source-line-no">5509</span><span id="line-5509">         config = bs.add(Config.class, builder.config().resolving(varResolver.createSession()));</span>
<span class="source-line-no">5510</span><span id="line-5510">         responseProcessors = bs.add(ResponseProcessor[].class, builder.responseProcessors().build().toArray());</span>
<span class="source-line-no">5511</span><span id="line-5511">         callLogger = bs.add(CallLogger.class, builder.callLogger().orElse(null));</span>
<span class="source-line-no">5512</span><span id="line-5512">         partSerializer = bs.add(HttpPartSerializer.class, builder.partSerializer().create());</span>
<span class="source-line-no">5513</span><span id="line-5513">         partParser = bs.add(HttpPartParser.class, builder.partParser().create());</span>
<span class="source-line-no">5514</span><span id="line-5514">         jsonSchemaGenerator = bs.add(JsonSchemaGenerator.class, builder.jsonSchemaGenerator().build());</span>
<span class="source-line-no">5515</span><span id="line-5515">         staticFiles = bs.add(StaticFiles.class, builder.staticFiles().orElse(null));</span>
<span class="source-line-no">5516</span><span id="line-5516">         bs.add(FileFinder.class, staticFiles);</span>
<span class="source-line-no">5517</span><span id="line-5517">         defaultRequestHeaders = bs.add(HeaderList.class, builder.defaultRequestHeaders(), "defaultRequestHeaders");</span>
<span class="source-line-no">5518</span><span id="line-5518">         defaultResponseHeaders = bs.add(HeaderList.class, builder.defaultResponseHeaders(), "defaultResponseHeaders");</span>
<span class="source-line-no">5519</span><span id="line-5519">         defaultRequestAttributes = bs.add(NamedAttributeMap.class, builder.defaultRequestAttributes(), "defaultRequestAttributes");</span>
<span class="source-line-no">5520</span><span id="line-5520">         restOpArgs = builder.restOpArgs().build().asArray();</span>
<span class="source-line-no">5521</span><span id="line-5521">         debugEnablement = bs.add(DebugEnablement.class, builder.debugEnablement().orElse(null));</span>
<span class="source-line-no">5522</span><span id="line-5522">         startCallMethods = builder.startCallMethods().stream().map(this::toMethodInvoker).toArray(MethodInvoker[]::new);</span>
<span class="source-line-no">5523</span><span id="line-5523">         endCallMethods = builder.endCallMethods().stream().map(this::toMethodInvoker).toArray(MethodInvoker[]::new);</span>
<span class="source-line-no">5524</span><span id="line-5524">         postInitMethods = builder.postInitMethods().stream().map(this::toMethodInvoker).toArray(MethodInvoker[]::new);</span>
<span class="source-line-no">5525</span><span id="line-5525">         postInitChildFirstMethods = builder.postInitChildFirstMethods().stream().map(this::toMethodInvoker).toArray(MethodInvoker[]::new);</span>
<span class="source-line-no">5526</span><span id="line-5526">         destroyMethods = builder.destroyMethods().stream().map(this::toMethodInvoker).toArray(MethodInvoker[]::new);</span>
<span class="source-line-no">5527</span><span id="line-5527">         preCallMethods = builder.preCallMethods();</span>
<span class="source-line-no">5528</span><span id="line-5528">         postCallMethods = builder.postCallMethods();</span>
<span class="source-line-no">5529</span><span id="line-5529">         restOperations = builder.restOperations(this).build();</span>
<span class="source-line-no">5530</span><span id="line-5530">         restChildren = builder.restChildren(this).build();</span>
<span class="source-line-no">5531</span><span id="line-5531">         swaggerProvider = bs.add(SwaggerProvider.class, builder.swaggerProvider().orElse(null));</span>
<span class="source-line-no">5532</span><span id="line-5532"></span>
<span class="source-line-no">5533</span><span id="line-5533">         List&lt;RestOpContext&gt; opContexts = restOperations.getOpContexts();</span>
<span class="source-line-no">5534</span><span id="line-5534"></span>
<span class="source-line-no">5535</span><span id="line-5535">         produces = builder.produces().orElseGet(</span>
<span class="source-line-no">5536</span><span id="line-5536">            ()-&gt;{</span>
<span class="source-line-no">5537</span><span id="line-5537">               Set&lt;MediaType&gt; s = opContexts.isEmpty() ? emptySet() : setFrom(opContexts.get(0).getSerializers().getSupportedMediaTypes());</span>
<span class="source-line-no">5538</span><span id="line-5538">               opContexts.forEach(x -&gt; s.retainAll(x.getSerializers().getSupportedMediaTypes()));</span>
<span class="source-line-no">5539</span><span id="line-5539">               return u(listFrom(s));</span>
<span class="source-line-no">5540</span><span id="line-5540">            }</span>
<span class="source-line-no">5541</span><span id="line-5541">         );</span>
<span class="source-line-no">5542</span><span id="line-5542">         consumes = builder.consumes().orElseGet(</span>
<span class="source-line-no">5543</span><span id="line-5543">            ()-&gt;{</span>
<span class="source-line-no">5544</span><span id="line-5544">               Set&lt;MediaType&gt; s = opContexts.isEmpty() ? emptySet() : setFrom(opContexts.get(0).getParsers().getSupportedMediaTypes());</span>
<span class="source-line-no">5545</span><span id="line-5545">               opContexts.forEach(x -&gt; s.retainAll(x.getParsers().getSupportedMediaTypes()));</span>
<span class="source-line-no">5546</span><span id="line-5546">               return u(listFrom(s));</span>
<span class="source-line-no">5547</span><span id="line-5547">            }</span>
<span class="source-line-no">5548</span><span id="line-5548">         );</span>
<span class="source-line-no">5549</span><span id="line-5549"></span>
<span class="source-line-no">5550</span><span id="line-5550">      } catch (BasicHttpException e) {</span>
<span class="source-line-no">5551</span><span id="line-5551">         _initException = e;</span>
<span class="source-line-no">5552</span><span id="line-5552">         throw e;</span>
<span class="source-line-no">5553</span><span id="line-5553">      } catch (Exception e) {</span>
<span class="source-line-no">5554</span><span id="line-5554">         _initException = new InternalServerError(e);</span>
<span class="source-line-no">5555</span><span id="line-5555">         throw e;</span>
<span class="source-line-no">5556</span><span id="line-5556">      } finally {</span>
<span class="source-line-no">5557</span><span id="line-5557">         initException = _initException;</span>
<span class="source-line-no">5558</span><span id="line-5558">      }</span>
<span class="source-line-no">5559</span><span id="line-5559">   }</span>
<span class="source-line-no">5560</span><span id="line-5560"></span>
<span class="source-line-no">5561</span><span id="line-5561">   private MethodInvoker toMethodInvoker(Method m) {</span>
<span class="source-line-no">5562</span><span id="line-5562">      return new MethodInvoker(m, getMethodExecStats(m));</span>
<span class="source-line-no">5563</span><span id="line-5563">   }</span>
<span class="source-line-no">5564</span><span id="line-5564"></span>
<span class="source-line-no">5565</span><span id="line-5565">   private Set&lt;String&gt; newCaseInsensitiveSet(String value) {</span>
<span class="source-line-no">5566</span><span id="line-5566">      Set&lt;String&gt; s = new TreeSet&lt;&gt;(String.CASE_INSENSITIVE_ORDER) {</span>
<span class="source-line-no">5567</span><span id="line-5567">         private static final long serialVersionUID = 1L;</span>
<span class="source-line-no">5568</span><span id="line-5568">         @Override</span>
<span class="source-line-no">5569</span><span id="line-5569">         public boolean contains(Object v) {</span>
<span class="source-line-no">5570</span><span id="line-5570">            return v == null ? false : super.contains(v);</span>
<span class="source-line-no">5571</span><span id="line-5571">         }</span>
<span class="source-line-no">5572</span><span id="line-5572">      };</span>
<span class="source-line-no">5573</span><span id="line-5573">      Utils.split(value, x -&gt; s.add(x));</span>
<span class="source-line-no">5574</span><span id="line-5574">      return u(s);</span>
<span class="source-line-no">5575</span><span id="line-5575">   }</span>
<span class="source-line-no">5576</span><span id="line-5576"></span>
<span class="source-line-no">5577</span><span id="line-5577">   @Override /* Context */</span>
<span class="source-line-no">5578</span><span id="line-5578">   public RestSession.Builder createSession() {</span>
<span class="source-line-no">5579</span><span id="line-5579">      return RestSession.create(this);</span>
<span class="source-line-no">5580</span><span id="line-5580">   }</span>
<span class="source-line-no">5581</span><span id="line-5581"></span>
<span class="source-line-no">5582</span><span id="line-5582">   /**</span>
<span class="source-line-no">5583</span><span id="line-5583">    * Returns the bean store associated with this context.</span>
<span class="source-line-no">5584</span><span id="line-5584">    *</span>
<span class="source-line-no">5585</span><span id="line-5585">    * &lt;p&gt;</span>
<span class="source-line-no">5586</span><span id="line-5586">    * The bean store is used for instantiating child resource classes.</span>
<span class="source-line-no">5587</span><span id="line-5587">    *</span>
<span class="source-line-no">5588</span><span id="line-5588">    * @return The resource resolver associated with this context.</span>
<span class="source-line-no">5589</span><span id="line-5589">    */</span>
<span class="source-line-no">5590</span><span id="line-5590">   public BeanStore getBeanStore() {</span>
<span class="source-line-no">5591</span><span id="line-5591">      return beanStore;</span>
<span class="source-line-no">5592</span><span id="line-5592">   }</span>
<span class="source-line-no">5593</span><span id="line-5593"></span>
<span class="source-line-no">5594</span><span id="line-5594">   /**</span>
<span class="source-line-no">5595</span><span id="line-5595">    * Returns the bean context associated with this context.</span>
<span class="source-line-no">5596</span><span id="line-5596">    *</span>
<span class="source-line-no">5597</span><span id="line-5597">    * @return The bean store associated with this context.</span>
<span class="source-line-no">5598</span><span id="line-5598">    */</span>
<span class="source-line-no">5599</span><span id="line-5599">   public BeanContext getBeanContext() {</span>
<span class="source-line-no">5600</span><span id="line-5600">      return beanContext;</span>
<span class="source-line-no">5601</span><span id="line-5601">   }</span>
<span class="source-line-no">5602</span><span id="line-5602"></span>
<span class="source-line-no">5603</span><span id="line-5603">   /**</span>
<span class="source-line-no">5604</span><span id="line-5604">    * Returns the encoders associated with this context.</span>
<span class="source-line-no">5605</span><span id="line-5605">    *</span>
<span class="source-line-no">5606</span><span id="line-5606">    * @return The encoders associated with this context.</span>
<span class="source-line-no">5607</span><span id="line-5607">    */</span>
<span class="source-line-no">5608</span><span id="line-5608">   public EncoderSet getEncoders() {</span>
<span class="source-line-no">5609</span><span id="line-5609">      return encoders;</span>
<span class="source-line-no">5610</span><span id="line-5610">   }</span>
<span class="source-line-no">5611</span><span id="line-5611"></span>
<span class="source-line-no">5612</span><span id="line-5612">   /**</span>
<span class="source-line-no">5613</span><span id="line-5613">    * Returns the serializers associated with this context.</span>
<span class="source-line-no">5614</span><span id="line-5614">    *</span>
<span class="source-line-no">5615</span><span id="line-5615">    * @return The serializers associated with this context.</span>
<span class="source-line-no">5616</span><span id="line-5616">    */</span>
<span class="source-line-no">5617</span><span id="line-5617">   public SerializerSet getSerializers() {</span>
<span class="source-line-no">5618</span><span id="line-5618">      return serializers;</span>
<span class="source-line-no">5619</span><span id="line-5619">   }</span>
<span class="source-line-no">5620</span><span id="line-5620"></span>
<span class="source-line-no">5621</span><span id="line-5621">   /**</span>
<span class="source-line-no">5622</span><span id="line-5622">    * Returns the parsers associated with this context.</span>
<span class="source-line-no">5623</span><span id="line-5623">    *</span>
<span class="source-line-no">5624</span><span id="line-5624">    * @return The parsers associated with this context.</span>
<span class="source-line-no">5625</span><span id="line-5625">    */</span>
<span class="source-line-no">5626</span><span id="line-5626">   public ParserSet getParsers() {</span>
<span class="source-line-no">5627</span><span id="line-5627">      return parsers;</span>
<span class="source-line-no">5628</span><span id="line-5628">   }</span>
<span class="source-line-no">5629</span><span id="line-5629"></span>
<span class="source-line-no">5630</span><span id="line-5630">   /**</span>
<span class="source-line-no">5631</span><span id="line-5631">    * Returns the time statistics gatherer for the specified method.</span>
<span class="source-line-no">5632</span><span id="line-5632">    *</span>
<span class="source-line-no">5633</span><span id="line-5633">    * @param m The method to get statistics for.</span>
<span class="source-line-no">5634</span><span id="line-5634">    * @return The cached time-stats object.</span>
<span class="source-line-no">5635</span><span id="line-5635">    */</span>
<span class="source-line-no">5636</span><span id="line-5636">   protected MethodExecStats getMethodExecStats(Method m) {</span>
<span class="source-line-no">5637</span><span id="line-5637">      return this.methodExecStore.getStats(m);</span>
<span class="source-line-no">5638</span><span id="line-5638">   }</span>
<span class="source-line-no">5639</span><span id="line-5639"></span>
<span class="source-line-no">5640</span><span id="line-5640">   /**</span>
<span class="source-line-no">5641</span><span id="line-5641">    * Returns the variable resolver for this servlet.</span>
<span class="source-line-no">5642</span><span id="line-5642">    *</span>
<span class="source-line-no">5643</span><span id="line-5643">    * &lt;p&gt;</span>
<span class="source-line-no">5644</span><span id="line-5644">    * Variable resolvers are used to replace variables in property values.</span>
<span class="source-line-no">5645</span><span id="line-5645">    * They can be nested arbitrarily deep.</span>
<span class="source-line-no">5646</span><span id="line-5646">    * They can also return values that themselves contain other variables.</span>
<span class="source-line-no">5647</span><span id="line-5647">    *</span>
<span class="source-line-no">5648</span><span id="line-5648">    * &lt;h5 class='figure'&gt;Example:&lt;/h5&gt;</span>
<span class="source-line-no">5649</span><span id="line-5649">    * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5650</span><span id="line-5650">    *    &lt;ja&gt;@Rest&lt;/ja&gt;(</span>
<span class="source-line-no">5651</span><span id="line-5651">    *       messages=&lt;js&gt;"nls/Messages"&lt;/js&gt;,</span>
<span class="source-line-no">5652</span><span id="line-5652">    *       properties={</span>
<span class="source-line-no">5653</span><span id="line-5653">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"title"&lt;/js&gt;,value=&lt;js&gt;"$L{title}"&lt;/js&gt;),  &lt;jc&gt;// Localized variable in Messages.properties&lt;/jc&gt;</span>
<span class="source-line-no">5654</span><span id="line-5654">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"javaVendor"&lt;/js&gt;,value=&lt;js&gt;"$S{java.vendor,Oracle}"&lt;/js&gt;),  &lt;jc&gt;// System property with default value&lt;/jc&gt;</span>
<span class="source-line-no">5655</span><span id="line-5655">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"foo"&lt;/js&gt;,value=&lt;js&gt;"bar"&lt;/js&gt;),</span>
<span class="source-line-no">5656</span><span id="line-5656">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"bar"&lt;/js&gt;,value=&lt;js&gt;"baz"&lt;/js&gt;),</span>
<span class="source-line-no">5657</span><span id="line-5657">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"v1"&lt;/js&gt;,value=&lt;js&gt;"$R{foo}"&lt;/js&gt;),  &lt;jc&gt;// Request variable.  value="bar"&lt;/jc&gt;</span>
<span class="source-line-no">5658</span><span id="line-5658">    *          &lt;ja&gt;@Property&lt;/ja&gt;(name=&lt;js&gt;"v1"&lt;/js&gt;,value=&lt;js&gt;"$R{foo,bar}"&lt;/js&gt;),  &lt;jc&gt;// Request variable.  value="bar"&lt;/jc&gt;</span>
<span class="source-line-no">5659</span><span id="line-5659">    *       }</span>
<span class="source-line-no">5660</span><span id="line-5660">    *    )</span>
<span class="source-line-no">5661</span><span id="line-5661">    *    &lt;jk&gt;public class&lt;/jk&gt; MyRestResource &lt;jk&gt;extends&lt;/jk&gt; BasicRestServlet {</span>
<span class="source-line-no">5662</span><span id="line-5662">    * &lt;/p&gt;</span>
<span class="source-line-no">5663</span><span id="line-5663">    *</span>
<span class="source-line-no">5664</span><span id="line-5664">    * &lt;p&gt;</span>
<span class="source-line-no">5665</span><span id="line-5665">    * A typical usage pattern involves using variables inside the {@link HtmlDocConfig @HtmlDocConfig} annotation:</span>
<span class="source-line-no">5666</span><span id="line-5666">    * &lt;p class='bjava'&gt;</span>
<span class="source-line-no">5667</span><span id="line-5667">    *    &lt;ja&gt;@RestGet&lt;/ja&gt;(&lt;js&gt;"/{name}/*"&lt;/js&gt;)</span>
<span class="source-line-no">5668</span><span id="line-5668">    *    &lt;ja&gt;@HtmlDocConfig&lt;/ja&gt;(</span>
<span class="source-line-no">5669</span><span id="line-5669">    *       navlinks={</span>
<span class="source-line-no">5670</span><span id="line-5670">    *          &lt;js&gt;"up: $R{requestParentURI}"&lt;/js&gt;,</span>
<span class="source-line-no">5671</span><span id="line-5671">    *          &lt;js&gt;"api: servlet:/api"&lt;/js&gt;,</span>
<span class="source-line-no">5672</span><span id="line-5672">    *          &lt;js&gt;"stats: servlet:/stats"&lt;/js&gt;,</span>
<span class="source-line-no">5673</span><span id="line-5673">    *          &lt;js&gt;"editLevel: servlet:/editLevel?logger=$A{attribute.name, OFF}"&lt;/js&gt;</span>
<span class="source-line-no">5674</span><span id="line-5674">    *       }</span>
<span class="source-line-no">5675</span><span id="line-5675">    *       header={</span>
<span class="source-line-no">5676</span><span id="line-5676">    *          &lt;js&gt;"&amp;lt;h1&amp;gt;$L{MyLocalizedPageTitle}&amp;lt;/h1&amp;gt;"&lt;/js&gt;</span>
<span class="source-line-no">5677</span><span id="line-5677">    *       },</span>
<span class="source-line-no">5678</span><span id="line-5678">    *       aside={</span>
<span class="source-line-no">5679</span><span id="line-5679">    *          &lt;js&gt;"$F{resources/AsideText.html}"&lt;/js&gt;</span>
<span class="source-line-no">5680</span><span id="line-5680">    *       }</span>
<span class="source-line-no">5681</span><span id="line-5681">    *    )</span>
<span class="source-line-no">5682</span><span id="line-5682">    *    &lt;jk&gt;public&lt;/jk&gt; LoggerEntry getLogger(RestRequest &lt;jv&gt;req&lt;/jv&gt;, &lt;ja&gt;@Path&lt;/ja&gt; String &lt;jv&gt;name&lt;/jv&gt;) &lt;jk&gt;throws&lt;/jk&gt; Exception {</span>
<span class="source-line-no">5683</span><span id="line-5683">    * &lt;/p&gt;</span>
<span class="source-line-no">5684</span><span id="line-5684">    *</span>
<span class="source-line-no">5685</span><span id="line-5685">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5686</span><span id="line-5686">    *    &lt;li class='link'&gt;&lt;a class="doclink" href="https://juneau.apache.org/docs/topics/RestServerSvlVariables"&gt;SVL Variables&lt;/a&gt;</span>
<span class="source-line-no">5687</span><span id="line-5687">    * &lt;/ul&gt;</span>
<span class="source-line-no">5688</span><span id="line-5688">    *</span>
<span class="source-line-no">5689</span><span id="line-5689">    * @return The var resolver in use by this resource.</span>
<span class="source-line-no">5690</span><span id="line-5690">    */</span>
<span class="source-line-no">5691</span><span id="line-5691">   public VarResolver getVarResolver() {</span>
<span class="source-line-no">5692</span><span id="line-5692">      return varResolver;</span>
<span class="source-line-no">5693</span><span id="line-5693">   }</span>
<span class="source-line-no">5694</span><span id="line-5694"></span>
<span class="source-line-no">5695</span><span id="line-5695">   /**</span>
<span class="source-line-no">5696</span><span id="line-5696">    * Returns the config file associated with this servlet.</span>
<span class="source-line-no">5697</span><span id="line-5697">    *</span>
<span class="source-line-no">5698</span><span id="line-5698">    * &lt;p&gt;</span>
<span class="source-line-no">5699</span><span id="line-5699">    * The config file is identified via one of the following:</span>
<span class="source-line-no">5700</span><span id="line-5700">    * &lt;ul class='javatree'&gt;</span>
<span class="source-line-no">5701</span><span id="line-5701">    *    &lt;li class='ja'&gt;{@link Rest#config()}</span>
<span class="source-line-no">5702</span><span id="line-5702">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#config(Config)}</span>
<span class="source-line-no">5703</span><span id="line-5703">    * &lt;/ul&gt;</span>
<span class="source-line-no">5704</span><span id="line-5704">    *</span>
<span class="source-line-no">5705</span><span id="line-5705">    * @return</span>
<span class="source-line-no">5706</span><span id="line-5706">    *    The resolving config file associated with this servlet.</span>
<span class="source-line-no">5707</span><span id="line-5707">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5708</span><span id="line-5708">    */</span>
<span class="source-line-no">5709</span><span id="line-5709">   public Config getConfig() {</span>
<span class="source-line-no">5710</span><span id="line-5710">      return config;</span>
<span class="source-line-no">5711</span><span id="line-5711">   }</span>
<span class="source-line-no">5712</span><span id="line-5712"></span>
<span class="source-line-no">5713</span><span id="line-5713"></span>
<span class="source-line-no">5714</span><span id="line-5714">   /**</span>
<span class="source-line-no">5715</span><span id="line-5715">    * Returns the path for this resource as defined by the {@link Rest#path() @Rest(path)} annotation or</span>
<span class="source-line-no">5716</span><span id="line-5716">    * {@link RestContext.Builder#path(String)} method.</span>
<span class="source-line-no">5717</span><span id="line-5717">    *</span>
<span class="source-line-no">5718</span><span id="line-5718">    * &lt;p&gt;</span>
<span class="source-line-no">5719</span><span id="line-5719">    * If path is not specified, returns &lt;js&gt;""&lt;/js&gt;.</span>
<span class="source-line-no">5720</span><span id="line-5720">    *</span>
<span class="source-line-no">5721</span><span id="line-5721">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5722</span><span id="line-5722">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#path(String)}</span>
<span class="source-line-no">5723</span><span id="line-5723">    * &lt;/ul&gt;</span>
<span class="source-line-no">5724</span><span id="line-5724">    *</span>
<span class="source-line-no">5725</span><span id="line-5725">    * @return The servlet path.</span>
<span class="source-line-no">5726</span><span id="line-5726">    */</span>
<span class="source-line-no">5727</span><span id="line-5727">   public String getPath() {</span>
<span class="source-line-no">5728</span><span id="line-5728">      return path;</span>
<span class="source-line-no">5729</span><span id="line-5729">   }</span>
<span class="source-line-no">5730</span><span id="line-5730"></span>
<span class="source-line-no">5731</span><span id="line-5731">   /**</span>
<span class="source-line-no">5732</span><span id="line-5732">    * Returns the path for this resource as defined by the {@link Rest#path() @Rest(path)} annotation or</span>
<span class="source-line-no">5733</span><span id="line-5733">    * {@link RestContext.Builder#path(String)} method concatenated with those on all parent classes.</span>
<span class="source-line-no">5734</span><span id="line-5734">    *</span>
<span class="source-line-no">5735</span><span id="line-5735">    * &lt;p&gt;</span>
<span class="source-line-no">5736</span><span id="line-5736">    * If path is not specified, returns &lt;js&gt;""&lt;/js&gt;.</span>
<span class="source-line-no">5737</span><span id="line-5737">    *</span>
<span class="source-line-no">5738</span><span id="line-5738">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5739</span><span id="line-5739">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#path(String)}</span>
<span class="source-line-no">5740</span><span id="line-5740">    * &lt;/ul&gt;</span>
<span class="source-line-no">5741</span><span id="line-5741">    *</span>
<span class="source-line-no">5742</span><span id="line-5742">    * @return The full path.</span>
<span class="source-line-no">5743</span><span id="line-5743">    */</span>
<span class="source-line-no">5744</span><span id="line-5744">   public String getFullPath() {</span>
<span class="source-line-no">5745</span><span id="line-5745">      return fullPath;</span>
<span class="source-line-no">5746</span><span id="line-5746">   }</span>
<span class="source-line-no">5747</span><span id="line-5747"></span>
<span class="source-line-no">5748</span><span id="line-5748">   /**</span>
<span class="source-line-no">5749</span><span id="line-5749">    * Returns the call logger to use for this resource.</span>
<span class="source-line-no">5750</span><span id="line-5750">    *</span>
<span class="source-line-no">5751</span><span id="line-5751">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5752</span><span id="line-5752">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#callLogger()}</span>
<span class="source-line-no">5753</span><span id="line-5753">    * &lt;/ul&gt;</span>
<span class="source-line-no">5754</span><span id="line-5754">    *</span>
<span class="source-line-no">5755</span><span id="line-5755">    * @return</span>
<span class="source-line-no">5756</span><span id="line-5756">    *    The call logger to use for this resource.</span>
<span class="source-line-no">5757</span><span id="line-5757">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5758</span><span id="line-5758">    */</span>
<span class="source-line-no">5759</span><span id="line-5759">   public CallLogger getCallLogger() {</span>
<span class="source-line-no">5760</span><span id="line-5760">      return callLogger;</span>
<span class="source-line-no">5761</span><span id="line-5761">   }</span>
<span class="source-line-no">5762</span><span id="line-5762"></span>
<span class="source-line-no">5763</span><span id="line-5763">   /**</span>
<span class="source-line-no">5764</span><span id="line-5764">    * Returns the resource bundle used by this resource.</span>
<span class="source-line-no">5765</span><span id="line-5765">    *</span>
<span class="source-line-no">5766</span><span id="line-5766">    * @return</span>
<span class="source-line-no">5767</span><span id="line-5767">    *    The resource bundle for this resource.</span>
<span class="source-line-no">5768</span><span id="line-5768">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5769</span><span id="line-5769">    */</span>
<span class="source-line-no">5770</span><span id="line-5770">   public Messages getMessages() {</span>
<span class="source-line-no">5771</span><span id="line-5771">      return messages;</span>
<span class="source-line-no">5772</span><span id="line-5772">   }</span>
<span class="source-line-no">5773</span><span id="line-5773"></span>
<span class="source-line-no">5774</span><span id="line-5774">   /**</span>
<span class="source-line-no">5775</span><span id="line-5775">    * Returns the Swagger provider used by this resource.</span>
<span class="source-line-no">5776</span><span id="line-5776">    *</span>
<span class="source-line-no">5777</span><span id="line-5777">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5778</span><span id="line-5778">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#swaggerProvider(Class)}</span>
<span class="source-line-no">5779</span><span id="line-5779">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#swaggerProvider(SwaggerProvider)}</span>
<span class="source-line-no">5780</span><span id="line-5780">    * &lt;/ul&gt;</span>
<span class="source-line-no">5781</span><span id="line-5781">    *</span>
<span class="source-line-no">5782</span><span id="line-5782">    * @return</span>
<span class="source-line-no">5783</span><span id="line-5783">    *    The information provider for this resource.</span>
<span class="source-line-no">5784</span><span id="line-5784">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5785</span><span id="line-5785">    */</span>
<span class="source-line-no">5786</span><span id="line-5786">   public SwaggerProvider getSwaggerProvider() {</span>
<span class="source-line-no">5787</span><span id="line-5787">      return swaggerProvider;</span>
<span class="source-line-no">5788</span><span id="line-5788">   }</span>
<span class="source-line-no">5789</span><span id="line-5789"></span>
<span class="source-line-no">5790</span><span id="line-5790">   /**</span>
<span class="source-line-no">5791</span><span id="line-5791">    * Returns the resource object.</span>
<span class="source-line-no">5792</span><span id="line-5792">    *</span>
<span class="source-line-no">5793</span><span id="line-5793">    * &lt;p&gt;</span>
<span class="source-line-no">5794</span><span id="line-5794">    * This is the instance of the class annotated with the {@link Rest @Rest} annotation, usually</span>
<span class="source-line-no">5795</span><span id="line-5795">    * an instance of {@link RestServlet}.</span>
<span class="source-line-no">5796</span><span id="line-5796">    *</span>
<span class="source-line-no">5797</span><span id="line-5797">    * @return</span>
<span class="source-line-no">5798</span><span id="line-5798">    *    The resource object.</span>
<span class="source-line-no">5799</span><span id="line-5799">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5800</span><span id="line-5800">    */</span>
<span class="source-line-no">5801</span><span id="line-5801">   public Object getResource() {</span>
<span class="source-line-no">5802</span><span id="line-5802">      return resource.get();</span>
<span class="source-line-no">5803</span><span id="line-5803">   }</span>
<span class="source-line-no">5804</span><span id="line-5804"></span>
<span class="source-line-no">5805</span><span id="line-5805">   /**</span>
<span class="source-line-no">5806</span><span id="line-5806">    * Returns the servlet init parameter returned by {@link ServletConfig#getInitParameter(String)}.</span>
<span class="source-line-no">5807</span><span id="line-5807">    *</span>
<span class="source-line-no">5808</span><span id="line-5808">    * @param name The init parameter name.</span>
<span class="source-line-no">5809</span><span id="line-5809">    * @return The servlet init parameter, or &lt;jk&gt;null&lt;/jk&gt; if not found.</span>
<span class="source-line-no">5810</span><span id="line-5810">    */</span>
<span class="source-line-no">5811</span><span id="line-5811">   public String getServletInitParameter(String name) {</span>
<span class="source-line-no">5812</span><span id="line-5812">      return builder.getInitParameter(name);</span>
<span class="source-line-no">5813</span><span id="line-5813">   }</span>
<span class="source-line-no">5814</span><span id="line-5814"></span>
<span class="source-line-no">5815</span><span id="line-5815">   /**</span>
<span class="source-line-no">5816</span><span id="line-5816">    * Returns the child resources associated with this servlet.</span>
<span class="source-line-no">5817</span><span id="line-5817">    *</span>
<span class="source-line-no">5818</span><span id="line-5818">    * @return</span>
<span class="source-line-no">5819</span><span id="line-5819">    *    An unmodifiable map of child resources.</span>
<span class="source-line-no">5820</span><span id="line-5820">    *    Keys are the {@link Rest#path() @Rest(path)} annotation defined on the child resource.</span>
<span class="source-line-no">5821</span><span id="line-5821">    */</span>
<span class="source-line-no">5822</span><span id="line-5822">   public RestChildren getRestChildren() {</span>
<span class="source-line-no">5823</span><span id="line-5823">      return restChildren;</span>
<span class="source-line-no">5824</span><span id="line-5824">   }</span>
<span class="source-line-no">5825</span><span id="line-5825"></span>
<span class="source-line-no">5826</span><span id="line-5826">   /**</span>
<span class="source-line-no">5827</span><span id="line-5827">    * Returns whether it's safe to render stack traces in HTTP responses.</span>
<span class="source-line-no">5828</span><span id="line-5828">    *</span>
<span class="source-line-no">5829</span><span id="line-5829">    * @return &lt;jk&gt;true&lt;/jk&gt; if setting is enabled.</span>
<span class="source-line-no">5830</span><span id="line-5830">    */</span>
<span class="source-line-no">5831</span><span id="line-5831">   public boolean isRenderResponseStackTraces() {</span>
<span class="source-line-no">5832</span><span id="line-5832">      return renderResponseStackTraces;</span>
<span class="source-line-no">5833</span><span id="line-5833">   }</span>
<span class="source-line-no">5834</span><span id="line-5834"></span>
<span class="source-line-no">5835</span><span id="line-5835">   /**</span>
<span class="source-line-no">5836</span><span id="line-5836">    * Returns whether it's safe to pass the HTTP content as a &lt;js&gt;"content"&lt;/js&gt; GET parameter.</span>
<span class="source-line-no">5837</span><span id="line-5837">    *</span>
<span class="source-line-no">5838</span><span id="line-5838">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5839</span><span id="line-5839">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#disableContentParam()}</span>
<span class="source-line-no">5840</span><span id="line-5840">    * &lt;/ul&gt;</span>
<span class="source-line-no">5841</span><span id="line-5841">    *</span>
<span class="source-line-no">5842</span><span id="line-5842">    * @return &lt;jk&gt;true&lt;/jk&gt; if setting is enabled.</span>
<span class="source-line-no">5843</span><span id="line-5843">    */</span>
<span class="source-line-no">5844</span><span id="line-5844">   public boolean isAllowContentParam() {</span>
<span class="source-line-no">5845</span><span id="line-5845">      return allowContentParam;</span>
<span class="source-line-no">5846</span><span id="line-5846">   }</span>
<span class="source-line-no">5847</span><span id="line-5847"></span>
<span class="source-line-no">5848</span><span id="line-5848">   /**</span>
<span class="source-line-no">5849</span><span id="line-5849">    * Allowed header URL parameters.</span>
<span class="source-line-no">5850</span><span id="line-5850">    *</span>
<span class="source-line-no">5851</span><span id="line-5851">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5852</span><span id="line-5852">    *    &lt;li class='ja'&gt;{@link Rest#allowedHeaderParams}</span>
<span class="source-line-no">5853</span><span id="line-5853">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#allowedHeaderParams(String)}</span>
<span class="source-line-no">5854</span><span id="line-5854">    * &lt;/ul&gt;</span>
<span class="source-line-no">5855</span><span id="line-5855">    *</span>
<span class="source-line-no">5856</span><span id="line-5856">    * @return</span>
<span class="source-line-no">5857</span><span id="line-5857">    *    The header names allowed to be passed as URL parameters.</span>
<span class="source-line-no">5858</span><span id="line-5858">    *    &lt;br&gt;The set is case-insensitive ordered and unmodifiable.</span>
<span class="source-line-no">5859</span><span id="line-5859">    */</span>
<span class="source-line-no">5860</span><span id="line-5860">   public Set&lt;String&gt; getAllowedHeaderParams() {</span>
<span class="source-line-no">5861</span><span id="line-5861">      return allowedHeaderParams;</span>
<span class="source-line-no">5862</span><span id="line-5862">   }</span>
<span class="source-line-no">5863</span><span id="line-5863"></span>
<span class="source-line-no">5864</span><span id="line-5864">   /**</span>
<span class="source-line-no">5865</span><span id="line-5865">    * Allowed method headers.</span>
<span class="source-line-no">5866</span><span id="line-5866">    *</span>
<span class="source-line-no">5867</span><span id="line-5867">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5868</span><span id="line-5868">    *    &lt;li class='ja'&gt;{@link Rest#allowedMethodHeaders}</span>
<span class="source-line-no">5869</span><span id="line-5869">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#allowedMethodHeaders(String)}</span>
<span class="source-line-no">5870</span><span id="line-5870">    * &lt;/ul&gt;</span>
<span class="source-line-no">5871</span><span id="line-5871">    *</span>
<span class="source-line-no">5872</span><span id="line-5872">    * @return</span>
<span class="source-line-no">5873</span><span id="line-5873">    *    The method names allowed to be passed as &lt;c&gt;X-Method&lt;/c&gt; headers.</span>
<span class="source-line-no">5874</span><span id="line-5874">    *    &lt;br&gt;The set is case-insensitive ordered and unmodifiable.</span>
<span class="source-line-no">5875</span><span id="line-5875">    */</span>
<span class="source-line-no">5876</span><span id="line-5876">   public Set&lt;String&gt; getAllowedMethodHeaders() {</span>
<span class="source-line-no">5877</span><span id="line-5877">      return allowedMethodHeaders;</span>
<span class="source-line-no">5878</span><span id="line-5878">   }</span>
<span class="source-line-no">5879</span><span id="line-5879"></span>
<span class="source-line-no">5880</span><span id="line-5880">   /**</span>
<span class="source-line-no">5881</span><span id="line-5881">    * Allowed method URL parameters.</span>
<span class="source-line-no">5882</span><span id="line-5882">    *</span>
<span class="source-line-no">5883</span><span id="line-5883">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5884</span><span id="line-5884">    *    &lt;li class='ja'&gt;{@link Rest#allowedMethodParams}</span>
<span class="source-line-no">5885</span><span id="line-5885">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#allowedMethodParams(String)}</span>
<span class="source-line-no">5886</span><span id="line-5886">    * &lt;/ul&gt;</span>
<span class="source-line-no">5887</span><span id="line-5887">    *</span>
<span class="source-line-no">5888</span><span id="line-5888">    * @return</span>
<span class="source-line-no">5889</span><span id="line-5889">    *    The method names allowed to be passed as &lt;c&gt;method&lt;/c&gt; URL parameters.</span>
<span class="source-line-no">5890</span><span id="line-5890">    *    &lt;br&gt;The set is case-insensitive ordered and unmodifiable.</span>
<span class="source-line-no">5891</span><span id="line-5891">    */</span>
<span class="source-line-no">5892</span><span id="line-5892">   public Set&lt;String&gt; getAllowedMethodParams() {</span>
<span class="source-line-no">5893</span><span id="line-5893">      return allowedMethodParams;</span>
<span class="source-line-no">5894</span><span id="line-5894">   }</span>
<span class="source-line-no">5895</span><span id="line-5895"></span>
<span class="source-line-no">5896</span><span id="line-5896">   /**</span>
<span class="source-line-no">5897</span><span id="line-5897">    * Returns the name of the client version header name used by this resource.</span>
<span class="source-line-no">5898</span><span id="line-5898">    *</span>
<span class="source-line-no">5899</span><span id="line-5899">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">5900</span><span id="line-5900">    *    &lt;li class='ja'&gt;{@link Rest#clientVersionHeader}</span>
<span class="source-line-no">5901</span><span id="line-5901">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#clientVersionHeader(String)}</span>
<span class="source-line-no">5902</span><span id="line-5902">    * &lt;/ul&gt;</span>
<span class="source-line-no">5903</span><span id="line-5903">    *</span>
<span class="source-line-no">5904</span><span id="line-5904">    * @return</span>
<span class="source-line-no">5905</span><span id="line-5905">    *    The name of the client version header used by this resource.</span>
<span class="source-line-no">5906</span><span id="line-5906">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5907</span><span id="line-5907">    */</span>
<span class="source-line-no">5908</span><span id="line-5908">   public String getClientVersionHeader() {</span>
<span class="source-line-no">5909</span><span id="line-5909">      return clientVersionHeader;</span>
<span class="source-line-no">5910</span><span id="line-5910">   }</span>
<span class="source-line-no">5911</span><span id="line-5911"></span>
<span class="source-line-no">5912</span><span id="line-5912">   /**</span>
<span class="source-line-no">5913</span><span id="line-5913">    * Returns the static files associated with this context.</span>
<span class="source-line-no">5914</span><span id="line-5914">    *</span>
<span class="source-line-no">5915</span><span id="line-5915">    * @return</span>
<span class="source-line-no">5916</span><span id="line-5916">    *    The static files for this resource.</span>
<span class="source-line-no">5917</span><span id="line-5917">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5918</span><span id="line-5918">    */</span>
<span class="source-line-no">5919</span><span id="line-5919">   public StaticFiles getStaticFiles() {</span>
<span class="source-line-no">5920</span><span id="line-5920">      return staticFiles;</span>
<span class="source-line-no">5921</span><span id="line-5921">   }</span>
<span class="source-line-no">5922</span><span id="line-5922"></span>
<span class="source-line-no">5923</span><span id="line-5923">   /**</span>
<span class="source-line-no">5924</span><span id="line-5924">    * Returns the logger associated with this context.</span>
<span class="source-line-no">5925</span><span id="line-5925">    *</span>
<span class="source-line-no">5926</span><span id="line-5926">    * @return</span>
<span class="source-line-no">5927</span><span id="line-5927">    *    The logger for this resource.</span>
<span class="source-line-no">5928</span><span id="line-5928">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5929</span><span id="line-5929">    */</span>
<span class="source-line-no">5930</span><span id="line-5930">   public Logger getLogger() {</span>
<span class="source-line-no">5931</span><span id="line-5931">      return logger;</span>
<span class="source-line-no">5932</span><span id="line-5932">   }</span>
<span class="source-line-no">5933</span><span id="line-5933"></span>
<span class="source-line-no">5934</span><span id="line-5934">   /**</span>
<span class="source-line-no">5935</span><span id="line-5935">    * Returns the stack trace database associated with this context.</span>
<span class="source-line-no">5936</span><span id="line-5936">    *</span>
<span class="source-line-no">5937</span><span id="line-5937">    * @return</span>
<span class="source-line-no">5938</span><span id="line-5938">    *    The stack trace database for this resource.</span>
<span class="source-line-no">5939</span><span id="line-5939">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5940</span><span id="line-5940">    */</span>
<span class="source-line-no">5941</span><span id="line-5941">   public ThrownStore getThrownStore() {</span>
<span class="source-line-no">5942</span><span id="line-5942">      return thrownStore;</span>
<span class="source-line-no">5943</span><span id="line-5943">   }</span>
<span class="source-line-no">5944</span><span id="line-5944"></span>
<span class="source-line-no">5945</span><span id="line-5945">   /**</span>
<span class="source-line-no">5946</span><span id="line-5946">    * Returns the HTTP-part parser associated with this resource.</span>
<span class="source-line-no">5947</span><span id="line-5947">    *</span>
<span class="source-line-no">5948</span><span id="line-5948">    * @return</span>
<span class="source-line-no">5949</span><span id="line-5949">    *    The HTTP-part parser associated with this resource.</span>
<span class="source-line-no">5950</span><span id="line-5950">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5951</span><span id="line-5951">    */</span>
<span class="source-line-no">5952</span><span id="line-5952">   public HttpPartParser getPartParser() {</span>
<span class="source-line-no">5953</span><span id="line-5953">      return partParser;</span>
<span class="source-line-no">5954</span><span id="line-5954">   }</span>
<span class="source-line-no">5955</span><span id="line-5955"></span>
<span class="source-line-no">5956</span><span id="line-5956">   /**</span>
<span class="source-line-no">5957</span><span id="line-5957">    * Returns the HTTP-part serializer associated with this resource.</span>
<span class="source-line-no">5958</span><span id="line-5958">    *</span>
<span class="source-line-no">5959</span><span id="line-5959">    * @return</span>
<span class="source-line-no">5960</span><span id="line-5960">    *    The HTTP-part serializer associated with this resource.</span>
<span class="source-line-no">5961</span><span id="line-5961">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5962</span><span id="line-5962">    */</span>
<span class="source-line-no">5963</span><span id="line-5963">   public HttpPartSerializer getPartSerializer() {</span>
<span class="source-line-no">5964</span><span id="line-5964">      return partSerializer;</span>
<span class="source-line-no">5965</span><span id="line-5965">   }</span>
<span class="source-line-no">5966</span><span id="line-5966"></span>
<span class="source-line-no">5967</span><span id="line-5967">   /**</span>
<span class="source-line-no">5968</span><span id="line-5968">    * Returns the JSON-Schema generator associated with this resource.</span>
<span class="source-line-no">5969</span><span id="line-5969">    *</span>
<span class="source-line-no">5970</span><span id="line-5970">    * @return</span>
<span class="source-line-no">5971</span><span id="line-5971">    *    The HTTP-part serializer associated with this resource.</span>
<span class="source-line-no">5972</span><span id="line-5972">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5973</span><span id="line-5973">    */</span>
<span class="source-line-no">5974</span><span id="line-5974">   public JsonSchemaGenerator getJsonSchemaGenerator() {</span>
<span class="source-line-no">5975</span><span id="line-5975">      return jsonSchemaGenerator;</span>
<span class="source-line-no">5976</span><span id="line-5976">   }</span>
<span class="source-line-no">5977</span><span id="line-5977"></span>
<span class="source-line-no">5978</span><span id="line-5978">   /**</span>
<span class="source-line-no">5979</span><span id="line-5979">    * Returns the explicit list of supported accept types for this resource.</span>
<span class="source-line-no">5980</span><span id="line-5980">    *</span>
<span class="source-line-no">5981</span><span id="line-5981">    * &lt;p&gt;</span>
<span class="source-line-no">5982</span><span id="line-5982">    * Consists of the media types for production common to all operations on this class.</span>
<span class="source-line-no">5983</span><span id="line-5983">    *</span>
<span class="source-line-no">5984</span><span id="line-5984">    * &lt;p&gt;</span>
<span class="source-line-no">5985</span><span id="line-5985">    * Can be overridden by {@link RestContext.Builder#produces(MediaType...)}.</span>
<span class="source-line-no">5986</span><span id="line-5986">    *</span>
<span class="source-line-no">5987</span><span id="line-5987">    * @return</span>
<span class="source-line-no">5988</span><span id="line-5988">    *    An unmodifiable list of supported &lt;c&gt;Accept&lt;/c&gt; header values for this resource.</span>
<span class="source-line-no">5989</span><span id="line-5989">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">5990</span><span id="line-5990">    */</span>
<span class="source-line-no">5991</span><span id="line-5991">   public List&lt;MediaType&gt; getProduces() {</span>
<span class="source-line-no">5992</span><span id="line-5992">      return produces;</span>
<span class="source-line-no">5993</span><span id="line-5993">   }</span>
<span class="source-line-no">5994</span><span id="line-5994"></span>
<span class="source-line-no">5995</span><span id="line-5995">   /**</span>
<span class="source-line-no">5996</span><span id="line-5996">    * Returns the explicit list of supported content types for this resource.</span>
<span class="source-line-no">5997</span><span id="line-5997">    *</span>
<span class="source-line-no">5998</span><span id="line-5998">    * &lt;p&gt;</span>
<span class="source-line-no">5999</span><span id="line-5999">    * Consists of the media types for consumption common to all operations on this class.</span>
<span class="source-line-no">6000</span><span id="line-6000">    *</span>
<span class="source-line-no">6001</span><span id="line-6001">    * &lt;p&gt;</span>
<span class="source-line-no">6002</span><span id="line-6002">    * Can be overridden by {@link RestContext.Builder#consumes(MediaType...)}.</span>
<span class="source-line-no">6003</span><span id="line-6003">    *</span>
<span class="source-line-no">6004</span><span id="line-6004">    * @return</span>
<span class="source-line-no">6005</span><span id="line-6005">    *    An unmodifiable list of supported &lt;c&gt;Content-Type&lt;/c&gt; header values for this resource.</span>
<span class="source-line-no">6006</span><span id="line-6006">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6007</span><span id="line-6007">    */</span>
<span class="source-line-no">6008</span><span id="line-6008">   public List&lt;MediaType&gt; getConsumes() {</span>
<span class="source-line-no">6009</span><span id="line-6009">      return consumes;</span>
<span class="source-line-no">6010</span><span id="line-6010">   }</span>
<span class="source-line-no">6011</span><span id="line-6011"></span>
<span class="source-line-no">6012</span><span id="line-6012">   /**</span>
<span class="source-line-no">6013</span><span id="line-6013">    * Returns the default request headers for this resource.</span>
<span class="source-line-no">6014</span><span id="line-6014">    *</span>
<span class="source-line-no">6015</span><span id="line-6015">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6016</span><span id="line-6016">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#defaultRequestHeaders(org.apache.http.Header...)}</span>
<span class="source-line-no">6017</span><span id="line-6017">    * &lt;/ul&gt;</span>
<span class="source-line-no">6018</span><span id="line-6018">    *</span>
<span class="source-line-no">6019</span><span id="line-6019">    * @return</span>
<span class="source-line-no">6020</span><span id="line-6020">    *    The default request headers for this resource in an unmodifiable list.</span>
<span class="source-line-no">6021</span><span id="line-6021">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6022</span><span id="line-6022">    */</span>
<span class="source-line-no">6023</span><span id="line-6023">   public HeaderList getDefaultRequestHeaders() {</span>
<span class="source-line-no">6024</span><span id="line-6024">      return defaultRequestHeaders;</span>
<span class="source-line-no">6025</span><span id="line-6025">   }</span>
<span class="source-line-no">6026</span><span id="line-6026"></span>
<span class="source-line-no">6027</span><span id="line-6027">   /**</span>
<span class="source-line-no">6028</span><span id="line-6028">    * Returns the default request attributes for this resource.</span>
<span class="source-line-no">6029</span><span id="line-6029">    *</span>
<span class="source-line-no">6030</span><span id="line-6030">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6031</span><span id="line-6031">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#defaultRequestAttributes(NamedAttribute...)}</span>
<span class="source-line-no">6032</span><span id="line-6032">    * &lt;/ul&gt;</span>
<span class="source-line-no">6033</span><span id="line-6033">    *</span>
<span class="source-line-no">6034</span><span id="line-6034">    * @return</span>
<span class="source-line-no">6035</span><span id="line-6035">    *    The default request headers for this resource in an unmodifiable list.</span>
<span class="source-line-no">6036</span><span id="line-6036">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6037</span><span id="line-6037">    */</span>
<span class="source-line-no">6038</span><span id="line-6038">   public NamedAttributeMap getDefaultRequestAttributes() {</span>
<span class="source-line-no">6039</span><span id="line-6039">      return defaultRequestAttributes;</span>
<span class="source-line-no">6040</span><span id="line-6040">   }</span>
<span class="source-line-no">6041</span><span id="line-6041"></span>
<span class="source-line-no">6042</span><span id="line-6042">   /**</span>
<span class="source-line-no">6043</span><span id="line-6043">    * Returns the default response headers for this resource.</span>
<span class="source-line-no">6044</span><span id="line-6044">    *</span>
<span class="source-line-no">6045</span><span id="line-6045">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6046</span><span id="line-6046">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#defaultResponseHeaders(org.apache.http.Header...)}</span>
<span class="source-line-no">6047</span><span id="line-6047">    * &lt;/ul&gt;</span>
<span class="source-line-no">6048</span><span id="line-6048">    *</span>
<span class="source-line-no">6049</span><span id="line-6049">    * @return</span>
<span class="source-line-no">6050</span><span id="line-6050">    *    The default response headers for this resource in an unmodifiable list.</span>
<span class="source-line-no">6051</span><span id="line-6051">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6052</span><span id="line-6052">    */</span>
<span class="source-line-no">6053</span><span id="line-6053">   public HeaderList getDefaultResponseHeaders() {</span>
<span class="source-line-no">6054</span><span id="line-6054">      return defaultResponseHeaders;</span>
<span class="source-line-no">6055</span><span id="line-6055">   }</span>
<span class="source-line-no">6056</span><span id="line-6056"></span>
<span class="source-line-no">6057</span><span id="line-6057">   /**</span>
<span class="source-line-no">6058</span><span id="line-6058">    * Returns the authority path of the resource.</span>
<span class="source-line-no">6059</span><span id="line-6059">    *</span>
<span class="source-line-no">6060</span><span id="line-6060">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6061</span><span id="line-6061">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#uriAuthority(String)}</span>
<span class="source-line-no">6062</span><span id="line-6062">    * &lt;/ul&gt;</span>
<span class="source-line-no">6063</span><span id="line-6063">    *</span>
<span class="source-line-no">6064</span><span id="line-6064">    * @return</span>
<span class="source-line-no">6065</span><span id="line-6065">    *    The authority path of this resource.</span>
<span class="source-line-no">6066</span><span id="line-6066">    *    &lt;br&gt;If not specified, returns the context path of the ascendant resource.</span>
<span class="source-line-no">6067</span><span id="line-6067">    */</span>
<span class="source-line-no">6068</span><span id="line-6068">   public String getUriAuthority() {</span>
<span class="source-line-no">6069</span><span id="line-6069">      if (uriAuthority != null)</span>
<span class="source-line-no">6070</span><span id="line-6070">         return uriAuthority;</span>
<span class="source-line-no">6071</span><span id="line-6071">      if (parentContext != null)</span>
<span class="source-line-no">6072</span><span id="line-6072">         return parentContext.getUriAuthority();</span>
<span class="source-line-no">6073</span><span id="line-6073">      return null;</span>
<span class="source-line-no">6074</span><span id="line-6074">   }</span>
<span class="source-line-no">6075</span><span id="line-6075"></span>
<span class="source-line-no">6076</span><span id="line-6076">   /**</span>
<span class="source-line-no">6077</span><span id="line-6077">    * Returns the context path of the resource.</span>
<span class="source-line-no">6078</span><span id="line-6078">    *</span>
<span class="source-line-no">6079</span><span id="line-6079">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6080</span><span id="line-6080">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#uriContext(String)}</span>
<span class="source-line-no">6081</span><span id="line-6081">    * &lt;/ul&gt;</span>
<span class="source-line-no">6082</span><span id="line-6082">    *</span>
<span class="source-line-no">6083</span><span id="line-6083">    * @return</span>
<span class="source-line-no">6084</span><span id="line-6084">    *    The context path of this resource.</span>
<span class="source-line-no">6085</span><span id="line-6085">    *    &lt;br&gt;If not specified, returns the context path of the ascendant resource.</span>
<span class="source-line-no">6086</span><span id="line-6086">    */</span>
<span class="source-line-no">6087</span><span id="line-6087">   public String getUriContext() {</span>
<span class="source-line-no">6088</span><span id="line-6088">      if (uriContext != null)</span>
<span class="source-line-no">6089</span><span id="line-6089">         return uriContext;</span>
<span class="source-line-no">6090</span><span id="line-6090">      if (parentContext != null)</span>
<span class="source-line-no">6091</span><span id="line-6091">         return parentContext.getUriContext();</span>
<span class="source-line-no">6092</span><span id="line-6092">      return null;</span>
<span class="source-line-no">6093</span><span id="line-6093">   }</span>
<span class="source-line-no">6094</span><span id="line-6094"></span>
<span class="source-line-no">6095</span><span id="line-6095">   /**</span>
<span class="source-line-no">6096</span><span id="line-6096">    * Returns the setting on how relative URIs should be interpreted as relative to.</span>
<span class="source-line-no">6097</span><span id="line-6097">    *</span>
<span class="source-line-no">6098</span><span id="line-6098">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6099</span><span id="line-6099">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#uriRelativity(UriRelativity)}</span>
<span class="source-line-no">6100</span><span id="line-6100">    * &lt;/ul&gt;</span>
<span class="source-line-no">6101</span><span id="line-6101">    *</span>
<span class="source-line-no">6102</span><span id="line-6102">    * @return</span>
<span class="source-line-no">6103</span><span id="line-6103">    *    The URI-resolution relativity setting value.</span>
<span class="source-line-no">6104</span><span id="line-6104">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6105</span><span id="line-6105">    */</span>
<span class="source-line-no">6106</span><span id="line-6106">   public UriRelativity getUriRelativity() {</span>
<span class="source-line-no">6107</span><span id="line-6107">      return uriRelativity;</span>
<span class="source-line-no">6108</span><span id="line-6108">   }</span>
<span class="source-line-no">6109</span><span id="line-6109"></span>
<span class="source-line-no">6110</span><span id="line-6110">   /**</span>
<span class="source-line-no">6111</span><span id="line-6111">    * Returns the setting on how relative URIs should be resolved.</span>
<span class="source-line-no">6112</span><span id="line-6112">    *</span>
<span class="source-line-no">6113</span><span id="line-6113">    * &lt;h5 class='section'&gt;See Also:&lt;/h5&gt;&lt;ul&gt;</span>
<span class="source-line-no">6114</span><span id="line-6114">    *    &lt;li class='jm'&gt;{@link RestContext.Builder#uriResolution(UriResolution)}</span>
<span class="source-line-no">6115</span><span id="line-6115">    * &lt;/ul&gt;</span>
<span class="source-line-no">6116</span><span id="line-6116">    *</span>
<span class="source-line-no">6117</span><span id="line-6117">    * @return</span>
<span class="source-line-no">6118</span><span id="line-6118">    *    The URI-resolution setting value.</span>
<span class="source-line-no">6119</span><span id="line-6119">    *    &lt;br&gt;Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6120</span><span id="line-6120">    */</span>
<span class="source-line-no">6121</span><span id="line-6121">   public UriResolution getUriResolution() {</span>
<span class="source-line-no">6122</span><span id="line-6122">      return uriResolution;</span>
<span class="source-line-no">6123</span><span id="line-6123">   }</span>
<span class="source-line-no">6124</span><span id="line-6124"></span>
<span class="source-line-no">6125</span><span id="line-6125">   /**</span>
<span class="source-line-no">6126</span><span id="line-6126">    * Returns the REST Java methods defined in this resource.</span>
<span class="source-line-no">6127</span><span id="line-6127">    *</span>
<span class="source-line-no">6128</span><span id="line-6128">    * &lt;p&gt;</span>
<span class="source-line-no">6129</span><span id="line-6129">    * These are the methods annotated with the {@link RestOp @RestOp} annotation.</span>
<span class="source-line-no">6130</span><span id="line-6130">    *</span>
<span class="source-line-no">6131</span><span id="line-6131">    * @return</span>
<span class="source-line-no">6132</span><span id="line-6132">    *    An unmodifiable map of Java method names to call method objects.</span>
<span class="source-line-no">6133</span><span id="line-6133">    */</span>
<span class="source-line-no">6134</span><span id="line-6134">   public RestOperations getRestOperations() {</span>
<span class="source-line-no">6135</span><span id="line-6135">      return restOperations;</span>
<span class="source-line-no">6136</span><span id="line-6136">   }</span>
<span class="source-line-no">6137</span><span id="line-6137"></span>
<span class="source-line-no">6138</span><span id="line-6138">   /**</span>
<span class="source-line-no">6139</span><span id="line-6139">    * Returns the timing statistics on all method executions on this class.</span>
<span class="source-line-no">6140</span><span id="line-6140">    *</span>
<span class="source-line-no">6141</span><span id="line-6141">    * @return The timing statistics on all method executions on this class.</span>
<span class="source-line-no">6142</span><span id="line-6142">    */</span>
<span class="source-line-no">6143</span><span id="line-6143">   public MethodExecStore getMethodExecStore() {</span>
<span class="source-line-no">6144</span><span id="line-6144">      return methodExecStore;</span>
<span class="source-line-no">6145</span><span id="line-6145">   }</span>
<span class="source-line-no">6146</span><span id="line-6146"></span>
<span class="source-line-no">6147</span><span id="line-6147">   /**</span>
<span class="source-line-no">6148</span><span id="line-6148">    * Gives access to the internal statistics on this context.</span>
<span class="source-line-no">6149</span><span id="line-6149">    *</span>
<span class="source-line-no">6150</span><span id="line-6150">    * @return The context statistics.</span>
<span class="source-line-no">6151</span><span id="line-6151">    */</span>
<span class="source-line-no">6152</span><span id="line-6152">   public RestContextStats getStats() {</span>
<span class="source-line-no">6153</span><span id="line-6153">      return new RestContextStats(startTime, getMethodExecStore().getStatsByTotalTime());</span>
<span class="source-line-no">6154</span><span id="line-6154">   }</span>
<span class="source-line-no">6155</span><span id="line-6155"></span>
<span class="source-line-no">6156</span><span id="line-6156">   /**</span>
<span class="source-line-no">6157</span><span id="line-6157">    * Returns the resource class type.</span>
<span class="source-line-no">6158</span><span id="line-6158">    *</span>
<span class="source-line-no">6159</span><span id="line-6159">    * @return The resource class type.</span>
<span class="source-line-no">6160</span><span id="line-6160">    */</span>
<span class="source-line-no">6161</span><span id="line-6161">   public Class&lt;?&gt; getResourceClass() {</span>
<span class="source-line-no">6162</span><span id="line-6162">      return resourceClass;</span>
<span class="source-line-no">6163</span><span id="line-6163">   }</span>
<span class="source-line-no">6164</span><span id="line-6164"></span>
<span class="source-line-no">6165</span><span id="line-6165">   /**</span>
<span class="source-line-no">6166</span><span id="line-6166">    * Returns the builder that created this context.</span>
<span class="source-line-no">6167</span><span id="line-6167">    *</span>
<span class="source-line-no">6168</span><span id="line-6168">    * @return The builder that created this context.</span>
<span class="source-line-no">6169</span><span id="line-6169">    */</span>
<span class="source-line-no">6170</span><span id="line-6170">   public ServletConfig getBuilder() {</span>
<span class="source-line-no">6171</span><span id="line-6171">      return builder;</span>
<span class="source-line-no">6172</span><span id="line-6172">   }</span>
<span class="source-line-no">6173</span><span id="line-6173"></span>
<span class="source-line-no">6174</span><span id="line-6174">   /**</span>
<span class="source-line-no">6175</span><span id="line-6175">    * Returns the path matcher for this context.</span>
<span class="source-line-no">6176</span><span id="line-6176">    *</span>
<span class="source-line-no">6177</span><span id="line-6177">    * @return The path matcher for this context.</span>
<span class="source-line-no">6178</span><span id="line-6178">    */</span>
<span class="source-line-no">6179</span><span id="line-6179">   public UrlPathMatcher getPathMatcher() {</span>
<span class="source-line-no">6180</span><span id="line-6180">      return pathMatcher;</span>
<span class="source-line-no">6181</span><span id="line-6181">   }</span>
<span class="source-line-no">6182</span><span id="line-6182"></span>
<span class="source-line-no">6183</span><span id="line-6183">   /**</span>
<span class="source-line-no">6184</span><span id="line-6184">    * Returns the root bean store for this context.</span>
<span class="source-line-no">6185</span><span id="line-6185">    *</span>
<span class="source-line-no">6186</span><span id="line-6186">    * @return The root bean store for this context.</span>
<span class="source-line-no">6187</span><span id="line-6187">    */</span>
<span class="source-line-no">6188</span><span id="line-6188">   public BeanStore getRootBeanStore() {</span>
<span class="source-line-no">6189</span><span id="line-6189">      return rootBeanStore;</span>
<span class="source-line-no">6190</span><span id="line-6190">   }</span>
<span class="source-line-no">6191</span><span id="line-6191"></span>
<span class="source-line-no">6192</span><span id="line-6192">   /**</span>
<span class="source-line-no">6193</span><span id="line-6193">    * Returns the swagger for the REST resource.</span>
<span class="source-line-no">6194</span><span id="line-6194">    *</span>
<span class="source-line-no">6195</span><span id="line-6195">    * @param locale The locale of the swagger to return.</span>
<span class="source-line-no">6196</span><span id="line-6196">    * @return The swagger as an {@link Optional}.  Never &lt;jk&gt;null&lt;/jk&gt;.</span>
<span class="source-line-no">6197</span><span id="line-6197">    */</span>
<span class="source-line-no">6198</span><span id="line-6198">   public Optional&lt;Swagger&gt; getSwagger(Locale locale) {</span>
<span class="source-line-no">6199</span><span id="line-6199">      Swagger s = swaggerCache.get(locale);</span>
<span class="source-line-no">6200</span><span id="line-6200">      if (s == null) {</span>
<span class="source-line-no">6201</span><span id="line-6201">         try {</span>
<span class="source-line-no">6202</span><span id="line-6202">            s = swaggerProvider.getSwagger(this, locale);</span>
<span class="source-line-no">6203</span><span id="line-6203">            if (s != null)</span>
<span class="source-line-no">6204</span><span id="line-6204">               swaggerCache.put(locale, s);</span>
<span class="source-line-no">6205</span><span id="line-6205">         } catch (Exception e) {</span>
<span class="source-line-no">6206</span><span id="line-6206">            throw new InternalServerError(e);</span>
<span class="source-line-no">6207</span><span id="line-6207">         }</span>
<span class="source-line-no">6208</span><span id="line-6208">      }</span>
<span class="source-line-no">6209</span><span id="line-6209">      return Utils.opt(s);</span>
<span class="source-line-no">6210</span><span id="line-6210">   }</span>
<span class="source-line-no">6211</span><span id="line-6211"></span>
<span class="source-line-no">6212</span><span id="line-6212">   /**</span>
<span class="source-line-no">6213</span><span id="line-6213">    * Finds the {@link RestOpArg} instances to handle resolving objects on the calls to the specified Java method.</span>
<span class="source-line-no">6214</span><span id="line-6214">    *</span>
<span class="source-line-no">6215</span><span id="line-6215">    * @param m The Java method being called.</span>
<span class="source-line-no">6216</span><span id="line-6216">    * @param beanStore</span>
<span class="source-line-no">6217</span><span id="line-6217">    *    The factory used for creating beans and retrieving injected beans.</span>
<span class="source-line-no">6218</span><span id="line-6218">    *    &lt;br&gt;Created by {@link RestContext.Builder#beanStore()}.</span>
<span class="source-line-no">6219</span><span id="line-6219">    * @return The array of resolvers.</span>
<span class="source-line-no">6220</span><span id="line-6220">    */</span>
<span class="source-line-no">6221</span><span id="line-6221">   protected RestOpArg[] findRestOperationArgs(Method m, BeanStore beanStore) {</span>
<span class="source-line-no">6222</span><span id="line-6222"></span>
<span class="source-line-no">6223</span><span id="line-6223">      MethodInfo mi = MethodInfo.of(m);</span>
<span class="source-line-no">6224</span><span id="line-6224">      List&lt;ClassInfo&gt; pt = mi.getParamTypes();</span>
<span class="source-line-no">6225</span><span id="line-6225">      RestOpArg[] ra = new RestOpArg[pt.size()];</span>
<span class="source-line-no">6226</span><span id="line-6226"></span>
<span class="source-line-no">6227</span><span id="line-6227">      beanStore = BeanStore.of(beanStore, getResource());</span>
<span class="source-line-no">6228</span><span id="line-6228"></span>
<span class="source-line-no">6229</span><span id="line-6229">      for (int i = 0; i &lt; pt.size(); i++) {</span>
<span class="source-line-no">6230</span><span id="line-6230">         ParamInfo pi = mi.getParam(i);</span>
<span class="source-line-no">6231</span><span id="line-6231">         beanStore.addBean(ParamInfo.class, pi);</span>
<span class="source-line-no">6232</span><span id="line-6232">         for (Class&lt;? extends RestOpArg&gt; c : restOpArgs) {</span>
<span class="source-line-no">6233</span><span id="line-6233">            try {</span>
<span class="source-line-no">6234</span><span id="line-6234">               ra[i] = beanStore.createBean(RestOpArg.class).type(c).run();</span>
<span class="source-line-no">6235</span><span id="line-6235">               if (ra[i] != null)</span>
<span class="source-line-no">6236</span><span id="line-6236">                  break;</span>
<span class="source-line-no">6237</span><span id="line-6237">            } catch (ExecutableException e) {</span>
<span class="source-line-no">6238</span><span id="line-6238">               throw new InternalServerError(e.unwrap(), "Could not resolve parameter {0} on method {1}.", i, mi.getFullName());</span>
<span class="source-line-no">6239</span><span id="line-6239">            }</span>
<span class="source-line-no">6240</span><span id="line-6240">         }</span>
<span class="source-line-no">6241</span><span id="line-6241">         if (ra[i] == null)</span>
<span class="source-line-no">6242</span><span id="line-6242">            throw new InternalServerError("Could not resolve parameter {0} on method {1}.", i, mi.getFullName());</span>
<span class="source-line-no">6243</span><span id="line-6243">      }</span>
<span class="source-line-no">6244</span><span id="line-6244"></span>
<span class="source-line-no">6245</span><span id="line-6245">      return ra;</span>
<span class="source-line-no">6246</span><span id="line-6246">   }</span>
<span class="source-line-no">6247</span><span id="line-6247"></span>
<span class="source-line-no">6248</span><span id="line-6248">   /**</span>
<span class="source-line-no">6249</span><span id="line-6249">    * Returns the list of methods to invoke before the actual REST method is called.</span>
<span class="source-line-no">6250</span><span id="line-6250">    *</span>
<span class="source-line-no">6251</span><span id="line-6251">    * @return The list of methods to invoke before the actual REST method is called.</span>
<span class="source-line-no">6252</span><span id="line-6252">    */</span>
<span class="source-line-no">6253</span><span id="line-6253">   protected MethodList getPreCallMethods() {</span>
<span class="source-line-no">6254</span><span id="line-6254">      return preCallMethods;</span>
<span class="source-line-no">6255</span><span id="line-6255">   }</span>
<span class="source-line-no">6256</span><span id="line-6256"></span>
<span class="source-line-no">6257</span><span id="line-6257">   /**</span>
<span class="source-line-no">6258</span><span id="line-6258">    * Returns the list of methods to invoke after the actual REST method is called.</span>
<span class="source-line-no">6259</span><span id="line-6259">    *</span>
<span class="source-line-no">6260</span><span id="line-6260">    * @return The list of methods to invoke after the actual REST method is called.</span>
<span class="source-line-no">6261</span><span id="line-6261">    */</span>
<span class="source-line-no">6262</span><span id="line-6262">   protected MethodList getPostCallMethods() {</span>
<span class="source-line-no">6263</span><span id="line-6263">      return postCallMethods;</span>
<span class="source-line-no">6264</span><span id="line-6264">   }</span>
<span class="source-line-no">6265</span><span id="line-6265"></span>
<span class="source-line-no">6266</span><span id="line-6266">   /**</span>
<span class="source-line-no">6267</span><span id="line-6267">    * The main service method.</span>
<span class="source-line-no">6268</span><span id="line-6268">    *</span>
<span class="source-line-no">6269</span><span id="line-6269">    * &lt;p&gt;</span>
<span class="source-line-no">6270</span><span id="line-6270">    * Subclasses can optionally override this method if they want to tailor the behavior of requests.</span>
<span class="source-line-no">6271</span><span id="line-6271">    *</span>
<span class="source-line-no">6272</span><span id="line-6272">    * @param resource</span>
<span class="source-line-no">6273</span><span id="line-6273">    *    The REST servlet or bean that this context defines.</span>
<span class="source-line-no">6274</span><span id="line-6274">    *    &lt;br&gt;Note that this bean may not be the same bean used during initialization as it may have been replaced at runtime.</span>
<span class="source-line-no">6275</span><span id="line-6275">    * @param r1 The incoming HTTP servlet request object.</span>
<span class="source-line-no">6276</span><span id="line-6276">    * @param r2 The incoming HTTP servlet response object.</span>
<span class="source-line-no">6277</span><span id="line-6277">    * @throws ServletException General servlet exception.</span>
<span class="source-line-no">6278</span><span id="line-6278">    * @throws IOException Thrown by underlying stream.</span>
<span class="source-line-no">6279</span><span id="line-6279">    */</span>
<span class="source-line-no">6280</span><span id="line-6280">   public void execute(Object resource, HttpServletRequest r1, HttpServletResponse r2) throws ServletException, IOException {</span>
<span class="source-line-no">6281</span><span id="line-6281"></span>
<span class="source-line-no">6282</span><span id="line-6282">      // Must be careful not to bleed thread-locals.</span>
<span class="source-line-no">6283</span><span id="line-6283">      if (localSession.get() != null)</span>
<span class="source-line-no">6284</span><span id="line-6284">         System.err.println("WARNING:  Thread-local call object was not cleaned up from previous request.  " + this + ", thread=["+Thread.currentThread().getId()+"]");</span>
<span class="source-line-no">6285</span><span id="line-6285"></span>
<span class="source-line-no">6286</span><span id="line-6286">      RestSession.Builder sb = createSession().resource(resource).req(r1).res(r2).logger(getCallLogger());</span>
<span class="source-line-no">6287</span><span id="line-6287"></span>
<span class="source-line-no">6288</span><span id="line-6288">      try {</span>
<span class="source-line-no">6289</span><span id="line-6289"></span>
<span class="source-line-no">6290</span><span id="line-6290">         if (initException != null)</span>
<span class="source-line-no">6291</span><span id="line-6291">            throw initException;</span>
<span class="source-line-no">6292</span><span id="line-6292"></span>
<span class="source-line-no">6293</span><span id="line-6293">         // If the resource path contains variables (e.g. @Rest(path="/f/{a}/{b}"), then we want to resolve</span>
<span class="source-line-no">6294</span><span id="line-6294">         // those variables and push the servletPath to include the resolved variables.  The new pathInfo will be</span>
<span class="source-line-no">6295</span><span id="line-6295">         // the remainder after the new servletPath.</span>
<span class="source-line-no">6296</span><span id="line-6296">         // Only do this for the top-level resource because the logic for child resources are processed next.</span>
<span class="source-line-no">6297</span><span id="line-6297">         if (pathMatcher.hasVars() &amp;&amp; parentContext == null) {</span>
<span class="source-line-no">6298</span><span id="line-6298">            String sp = sb.req().getServletPath();</span>
<span class="source-line-no">6299</span><span id="line-6299">            String pi = sb.getPathInfoUndecoded();</span>
<span class="source-line-no">6300</span><span id="line-6300">            UrlPath upi2 = UrlPath.of(pi == null ? sp : sp + pi);</span>
<span class="source-line-no">6301</span><span id="line-6301">            UrlPathMatch uppm = pathMatcher.match(upi2);</span>
<span class="source-line-no">6302</span><span id="line-6302">            if (uppm != null &amp;&amp; ! uppm.hasEmptyVars()) {</span>
<span class="source-line-no">6303</span><span id="line-6303">               sb.pathVars(uppm.getVars());</span>
<span class="source-line-no">6304</span><span id="line-6304">               sb.req(</span>
<span class="source-line-no">6305</span><span id="line-6305">                  new OverrideableHttpServletRequest(sb.req())</span>
<span class="source-line-no">6306</span><span id="line-6306">                     .pathInfo(Utils.nullIfEmpty(urlDecode(uppm.getSuffix())))</span>
<span class="source-line-no">6307</span><span id="line-6307">                     .servletPath(uppm.getPrefix())</span>
<span class="source-line-no">6308</span><span id="line-6308">               );</span>
<span class="source-line-no">6309</span><span id="line-6309">            } else {</span>
<span class="source-line-no">6310</span><span id="line-6310">               RestSession call = sb.build();</span>
<span class="source-line-no">6311</span><span id="line-6311">               call.debug(isDebug(call)).status(SC_NOT_FOUND).finish();</span>
<span class="source-line-no">6312</span><span id="line-6312">               return;</span>
<span class="source-line-no">6313</span><span id="line-6313">            }</span>
<span class="source-line-no">6314</span><span id="line-6314">         }</span>
<span class="source-line-no">6315</span><span id="line-6315"></span>
<span class="source-line-no">6316</span><span id="line-6316">         // If this resource has child resources, try to recursively call them.</span>
<span class="source-line-no">6317</span><span id="line-6317">         Optional&lt;RestChildMatch&gt; childMatch = restChildren.findMatch(sb);</span>
<span class="source-line-no">6318</span><span id="line-6318">         if (childMatch.isPresent()) {</span>
<span class="source-line-no">6319</span><span id="line-6319">            UrlPathMatch uppm = childMatch.get().getPathMatch();</span>
<span class="source-line-no">6320</span><span id="line-6320">            RestContext rc = childMatch.get().getChildContext();</span>
<span class="source-line-no">6321</span><span id="line-6321">            if (! uppm.hasEmptyVars()) {</span>
<span class="source-line-no">6322</span><span id="line-6322">               sb.pathVars(uppm.getVars());</span>
<span class="source-line-no">6323</span><span id="line-6323">               HttpServletRequest childRequest = new OverrideableHttpServletRequest(sb.req())</span>
<span class="source-line-no">6324</span><span id="line-6324">                  .pathInfo(Utils.nullIfEmpty(urlDecode(uppm.getSuffix())))</span>
<span class="source-line-no">6325</span><span id="line-6325">                  .servletPath(sb.req().getServletPath() + uppm.getPrefix());</span>
<span class="source-line-no">6326</span><span id="line-6326">               rc.execute(rc.getResource(), childRequest, sb.res());</span>
<span class="source-line-no">6327</span><span id="line-6327">            } else {</span>
<span class="source-line-no">6328</span><span id="line-6328">               RestSession call = sb.build();</span>
<span class="source-line-no">6329</span><span id="line-6329">               call.debug(isDebug(call)).status(SC_NOT_FOUND).finish();</span>
<span class="source-line-no">6330</span><span id="line-6330">            }</span>
<span class="source-line-no">6331</span><span id="line-6331">            return;</span>
<span class="source-line-no">6332</span><span id="line-6332">         }</span>
<span class="source-line-no">6333</span><span id="line-6333"></span>
<span class="source-line-no">6334</span><span id="line-6334">      } catch (Throwable e) {</span>
<span class="source-line-no">6335</span><span id="line-6335">         handleError(sb.build(), convertThrowable(e));</span>
<span class="source-line-no">6336</span><span id="line-6336">      }</span>
<span class="source-line-no">6337</span><span id="line-6337"></span>
<span class="source-line-no">6338</span><span id="line-6338">      RestSession s = sb.build();</span>
<span class="source-line-no">6339</span><span id="line-6339"></span>
<span class="source-line-no">6340</span><span id="line-6340">      try {</span>
<span class="source-line-no">6341</span><span id="line-6341">         localSession.set(s);</span>
<span class="source-line-no">6342</span><span id="line-6342">         s.debug(isDebug(s));</span>
<span class="source-line-no">6343</span><span id="line-6343">         startCall(s);</span>
<span class="source-line-no">6344</span><span id="line-6344">         s.run();</span>
<span class="source-line-no">6345</span><span id="line-6345">      } catch (Throwable e) {</span>
<span class="source-line-no">6346</span><span id="line-6346">         handleError(s, convertThrowable(e));</span>
<span class="source-line-no">6347</span><span id="line-6347">      } finally {</span>
<span class="source-line-no">6348</span><span id="line-6348">         try {</span>
<span class="source-line-no">6349</span><span id="line-6349">            s.finish();</span>
<span class="source-line-no">6350</span><span id="line-6350">            endCall(s);</span>
<span class="source-line-no">6351</span><span id="line-6351">         } finally {</span>
<span class="source-line-no">6352</span><span id="line-6352">            localSession.remove();</span>
<span class="source-line-no">6353</span><span id="line-6353">         }</span>
<span class="source-line-no">6354</span><span id="line-6354">      }</span>
<span class="source-line-no">6355</span><span id="line-6355">   }</span>
<span class="source-line-no">6356</span><span id="line-6356"></span>
<span class="source-line-no">6357</span><span id="line-6357">   private boolean isDebug(RestSession call) {</span>
<span class="source-line-no">6358</span><span id="line-6358">      return debugEnablement.isDebug(this, call.getRequest());</span>
<span class="source-line-no">6359</span><span id="line-6359">   }</span>
<span class="source-line-no">6360</span><span id="line-6360"></span>
<span class="source-line-no">6361</span><span id="line-6361">   /**</span>
<span class="source-line-no">6362</span><span id="line-6362">    * Returns the debug enablement bean for this context.</span>
<span class="source-line-no">6363</span><span id="line-6363">    *</span>
<span class="source-line-no">6364</span><span id="line-6364">    * @return The debug enablement bean for this context.</span>
<span class="source-line-no">6365</span><span id="line-6365">    */</span>
<span class="source-line-no">6366</span><span id="line-6366">   public DebugEnablement getDebugEnablement() {</span>
<span class="source-line-no">6367</span><span id="line-6367">      return debugEnablement;</span>
<span class="source-line-no">6368</span><span id="line-6368">   }</span>
<span class="source-line-no">6369</span><span id="line-6369"></span>
<span class="source-line-no">6370</span><span id="line-6370">   /**</span>
<span class="source-line-no">6371</span><span id="line-6371">    * The main method for serializing POJOs passed in through the {@link RestResponse#setContent(Object)} method or</span>
<span class="source-line-no">6372</span><span id="line-6372">    * returned by the Java method.</span>
<span class="source-line-no">6373</span><span id="line-6373">    *</span>
<span class="source-line-no">6374</span><span id="line-6374">    * &lt;p&gt;</span>
<span class="source-line-no">6375</span><span id="line-6375">    * Subclasses may override this method if they wish to modify the way the output is rendered or support other output</span>
<span class="source-line-no">6376</span><span id="line-6376">    * formats.</span>
<span class="source-line-no">6377</span><span id="line-6377">    *</span>
<span class="source-line-no">6378</span><span id="line-6378">    * &lt;p&gt;</span>
<span class="source-line-no">6379</span><span id="line-6379">    * The default implementation simply iterates through the response handlers on this resource</span>
<span class="source-line-no">6380</span><span id="line-6380">    * looking for the first one whose {@link ResponseProcessor#process(RestOpSession)} method returns</span>
<span class="source-line-no">6381</span><span id="line-6381">    * &lt;jk&gt;true&lt;/jk&gt;.</span>
<span class="source-line-no">6382</span><span id="line-6382">    *</span>
<span class="source-line-no">6383</span><span id="line-6383">    * @param opSession The HTTP call.</span>
<span class="source-line-no">6384</span><span id="line-6384">    * @throws IOException Thrown by underlying stream.</span>
<span class="source-line-no">6385</span><span id="line-6385">    * @throws BasicHttpException Non-200 response.</span>
<span class="source-line-no">6386</span><span id="line-6386">    * @throws NotImplemented No registered response processors could handle the call.</span>
<span class="source-line-no">6387</span><span id="line-6387">    */</span>
<span class="source-line-no">6388</span><span id="line-6388">   protected void processResponse(RestOpSession opSession) throws IOException, BasicHttpException, NotImplemented {</span>
<span class="source-line-no">6389</span><span id="line-6389"></span>
<span class="source-line-no">6390</span><span id="line-6390">      // Loop until we find the correct processor for the POJO.</span>
<span class="source-line-no">6391</span><span id="line-6391">      int loops = 5;</span>
<span class="source-line-no">6392</span><span id="line-6392">      for (int i = 0; i &lt; responseProcessors.length; i++) {</span>
<span class="source-line-no">6393</span><span id="line-6393">         int j = responseProcessors[i].process(opSession);</span>
<span class="source-line-no">6394</span><span id="line-6394">         if (j == FINISHED)</span>
<span class="source-line-no">6395</span><span id="line-6395">            return;</span>
<span class="source-line-no">6396</span><span id="line-6396">         if (j == RESTART) {</span>
<span class="source-line-no">6397</span><span id="line-6397">            if (loops-- &lt; 0)</span>
<span class="source-line-no">6398</span><span id="line-6398">               throw new InternalServerError("Too many processing loops.");</span>
<span class="source-line-no">6399</span><span id="line-6399">            i = -1;  // Start over.</span>
<span class="source-line-no">6400</span><span id="line-6400">         }</span>
<span class="source-line-no">6401</span><span id="line-6401">      }</span>
<span class="source-line-no">6402</span><span id="line-6402"></span>
<span class="source-line-no">6403</span><span id="line-6403">      Object output = opSession.getResponse().getContent().orElse(null);</span>
<span class="source-line-no">6404</span><span id="line-6404">      throw new NotImplemented("No response processors found to process output of type ''{0}''", className(output));</span>
<span class="source-line-no">6405</span><span id="line-6405">   }</span>
<span class="source-line-no">6406</span><span id="line-6406"></span>
<span class="source-line-no">6407</span><span id="line-6407">   /**</span>
<span class="source-line-no">6408</span><span id="line-6408">    * Method that can be subclassed to allow uncaught throwables to be treated as other types of throwables.</span>
<span class="source-line-no">6409</span><span id="line-6409">    *</span>
<span class="source-line-no">6410</span><span id="line-6410">    * &lt;p&gt;</span>
<span class="source-line-no">6411</span><span id="line-6411">    * The default implementation looks at the throwable class name to determine whether it can be converted to another type:</span>
<span class="source-line-no">6412</span><span id="line-6412">    *</span>
<span class="source-line-no">6413</span><span id="line-6413">    * &lt;ul&gt;</span>
<span class="source-line-no">6414</span><span id="line-6414">    *    &lt;li&gt;&lt;js&gt;"*AccessDenied*"&lt;/js&gt; - Converted to {@link Unauthorized}.</span>
<span class="source-line-no">6415</span><span id="line-6415">    *    &lt;li&gt;&lt;js&gt;"*Empty*"&lt;/js&gt;,&lt;js&gt;"*NotFound*"&lt;/js&gt; - Converted to {@link NotFound}.</span>
<span class="source-line-no">6416</span><span id="line-6416">    * &lt;/ul&gt;</span>
<span class="source-line-no">6417</span><span id="line-6417">    *</span>
<span class="source-line-no">6418</span><span id="line-6418">    * @param t The thrown object.</span>
<span class="source-line-no">6419</span><span id="line-6419">    * @return The converted thrown object.</span>
<span class="source-line-no">6420</span><span id="line-6420">    */</span>
<span class="source-line-no">6421</span><span id="line-6421">   protected Throwable convertThrowable(Throwable t) {</span>
<span class="source-line-no">6422</span><span id="line-6422"></span>
<span class="source-line-no">6423</span><span id="line-6423">      if (t instanceof InvocationTargetException)</span>
<span class="source-line-no">6424</span><span id="line-6424">         t = ((InvocationTargetException)t).getTargetException();</span>
<span class="source-line-no">6425</span><span id="line-6425"></span>
<span class="source-line-no">6426</span><span id="line-6426">      if (t instanceof ExecutableException)</span>
<span class="source-line-no">6427</span><span id="line-6427">         t = ((ExecutableException)t).getTargetException();</span>
<span class="source-line-no">6428</span><span id="line-6428"></span>
<span class="source-line-no">6429</span><span id="line-6429">      if (t instanceof BasicHttpException)</span>
<span class="source-line-no">6430</span><span id="line-6430">         return t;</span>
<span class="source-line-no">6431</span><span id="line-6431"></span>
<span class="source-line-no">6432</span><span id="line-6432">      ClassInfo ci = ClassInfo.of(t);</span>
<span class="source-line-no">6433</span><span id="line-6433"></span>
<span class="source-line-no">6434</span><span id="line-6434">      if (ci.hasAnnotation(Response.class))</span>
<span class="source-line-no">6435</span><span id="line-6435">         return t;</span>
<span class="source-line-no">6436</span><span id="line-6436"></span>
<span class="source-line-no">6437</span><span id="line-6437">      if (ci.isChildOf(ParseException.class) || ci.is(InvalidDataConversionException.class))</span>
<span class="source-line-no">6438</span><span id="line-6438">         return new BadRequest(t);</span>
<span class="source-line-no">6439</span><span id="line-6439"></span>
<span class="source-line-no">6440</span><span id="line-6440">      String n = className(t);</span>
<span class="source-line-no">6441</span><span id="line-6441"></span>
<span class="source-line-no">6442</span><span id="line-6442">      if (n.contains("AccessDenied") || n.contains("Unauthorized"))</span>
<span class="source-line-no">6443</span><span id="line-6443">         return new Unauthorized(t);</span>
<span class="source-line-no">6444</span><span id="line-6444"></span>
<span class="source-line-no">6445</span><span id="line-6445">      if (n.contains("Empty") || n.contains("NotFound"))</span>
<span class="source-line-no">6446</span><span id="line-6446">         return new NotFound(t);</span>
<span class="source-line-no">6447</span><span id="line-6447"></span>
<span class="source-line-no">6448</span><span id="line-6448">      return t;</span>
<span class="source-line-no">6449</span><span id="line-6449">   }</span>
<span class="source-line-no">6450</span><span id="line-6450"></span>
<span class="source-line-no">6451</span><span id="line-6451">   /**</span>
<span class="source-line-no">6452</span><span id="line-6452">    * Handle the case where a matching method was not found.</span>
<span class="source-line-no">6453</span><span id="line-6453">    *</span>
<span class="source-line-no">6454</span><span id="line-6454">    * &lt;p&gt;</span>
<span class="source-line-no">6455</span><span id="line-6455">    * Subclasses can override this method to provide a 2nd-chance for specifying a response.</span>
<span class="source-line-no">6456</span><span id="line-6456">    * The default implementation will simply throw an exception with an appropriate message.</span>
<span class="source-line-no">6457</span><span id="line-6457">    *</span>
<span class="source-line-no">6458</span><span id="line-6458">    * @param session The HTTP call.</span>
<span class="source-line-no">6459</span><span id="line-6459">    * @throws Exception Any exception can be thrown.</span>
<span class="source-line-no">6460</span><span id="line-6460">    */</span>
<span class="source-line-no">6461</span><span id="line-6461">   protected void handleNotFound(RestSession session) throws Exception {</span>
<span class="source-line-no">6462</span><span id="line-6462">      String pathInfo = session.getPathInfo();</span>
<span class="source-line-no">6463</span><span id="line-6463">      String methodUC = session.getMethod();</span>
<span class="source-line-no">6464</span><span id="line-6464">      int rc = session.getStatus();</span>
<span class="source-line-no">6465</span><span id="line-6465">      String onPath = pathInfo == null ? " on no pathInfo"  : String.format(" on path '%s'", pathInfo);</span>
<span class="source-line-no">6466</span><span id="line-6466">      if (rc == SC_NOT_FOUND)</span>
<span class="source-line-no">6467</span><span id="line-6467">         throw new NotFound("Method ''{0}'' not found on resource with matching pattern{1}.", methodUC, onPath);</span>
<span class="source-line-no">6468</span><span id="line-6468">      else if (rc == SC_PRECONDITION_FAILED)</span>
<span class="source-line-no">6469</span><span id="line-6469">         throw new PreconditionFailed("Method ''{0}'' not found on resource{1} with matching matcher.", methodUC, onPath);</span>
<span class="source-line-no">6470</span><span id="line-6470">      else if (rc == SC_METHOD_NOT_ALLOWED)</span>
<span class="source-line-no">6471</span><span id="line-6471">         throw new MethodNotAllowed("Method ''{0}'' not found on resource{1}.", methodUC, onPath);</span>
<span class="source-line-no">6472</span><span id="line-6472">      else</span>
<span class="source-line-no">6473</span><span id="line-6473">         throw new ServletException("Invalid method response: " + rc, session.getException());</span>
<span class="source-line-no">6474</span><span id="line-6474">   }</span>
<span class="source-line-no">6475</span><span id="line-6475"></span>
<span class="source-line-no">6476</span><span id="line-6476">   /**</span>
<span class="source-line-no">6477</span><span id="line-6477">    * Method for handling response errors.</span>
<span class="source-line-no">6478</span><span id="line-6478">    *</span>
<span class="source-line-no">6479</span><span id="line-6479">    * &lt;p&gt;</span>
<span class="source-line-no">6480</span><span id="line-6480">    * Subclasses can override this method to provide their own custom error response handling.</span>
<span class="source-line-no">6481</span><span id="line-6481">    *</span>
<span class="source-line-no">6482</span><span id="line-6482">    * @param session The rest call.</span>
<span class="source-line-no">6483</span><span id="line-6483">    * @param e The exception that occurred.</span>
<span class="source-line-no">6484</span><span id="line-6484">    * @throws IOException Can be thrown if a problem occurred trying to write to the output stream.</span>
<span class="source-line-no">6485</span><span id="line-6485">    */</span>
<span class="source-line-no">6486</span><span id="line-6486">   protected synchronized void handleError(RestSession session, Throwable e) throws IOException {</span>
<span class="source-line-no">6487</span><span id="line-6487"></span>
<span class="source-line-no">6488</span><span id="line-6488">      session.exception(e);</span>
<span class="source-line-no">6489</span><span id="line-6489"></span>
<span class="source-line-no">6490</span><span id="line-6490">      if (session.isDebug())</span>
<span class="source-line-no">6491</span><span id="line-6491">         e.printStackTrace();</span>
<span class="source-line-no">6492</span><span id="line-6492"></span>
<span class="source-line-no">6493</span><span id="line-6493">      int code = 500;</span>
<span class="source-line-no">6494</span><span id="line-6494"></span>
<span class="source-line-no">6495</span><span id="line-6495">      ClassInfo ci = ClassInfo.of(e);</span>
<span class="source-line-no">6496</span><span id="line-6496">      StatusCode r = ci.getAnnotation(StatusCode.class);</span>
<span class="source-line-no">6497</span><span id="line-6497">      if (r != null)</span>
<span class="source-line-no">6498</span><span id="line-6498">         if (r.value().length &gt; 0)</span>
<span class="source-line-no">6499</span><span id="line-6499">            code = r.value()[0];</span>
<span class="source-line-no">6500</span><span id="line-6500"></span>
<span class="source-line-no">6501</span><span id="line-6501">      BasicHttpException e2 = (e instanceof BasicHttpException ? (BasicHttpException)e : new BasicHttpException(code, e));</span>
<span class="source-line-no">6502</span><span id="line-6502"></span>
<span class="source-line-no">6503</span><span id="line-6503">      HttpServletRequest req = session.getRequest();</span>
<span class="source-line-no">6504</span><span id="line-6504">      HttpServletResponse res = session.getResponse();</span>
<span class="source-line-no">6505</span><span id="line-6505"></span>
<span class="source-line-no">6506</span><span id="line-6506">      Throwable t = e2.getRootCause();</span>
<span class="source-line-no">6507</span><span id="line-6507">      if (t != null) {</span>
<span class="source-line-no">6508</span><span id="line-6508">         Thrown t2 = thrown(t);</span>
<span class="source-line-no">6509</span><span id="line-6509">         res.setHeader(t2.getName(), t2.getValue());</span>
<span class="source-line-no">6510</span><span id="line-6510">      }</span>
<span class="source-line-no">6511</span><span id="line-6511"></span>
<span class="source-line-no">6512</span><span id="line-6512">      try {</span>
<span class="source-line-no">6513</span><span id="line-6513">         res.setContentType("text/plain");</span>
<span class="source-line-no">6514</span><span id="line-6514">         res.setHeader("Content-Encoding", "identity");</span>
<span class="source-line-no">6515</span><span id="line-6515">         int statusCode = e2.getStatusLine().getStatusCode();</span>
<span class="source-line-no">6516</span><span id="line-6516">         res.setStatus(statusCode);</span>
<span class="source-line-no">6517</span><span id="line-6517"></span>
<span class="source-line-no">6518</span><span id="line-6518">         PrintWriter w = null;</span>
<span class="source-line-no">6519</span><span id="line-6519">         try {</span>
<span class="source-line-no">6520</span><span id="line-6520">            w = res.getWriter();</span>
<span class="source-line-no">6521</span><span id="line-6521">         } catch (IllegalStateException x) {</span>
<span class="source-line-no">6522</span><span id="line-6522">            w = new PrintWriter(new OutputStreamWriter(res.getOutputStream(), UTF8));</span>
<span class="source-line-no">6523</span><span id="line-6523">         }</span>
<span class="source-line-no">6524</span><span id="line-6524"></span>
<span class="source-line-no">6525</span><span id="line-6525">         try (PrintWriter w2 = w) {</span>
<span class="source-line-no">6526</span><span id="line-6526">            String httpMessage = RestUtils.getHttpResponseText(statusCode);</span>
<span class="source-line-no">6527</span><span id="line-6527">            if (httpMessage != null)</span>
<span class="source-line-no">6528</span><span id="line-6528">               w2.append("HTTP ").append(String.valueOf(statusCode)).append(": ").append(httpMessage).append("\n\n");</span>
<span class="source-line-no">6529</span><span id="line-6529">            if (isRenderResponseStackTraces())</span>
<span class="source-line-no">6530</span><span id="line-6530">               e.printStackTrace(w2);</span>
<span class="source-line-no">6531</span><span id="line-6531">            else</span>
<span class="source-line-no">6532</span><span id="line-6532">               w2.append(e2.getFullStackMessage(true));</span>
<span class="source-line-no">6533</span><span id="line-6533">         }</span>
<span class="source-line-no">6534</span><span id="line-6534"></span>
<span class="source-line-no">6535</span><span id="line-6535">      } catch (Exception e1) {</span>
<span class="source-line-no">6536</span><span id="line-6536">         req.setAttribute("Exception", e1);</span>
<span class="source-line-no">6537</span><span id="line-6537">      }</span>
<span class="source-line-no">6538</span><span id="line-6538">   }</span>
<span class="source-line-no">6539</span><span id="line-6539"></span>
<span class="source-line-no">6540</span><span id="line-6540">   /**</span>
<span class="source-line-no">6541</span><span id="line-6541">    * Called at the start of a request to invoke all {@link RestStartCall} methods.</span>
<span class="source-line-no">6542</span><span id="line-6542">    *</span>
<span class="source-line-no">6543</span><span id="line-6543">    * @param session The current request.</span>
<span class="source-line-no">6544</span><span id="line-6544">    * @throws BasicHttpException If thrown from call methods.</span>
<span class="source-line-no">6545</span><span id="line-6545">    */</span>
<span class="source-line-no">6546</span><span id="line-6546">   protected void startCall(RestSession session) throws BasicHttpException {</span>
<span class="source-line-no">6547</span><span id="line-6547">      for (MethodInvoker x : startCallMethods) {</span>
<span class="source-line-no">6548</span><span id="line-6548">         try {</span>
<span class="source-line-no">6549</span><span id="line-6549">            x.invoke(session.getBeanStore(), session.getContext().getResource());</span>
<span class="source-line-no">6550</span><span id="line-6550">         } catch (IllegalAccessException|IllegalArgumentException e) {</span>
<span class="source-line-no">6551</span><span id="line-6551">            throw new InternalServerError(e, "Error occurred invoking start-call method ''{0}''.", x.getFullName());</span>
<span class="source-line-no">6552</span><span id="line-6552">         } catch (InvocationTargetException e) {</span>
<span class="source-line-no">6553</span><span id="line-6553">            Throwable t = e.getTargetException();</span>
<span class="source-line-no">6554</span><span id="line-6554">            if (t instanceof BasicHttpException)</span>
<span class="source-line-no">6555</span><span id="line-6555">               throw (BasicHttpException)t;</span>
<span class="source-line-no">6556</span><span id="line-6556">            throw new InternalServerError(t);</span>
<span class="source-line-no">6557</span><span id="line-6557">         }</span>
<span class="source-line-no">6558</span><span id="line-6558">      }</span>
<span class="source-line-no">6559</span><span id="line-6559">   }</span>
<span class="source-line-no">6560</span><span id="line-6560"></span>
<span class="source-line-no">6561</span><span id="line-6561">   /**</span>
<span class="source-line-no">6562</span><span id="line-6562">    * Called during a request to invoke all {@link RestPreCall} methods.</span>
<span class="source-line-no">6563</span><span id="line-6563">    *</span>
<span class="source-line-no">6564</span><span id="line-6564">    * @param session The current request.</span>
<span class="source-line-no">6565</span><span id="line-6565">    * @throws Throwable If thrown from call methods.</span>
<span class="source-line-no">6566</span><span id="line-6566">    */</span>
<span class="source-line-no">6567</span><span id="line-6567">   protected void preCall(RestOpSession session) throws Throwable {</span>
<span class="source-line-no">6568</span><span id="line-6568">      for (RestOpInvoker m : session.getContext().getPreCallMethods())</span>
<span class="source-line-no">6569</span><span id="line-6569">         m.invoke(session);</span>
<span class="source-line-no">6570</span><span id="line-6570">   }</span>
<span class="source-line-no">6571</span><span id="line-6571"></span>
<span class="source-line-no">6572</span><span id="line-6572">   /**</span>
<span class="source-line-no">6573</span><span id="line-6573">    * Called during a request to invoke all {@link RestPostCall} methods.</span>
<span class="source-line-no">6574</span><span id="line-6574">    *</span>
<span class="source-line-no">6575</span><span id="line-6575">    * @param session The current request.</span>
<span class="source-line-no">6576</span><span id="line-6576">    * @throws Throwable If thrown from call methods.</span>
<span class="source-line-no">6577</span><span id="line-6577">    */</span>
<span class="source-line-no">6578</span><span id="line-6578">   protected void postCall(RestOpSession session) throws Throwable {</span>
<span class="source-line-no">6579</span><span id="line-6579">      for (RestOpInvoker m : session.getContext().getPostCallMethods())</span>
<span class="source-line-no">6580</span><span id="line-6580">         m.invoke(session);</span>
<span class="source-line-no">6581</span><span id="line-6581">   }</span>
<span class="source-line-no">6582</span><span id="line-6582"></span>
<span class="source-line-no">6583</span><span id="line-6583">   /**</span>
<span class="source-line-no">6584</span><span id="line-6584">    * Called at the end of a request to invoke all {@link RestEndCall} methods.</span>
<span class="source-line-no">6585</span><span id="line-6585">    *</span>
<span class="source-line-no">6586</span><span id="line-6586">    * &lt;p&gt;</span>
<span class="source-line-no">6587</span><span id="line-6587">    * This is the very last method called in {@link #execute(Object, HttpServletRequest, HttpServletResponse)}.</span>
<span class="source-line-no">6588</span><span id="line-6588">    *</span>
<span class="source-line-no">6589</span><span id="line-6589">    * @param session The current request.</span>
<span class="source-line-no">6590</span><span id="line-6590">    */</span>
<span class="source-line-no">6591</span><span id="line-6591">   protected void endCall(RestSession session) {</span>
<span class="source-line-no">6592</span><span id="line-6592">      for (MethodInvoker x : endCallMethods) {</span>
<span class="source-line-no">6593</span><span id="line-6593">         try {</span>
<span class="source-line-no">6594</span><span id="line-6594">            x.invoke(session.getBeanStore(), session.getResource());</span>
<span class="source-line-no">6595</span><span id="line-6595">         } catch (Exception e) {</span>
<span class="source-line-no">6596</span><span id="line-6596">            getLogger().log(Level.WARNING, unwrap(e), ()-&gt;Utils.f("Error occurred invoking finish-call method ''{0}''.", x.getFullName()));</span>
<span class="source-line-no">6597</span><span id="line-6597">         }</span>
<span class="source-line-no">6598</span><span id="line-6598">      }</span>
<span class="source-line-no">6599</span><span id="line-6599">   }</span>
<span class="source-line-no">6600</span><span id="line-6600"></span>
<span class="source-line-no">6601</span><span id="line-6601">   /**</span>
<span class="source-line-no">6602</span><span id="line-6602">    * Called during servlet initialization to invoke all {@link RestPostInit} child-last methods.</span>
<span class="source-line-no">6603</span><span id="line-6603">    *</span>
<span class="source-line-no">6604</span><span id="line-6604">    * @return This object.</span>
<span class="source-line-no">6605</span><span id="line-6605">    * @throws ServletException Error occurred.</span>
<span class="source-line-no">6606</span><span id="line-6606">    */</span>
<span class="source-line-no">6607</span><span id="line-6607">   public synchronized RestContext postInit() throws ServletException {</span>
<span class="source-line-no">6608</span><span id="line-6608">      if (initialized.get())</span>
<span class="source-line-no">6609</span><span id="line-6609">         return this;</span>
<span class="source-line-no">6610</span><span id="line-6610">      Object resource = getResource();</span>
<span class="source-line-no">6611</span><span id="line-6611">      MethodInfo mi = ClassInfo.of(getResource()).getPublicMethod(</span>
<span class="source-line-no">6612</span><span id="line-6612">         x -&gt; x.hasName("setContext")</span>
<span class="source-line-no">6613</span><span id="line-6613">         &amp;&amp; x.hasParamTypes(RestContext.class)</span>
<span class="source-line-no">6614</span><span id="line-6614">      );</span>
<span class="source-line-no">6615</span><span id="line-6615">      if (mi != null) {</span>
<span class="source-line-no">6616</span><span id="line-6616">         try {</span>
<span class="source-line-no">6617</span><span id="line-6617">            mi.accessible().invoke(resource, this);</span>
<span class="source-line-no">6618</span><span id="line-6618">         } catch (ExecutableException e) {</span>
<span class="source-line-no">6619</span><span id="line-6619">            throw new ServletException(e.unwrap());</span>
<span class="source-line-no">6620</span><span id="line-6620">         }</span>
<span class="source-line-no">6621</span><span id="line-6621">      }</span>
<span class="source-line-no">6622</span><span id="line-6622">      for (MethodInvoker x : postInitMethods) {</span>
<span class="source-line-no">6623</span><span id="line-6623">         try {</span>
<span class="source-line-no">6624</span><span id="line-6624">            x.invoke(beanStore, getResource());</span>
<span class="source-line-no">6625</span><span id="line-6625">         } catch (Exception e) {</span>
<span class="source-line-no">6626</span><span id="line-6626">            throw new ServletException(unwrap(e));</span>
<span class="source-line-no">6627</span><span id="line-6627">         }</span>
<span class="source-line-no">6628</span><span id="line-6628">      }</span>
<span class="source-line-no">6629</span><span id="line-6629">      restChildren.postInit();</span>
<span class="source-line-no">6630</span><span id="line-6630">      return this;</span>
<span class="source-line-no">6631</span><span id="line-6631">   }</span>
<span class="source-line-no">6632</span><span id="line-6632"></span>
<span class="source-line-no">6633</span><span id="line-6633">   /**</span>
<span class="source-line-no">6634</span><span id="line-6634">    * Called during servlet initialization to invoke all {@link RestPostInit} child-first methods.</span>
<span class="source-line-no">6635</span><span id="line-6635">    *</span>
<span class="source-line-no">6636</span><span id="line-6636">    * @return This object.</span>
<span class="source-line-no">6637</span><span id="line-6637">    * @throws ServletException Error occurred.</span>
<span class="source-line-no">6638</span><span id="line-6638">    */</span>
<span class="source-line-no">6639</span><span id="line-6639">   public RestContext postInitChildFirst() throws ServletException {</span>
<span class="source-line-no">6640</span><span id="line-6640">      if (initialized.get())</span>
<span class="source-line-no">6641</span><span id="line-6641">         return this;</span>
<span class="source-line-no">6642</span><span id="line-6642">      restChildren.postInitChildFirst();</span>
<span class="source-line-no">6643</span><span id="line-6643">      for (MethodInvoker x : postInitChildFirstMethods) {</span>
<span class="source-line-no">6644</span><span id="line-6644">         try {</span>
<span class="source-line-no">6645</span><span id="line-6645">            x.invoke(beanStore, getResource());</span>
<span class="source-line-no">6646</span><span id="line-6646">         } catch (Exception e) {</span>
<span class="source-line-no">6647</span><span id="line-6647">            throw new ServletException(unwrap(e));</span>
<span class="source-line-no">6648</span><span id="line-6648">         }</span>
<span class="source-line-no">6649</span><span id="line-6649">      }</span>
<span class="source-line-no">6650</span><span id="line-6650">      initialized.set(true);</span>
<span class="source-line-no">6651</span><span id="line-6651">      return this;</span>
<span class="source-line-no">6652</span><span id="line-6652">   }</span>
<span class="source-line-no">6653</span><span id="line-6653"></span>
<span class="source-line-no">6654</span><span id="line-6654">   /**</span>
<span class="source-line-no">6655</span><span id="line-6655">    * Called during servlet destruction to invoke all {@link RestDestroy} methods.</span>
<span class="source-line-no">6656</span><span id="line-6656">    */</span>
<span class="source-line-no">6657</span><span id="line-6657">   public void destroy() {</span>
<span class="source-line-no">6658</span><span id="line-6658">      for (MethodInvoker x : destroyMethods) {</span>
<span class="source-line-no">6659</span><span id="line-6659">         try {</span>
<span class="source-line-no">6660</span><span id="line-6660">            x.invoke(beanStore, getResource());</span>
<span class="source-line-no">6661</span><span id="line-6661">         } catch (Exception e) {</span>
<span class="source-line-no">6662</span><span id="line-6662">            getLogger().log(Level.WARNING, unwrap(e), ()-&gt;Utils.f("Error occurred invoking servlet-destroy method ''{0}''.", x.getFullName()));</span>
<span class="source-line-no">6663</span><span id="line-6663">         }</span>
<span class="source-line-no">6664</span><span id="line-6664">      }</span>
<span class="source-line-no">6665</span><span id="line-6665"></span>
<span class="source-line-no">6666</span><span id="line-6666">      restChildren.destroy();</span>
<span class="source-line-no">6667</span><span id="line-6667">   }</span>
<span class="source-line-no">6668</span><span id="line-6668"></span>
<span class="source-line-no">6669</span><span id="line-6669">   /**</span>
<span class="source-line-no">6670</span><span id="line-6670">    * Returns the HTTP call for the current request.</span>
<span class="source-line-no">6671</span><span id="line-6671">    *</span>
<span class="source-line-no">6672</span><span id="line-6672">    * @return The HTTP call for the current request, never &lt;jk&gt;null&lt;/jk&gt;?</span>
<span class="source-line-no">6673</span><span id="line-6673">    * @throws InternalServerError If no active request exists on the current thread.</span>
<span class="source-line-no">6674</span><span id="line-6674">    */</span>
<span class="source-line-no">6675</span><span id="line-6675">   public RestSession getLocalSession() {</span>
<span class="source-line-no">6676</span><span id="line-6676">      RestSession rc = localSession.get();</span>
<span class="source-line-no">6677</span><span id="line-6677">      if (rc == null)</span>
<span class="source-line-no">6678</span><span id="line-6678">         throw new InternalServerError("No active request on current thread.");</span>
<span class="source-line-no">6679</span><span id="line-6679">      return rc;</span>
<span class="source-line-no">6680</span><span id="line-6680">   }</span>
<span class="source-line-no">6681</span><span id="line-6681"></span>
<span class="source-line-no">6682</span><span id="line-6682">// /**</span>
<span class="source-line-no">6683</span><span id="line-6683">//  * If the specified object is annotated with {@link Response}, this returns the response metadata about that object.</span>
<span class="source-line-no">6684</span><span id="line-6684">//  *</span>
<span class="source-line-no">6685</span><span id="line-6685">//  * @param o The object to check.</span>
<span class="source-line-no">6686</span><span id="line-6686">//  * @return The response metadata, or &lt;jk&gt;null&lt;/jk&gt; if it wasn't annotated with {@link Response}.</span>
<span class="source-line-no">6687</span><span id="line-6687">//  */</span>
<span class="source-line-no">6688</span><span id="line-6688">// public ResponseBeanMeta getResponseBeanMeta(Object o) {</span>
<span class="source-line-no">6689</span><span id="line-6689">//    if (o == null)</span>
<span class="source-line-no">6690</span><span id="line-6690">//       return null;</span>
<span class="source-line-no">6691</span><span id="line-6691">//    Class&lt;?&gt; c = o.getClass();</span>
<span class="source-line-no">6692</span><span id="line-6692">//    ResponseBeanMeta rbm = responseBeanMetas.get(c);</span>
<span class="source-line-no">6693</span><span id="line-6693">//    if (rbm == null) {</span>
<span class="source-line-no">6694</span><span id="line-6694">//       rbm = ResponseBeanMeta.create(c, getAnnotations());</span>
<span class="source-line-no">6695</span><span id="line-6695">//       if (rbm == null)</span>
<span class="source-line-no">6696</span><span id="line-6696">//          rbm = ResponseBeanMeta.NULL;</span>
<span class="source-line-no">6697</span><span id="line-6697">//       responseBeanMetas.put(c, rbm);</span>
<span class="source-line-no">6698</span><span id="line-6698">//    }</span>
<span class="source-line-no">6699</span><span id="line-6699">//    if (rbm == ResponseBeanMeta.NULL)</span>
<span class="source-line-no">6700</span><span id="line-6700">//       return null;</span>
<span class="source-line-no">6701</span><span id="line-6701">//    return rbm;</span>
<span class="source-line-no">6702</span><span id="line-6702">// }</span>
<span class="source-line-no">6703</span><span id="line-6703">//</span>
<span class="source-line-no">6704</span><span id="line-6704">   /**</span>
<span class="source-line-no">6705</span><span id="line-6705">    * Returns the annotations applied to this context.</span>
<span class="source-line-no">6706</span><span id="line-6706">    *</span>
<span class="source-line-no">6707</span><span id="line-6707">    * @return The annotations applied to this context.</span>
<span class="source-line-no">6708</span><span id="line-6708">    */</span>
<span class="source-line-no">6709</span><span id="line-6709">   public AnnotationWorkList getAnnotations() {</span>
<span class="source-line-no">6710</span><span id="line-6710">      return builder.getApplied();</span>
<span class="source-line-no">6711</span><span id="line-6711">   }</span>
<span class="source-line-no">6712</span><span id="line-6712"></span>
<span class="source-line-no">6713</span><span id="line-6713"></span>
<span class="source-line-no">6714</span><span id="line-6714"></span>
<span class="source-line-no">6715</span><span id="line-6715"></span>
<span class="source-line-no">6716</span><span id="line-6716">   //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">6717</span><span id="line-6717">   // Helper methods</span>
<span class="source-line-no">6718</span><span id="line-6718">   //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">6719</span><span id="line-6719"></span>
<span class="source-line-no">6720</span><span id="line-6720">   private Throwable unwrap(Throwable t) {</span>
<span class="source-line-no">6721</span><span id="line-6721">      if (t instanceof InvocationTargetException) {</span>
<span class="source-line-no">6722</span><span id="line-6722">         return ((InvocationTargetException)t).getTargetException();</span>
<span class="source-line-no">6723</span><span id="line-6723">      }</span>
<span class="source-line-no">6724</span><span id="line-6724">      return t;</span>
<span class="source-line-no">6725</span><span id="line-6725">   }</span>
<span class="source-line-no">6726</span><span id="line-6726"></span>
<span class="source-line-no">6727</span><span id="line-6727">   static ServletException servletException(String msg, Object...args) {</span>
<span class="source-line-no">6728</span><span id="line-6728">      return new ServletException(Utils.f(msg, args));</span>
<span class="source-line-no">6729</span><span id="line-6729">   }</span>
<span class="source-line-no">6730</span><span id="line-6730"></span>
<span class="source-line-no">6731</span><span id="line-6731">   static ServletException servletException(Throwable t, String msg, Object...args) {</span>
<span class="source-line-no">6732</span><span id="line-6732">      return new ServletException(Utils.f(msg, args), t);</span>
<span class="source-line-no">6733</span><span id="line-6733">   }</span>
<span class="source-line-no">6734</span><span id="line-6734"></span>
<span class="source-line-no">6735</span><span id="line-6735">   //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">6736</span><span id="line-6736">   // Other methods</span>
<span class="source-line-no">6737</span><span id="line-6737">   //-----------------------------------------------------------------------------------------------------------------</span>
<span class="source-line-no">6738</span><span id="line-6738"></span>
<span class="source-line-no">6739</span><span id="line-6739">   @Override /* Context */</span>
<span class="source-line-no">6740</span><span id="line-6740">   protected JsonMap properties() {</span>
<span class="source-line-no">6741</span><span id="line-6741">      return filteredMap()</span>
<span class="source-line-no">6742</span><span id="line-6742">         .append("allowContentParam", allowContentParam)</span>
<span class="source-line-no">6743</span><span id="line-6743">         .append("allowedMethodHeader", allowedMethodHeaders)</span>
<span class="source-line-no">6744</span><span id="line-6744">         .append("allowedMethodParams", allowedMethodParams)</span>
<span class="source-line-no">6745</span><span id="line-6745">         .append("allowedHeaderParams", allowedHeaderParams)</span>
<span class="source-line-no">6746</span><span id="line-6746">         .append("beanStore", beanStore)</span>
<span class="source-line-no">6747</span><span id="line-6747">         .append("clientVersionHeader", clientVersionHeader)</span>
<span class="source-line-no">6748</span><span id="line-6748">         .append("consumes", consumes)</span>
<span class="source-line-no">6749</span><span id="line-6749">         .append("defaultRequestHeaders", defaultRequestHeaders)</span>
<span class="source-line-no">6750</span><span id="line-6750">         .append("defaultResponseHeaders", defaultResponseHeaders)</span>
<span class="source-line-no">6751</span><span id="line-6751">         .append("restOpArgs", restOpArgs)</span>
<span class="source-line-no">6752</span><span id="line-6752">         .append("partParser", partParser)</span>
<span class="source-line-no">6753</span><span id="line-6753">         .append("partSerializer", partSerializer)</span>
<span class="source-line-no">6754</span><span id="line-6754">         .append("produces", produces)</span>
<span class="source-line-no">6755</span><span id="line-6755">         .append("renderResponseStackTraces", renderResponseStackTraces)</span>
<span class="source-line-no">6756</span><span id="line-6756">         .append("responseProcessors", responseProcessors)</span>
<span class="source-line-no">6757</span><span id="line-6757">         .append("staticFiles", staticFiles)</span>
<span class="source-line-no">6758</span><span id="line-6758">         .append("swaggerProvider", swaggerProvider)</span>
<span class="source-line-no">6759</span><span id="line-6759">         .append("uriAuthority", uriAuthority)</span>
<span class="source-line-no">6760</span><span id="line-6760">         .append("uriContext", uriContext)</span>
<span class="source-line-no">6761</span><span id="line-6761">         .append("uriRelativity", uriRelativity)</span>
<span class="source-line-no">6762</span><span id="line-6762">         .append("uriResolution", uriResolution);</span>
<span class="source-line-no">6763</span><span id="line-6763">   }</span>
<span class="source-line-no">6764</span><span id="line-6764">}</span>




























































</pre>
</div>
</main>
</body>
</html>
