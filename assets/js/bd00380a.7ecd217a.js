"use strict";(self.webpackChunkjuneau_documentation=self.webpackChunkjuneau_documentation||[]).push([[1705],{4724:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"topics/19.01.00.JuneauShadedOverview","title":"Juneau Shaded Artifacts","description":"Juneau provides shaded (uber) JAR artifacts that bundle multiple Juneau modules into single JAR files. These artifacts simplify dependency management and are especially useful for build systems like Bazel that require explicit dependency declarations.","source":"@site/docs/topics/19.01.00.JuneauShadedOverview.md","sourceDirName":"topics","slug":"/topics/JuneauShadedOverview","permalink":"/docs/topics/JuneauShadedOverview","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/juneau/tree/master/juneau-docs/docs/topics/19.01.00.JuneauShadedOverview.md","tags":[],"version":"current","frontMatter":{"title":"Juneau Shaded Artifacts","slug":"JuneauShadedOverview"},"sidebar":"mainSidebar","previous":{"title":"18.4. juneau-examples-rest-springboot","permalink":"/docs/topics/JuneauExamplesRestSpringboot"},"next":{"title":"19.2. juneau-shaded-core","permalink":"/docs/topics/JuneauShadedCore"}}');var a=s(74848),i=s(28453);const d={title:"Juneau Shaded Artifacts",slug:"JuneauShadedOverview"},l=void 0,t={},c=[{value:"What Are Shaded Artifacts?",id:"what-are-shaded-artifacts",level:2},{value:"Available Shaded Artifacts",id:"available-shaded-artifacts",level:2},{value:"When to Use Shaded Artifacts",id:"when-to-use-shaded-artifacts",level:2},{value:"\u2705 Use Shaded Artifacts When:",id:"-use-shaded-artifacts-when",level:3},{value:"\u274c Consider Individual Modules When:",id:"-consider-individual-modules-when",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"Maven",id:"maven",level:3},{value:"Bazel",id:"bazel",level:3},{value:"Why Shaded Artifacts for Bazel?",id:"why-shaded-artifacts-for-bazel",level:2},{value:"The Problem with Regular Juneau in Bazel",id:"the-problem-with-regular-juneau-in-bazel",level:3},{value:"Solution with Shaded Artifacts",id:"solution-with-shaded-artifacts",level:3},{value:"Complete Bazel Examples",id:"complete-bazel-examples",level:2},{value:"Example 1: REST Client",id:"example-1-rest-client",level:3},{value:"Example 2: REST Server",id:"example-2-rest-server",level:3},{value:"Example 3: Spring Boot Integration",id:"example-3-spring-boot-integration",level:3},{value:"Example 4: Core Marshalling Only",id:"example-4-core-marshalling-only",level:3},{value:"Example 5: Everything (Complete Framework)",id:"example-5-everything-complete-framework",level:3},{value:"Finding External Dependencies",id:"finding-external-dependencies",level:2},{value:"Method 1: Check the dependency-reduced-pom.xml",id:"method-1-check-the-dependency-reduced-pomxml",level:3},{value:"Method 2: Use Maven dependency",id:"method-2-use-maven-dependency",level:3},{value:"Method 3: Common External Dependencies",id:"method-3-common-external-dependencies",level:3},{value:"Advanced: Using rules_jvm_external",id:"advanced-using-rules_jvm_external",level:2},{value:"Bazel Troubleshooting",id:"bazel-troubleshooting",level:2},{value:"Build fails with &quot;package X does not exist&quot;",id:"build-fails-with-package-x-does-not-exist",level:3},{value:"Conflicting versions of dependencies",id:"conflicting-versions-of-dependencies",level:3},{value:"Shaded JAR is too large",id:"shaded-jar-is-too-large",level:3},{value:"Bazel Best Practices",id:"bazel-best-practices",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Build Time",id:"build-time",level:3},{value:"Runtime",id:"runtime",level:3},{value:"JAR Size",id:"jar-size",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Distribution",id:"distribution",level:2},{value:"Learn More",id:"learn-more",level:2},{value:"Individual Shaded Artifacts",id:"individual-shaded-artifacts",level:3},{value:"Additional Resources",id:"additional-resources",level:3}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["Juneau provides ",(0,a.jsx)(n.strong,{children:"shaded (uber) JAR artifacts"})," that bundle multiple Juneau modules into single JAR files. These artifacts simplify dependency management and are especially useful for build systems like Bazel that require explicit dependency declarations."]}),"\n",(0,a.jsx)(n.h2,{id:"what-are-shaded-artifacts",children:"What Are Shaded Artifacts?"}),"\n",(0,a.jsxs)(n.p,{children:["Shaded artifacts use the ",(0,a.jsx)(n.a,{href:"https://maven.apache.org/plugins/maven-shade-plugin/",children:"Maven Shade Plugin"})," to:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Bundle multiple Juneau modules into a single JAR"}),"\n",(0,a.jsx)(n.li,{children:"Merge service provider files automatically"}),"\n",(0,a.jsx)(n.li,{children:"Eliminate the need to declare transitive Juneau dependencies"}),"\n",(0,a.jsx)(n.li,{children:"Maintain all original functionality without modification"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Important"}),": Shaded artifacts only bundle Juneau modules. External dependencies (like Apache HttpClient, Jakarta Servlet API, etc.) must still be declared separately."]}),"\n",(0,a.jsx)(n.h2,{id:"available-shaded-artifacts",children:"Available Shaded Artifacts"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Artifact"}),(0,a.jsx)(n.th,{children:"Size"}),(0,a.jsx)(n.th,{children:"Description"}),(0,a.jsx)(n.th,{children:"Details"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedCore",children:"juneau-shaded-core"})}),(0,a.jsx)(n.td,{children:"2.0 MB"}),(0,a.jsx)(n.td,{children:"Core marshalling and configuration functionality"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedCore",children:"Learn more \u2192"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestClient",children:"juneau-shaded-rest-client"})}),(0,a.jsx)(n.td,{children:"3.8 MB"}),(0,a.jsx)(n.td,{children:"Core + REST client functionality"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestClient",children:"Learn more \u2192"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServer",children:"juneau-shaded-rest-server"})}),(0,a.jsx)(n.td,{children:"3.8 MB"}),(0,a.jsx)(n.td,{children:"Core + REST server functionality"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServer",children:"Learn more \u2192"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServerSpringboot",children:"juneau-shaded-rest-server-springboot"})}),(0,a.jsx)(n.td,{children:"3.8 MB"}),(0,a.jsx)(n.td,{children:"REST server + Spring Boot integration"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServerSpringboot",children:"Learn more \u2192"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedAll",children:"juneau-shaded-all"})}),(0,a.jsx)(n.td,{children:"4.0 MB"}),(0,a.jsx)(n.td,{children:"Complete Juneau framework in one JAR"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedAll",children:"Learn more \u2192"})})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"when-to-use-shaded-artifacts",children:"When to Use Shaded Artifacts"}),"\n",(0,a.jsx)(n.h3,{id:"-use-shaded-artifacts-when",children:"\u2705 Use Shaded Artifacts When:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Using Bazel or similar build systems"})," - These require explicit dependency declarations; shaded artifacts simplify this significantly"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Wanting simplified dependency management"})," - One dependency instead of many"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Building standalone applications"})," - Uber JARs are convenient for deployment"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Getting started quickly"})," - Fewer decisions about which modules to include"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"-consider-individual-modules-when",children:"\u274c Consider Individual Modules When:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Building a library"})," - Other projects may need fine-grained control over dependencies"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Minimizing JAR size"})," - Individual modules allow excluding unused functionality"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Avoiding classpath conflicts"})," - In complex applications with many dependencies"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Needing different module versions"})," - Though this is rarely necessary"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,a.jsx)(n.h3,{id:"maven",children:"Maven"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.juneau</groupId>\n    <artifactId>juneau-shaded-all</artifactId>\n    <version>${juneau.version}</version>\n</dependency>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"bazel",children:"Bazel"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_all",\n    artifact = "org.apache.juneau:juneau-shaded-all:${juneau.version}",\n)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"why-shaded-artifacts-for-bazel",children:"Why Shaded Artifacts for Bazel?"}),"\n",(0,a.jsxs)(n.p,{children:["Bazel enforces ",(0,a.jsx)(n.strong,{children:"strict dependency management"})," where you must explicitly declare every direct dependency your code uses. Unlike Maven, which automatically resolves transitive dependencies, Bazel requires you to know and declare all dependencies."]}),"\n",(0,a.jsx)(n.h3,{id:"the-problem-with-regular-juneau-in-bazel",children:"The Problem with Regular Juneau in Bazel"}),"\n",(0,a.jsx)(n.p,{children:"When using regular Juneau modules in Bazel:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'# This is incomplete and will fail!\nmaven_jar(\n    name = "juneau_marshall",\n    artifact = "org.apache.juneau:juneau-marshall:9.2.0-SNAPSHOT",\n)\n\njava_library(\n    name = "my_lib",\n    srcs = ["MyCode.java"],\n    deps = ["@juneau_marshall//jar"],  # Missing juneau-common!\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Problem"}),": Your code can't compile because ",(0,a.jsx)(n.code,{children:"juneau-marshall"})," depends on ",(0,a.jsx)(n.code,{children:"juneau-common"}),", but you didn't declare it."]}),"\n",(0,a.jsx)(n.h3,{id:"solution-with-shaded-artifacts",children:"Solution with Shaded Artifacts"}),"\n",(0,a.jsx)(n.p,{children:"Just one dependency declaration!"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_core",\n    artifact = "org.apache.juneau:juneau-shaded-core:9.2.0-SNAPSHOT",\n)\n\njava_library(\n    name = "my_lib",\n    srcs = ["MyCode.java"],\n    deps = ["@juneau_core//jar"],  # Everything included!\n)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"complete-bazel-examples",children:"Complete Bazel Examples"}),"\n",(0,a.jsx)(n.h3,{id:"example-1-rest-client",children:"Example 1: REST Client"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Scenario"}),": Build a REST client application."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")\n\n# Add Maven dependencies\nmaven_jar(\n    name = "juneau_rest_client",\n    artifact = "org.apache.juneau:juneau-shaded-rest-client:9.2.0-SNAPSHOT",\n    repository = "https://repository.apache.org/content/repositories/snapshots/",\n)\n\n# External dependencies (still need these)\nmaven_jar(\n    name = "httpclient5",\n    artifact = "org.apache.httpcomponents.client5:httpclient5:5.2.1",\n)\n\nmaven_jar(\n    name = "httpcore5",\n    artifact = "org.apache.httpcomponents.core5:httpcore5:5.2.1",\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_binary(\n    name = "my_rest_client",\n    srcs = ["MyRestClient.java"],\n    deps = [\n        "@juneau_rest_client//jar",\n        "@httpclient5//jar",\n        "@httpcore5//jar",\n    ],\n    main_class = "com.example.MyRestClient",\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"example-2-rest-server",children:"Example 2: REST Server"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Scenario"}),": Build a REST server application."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_rest_server",\n    artifact = "org.apache.juneau:juneau-shaded-rest-server:9.2.0-SNAPSHOT",\n    repository = "https://repository.apache.org/content/repositories/snapshots/",\n)\n\nmaven_jar(\n    name = "jakarta_servlet_api",\n    artifact = "jakarta.servlet:jakarta.servlet-api:6.1.0",\n)\n\nmaven_jar(\n    name = "jetty_server",\n    artifact = "org.eclipse.jetty:jetty-server:12.0.5",\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_library(\n    name = "my_rest_server",\n    srcs = ["MyRestServer.java"],\n    deps = [\n        "@juneau_rest_server//jar",\n        "@jakarta_servlet_api//jar",\n        "@jetty_server//jar",\n    ],\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"example-3-spring-boot-integration",children:"Example 3: Spring Boot Integration"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Scenario"}),": Build a Spring Boot + Juneau application."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_rest_server_springboot",\n    artifact = "org.apache.juneau:juneau-shaded-rest-server-springboot:9.2.0-SNAPSHOT",\n    repository = "https://repository.apache.org/content/repositories/snapshots/",\n)\n\nmaven_jar(\n    name = "spring_boot_starter_web",\n    artifact = "org.springframework.boot:spring-boot-starter-web:3.2.0",\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_library(\n    name = "my_spring_app",\n    srcs = glob(["src/**/*.java"]),\n    deps = [\n        "@juneau_rest_server_springboot//jar",\n        "@spring_boot_starter_web//jar",\n    ],\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"example-4-core-marshalling-only",children:"Example 4: Core Marshalling Only"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Scenario"}),": Use Juneau for JSON/XML/etc. serialization without REST features."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_core",\n    artifact = "org.apache.juneau:juneau-shaded-core:9.2.0-SNAPSHOT",\n    repository = "https://repository.apache.org/content/repositories/snapshots/",\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_library(\n    name = "my_serialization_lib",\n    srcs = ["MySerializer.java"],\n    deps = [\n        "@juneau_core//jar",\n    ],\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"example-5-everything-complete-framework",children:"Example 5: Everything (Complete Framework)"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Scenario"}),": You want access to all Juneau features."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_jar(\n    name = "juneau_all",\n    artifact = "org.apache.juneau:juneau-shaded-all:9.2.0-SNAPSHOT",\n    repository = "https://repository.apache.org/content/repositories/snapshots/",\n)\n\n# Still need external dependencies\nmaven_jar(\n    name = "jakarta_servlet_api",\n    artifact = "jakarta.servlet:jakarta.servlet-api:6.1.0",\n)\n\nmaven_jar(\n    name = "httpclient5",\n    artifact = "org.apache.httpcomponents.client5:httpclient5:5.2.1",\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_library(\n    name = "my_full_app",\n    srcs = glob(["src/**/*.java"]),\n    deps = [\n        "@juneau_all//jar",\n        "@jakarta_servlet_api//jar",\n        "@httpclient5//jar",\n    ],\n)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"finding-external-dependencies",children:"Finding External Dependencies"}),"\n",(0,a.jsxs)(n.p,{children:["Shaded JARs ",(0,a.jsx)(n.strong,{children:"only bundle Juneau modules"}),". External dependencies (like Apache HttpClient, Jakarta Servlet API, etc.) must still be declared separately."]}),"\n",(0,a.jsx)(n.h3,{id:"method-1-check-the-dependency-reduced-pomxml",children:"Method 1: Check the dependency-reduced-pom.xml"}),"\n",(0,a.jsx)(n.p,{children:"After building a shaded module, examine:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cat juneau-shaded/juneau-shaded-rest-client/dependency-reduced-pom.xml\n"})}),"\n",(0,a.jsx)(n.p,{children:"This file lists all external dependencies that the shaded JAR still requires."}),"\n",(0,a.jsxs)(n.h3,{id:"method-2-use-maven-dependency",children:["Method 2: Use Maven dependency",":tree"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd juneau-shaded/juneau-shaded-rest-client\nmvn dependency:tree\n"})}),"\n",(0,a.jsx)(n.h3,{id:"method-3-common-external-dependencies",children:"Method 3: Common External Dependencies"}),"\n",(0,a.jsx)(n.p,{children:"Here's a quick reference:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Juneau Shaded Artifact"}),(0,a.jsx)(n.th,{children:"Common External Dependencies"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-core"})}),(0,a.jsxs)(n.td,{children:["None (optional: ",(0,a.jsx)(n.code,{children:"jakarta.xml.bind-api"})," for XML)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-rest-client"})}),(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.code,{children:"httpclient5"}),", ",(0,a.jsx)(n.code,{children:"httpcore5"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-rest-server"})}),(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.code,{children:"jakarta.servlet-api"}),", ",(0,a.jsx)(n.code,{children:"jetty-server"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-rest-server-springboot"})}),(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.code,{children:"spring-boot-starter-web"}),", ",(0,a.jsx)(n.code,{children:"jakarta.servlet-api"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-all"})}),(0,a.jsx)(n.td,{children:"All of the above"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"advanced-using-rules_jvm_external",children:"Advanced: Using rules_jvm_external"}),"\n",(0,a.jsxs)(n.p,{children:["For more sophisticated Bazel builds, use ",(0,a.jsx)(n.code,{children:"rules_jvm_external"}),":"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WORKSPACE"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")\n\nRULES_JVM_EXTERNAL_TAG = "5.3"\nRULES_JVM_EXTERNAL_SHA = "d31e369b854322ca5098ea12c69d7175ded971435e55c18dd9dd5f29cc5249ac"\n\nhttp_archive(\n    name = "rules_jvm_external",\n    strip_prefix = "rules_jvm_external-%s" % RULES_JVM_EXTERNAL_TAG,\n    sha256 = RULES_JVM_EXTERNAL_SHA,\n    url = "https://github.com/bazelbuild/rules_jvm_external/releases/download/%s/rules_jvm_external-%s.tar.gz" % (RULES_JVM_EXTERNAL_TAG, RULES_JVM_EXTERNAL_TAG),\n)\n\nload("@rules_jvm_external//:defs.bzl", "maven_install")\n\nmaven_install(\n    artifacts = [\n        "org.apache.juneau:juneau-shaded-rest-client:9.2.0-SNAPSHOT",\n        "org.apache.httpcomponents.client5:httpclient5:5.2.1",\n        "org.apache.httpcomponents.core5:httpcore5:5.2.1",\n    ],\n    repositories = [\n        "https://repository.apache.org/content/repositories/snapshots/",\n        "https://repo1.maven.org/maven2",\n    ],\n    fetch_sources = True,\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"BUILD"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'java_binary(\n    name = "my_app",\n    srcs = ["MyApp.java"],\n    deps = [\n        "@maven//:org_apache_juneau_juneau_shaded_rest_client",\n        "@maven//:org_apache_httpcomponents_client5_httpclient5",\n        "@maven//:org_apache_httpcomponents_core5_httpcore5",\n    ],\n    main_class = "com.example.MyApp",\n)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"bazel-troubleshooting",children:"Bazel Troubleshooting"}),"\n",(0,a.jsx)(n.h3,{id:"build-fails-with-package-x-does-not-exist",children:'Build fails with "package X does not exist"'}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Cause"}),": You're missing an external dependency."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Solution"}),": Check the ",(0,a.jsx)(n.code,{children:"dependency-reduced-pom.xml"})," for the shaded module and add the missing dependency to your WORKSPACE."]}),"\n",(0,a.jsx)(n.h3,{id:"conflicting-versions-of-dependencies",children:"Conflicting versions of dependencies"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Cause"}),": Multiple artifacts depend on different versions of the same library."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Solution"}),": Use ",(0,a.jsx)(n.code,{children:"rules_jvm_external"})," with version resolution:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'maven_install(\n    artifacts = [\n        "org.apache.juneau:juneau-shaded-rest-client:9.2.0-SNAPSHOT",\n        "org.apache.httpcomponents.client5:httpclient5:5.2.1",\n    ],\n    version_conflict_policy = "pinned",  # Use specific versions\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"shaded-jar-is-too-large",children:"Shaded JAR is too large"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Cause"}),": You're using ",(0,a.jsx)(n.code,{children:"juneau-shaded-all"})," when you only need a subset."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Solution"}),": Use a more specific shaded artifact:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["For client only: ",(0,a.jsx)(n.code,{children:"juneau-shaded-rest-client"})]}),"\n",(0,a.jsxs)(n.li,{children:["For server only: ",(0,a.jsx)(n.code,{children:"juneau-shaded-rest-server"})]}),"\n",(0,a.jsxs)(n.li,{children:["For core only: ",(0,a.jsx)(n.code,{children:"juneau-shaded-core"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"bazel-best-practices",children:"Bazel Best Practices"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Start with the smallest shaded artifact"})," that meets your needs"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsxs)(n.strong,{children:["Always check ",(0,a.jsx)(n.code,{children:"dependency-reduced-pom.xml"})]})," for external dependencies"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsxs)(n.strong,{children:["Use ",(0,a.jsx)(n.code,{children:"rules_jvm_external"})]})," for production Bazel builds"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Pin dependency versions"})," to ensure reproducible builds"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Document external dependencies"})," in your project's README"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,a.jsx)(n.h3,{id:"build-time",children:"Build Time"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Shaded JARs"}),": Faster builds due to fewer dependency declarations"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Individual Modules"}),": More explicit control but slower due to transitive resolution"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"runtime",children:"Runtime"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"No runtime difference between shaded and non-shaded artifacts"}),"\n",(0,a.jsx)(n.li,{children:"Same classes, same performance characteristics"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"jar-size",children:"JAR Size"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Shaded JARs are larger but self-contained"}),"\n",(0,a.jsx)(n.li,{children:"For microservices, this is usually acceptable"}),"\n",(0,a.jsx)(n.li,{children:"For libraries, consider using individual modules"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,a.jsx)(n.p,{children:"The shaded modules form a dependency hierarchy:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"juneau-shaded-core (2.1 MB)\n    \u2193\n    \u251c\u2500\u2192 juneau-shaded-rest-client (3.8 MB)\n    \u2502\n    \u2514\u2500\u2192 juneau-shaded-rest-server (3.8 MB)\n            \u2193\n            \u2514\u2500\u2192 juneau-shaded-rest-server-springboot (3.8 MB)\n\njuneau-shaded-all (4.0 MB)\n    = juneau-shaded-rest-server-springboot\n    + juneau-rest-client\n    + all bean modules\n    + all microservice modules\n"})}),"\n",(0,a.jsx)(n.h2,{id:"distribution",children:"Distribution"}),"\n",(0,a.jsxs)(n.p,{children:["All shaded artifacts are included in the binary distribution under the ",(0,a.jsx)(n.code,{children:"/shaded"})," directory:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"apache-juneau-${version}-bin.zip\n\u2514\u2500\u2500 shaded/\n    \u251c\u2500\u2500 juneau-shaded-core-${version}.jar\n    \u251c\u2500\u2500 juneau-shaded-rest-client-${version}.jar\n    \u251c\u2500\u2500 juneau-shaded-rest-server-${version}.jar\n    \u251c\u2500\u2500 juneau-shaded-rest-server-springboot-${version}.jar\n    \u2514\u2500\u2500 juneau-shaded-all-${version}.jar\n"})}),"\n",(0,a.jsx)(n.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,a.jsx)(n.h3,{id:"individual-shaded-artifacts",children:"Individual Shaded Artifacts"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedCore",children:"Juneau Shaded Core"})})," - Core marshalling and configuration"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestClient",children:"Juneau Shaded REST Client"})})," - REST client development"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServer",children:"Juneau Shaded REST Server"})})," - REST server development"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedRestServerSpringboot",children:"Juneau Shaded REST Server Spring Boot"})})," - Spring Boot integration"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/topics/JuneauShadedAll",children:"Juneau Shaded All"})})," - Complete framework"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/juneau-shaded/README.md",children:"Shaded Module README"})})," - Complete technical documentation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"https://juneau.apache.org",children:"Juneau Documentation"})})," - Official Juneau docs"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"https://bazel.build",children:"Bazel Documentation"})})," - Learn more about Bazel"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"mailto:dev@juneau.apache.org",children:"Apache Juneau Mailing List"})})," - Get help from the community"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var r=s(96540);const a={},i=r.createContext(a);function d(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);