"use strict";(globalThis.webpackChunkjuneau_documentation=globalThis.webpackChunkjuneau_documentation||[]).push([[4004],{11076:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"topics/23.03.00.ScriptRelease","title":"release.py","description":"release.py automates the complete release process for Apache Juneau, including prerequisite checks, building, testing, Maven release, binary artifact creation, and SVN distribution upload.","source":"@site/pages/topics/23.03.00.ScriptRelease.md","sourceDirName":"topics","slug":"/topics/ScriptRelease","permalink":"/docs/topics/ScriptRelease","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/juneau/tree/master/docs/pages/topics/23.03.00.ScriptRelease.md","tags":[],"version":"current","frontMatter":{"title":"release.py","slug":"ScriptRelease"},"sidebar":"mainSidebar","previous":{"title":"23.2. push.py","permalink":"/docs/topics/ScriptPush"},"next":{"title":"23.4. release-docs-stage.py","permalink":"/docs/topics/ScriptReleaseDocsStage"}}');var r=i(74848),l=i(28453);const t={title:"release.py",slug:"ScriptRelease"},a=void 0,c={},o=[{value:"What It Does",id:"what-it-does",level:2},{value:"Usage",id:"usage",level:2},{value:"Start a New Release",id:"start-a-new-release",level:3},{value:"Resume from a Step",id:"resume-from-a-step",level:3},{value:"List Available Steps",id:"list-available-steps",level:3},{value:"Skip Specific Steps",id:"skip-specific-steps",level:3},{value:"Resume from Last Checkpoint",id:"resume-from-last-checkpoint",level:3},{value:"Command-Line Options",id:"command-line-options",level:2},{value:"Required (for new releases)",id:"required-for-new-releases",level:3},{value:"Optional",id:"optional",level:3},{value:"Environment Variables",id:"environment-variables",level:2},{value:"History Files",id:"history-files",level:2},{value:"Checkpoint/Resume",id:"checkpointresume",level:2},{value:"Vote Email Generation",id:"vote-email-generation",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Notes",id:"notes",level:2}];function d(e){const s={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"release.py"})," automates the complete release process for Apache Juneau, including prerequisite checks, building, testing, Maven release, binary artifact creation, and SVN distribution upload."]}),"\n",(0,r.jsx)(s.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,r.jsx)(s.p,{children:"The script performs the following steps:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Check Prerequisites"})," - Verifies required tools are available"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Check Java Version"})," - Automatically detects and verifies Java 17+"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Check Maven Version"})," - Automatically detects and verifies Maven 3+"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Clean Maven Repository"})," - Cleans local Maven repo (only on first run for a version)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Make Git Folder"})," - Creates staging directory"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Clone Juneau"})," - Clones the repository to staging directory"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configure Git"})," - Sets up git user and email"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Clean Verify"})," - Builds and verifies the project"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Javadoc Aggregate"})," - Generates aggregate javadocs"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Create Test Workspace"})," - Creates a test workspace"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Deploy"})," - Deploys to Maven staging repository"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Release Prepare"})," - Prepares the Maven release"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Git Diff"})," - Shows changes made by release",":prepare"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Run Release Perform"})," - Performs the Maven release"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Create Binary Artifacts"})," - Downloads and processes source/binary artifacts"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Verify Distribution"})," - Verifies files on Apache distribution site"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(s.h3,{id:"start-a-new-release",children:"Start a New Release"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release.py --rc 1\n"})}),"\n",(0,r.jsx)(s.h3,{id:"resume-from-a-step",children:"Resume from a Step"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release.py --start-step run_release_perform\n"})}),"\n",(0,r.jsx)(s.h3,{id:"list-available-steps",children:"List Available Steps"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release.py --list-steps\n"})}),"\n",(0,r.jsx)(s.h3,{id:"skip-specific-steps",children:"Skip Specific Steps"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release.py --rc 1 --skip-step clean_maven_repo\n"})}),"\n",(0,r.jsx)(s.h3,{id:"resume-from-last-checkpoint",children:"Resume from Last Checkpoint"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release.py --resume\n"})}),"\n",(0,r.jsx)(s.h2,{id:"command-line-options",children:"Command-Line Options"}),"\n",(0,r.jsx)(s.h3,{id:"required-for-new-releases",children:"Required (for new releases)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--rc RC_NUMBER"})," - Release candidate number (e.g., ",(0,r.jsx)(s.code,{children:"--rc 1"})," for RC1)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"optional",children:"Optional"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--start-step STEP_NAME"})," - Start execution from the specified step"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--list-steps"})," - List all available steps and exit"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--skip-step STEP_NAME"})," - Skip a specific step (can be used multiple times)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--resume"})," - Resume from the last checkpoint (if available)"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsx)(s.p,{children:"The script prompts for and sets the following environment variables:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_VERSION"})," - Current release version (detected from pom.xml)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_NEXT_VERSION"})," - Next version (calculated)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_RELEASE"}),' - Full release name (e.g., "juneau-9.2.0-RC1")']}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_RELEASE_CANDIDATE"})," - Release candidate number"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_STAGING"})," - Staging directory path"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_USERNAME"})," - Apache username"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_EMAIL"})," - Apache email"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_GIT_BRANCH"})," - Git branch name"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_JAVA_HOME"})," - Java home directory"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"X_CLEANM2"})," - Whether to clean Maven repo (Y/N)"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"history-files",children:"History Files"}),"\n",(0,r.jsxs)(s.p,{children:["The script maintains history files (",(0,r.jsx)(s.code,{children:"release-history-{version}.json"}),") that store:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Default values for prompts"}),"\n",(0,r.jsx)(s.li,{children:"Last run date"}),"\n",(0,r.jsx)(s.li,{children:"Previous configuration values"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"This allows the script to provide intelligent defaults on subsequent runs."}),"\n",(0,r.jsx)(s.h2,{id:"checkpointresume",children:"Checkpoint/Resume"}),"\n",(0,r.jsx)(s.p,{children:"The script supports checkpoint/resume functionality:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["State is saved to ",(0,r.jsx)(s.code,{children:"~/.juneau-release-state.json"})]}),"\n",(0,r.jsxs)(s.li,{children:["You can resume from any step using ",(0,r.jsx)(s.code,{children:"--resume"})," or ",(0,r.jsx)(s.code,{children:"--start-step"})]}),"\n",(0,r.jsxs)(s.li,{children:["The ",(0,r.jsx)(s.code,{children:"--rc"})," parameter is optional when resuming (extracted from state/history)"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"vote-email-generation",children:"Vote Email Generation"}),"\n",(0,r.jsx)(s.p,{children:"After successful distribution verification, the script automatically generates a vote email body with:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Version and RC number"}),"\n",(0,r.jsx)(s.li,{children:"Distribution URLs"}),"\n",(0,r.jsx)(s.li,{children:"SHA-512 checksums (fetched from URLs)"}),"\n",(0,r.jsx)(s.li,{children:"Git commit hash"}),"\n",(0,r.jsx)(s.li,{children:"Vote end date (72 hours from now)"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"The email is printed to the console."}),"\n",(0,r.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Python 3.6 or higher"}),"\n",(0,r.jsx)(s.li,{children:"Java 17 or higher"}),"\n",(0,r.jsx)(s.li,{children:"Maven 3 or higher"}),"\n",(0,r.jsx)(s.li,{children:"Git"}),"\n",(0,r.jsx)(s.li,{children:"GPG (for signing)"}),"\n",(0,r.jsx)(s.li,{children:"SVN client (for distribution upload)"}),"\n",(0,r.jsx)(s.li,{children:"wget (for downloading artifacts)"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["The script automatically excludes ",(0,r.jsx)(s.code,{children:"juneau-docs"})," from the source release zip"]}),"\n",(0,r.jsx)(s.li,{children:"Source and binary artifacts are downloaded from Maven staging repository"}),"\n",(0,r.jsx)(s.li,{children:"Distribution verification checks for expected files on Apache distribution site"}),"\n",(0,r.jsxs)(s.li,{children:["The script uses ",(0,r.jsx)(s.code,{children:"current-release.py"})," and ",(0,r.jsx)(s.code,{children:"maven-version.py"})," for version detection"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>t,x:()=>a});var n=i(96540);const r={},l=n.createContext(r);function t(e){const s=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);