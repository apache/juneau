"use strict";(globalThis.webpackChunkjuneau_documentation=globalThis.webpackChunkjuneau_documentation||[]).push([[6249],{7527:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>n,toc:()=>r});const n=JSON.parse('{"id":"topics/23.09.00.ScriptBuildDocs","title":"build-docs.py","description":"build-docs.py builds the complete Apache Juneau documentation, including both Docusaurus documentation and Maven-generated Javadocs. This script replicates the documentation generation steps from the GitHub Actions workflow, allowing you to build and test the documentation locally.","source":"@site/pages/topics/23.09.00.ScriptBuildDocs.md","sourceDirName":"topics","slug":"/topics/ScriptBuildDocs","permalink":"/docs/topics/ScriptBuildDocs","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/juneau/tree/master/docs/pages/topics/23.09.00.ScriptBuildDocs.md","tags":[],"version":"current","frontMatter":{"title":"build-docs.py","slug":"ScriptBuildDocs"},"sidebar":"mainSidebar","previous":{"title":"23.8. maven-version.py","permalink":"/docs/topics/ScriptMavenVersion"},"next":{"title":"23.10. create-mvn-site.py","permalink":"/docs/topics/ScriptCreateMvnSite"}}');var t=i(74848),o=i(28453);const c={title:"build-docs.py",slug:"ScriptBuildDocs"},d=void 0,l={},r=[{value:"What It Does",id:"what-it-does",level:2},{value:"Usage",id:"usage",level:2},{value:"Build all documentation",id:"build-all-documentation",level:3},{value:"Skip specific steps",id:"skip-specific-steps",level:3},{value:"Command-Line Options",id:"command-line-options",level:2},{value:"Output Location",id:"output-location",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Notes",id:"notes",level:2},{value:"Build Order",id:"build-order",level:2},{value:"Integration with CI/CD",id:"integration-with-cicd",level:2}];function a(e){const s={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"build-docs.py"})," builds the complete Apache Juneau documentation, including both Docusaurus documentation and Maven-generated Javadocs. This script replicates the documentation generation steps from the GitHub Actions workflow, allowing you to build and test the documentation locally."]}),"\n",(0,t.jsx)(s.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,t.jsx)(s.p,{children:"The script performs the following steps:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Installs npm dependencies"})," - Runs ",(0,t.jsx)(s.code,{children:"npm ci"})," in the ",(0,t.jsx)(s.code,{children:"juneau-docs"})," directory"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Compiles Java modules"})," - Runs ",(0,t.jsx)(s.code,{children:"mvn clean install -DskipTests"})," to build all modules"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Generates Maven site"})," - Runs ",(0,t.jsx)(s.code,{children:"mvn site -DskipTests"})," to generate the Maven project site (includes aggregate javadocs)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Copies current javadocs"})," - Copies generated javadocs to ",(0,t.jsx)(s.code,{children:"juneau-docs/static/javadocs/<current-release>/"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Updates javadocs index"})," - Updates ",(0,t.jsx)(s.code,{children:"releases.json"})," with version information"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Copies Maven site"})," - Copies the generated site to ",(0,t.jsx)(s.code,{children:"juneau-docs/static/site/"})," (Docusaurus will copy to build)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Builds Docusaurus"})," - Runs ",(0,t.jsx)(s.code,{children:"npm run build"})," to generate the static Docusaurus site (copies static/ to build/)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Copies .asf.yaml"})," - Copies the ASF configuration file to the build directory"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Verifies apidocs"})," - Checks that the javadocs were successfully generated"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Checks topic links"})," - Validates all documentation links"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(s.h3,{id:"build-all-documentation",children:"Build all documentation"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cd /path/to/juneau\npython3 scripts/build-docs.py\n"})}),"\n",(0,t.jsx)(s.p,{children:"This will build both the Docusaurus documentation and the Maven site with javadocs."}),"\n",(0,t.jsx)(s.h3,{id:"skip-specific-steps",children:"Skip specific steps"}),"\n",(0,t.jsx)(s.p,{children:"You can skip individual steps if you only need to rebuild part of the documentation:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Skip npm steps (useful if you only changed Java code)\npython3 scripts/build-docs.py --skip-npm\n\n# Skip Maven steps (useful if you only changed Docusaurus docs)\npython3 scripts/build-docs.py --skip-maven\n\n# Skip copying step (useful for testing without updating build directory)\npython3 scripts/build-docs.py --skip-copy\n\n# Build for staging (sets SITE_URL for staging environment)\npython3 scripts/build-docs.py --staging\n"})}),"\n",(0,t.jsx)(s.h2,{id:"command-line-options",children:"Command-Line Options"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--skip-npm"})," - Skip npm install and Docusaurus build"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--skip-maven"})," - Skip Maven compilation and site generation"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--skip-copy"})," - Skip copying Maven site to static directory"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--staging"})," - Build for staging environment (sets SITE_URL)"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"output-location",children:"Output Location"}),"\n",(0,t.jsx)(s.p,{children:"After successful execution, the documentation will be available in:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Docusaurus docs"}),": ",(0,t.jsx)(s.code,{children:"juneau-docs/build/"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Maven site"}),": ",(0,t.jsx)(s.code,{children:"juneau-docs/build/site/"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Javadocs"}),": ",(0,t.jsx)(s.code,{children:"juneau-docs/build/javadocs/"})," (versioned, copied from static/javadocs) and ",(0,t.jsx)(s.code,{children:"juneau-docs/build/site/apidocs/"})," (current)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Javadocs index"}),": ",(0,t.jsx)(s.code,{children:"juneau-docs/build/javadocs/index.html"})," (dynamically loads from ",(0,t.jsx)(s.code,{children:"releases.json"}),")"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Python 3.6 or higher"}),"\n",(0,t.jsx)(s.li,{children:"No external Python dependencies (uses only standard library)"}),"\n",(0,t.jsx)(s.li,{children:"Node.js 18+ and npm"}),"\n",(0,t.jsx)(s.li,{children:"Maven 3.6+ and Java 17+"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The script automatically skips tests (",(0,t.jsx)(s.code,{children:"-DskipTests"}),") to speed up the build"]}),"\n",(0,t.jsx)(s.li,{children:"All commands are run from the project root directory"}),"\n",(0,t.jsxs)(s.li,{children:["The script will exit immediately if any command fails (unless using ",(0,t.jsx)(s.code,{children:"--skip-*"})," options)"]}),"\n",(0,t.jsxs)(s.li,{children:["The build directory (",(0,t.jsx)(s.code,{children:"juneau-docs/build/"}),") will be created if it doesn't exist"]}),"\n",(0,t.jsx)(s.li,{children:"Existing site contents will be replaced when copying"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"build-order",children:"Build Order"}),"\n",(0,t.jsxs)(s.p,{children:["The script copies Maven site to ",(0,t.jsx)(s.code,{children:"static/site/"})," and updates javadocs in ",(0,t.jsx)(s.code,{children:"static/javadocs/"})," ",(0,t.jsx)(s.strong,{children:"before"})," building Docusaurus. Docusaurus automatically copies everything from the ",(0,t.jsx)(s.code,{children:"static/"})," directory to the ",(0,t.jsx)(s.code,{children:"build/"})," directory during the build process, so the files are available when Docusaurus processes links, preventing broken link warnings."]}),"\n",(0,t.jsx)(s.h2,{id:"integration-with-cicd",children:"Integration with CI/CD"}),"\n",(0,t.jsx)(s.p,{children:"This script is used by the documentation release scripts:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"release-docs-stage.py"})," - Calls ",(0,t.jsx)(s.code,{children:"build-docs.py --staging"})," to build for staging"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"release-docs.py"})," - Promotes already-built documentation from staging to production"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>c,x:()=>d});var n=i(96540);const t={},o=n.createContext(t);function c(e){const s=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);