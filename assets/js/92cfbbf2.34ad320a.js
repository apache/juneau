"use strict";(globalThis.webpackChunkjuneau_documentation=globalThis.webpackChunkjuneau_documentation||[]).push([[5841],{22561:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"developer-info/04.03.01.ScriptReleaseDocsStage","title":"release-docs-stage.py","description":"release-docs-stage.py builds the documentation and deploys it to the asf-staging branch, making it available on the staging website.","source":"@site/pages/developer-info/04.03.01.ScriptReleaseDocsStage.md","sourceDirName":"developer-info","slug":"/developer-info/ScriptReleaseDocsStage","permalink":"/docs/developer-info/ScriptReleaseDocsStage","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/juneau/tree/master/docs/pages/developer-info/04.03.01.ScriptReleaseDocsStage.md","tags":[],"version":"current","frontMatter":{"title":"release-docs-stage.py","slug":"ScriptReleaseDocsStage"},"sidebar":"mainSidebar","previous":{"title":"4.2.13. start-examples-rest-springboot.py","permalink":"/docs/developer-info/ScriptStartExamplesRestSpringboot"},"next":{"title":"4.3.2. release-docs.py","permalink":"/docs/developer-info/ScriptReleaseDocs"}}');var n=i(74848),o=i(28453);const l={title:"release-docs-stage.py",slug:"ScriptReleaseDocsStage"},c=void 0,r={},d=[{value:"What It Does",id:"what-it-does",level:2},{value:"Usage",id:"usage",level:2},{value:"Deploy to Staging",id:"deploy-to-staging",level:3},{value:"Custom Commit Message",id:"custom-commit-message",level:3},{value:"Test Without Pushing",id:"test-without-pushing",level:3},{value:"Command-Line Options",id:"command-line-options",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Exit Codes",id:"exit-codes",level:2},{value:"Notes",id:"notes",level:2},{value:"Workflow",id:"workflow",level:2}];function a(e){const s={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"release-docs-stage.py"})," builds the documentation and deploys it to the ",(0,n.jsx)(s.code,{children:"asf-staging"})," branch, making it available on the staging website."]}),"\n",(0,n.jsx)(s.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,n.jsx)(s.p,{children:"The script:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Runs ",(0,n.jsx)(s.code,{children:"build-docs.py"})," with ",(0,n.jsx)(s.code,{children:"--staging"})," flag to build documentation for staging"]}),"\n",(0,n.jsx)(s.li,{children:"Clones the repository to a temporary directory"}),"\n",(0,n.jsxs)(s.li,{children:["Checks out the ",(0,n.jsx)(s.code,{children:"asf-staging"})," branch (or creates it if it doesn't exist)"]}),"\n",(0,n.jsxs)(s.li,{children:["Removes all existing files (except ",(0,n.jsx)(s.code,{children:".git"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:["Copies the built documentation from ",(0,n.jsx)(s.code,{children:"juneau-docs/build"})," to the temp directory"]}),"\n",(0,n.jsx)(s.li,{children:"Adds and commits the changes"}),"\n",(0,n.jsxs)(s.li,{children:["Pushes to the remote ",(0,n.jsx)(s.code,{children:"asf-staging"})," branch"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(s.h3,{id:"deploy-to-staging",children:"Deploy to Staging"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release-docs-stage.py\n"})}),"\n",(0,n.jsx)(s.h3,{id:"custom-commit-message",children:"Custom Commit Message"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'python3 scripts/release-docs-stage.py --commit-message "Updated API documentation"\n'})}),"\n",(0,n.jsx)(s.h3,{id:"test-without-pushing",children:"Test Without Pushing"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"python3 scripts/release-docs-stage.py --no-push\n"})}),"\n",(0,n.jsx)(s.h2,{id:"command-line-options",children:"Command-Line Options"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"--no-push"})," - Build and commit but don't push to remote"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"--commit-message MESSAGE"}),' - Custom commit message (default: "Deploy documentation staging")']}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Python 3.6 or higher"}),"\n",(0,n.jsx)(s.li,{children:"Git (git command must be in PATH)"}),"\n",(0,n.jsxs)(s.li,{children:["All prerequisites for ",(0,n.jsx)(s.code,{children:"build-docs.py"})," (Node.js, npm, Maven, Java)"]}),"\n",(0,n.jsx)(s.li,{children:"Write access to the remote repository"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"exit-codes",children:"Exit Codes"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"0"})," - Success"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"1"})," - Error occurred"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"The script uses a temporary directory for git operations"}),"\n",(0,n.jsx)(s.li,{children:"The temp directory is automatically cleaned up after successful push"}),"\n",(0,n.jsxs)(s.li,{children:["If ",(0,n.jsx)(s.code,{children:"--no-push"})," is used, the temp directory is not cleaned up (for manual inspection)"]}),"\n",(0,n.jsxs)(s.li,{children:["The script sets ",(0,n.jsx)(s.code,{children:"SITE_URL"})," environment variable to ",(0,n.jsx)(s.code,{children:"https://juneau.staged.apache.org"})," when building"]}),"\n",(0,n.jsx)(s.li,{children:"A success sound is played when the script completes successfully"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"workflow",children:"Workflow"}),"\n",(0,n.jsx)(s.p,{children:"This script is typically used as part of the documentation release workflow:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Make documentation changes"}),"\n",(0,n.jsxs)(s.li,{children:["Run ",(0,n.jsx)(s.code,{children:"release-docs-stage.py"})," to deploy to staging"]}),"\n",(0,n.jsx)(s.li,{children:"Review the staging site"}),"\n",(0,n.jsxs)(s.li,{children:["Run ",(0,n.jsx)(s.code,{children:"release-docs.py"})," to promote to production"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>c});var t=i(96540);const n={},o=t.createContext(n);function l(e){const s=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);