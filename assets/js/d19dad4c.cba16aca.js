"use strict";(self.webpackChunkjuneau_documentation=self.webpackChunkjuneau_documentation||[]).push([[85],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}},54110:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"topics/02.15.00.Recursion","title":"Non-Tree Models and Recursion Detection","description":"The Juneau Serializer API is designed to be used against POJO tree structures.","source":"@site/docs/topics/02.15.00.Recursion.md","sourceDirName":"topics","slug":"/topics/02.15.00.Recursion","permalink":"/docs/topics/02.15.00.Recursion","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/juneau/tree/main/juneau-docs-poc/juneau-documentation/docs/topics/02.15.00.Recursion.md","tags":[],"version":"current","frontMatter":{"title":"Non-Tree Models and Recursion Detection"},"sidebar":"tutorialSidebar","previous":{"title":"2.14. Virtual Beans","permalink":"/docs/topics/02.14.00.VirtualBeans"},"next":{"title":"2.16. Parsing into Generic Models","permalink":"/docs/topics/02.16.00.ParsingIntoGenericModels"}}');var i=t(74848),o=t(28453);const r={title:"Non-Tree Models and Recursion Detection"},a=void 0,c={},l=[];function u(e){const n={a:"a",admonition:"admonition",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The Juneau Serializer API is designed to be used against POJO tree structures.\nIt expects that there not be loops in the POJO model (e.g.\nchildren with references to parents, etc...).\nIf you try to serialize models with loops, you will usually cause a ",(0,i.jsx)(n.code,{children:"StackOverflowError"})," to be thrown (if ",(0,i.jsx)(n.a,{href:"../apidocs/org/apache/juneau/BeanTraverseContext/Builder.html#maxDepth(int)",children:"BeanTraverseContext.Builder.maxDepth(int)"})," is not reached first)."]}),"\n",(0,i.jsxs)(n.p,{children:["If you still want to use the Juneau serializers on such models, Juneau provides the ",(0,i.jsx)(n.a,{href:"../apidocs/org/apache/juneau/BeanTraverseContext/Builder.html#detectRecursions()",children:"BeanTraverseContext.Builder.detectRecursions()"})," setting.\nIt tells the serializer to look for instances of an object in the current branch of the tree and skip serialization when\na duplicate is encountered."]}),"\n",(0,i.jsx)(n.p,{children:"For example, let's make a POJO model out of the following classes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"public class A {\n    public B b;\n}\n\npublic class B {\n    public C c;\n}\n\npublic class C {\n    public A a;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now we create a model with a loop and serialize the results."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// Clone an existing serializer and set property for detecting recursions.\nWriterSerializer serializer = Json5Serializer\n    .DEFAULT_READABLE\n    .copy()\n    .detectRecursions()\n    .build();\n\n// Create a recursive loop.\nA a = new A();\na.b = new B();\na.b.c = new C();\na.b.c.a = a;\n\n// Serialize to JSON.\nString json = serializer.serialize(a);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["What we end up with is the following, which does not serialize the contents of the ",(0,i.jsx)(n.code,{children:"c"})," field:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"{\n    b: {\n        c: {\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Without recursion detection enabled, this would cause a stack-overflow error."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Recursion detection introduces a performance penalty of around 20%.\nFor this reason the setting is disabled by default."})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);